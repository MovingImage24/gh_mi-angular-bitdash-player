/*! Hive Stats Pack Copyright(c) 2019 HiveStreaming AB, All rights reserved. 
* Version: bitmovin-6.0.0
* Enabled Hive Techs: Java, WebRTC, Stats Only
*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}}(function(){return function a(o,s,c){function d(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return d(o[t][1][e]||e)},i,i.exports,a,o,s,c)}return s[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}({1:[function(e,t,r){"use strict";var n=(0,e("./adapter_factory.js").adapterFactory)({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=a.log,n=a.detectBrowser(e),i={browserDetails:n,commonShim:p,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(n.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;r("adapter.js shimming chrome."),(i.browserShim=o).shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),(i.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),i;r("adapter.js shimming edge."),(i.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"safari":if(!d||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),(i.browserShim=d).shimRTCIceServerUrls(e),d.shimCreateOfferLegacy(e),d.shimCallbacksAPI(e),d.shimLocalStreamsAPI(e),d.shimRemoteStreamsAPI(e),d.shimTrackEventTransceiver(e),d.shimGetUserMedia(e),p.shimRTCIceCandidate(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return i};var a=n(e("./utils")),o=n(e("./chrome/chrome_shim")),s=n(e("./edge/edge_shim")),c=n(e("./firefox/firefox_shim")),d=n(e("./safari/safari_shim")),p=n(e("./common_shim"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(a){if("object"!==(void 0===a?"undefined":s(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)c.wrapPeerConnectionEvent(a,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track};var r=new Event("track");r.track=t.track,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)}),n.stream.getTracks().forEach(function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t};var r=new Event("track");r.track=t,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var n=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=i.apply(this,arguments);return r||(r=n(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(n(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;this._senders=this._senders||[],t.apply(this,[e]),e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});e&&r._senders.splice(r._senders.indexOf(e),1)})}}else if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this,i=arguments;if(0<arguments.length&&"function"==typeof e)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof e))return s.apply(this,[]);function a(e){var n={};return e.result().forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)}),n[r.id]=r}),n}function o(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}if(2<=arguments.length){return s.apply(this,[function(e){i[1](o(a(e)))},e])}return new Promise(function(t,e){s.apply(n,[function(e){t(o(a(e)))},e])}).then(t,r)}},r.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(r?i=!0:r=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(n?i=!0:n=e),e.track===t}),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},r.shimAddTrackRemoveTrackWithNative=d,r.shimAddTrackRemoveTrack=function(o){if(!o.RTCPeerConnection)return;var e=c.detectBrowser(o);if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return d(o);var r=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var n=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[e.id]){var t=new o.MediaStream(e.getTracks());this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t}n.apply(this,[e])};var t=o.RTCPeerConnection.prototype.removeStream;function i(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i})}o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[e.id];if(i)i.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var a=new o.MediaStream([t]);this._streams[e.id]=a,this._reverseStreams[a.id]=e,this.addStream(a)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var t=o.RTCPeerConnection.prototype[e];o.RTCPeerConnection.prototype[e]=function(){var r=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?t.apply(this,[function(e){var t=i(r,e);n[0].apply(null,[t])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):t.apply(this,arguments).then(function(e){return i(r,e)})}});var a=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=function(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)}),new RTCSessionDescription({type:e.type,sdp:i})}(this,arguments[0])),a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:i(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}},r.shimPeerConnection=function(r){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);if(!r.RTCPeerConnection)return;["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},r.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var c=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils.js"));function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();i.apply(this,arguments);var n=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},r&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);-1!==t&&n._shimmedLocalStreams[e].splice(t,1),1===n._shimmedLocalStreams[e].length&&delete n._shimmedLocalStreams[e]}),a.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(a,e){if(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)return;if(!a.navigator.mediaDevices)return;if("function"!=typeof e)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");a.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(function(e){var t=i.video&&i.video.width,r=i.video&&i.video.height,n=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:n||3}},t&&(i.video.mandatory.maxWidth=t),r&&(i.video.mandatory.maxHeight=r),a.navigator.mediaDevices.getUserMedia(i)})}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var o=e&&e.navigator;if(!o.mediaDevices)return;function s(i){if("object"!==(void 0===i?"undefined":d(i))||i.mandatory||i.optional)return i;var a={};return Object.keys(i).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var r="object"===d(i[t])?i[t]:{ideal:i[t]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){a.optional=a.optional||[];var e={};"number"==typeof r.ideal?(e[n("min",t)]=r.ideal,a.optional.push(e),(e={})[n("max",t)]=r.ideal):e[n("",t)]=r.ideal,a.optional.push(e)}void 0!==r.exact&&"number"!=typeof r.exact?(a.mandatory=a.mandatory||{},a.mandatory[n("",t)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(a.mandatory=a.mandatory||{},a.mandatory[n(e,t)]=r[e])})}}),i.advanced&&(a.optional=(a.optional||[]).concat(i.advanced)),a}function n(r,n){if(61<=c.version)return n(r);if((r=JSON.parse(JSON.stringify(r)))&&"object"===d(r.audio)){var e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e((r=JSON.parse(JSON.stringify(r))).audio,"autoGainControl","googAutoGainControl"),e(r.audio,"noiseSuppression","googNoiseSuppression"),r.audio=s(r.audio)}if(r&&"object"===d(r.video)){var i=r.video.facingMode;i=i&&("object"===(void 0===i?"undefined":d(i))?i:{ideal:i});var t=c.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||t)){delete r.video.facingMode;var a=void 0;if("environment"===i.exact||"environment"===i.ideal?a=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(a=["front"]),a)return o.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return a.some(function(e){return t.label.toLowerCase().includes(e)})});return!t&&e.length&&a.includes("back")&&(t=e[e.length-1]),t&&(r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),r.video=s(r.video),p("chrome: "+JSON.stringify(r)),n(r)})}r.video=s(r.video)}return p("chrome: "+JSON.stringify(r)),n(r)}function i(e){return 64<=c.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}}var c=a.detectBrowser(e);if(o.getUserMedia=function(e,t,r){n(e,function(e){o.webkitGetUserMedia(e,t,function(e){if(r){r(i(e))}})})}.bind(o),o.mediaDevices.getUserMedia){var r=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return n(e,function(t){return r(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(i(e))})})}}};var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils.js"));var p=a.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new i(e),r=s.default.parseCandidate(e.candidate),n=Object.assign(t,r);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new i(e)},t.RTCIceCandidate.prototype=i.prototype,c.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})},r.shimMaxMessageSize=function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection)return;var a=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,function(e){if(!e||!e.sdp)return!1;var t=s.default.splitSections(e.sdp);return t.shift(),t.some(function(e){var t=s.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var e=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),t=function(e){var t=65536;return"firefox"===a.browser&&(t=a.version<57?-1===e?16384:2147483637:a.version<60?57===a.version?65535:65536:2147483637),t}(e),r=function(e,t){var r=65536;"firefox"===a.browser&&57===a.version&&(r=65535);var n=s.default.matchPrefix(e.sdp,"a=max-message-size:");return 0<n.length?r=parseInt(n[0].substr(19),10):"firefox"===a.browser&&-1!==t&&(r=2147483637),r}(arguments[0],e),n=void 0;n=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);var i={};Object.defineProperty(i,"maxMessageSize",{get:function(){return n}}),this._sctp=i}return o.apply(this,arguments)}},r.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,n){var i=r.send;r.send=function(){var e=arguments[0],t=e.length||e.size||e.byteLength;if("open"===r.readyState&&n.sctp&&t>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},r.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})},r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=c.detectBrowser(e);if("chrome"===t.browser&&71<=t.version)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),r.apply(this,arguments)}};var n,i=e("sdp"),s=(n=i)&&n.__esModule?n:{default:n},c=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=(0,d.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,s.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(a=c)&&a.__esModule?a:{default:a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?n=!0:t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})};var i=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(r){var n=s.detectBrowser(r);if("object"!==(void 0===r?"undefined":o(r))||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){return a.apply(this,[e||null]).then(function(r){if(n.version<53&&!t)try{r.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return r}).then(t,r)}},r.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},r.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},r.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})}},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(r,n){if(r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices)return;if(!r.navigator.mediaDevices)return;r.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,r.navigator.mediaDevices.getUserMedia(e);var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=d.detectBrowser(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":c(e))&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":c(e))&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}};var d=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getTracks().forEach(function(e){return n.call(r,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e,t){return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),n.call(this,e,t)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)})}})},r.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(e)){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!(0<=r._remoteStreams.indexOf(e))){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})}),t.apply(r,arguments)}}},r.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,i=t.createOffer,a=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=a.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};var r=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=r,r=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=r,r=function(e,t,r){var n=c.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=r},r.shimGetUserMedia=function(e){var n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var t=n.mediaDevices,r=t.getUserMedia.bind(t);n.mediaDevices.getUserMedia=function(e){return r(i(e))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n))},r.shimConstraints=i,r.shimRTCIceServerUrls=function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var r=[],n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(i=JSON.parse(JSON.stringify(i))).urls=i.url,delete i.url,r.push(i)):r.push(e.iceServers[n])}e.iceServers=r}return new a(e,t)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":d(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return n.apply(this,arguments)}};var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(e("../utils"));function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.extractVersion=a,r.wrapPeerConnectionEvent=function(e,n,i){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,a=t.addEventListener;t.addEventListener=function(e,r){if(e!==n)return a.apply(this,arguments);function t(e){var t=i(e);t&&r(t)}return this._eventMap=this._eventMap||{},this._eventMap[r]=t,a.apply(this,[e,t])};var o=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);var r=this._eventMap[t];return delete this._eventMap[t],o.apply(this,[e,r])},Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),e&&this.addEventListener(n,this["_on"+n]=e)},enumerable:!0,configurable:!0})},r.disableLog=function(e){return"boolean"==typeof e?(n=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.log=function(){if("object"===("undefined"==typeof window?"undefined":s(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},r.deprecated=function(e,t){if(!i)return;console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function a(o){if("object"!==(void 0===o?"undefined":s(o)))return o;return Object.keys(o).reduce(function(e,t){var r="object"===s(o[t]),n=r?a(o[t]):o[t],i=r&&!Object.keys(n).length;return void 0===n||i?e:Object.assign(e,c({},t,n))},{})},r.walkStats=o,r.filterStats=function(r,t,e){var n=e?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return r.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){r.forEach(function(e){e.type===n&&e.trackId===t.id&&o(r,e,i)})}),i};var n=!0,i=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function o(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(e){e.endsWith("Id")?o(t,t.get(r[e]),n):e.endsWith("Ids")&&r[e].forEach(function(e){o(t,t.get(e),n)})}))}},{}],16:[function(e,t,r){"use strict";var G=e("sdp");function c(e,t,r,n,i){var a=G.writeRtpDescription(e.kind,t);if(a+=G.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=G.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(n?n.id:"-")+" "+o+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+G.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+G.localCName+"\r\n"),a}function A(d,p){function u(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]}var f={codecs:[],headerExtensions:[],fecMechanisms:[]};return d.codecs.forEach(function(r){for(var e=0;e<p.codecs.length;e++){var t=p.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&t.parameters.apt&&(n=r,i=t,a=d.codecs,o=p.codecs,c=s=void 0,s=u(n.parameters.apt,a),c=u(i.parameters.apt,o),!s||!c||s.name.toLowerCase()!==c.name.toLowerCase()))continue;(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(r.numChannels,t.numChannels),f.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}var n,i,a,o,s,c}),d.headerExtensions.forEach(function(e){for(var t=0;t<p.headerExtensions.length;t++){var r=p.headerExtensions[t];if(e.uri===r.uri){f.headerExtensions.push(r);break}}}),f}function a(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function N(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function m(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(I,j){function L(e,t){t.addTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("addtrack",{track:e}))}function i(e,t,r,n){var i=new Event("track");i.track=t,i.receiver=r,i.transceiver={receiver:r},i.streams=n,I.setTimeout(function(){e._dispatchEvent("track",i)})}function n(e){var t=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw m("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=function(e,n){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!i?i=!0:0===e.indexOf("stun:")&&14393<=n&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers||[],j),this._iceGatherers=[],e.iceCandidatePoolSize)for(var n=e.iceCandidatePoolSize;0<n;n--)this._iceGatherers.push(new I.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=G.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},n.prototype.addTrack=function(t,e){if(this._isClosed)throw m("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw m("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(r=this.transceivers[n]);return r=r||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),r.track=t,r.stream=e,r.rtpSender=new I.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},n.prototype.addStream=function(t){var r=this;if(15025<=j)t.getTracks().forEach(function(e){r.addTrack(e,t)});else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},n.prototype.removeTrack=function(t){if(this._isClosed)throw m("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof I.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw m("InvalidAccessError","Sender was not created by this connection.");var r=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});e&&r.removeTrack(e)})},n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&0<r)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new I.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[r].bufferedCandidateEvents=[],this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;i.state=t?"completed":"gathering",null!==n.transceivers[r].bufferedCandidateEvents&&n.transceivers[r].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates),i},n.prototype._gather=function(s,c){var d=this,p=this.transceivers[c].iceGatherer;if(!p.onlocalcandidate){var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,p.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),p.onlocalcandidate=function(e){if(!(d.usingBundle&&0<c)){var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate,n=!r||0===Object.keys(r).length;if(n)"new"!==p.state&&"gathering"!==p.state||(p.state="completed");else{"new"===p.state&&(p.state="gathering"),r.component=1,r.ufrag=p.getLocalParameters().usernameFragment;var i=G.writeCandidate(r);t.candidate=Object.assign(t.candidate,G.parseCandidate(i)),t.candidate.candidate=i,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var a=G.getMediaSections(d._localDescription.sdp);a[t.candidate.sdpMLineIndex]+=n?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",d._localDescription.sdp=G.getDescription(d._localDescription.sdp)+a.join("");var o=d.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),n||d._dispatchEvent("icecandidate",t),o&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},I.setTimeout(function(){e.forEach(function(e){p.onlocalcandidate(e)})},0)}},n.prototype._createIceAndDtlsTransports=function(){var e=this,t=new I.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new I.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,t,r){var n=A(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:G.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),r&&e.rtpReceiver&&0<n.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&j<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,u,f=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(m("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,f.signalingState)||f._isClosed)return Promise.reject(m("InvalidStateError","Can not set local "+e.type+" in state "+f.signalingState));if("offer"===e.type)t=G.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){var r=G.parseRtpParameters(e);f.transceivers[t].localCapabilities=r}),f.transceivers.forEach(function(e,t){f._gather(e.mid,t)});else if("answer"===e.type){t=G.splitSections(f._remoteDescription.sdp),u=t.shift();var l=0<G.matchPrefix(u,"a=ice-lite").length;t.forEach(function(e,t){var r=f.transceivers[t],n=r.iceGatherer,i=r.iceTransport,a=r.dtlsTransport,o=r.localCapabilities,s=r.remoteCapabilities;if(!(G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length)&&!r.rejected){var c=G.getIceParameters(e,u),d=G.getDtlsParameters(e,u);l&&(d.role="server"),f.usingBundle&&0!==t||(f._gather(r.mid,t),"new"===i.state&&i.start(n,c,l?"controlling":"controlled"),"new"===a.state&&a.start(d));var p=A(o,s);f._transceive(r,0<p.codecs.length,!1)}})}return f._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?f._updateSignalingState("have-local-offer"):f._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(_){var w=this;if(-1===["offer","answer"].indexOf(_.type))return Promise.reject(m("TypeError",'Unsupported type "'+_.type+'"'));if(!a("setRemoteDescription",_.type,w.signalingState)||w._isClosed)return Promise.reject(m("InvalidStateError","Can not set remote "+_.type+" in state "+w.signalingState));var k={};w.remoteStreams.forEach(function(e){k[e.id]=e});var M=[],e=G.splitSections(_.sdp),D=e.shift(),x=0<G.matchPrefix(D,"a=ice-lite").length,O=0<G.matchPrefix(D,"a=group:BUNDLE ").length;w.usingBundle=O;var t=G.matchPrefix(D,"a=ice-options:")[0];return w.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var r=G.splitLines(e),n=G.getKind(e),i=G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length,a=r[0].substr(2).split(" ")[2],o=G.getDirection(e,D),s=G.parseMsid(e),c=G.getMid(e)||G.generateIdentifier();if(i||"application"===n&&("DTLS/SCTP"===a||"UDP/DTLS/SCTP"===a))w.transceivers[t]={mid:c,kind:n,protocol:a,rejected:!0};else{var d,p,u,f,l,m,h,v,y;!i&&w.transceivers[t]&&w.transceivers[t].rejected&&(w.transceivers[t]=w._createTransceiver(n,!0));var g,C,S=G.parseRtpParameters(e);i||(g=G.getIceParameters(e,D),(C=G.getDtlsParameters(e,D)).role="client"),h=G.parseRtpEncodingParameters(e);var T=G.parseRtcpParameters(e),R=0<G.matchPrefix(e,"a=end-of-candidates",D).length,P=G.matchPrefix(e,"a=candidate:").map(function(e){return G.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===_.type||"answer"===_.type)&&!i&&O&&0<t&&w.transceivers[t]&&(w._disposeIceAndDtlsTransports(t),w.transceivers[t].iceGatherer=w.transceivers[0].iceGatherer,w.transceivers[t].iceTransport=w.transceivers[0].iceTransport,w.transceivers[t].dtlsTransport=w.transceivers[0].dtlsTransport,w.transceivers[t].rtpSender&&w.transceivers[t].rtpSender.setTransport(w.transceivers[0].dtlsTransport),w.transceivers[t].rtpReceiver&&w.transceivers[t].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)),"offer"!==_.type||i){if("answer"===_.type&&!i){p=(d=w.transceivers[t]).iceGatherer,u=d.iceTransport,f=d.dtlsTransport,l=d.rtpReceiver,m=d.sendEncodingParameters,v=d.localCapabilities,w.transceivers[t].recvEncodingParameters=h,w.transceivers[t].remoteCapabilities=S,w.transceivers[t].rtcpParameters=T,P.length&&"new"===u.state&&(!x&&!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):u.setRemoteCandidates(P)),O&&0!==t||("new"===u.state&&u.start(p,g,"controlling"),"new"===f.state&&f.start(C)),!A(d.localCapabilities,d.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,w._transceive(d,"sendrecv"===o||"recvonly"===o,"sendrecv"===o||"sendonly"===o),!l||"sendrecv"!==o&&"sendonly"!==o?delete d.rtpReceiver:(y=l.track,s?(k[s.stream]||(k[s.stream]=new I.MediaStream),L(y,k[s.stream]),M.push([y,l,k[s.stream]])):(k.default||(k.default=new I.MediaStream),L(y,k.default),M.push([y,l,k.default])))}}else{(d=w.transceivers[t]||w._createTransceiver(n)).mid=c,d.iceGatherer||(d.iceGatherer=w._createIceGatherer(t,O)),P.length&&"new"===d.iceTransport.state&&(!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):d.iceTransport.setRemoteCandidates(P)),v=I.RTCRtpReceiver.getCapabilities(n),j<15019&&(v.codecs=v.codecs.filter(function(e){return"rtx"!==e.name})),m=d.sendEncodingParameters||[{ssrc:1001*(2*t+2)}];var b,E=!1;if("sendrecv"===o||"sendonly"===o){if(E=!d.rtpReceiver,l=d.rtpReceiver||new I.RTCRtpReceiver(d.dtlsTransport,n),E)y=l.track,s&&"-"===s.stream||(b=s?(k[s.stream]||(k[s.stream]=new I.MediaStream,Object.defineProperty(k[s.stream],"id",{get:function(){return s.stream}})),Object.defineProperty(y,"id",{get:function(){return s.track}}),k[s.stream]):(k.default||(k.default=new I.MediaStream),k.default)),b&&(L(y,b),d.associatedRemoteMediaStreams.push(b)),M.push([y,l,b])}else d.rtpReceiver&&d.rtpReceiver.track&&(d.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===d.rtpReceiver.track.id});t&&function(e,t){t.removeTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("removetrack",{track:e}))}(t,e)}),d.associatedRemoteMediaStreams=[]);d.localCapabilities=v,d.remoteCapabilities=S,d.rtpReceiver=l,d.rtcpParameters=T,d.sendEncodingParameters=m,d.recvEncodingParameters=h,w._transceive(w.transceivers[t],!1,E)}}}),void 0===w._dtlsRole&&(w._dtlsRole="offer"===_.type?"active":"passive"),w._remoteDescription={type:_.type,sdp:_.sdp},"offer"===_.type?w._updateSignalingState("have-remote-offer"):w._updateSignalingState("stable"),Object.keys(k).forEach(function(e){var n=k[e];if(n.getTracks().length){if(-1===w.remoteStreams.indexOf(n)){w.remoteStreams.push(n);var t=new Event("addstream");t.stream=n,I.setTimeout(function(){w._dispatchEvent("addstream",t)})}M.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&i(w,t,r,[n])})}}),M.forEach(function(e){e[2]||i(w,e[0],e[1],[])}),I.setTimeout(function(){w&&w.transceivers&&w.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,I.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},n.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var s=this;if(s._isClosed)return Promise.reject(m("InvalidStateError","Can not call createOffer after close"));var t=s.transceivers.filter(function(e){return"audio"===e.kind}).length,r=s.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(r=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(s.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)});0<t||0<r;)0<t&&(s._createTransceiver("audio"),t--),0<r&&(s._createTransceiver("video"),r--);var n=G.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(e,t){var r=e.track,n=e.kind,i=e.mid||G.generateIdentifier();e.mid=i,e.iceGatherer||(e.iceGatherer=s._createIceGatherer(t,s.usingBundle));var a=I.RTCRtpSender.getCapabilities(n);j<15019&&(a.codecs=a.codecs.filter(function(e){return"rtx"!==e.name})),a.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),a.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});var o=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];r&&15019<=j&&"video"===n&&!o[0].rtx&&(o[0].rtx={ssrc:o[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new I.RTCRtpReceiver(e.dtlsTransport,n)),e.localCapabilities=a,e.sendEncodingParameters=o}),"max-compat"!==s._config.bundlePolicy&&(n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n",s.transceivers.forEach(function(e,t){n+=c(e,e.localCapabilities,"offer",e.stream,s._dtlsRole),n+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===s.iceGatheringState||0!==t&&s.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,n+="a="+G.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(n+="a=end-of-candidates\r\n"))});var i=new I.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)},n.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(m("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(m("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var a=G.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(a+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=G.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach(function(e,t){if(!(o<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var r;if(e.stream)"audio"===e.kind?r=e.stream.getAudioTracks()[0]:"video"===e.kind&&(r=e.stream.getVideoTracks()[0]),r&&15019<=j&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var n=A(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=c(e,n,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var e=new I.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(e)},n.prototype.addIceCandidate=function(c){var d,p=this;return c&&void 0===c.sdpMLineIndex&&!c.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!p._remoteDescription)return t(m("InvalidStateError","Can not add ICE candidate without a remote description"));if(c&&""!==c.candidate){var r=c.sdpMLineIndex;if(c.sdpMid)for(var n=0;n<p.transceivers.length;n++)if(p.transceivers[n].mid===c.sdpMid){r=n;break}var i=p.transceivers[r];if(!i)return t(m("OperationError","Can not add ICE candidate"));if(i.rejected)return e();var a=0<Object.keys(c.candidate).length?G.parseCandidate(c.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return e();if(a.component&&1!==a.component)return e();if((0===r||0<r&&i.iceTransport!==p.transceivers[0].iceTransport)&&!N(i.iceTransport,a))return t(m("OperationError","Can not add ICE candidate"));var o=c.candidate.trim();0===o.indexOf("a=")&&(o=o.substr(2)),(d=G.getMediaSections(p._remoteDescription.sdp))[r]+="a="+(a.type?o:"end-of-candidates")+"\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join("")}else for(var s=0;s<p.transceivers.length&&(p.transceivers[s].rejected||(p.transceivers[s].iceTransport.addRemoteCandidate({}),(d=G.getMediaSections(p._remoteDescription.sdp))[s]+="a=end-of-candidates\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join(""),!p.usingBundle));s++);e()})},n.prototype.getStats=function(t){if(t&&t instanceof I.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw m("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&n.push(t[e].getStats())})}),Promise.all(n).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t=I[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map;return Object.keys(t).forEach(function(e){t[e].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(t[e]),r.set(e,t[e])}),r})}}});var e=["createOffer","createAnswer"];return e.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?r.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):r.apply(this,arguments)}}),(e=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?r.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):r.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),n}},{sdp:17}],17:[function(e,t,r){"use strict";var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},p.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},p.getDescription=function(e){var t=p.splitSections(e);return t&&t[0]},p.getMediaSections=function(e){var t=p.splitSections(e);return t.shift(),t},p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},p.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},p.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},p.parseIceOptions=function(e){return e.substr(14).split(" ")},p.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},p.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}},p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},p.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},p.writeFmtp=function(t){var e="",r=t.payloadType;if(void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e},p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},p.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},p.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return-1<n?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},p.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},p.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:p.matchPrefix(e+t,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},p.getIceParameters=function(e,t){var r=p.splitLines(e);return{usernameFragment:(r=r.concat(p.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},p.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=p.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var i=r[n],a=p.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var o=p.parseRtpMap(a),s=p.matchPrefix(e,"a=fmtp:"+i+" ");switch(o.parameters=s.length?p.parseFmtp(s[0]):{},o.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(p.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))}),t},p.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=0<t.codecs.length?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=p.writeRtpMap(e),r+=p.writeFmtp(e),r+=p.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(e){e.maxptime>n&&(n=e.maxptime)}),0<n&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=p.writeExtmap(e)}),r},p.parseRtpEncodingParameters=function(e){var r,n=[],t=p.parseRtpParameters(e),i=-1!==t.fecMechanisms.indexOf("RED"),a=-1!==t.fecMechanisms.indexOf("ULPFEC"),o=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<c.length&&1<c[0].length&&c[0][0]===s&&(r=c[0][1]),t.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&r&&(t.rtx={ssrc:r}),n.push(t),i&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});var d=p.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=d})),n},p.parseRtcpParameters=function(e){var t={},r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;var i=p.matchPrefix(e,"a=rtcp-mux");return t.mux=0<i.length,t},p.parseMsid=function(e){var t,r=p.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<n.length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||p.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(e,t,r,n){var i=p.writeRtpDescription(e.kind,t);if(i+=p.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),i},p.getDirection=function(e,t){for(var r=p.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?p.getDirection(t):"sendrecv"},p.getKind=function(e){return p.splitLines(e)[0].split(" ")[0].substr(2)},p.isRejected=function(e){return"0"===e.split(" ",2)[1]},p.parseMLine=function(e){var t=p.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},p.parseOLine=function(e){var t=p.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},p.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=p.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=p)},{}]},{},[1])(1)});
!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.i)define([],i);else{var n=i();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return f=[function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(42),s=n(4),e=(h.h="ws://127.0.0.1:8000/hive",h);function h(){}var o=(u.o="TimerScheduler",u.u="identityProvider",u.l="NetworkComponent",u.v="rtcManager",u.p="transport",u.g="httpManager",u.T="httpRequest",u.m="logger",u.O="serverManager",u.R="servicesClient",u);function u(){}var a,f,c=(l.prototype.apply=function(t){t.apply(this.context)},l);function l(t){this.id=t,this.context=new r.I}i._=c,(f=a=i.A||(i.A={}))[f.N=0]="HTTP",f[f.C=1]="RTC",f[f.k=2]="UDP";var v=(d.getId=function(){return"["+E.time()+"] ["+E.D().id+"]"},d);function d(){}var E=(p.M=function(t){this.startTime=new Date,t.apply(this.j),this.P=this.j.resolve(o.o),this.H=this.j.resolve(o.m),this.L=this.P.U()},p.F=function(t,i,n){this.G<1&&(this.M(i),this.B(t,n),this.V(t)),this.G+=1},p.q=function(){this.network=this.j.resolve(o.l),this.network.init()},p.net=function(){return this.network},p.system=function(){return this.j},p.logger=function(){return this.H},p.W=function(){return this.P},p.Y=function(t){return this.K.get(t)},p.B=function(t,i){var n=new c(t);return n.apply(i),this.K.set(t,n),n},p.V=function(t){this.$=this.Y(t)},p.resolve=function(t){return null!=this.$?this.$.context.resolve(t):(console.warn("undefined context"),null)},p.D=function(){return this.$},p.time=function(){if(this.P)return this.P.time()},p.setTimeout=function(t,i,n){return void 0===n&&(n=!1),this.P.setTimeout(t,i,n)},p.clearTimeout=function(t){return this.P.clearTimeout(t)},p.setInterval=function(t,i){return this.P.setInterval(t,i)},p.clearInterval=function(t){return this.P.clearInterval(t)},p.X=function(){return this.P.X()},p.J=function(t){if(void 0===t&&(t=!1),t)return this.Z(t),void(this.G=0);0!==this.G&&(this.G<=1&&this.Z(),this.G-=1)},p.Z=function(t){void 0===t&&(t=!1),this.P&&this.P.tt(t),this.j.it(),this.j=new r.I,this.K=new s,this.$=null,this.startTime=null,this.L=!1,this.seed=null,this.P=null,this.network=null,this.H=null},p.nt=function(t){this.seed=t},p.random=function(){return null==this.seed&&(this.seed=(new Date).getTime()),this.seed=(9301*this.seed+49297)%233280,this.seed/233280},p.rt=function(){return this.startTime},p.U=function(){return this.L},p.st=v,p.et=e,p.ht=o,p.A=a,p.G=0,p.j=new r.I,p.K=new s,p.L=!1,p);function p(){}i.Framework=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(111),s=n(21),e=n(7),o=n(2),u=n(2),h=e.ut.ot,f=(e.ut.at,e.ut.ft),c=e.ut.ct,a=(l.lt=function(t){return void 0===t&&(t="3.0.0"),void 0===this.vt&&(this.vt=new l(t)),this.vt},l.prototype.dt=function(){r.pt.lt().Et([16,17,88],function(){try{throw new Error("Upload console logs")}catch(t){atatus.notify(t),window.console&&console.log("[HiveComm] console log uploaded for debugging")}})},l.prototype.wt=function(){try{throw new Error("test")}catch(t){var i=t.stack.match(/(\/\/.*\.js)/i);if(i&&0<i.length)return i[0]}},l.prototype.setUser=function(t){this.gt&&this.isActive&&atatus.setUser(t)},l.prototype.bt=function(t){this.logger=t},l.prototype.setCustomData=function(t){this.gt&&this.isActive&&atatus.setCustomData(t)},l.prototype.yt=function(t){for(var i in t)this.Tt[i]=t[i]},l.prototype.Ot=function(t){this.St=t},l.prototype.Rt=function(){this.St=null},l.prototype.logError=function(t,i,n,r,s){var e="",h=n&&u.It[n]?u.It[n]:u.At._t;if("string"==typeof i?e=i.trim():void 0!==i&&(r=i),(r instanceof Error||r&&"object"!=typeof r)&&(r={error:r.toString()}),(r=r||{}).errorCode=n||o.GENERIC_ERROR,this.logger&&(0<Object.keys(r).length?this.logger.warn(e+" "+t,r):this.logger.warn(e+" "+t)),e&&(s=s?s.concat([e]):[e]),r.forceSend=!0,this.gt&&this.isActive)try{throw new Error(t)}catch(t){atatus.notify(t,r,s)}if(this.St)try{this.St({pluginVersion:this.version,reportingId:this.Tt?this.Tt.reportingGuid:"",p2pId:this.Tt?this.Tt.p2pId:"",message:t,severity:h,code:r.errorCode})}catch(t){this.logger.warn("Error in the onErrorCallback",t)}},l.prototype.setTags=function(t){this.gt&&this.isActive&&atatus.setTags(t)},l.prototype.notify=function(t,i){this.gt&&this.isActive&&((i=i||{}).forceSend=!0,atatus.notify(t,i))},l);function l(t){var o=this;if(this.version=t,this.isActive=!1,this.gt="undefined"!=typeof atatus&&null!=atatus,this.Tt={},l.vt)throw new Error("Error: Instantiation failed: Use AtatusLogger.getInstance() instead of new.");var u,i=null!=s.Nt.key?s.Nt.key:h,n=1==s.Nt.enabledRUM,r=1==s.Nt.enableKeyCombination,a=1==s.Nt.enabledErrorFilter;a&&(u=this.wt()),this.version=t,this.gt&&(null==s.Nt.enabled&&f||null!=s.Nt.enabled&&1==s.Nt.enabled)&&(atatus.config(i,{enableSourcemap:!0,disableRUM:!n,console:!1,version:t,beforeErrorSend:function(t){var i=!1;for(var n in t.customData=t.customData||{},void 0!==t.customData.forceSend&&(i=t.customData.forceSend,delete t.customData.forceSend,0===Object.keys(t.customData).length&&(t.customData=null)),o.Tt)t.customData[n]=o.Tt[n];if(!a||i)return!0;if(!u)return!1;try{var r=!1;if(t.backTraces){for(var s=0,e=t.backTraces;s<e.length;s++){var h=e[s];if(-1<h.f.indexOf(u)&&h.ln>c){r=!0;break}}r&&(t.name=t.name.replace(/%s \[[0-9]{2}:[0-9]{2}:[0-9]{2}:[0-9]+] /,""),0<=t.name.indexOf("Status Code Error:")&&(t.tags=["Plugin Error Code",t.name.split(":")[1].trim()]))}return r}catch(t){return!1}}}).install(),r&&this.dt(),this.isActive=!0,window.console&&console.log("[HiveComm] Error Monitor installed [RUM:"+n+", KeyHandler:"+r+"]"),a&&!u&&this.logError("Could not extract error filter"))}i.ErrorMonitor=a},function(t,i,n){"use strict";var r,s,e,h,o,u,a,f,c,l,v,d,E,p,w,g,b,y,T,m,O,S,R,I,_,A,N,C,k,D,M,j,P,H,L,U,F,G,x,B,V,q,Q,W,Y,K,$,X,J,z,Z,tt,it,nt,rt,st,et,ht;Object.defineProperty(i,"s",{value:!0}),(h=e=i.At||(i.At={}))[h._t=0]="NORMAL",h[h.Ct=1]="HIGH",h[h.CRITICAL=2]="CRITICAL",(u=o=i.kt||(i.kt={}))[u.Dt=268435456]="BASE_CODE",u[u.Mt=268435457]="FIRE_SERVER_CONNECTED_WITH_SWARM",u[u.jt=268435458]="FIRE_SERVER_CONNECTED_WITHOUT_SWARM",u[u.Pt=268435459]="CONNECTION_NOT_ESTABLISHED",u[u.Ht=268435460]="SEND_MESSAGE_TO_NON_EXISTING_CHANNEL",u[u.Lt=268435461]="RECEIVED_MESSAGE_FROM_NON_EXISTING_CONNECTION",(a=i.Ut||(i.Ut={}))[a.Dt=536870912]="BASE_CODE",a[a.Ft=536870913]="CREATE_OFFER",a[a.Gt=536870914]="CREATE_ANSWER",a[a.xt=536870915]="SIGNALING_STATE_CLOSED",a[a.Bt=536870916]="SET_LOCAL_DESCRIPTION_FAILED",a[a.Vt=536870917]="NEGOTIATION_FAILURE",a[a.qt=536870918]="SETUP_CHANNEL_ERROR",a[a.Qt=536870919]="ICE_CONNECTION_FAILED",a[a.Wt=536870920]="SET_REMOTE_DESCRIPTION",a[a.Yt=536870921]="UPDATE_ICE_CANDIDATES",a[a.Kt=536870922]="ANSWER_RECEIVED",a[a.$t=536870923]="OFFER_RECEIVED",a[a.Xt=536870924]="SEND_CANDIDATES",a[a.Jt=536870925]="CLOSE_CONNECTION",a[a.zt=536870926]="SEND_DATA",(f=i.Zt||(i.Zt={}))[f.Dt=805306368]="BASE_CODE",f[f.ti=805306369]="SEND_MSG_WITHOUT_CHANNEL",f[f.ii=805306370]="MSG_TRIGGER_ERROR",f[f.ni=805306371]="CONNECTION_TIMEOUT",(c=i.ri||(i.ri={}))[c.Dt=1073741824]="BASE_CODE",c[c.Jt=1073741825]="CLOSE_CONNECTION",c[c.si=1073741826]="P2P_DISPATCHER_ERROR",(l=i.ei||(i.ei={}))[l.Dt=1342177280]="BASE_CODE",l[l.hi=1342177281]="CONSTRUCT_MESSAGE",l[l.oi=1342177282]="DROPPED_MESSAGE",l[l.ui=1342177283]="SEND_MESSAGE",l[l.ai=1342177284]="RECEIVE_MESSAGE",(v=i.fi||(i.fi={}))[v.Dt=1610612736]="BASE_CODE",v[v.ci=1610612737]="NEW_DISPATCHER",(d=i.li||(i.li={}))[d.Dt=1879048192]="BASE_CODE",d[d.vi=1879048193]="INIT_CACHE",d[d.di=1879048194]="PUT_OPERATION",d[d.Ei=1879048195]="GET_OPERATION",d[d.pi=1879048196]="CONTAINS_OPERATION",d[d.wi=1879048197]="GET_KEYS_OPERATION",d[d.gi=1879048198]="GET_ELEMENTS_OPERATION",(E=i.bi||(i.bi={}))[E.Dt=2147483648]="BASE_CODE",E[E.di=2147483649]="PUT_OPERATION",E[E.Ei=2147483650]="GET_OPERATION",E[E.pi=2147483651]="CONTAINS_OPERATION",E[E.wi=2147483652]="GET_KEYS_OPERATION",E[E.gi=2147483653]="GET_ELEMENTS_OPERATION",E[E.yi=2147483654]="PURGE_CACHE_OPERATION",(p=i.Ti||(i.Ti={}))[p.Dt=2415919104]="BASE_CODE",(w=i.mi||(i.mi={}))[w.Dt=2684354560]="BASE_CODE",w[w.Oi=2684354561]="DISCOVERED_PEERS",w[w.Si=2684354562]="LEADER_ELECTION",w[w.Ri=2684354563]="GC_MEMBERS",w[w.Ii=2684354564]="ADD_LAN_MEMBER",w[w._i=2684354565]="ADD_RANDOM_MEMBER",w[w.Ai=2684354566]="SAMPLE_MEMBERSHIP",(g=i.Ni||(i.Ni={}))[g.Dt=2952790016]="BASE_CODE",g[g.Ci=2952790017]="SEND_ALL_HAVES",g[g.ki=2952790018]="SEND_HAVE",g[g.Di=2952790019]="UNKNOWN_HAVE",g[g.Mi=2952790020]="UNKNOWN_HAVES",g[g.ji=2952790021]="RECEIVED_HAVE",g[g.Pi=2952790022]="RECEIVED_HAVES",g[g.Hi=2952790023]="NO_OUT_PARTNER",g[g.Li=2952790024]="CREATE_RANDOM_BUFFER",g[g.Ui=2952790025]="REQUEST_PING",g[g.Fi=2952790026]="RECEIVED_PING",g[g.Gi=2952790027]="UNKNOWN_PING",g[g.xi=2952790028]="SEND_PONG",g[g.Bi=2952790029]="UNKOWN_PONG",g[g.Vi=2952790030]="WRONG_PONG_SIZE",g[g.qi=2952790031]="WRONG_TIMESTAMP",g[g.Qi=2952790032]="RECEIVED_PONG",g[g.Wi=2952790033]="COLLECT_PARTNER_SNAPSHOTS",(y=b=i.Yi||(i.Yi={}))[y.Dt=3221225472]="BASE_CODE",y[y.Ki=3221225473]="START_PARTNERSHIP",y[y.$i=3221225474]="NEW_LAN_MEMBER",y[y.Xi=3221225475]="IN_PARTNER_CHOICE",y[y.Ji=3221225476]="IN_PARTNER_ADD_PROCESS",y[y.zi=3221225477]="IN_PARTNER_CONNECT",y[y.Zi=3221225478]="IN_PARTNERSHIP_REQUEST",y[y.tn=3221225479]="OUT_PARNTERSHIP_REQUEST_PROCESS",y[y.in=3221225480]="CONSTRUCT_DISCOVER_PEER_INFO",y[y.nn=3221225481]="SEND_PARTN_RESP",y[y.rn=3221225482]="NEW_IN_PARTNER_TO_LIST",y[y.sn=3221225483]="REMOVE_DISCONNECTED_PEER",y[y.en=3221225484]="REMOVE_IN_PARTNER",y[y.hn=3221225485]="CLOSE_RECEIVED",y[y.un=3221225486]="SEND_PART_REQUEST",y[y.an=3221225487]="PART_REQUEST_EXPIRED",y[y.fn=3221225488]="UNKNOWN_PARTNERSHIP_REQUEST_EXPIRED",y[y.cn=3221225489]="UNKNOWN_OUT_PART_RESP",y[y.vn=3221225490]="CLOSE_PARTNERSHIP",y[y.dn=3221225491]="ANNOUNCE_BITRATE",y[y.En=3221225492]="CONSTRUCT_ANNOUNCE_BITRATE_MSG",y[y.pn=3221225493]="RECEIVE_BITRATE_INFO",y[y.wn=3221225494]="PEER_INFO_RECEIVED",y[y.gn=3221225495]="PEER_INFO_ANNOUNCED",y[y.bn=3221225496]="COLLECT_ALL_PARTNERS",(T=i.yn||(i.yn={}))[T.Dt=3489660928]="BASE_CODE",T[T.Tn=3489660929]="UPDATE_IN_PARTNERS",(m=i.mn||(i.mn={}))[m.Dt=3758096384]="BASE_CODE",m[m.On=3758096385]="SELECT_PARTNERS_TO_REMOVE",m[m.Sn=3758096386]="SELECT_PARTNERS_TO_ADD",m[m.Rn=3758096387]="SELECT_UPDATE_OUT",(O=i.In||(i.In={}))[O.Dt=4026531840]="BASE_CODE",O[O.On=4026531841]="SELECT_PARTNERS_TO_REMOVE",O[O.Sn=4026531842]="SELECT_PARTNERS_TO_ADD",O[O.Rn=4026531843]="SELECT_UPDATE_OUT",(S=i._n||(i._n={}))[S.Dt=4294967296]="BASE_CODE",S[S.Tn=4294967297]="UPDATE_IN_PARTNERS",S[S.On=4294967298]="SELECT_PARTNERS_TO_REMOVE",S[S.Sn=4294967299]="SELECT_PARTNERS_TO_ADD",S[S.Rn=4294967300]="SELECT_UPDATE_OUT",S[S.An=4294967301]="GROUP_PARTNERS",S[S.Nn=4294967302]="IDENTIFY_MEMBER_AS_LEADER_OR_SAME_SITE",S[S.Cn=4294967303]="AHEAD_BUT_BEHIND_DELTA",S[S.kn=4294967304]="BEHIND_OR_NOT_RETRIEVING_BITRATE",S[S.Dn=4294967305]="GET_DELTA_FOR_BITRATE",(R=i.Mn||(i.Mn={}))[R.Dt=4563402752]="BASE_CODE",R[R.jn=4563402753]="UPDATE_OUT_PARTNERS",(I=i.Pn||(i.Pn={}))[I.Dt=4831838208]="BASE_CODE",I[I.Hn=4831838209]="ADD_FRAGMENT_TO_MAP",I[I.Ln=4831838210]="WRAP_CHUNK",I[I.Un=4831838211]="GENERATE_HASHMAPS",(_=i.Fn||(i.Fn={}))[_.Dt=5100273664]="BASE_CODE",_[_.Gn=5100273665]="INIT_AES_MANAGER",_[_.xn=5100273666]="INIT_KEY",_[_.Bn=5100273667]="INIT_IV",_[_.Vn=5100273668]="DECRYPT_BUFFER",_[_.qn=5100273669]="DOWNLOAD_KEY_ONLOAD",_[_.Qn=5100273670]="DOWNLOAD_KEY",(N=A=i.Wn||(i.Wn={}))[N.Dt=5368709120]="BASE_CODE",N[N.Yn=5368709121]="GET_ENTITY_TYPE",N[N.Kn=5368709122]="GET_ENTITY_CHARACTERISTICS",N[N.$n=5368709123]="GET_NEXT_ENTITY",N[N.Xn=5368709124]="IS_CURRENT_CONTEXT",N[N.Jn=5368709125]="PARSED_METADATA",N[N.zn=5368709126]="PREFETCH_METADATA_RECEIVED",N[N.Zn=5368709127]="FRAGMENT_RECEIVED",N[N.tr=5368709128]="EVALUATE_PROTECTION",N[N.ir=5368709129]="GET_DISTANCE_DURATION",(k=C=i.nr||(i.nr={}))[k.Dt=5637144576]="BASE_CODE",k[k.rr=5637144577]="PARSE_METADATA",k[k.sr=5637144578]="EXTRACT_SEGMENT_MAPS",k[k.er=5637144579]="INIT_PROTECTION",k[k.hr=5637144580]="GET_SEGMENT_INFO",k[k.ur=5637144581]="GET_SEGMENT_DISTANCE",k[k.ar=5637144582]="EXTRACT_DURATION",k[k.cr=5637144583]="EXTRACT_DURATION_OR_DECRYPT",k[k.lr=5637144584]="EXTRACT_DURATION_CANNOT_DECRYPT",k[k.vr=5637144585]="EXTRACT_DURATION_NON_ENCRYPTED",k[k.dr=5637144586]="GENERATE_MISSING_SEGMENTS",k[k.Er=5637144587]="REGENERATE_MANIFEST",k[k.pr=5637144588]="TRIM_MANIFEST",k[k.wr=5637144589]="PARSE_BITRATES_TO_FILTER",k[k.gr=5637144590]="FILTER_BITRATES",k[k.br=5637144591]="GET_DISTANCE_DURATION_BETWEEN_SEGMENTS",k[k.yr=5637144592]="GET_SEGMENT",(M=D=i.Tr||(i.Tr={}))[M.Dt=5905580032]="BASE_CODE",M[M.Xn=5905580033]="IS_CURRENT_CONTEXT",M[M.Yn=5905580034]="GET_ENTITY_TYPE",M[M.Kn=5905580035]="GET_ENTITY_CHARACTERISTICS",M[M.mr=5905580036]="METADATA_RECEIVED",M[M.Or=5905580037]="SCHEDULE_METADATA_PREFETCH",M[M.$n=5905580038]="GET_NEXT_ENTITY",M[M.ir=5905580039]="GET_DISTANCE_DURATION",(P=j=i.Sr||(i.Sr={}))[P.Dt=6174015488]="BASE_CODE",P[P.Rr=6174015489]="PLAYLIST_MISMATCH",P[P.Ir=6174015490]="FLOAT_BITRATE",P[P.rr=6174015491]="PARSE_METADATA",P[P.hr=6174015492]="GET_SEGMENT_INFO",P[P.Ar=6174015493]="UPDATE_PLAYLIST",P[P.Nr=6174015494]="TRIM_PLAYLIST",(H=i.Cr||(i.Cr={}))[H.Dt=6442450944]="BASE_CODE",H[H.kr=6442450945]="GET_P2P_TIMEOUT",H[H.Dr=6442450946]="DELIVER_DELAY",(L=i.Mr||(i.Mr={}))[L.Dt=6710886400]="BASE_CODE",L[L.jr=6710886401]="IS_PLAYER_BUFFERING_BASE",L[L.Pr=6710886402]="CONFIGURE_REQUEST_DIRECTIVE",L[L.Hr=6710886403]="ATTEMPT_TO_UPGRADE_PREFETCH",(U=i.Lr||(i.Lr={}))[U.Dt=6979321856]="BASE_CODE",U[U.Ur=6979321857]="PREPARE_REQUEST",U[U.Fr=6979321858]="GET_CONNECTIVITY_INFO",U[U.Gr=6979321859]="COLLECT_TRACKER_REQUEST_INFO",U[U.xr=6979321860]="PREPARE_QUERY",U[U.Br=6979321861]="PREPARE_BITRATE_QUERY",U[U.Vr=6979321862]="PREPARE_TRACKER_INFO",U[U.qr=6979321863]="SEND_REQUEST",U[U.Qr=6979321864]="HANDLE_RESPONSE",(F=i.Wr||(i.Wr={}))[F.Dt=7247757312]="BASE_CODE",F[F.Yr=7247757313]="NEW_TRACKER_CLIENT",F[F.Kr=7247757314]="SERIALIZE_REQUEST",F[F.$r=7247757315]="DESERIALIZE_RESPONSE",F[F.Xr=7247757316]="SERVICE_CONNECTION_DOWN",F[F.qr=7247757317]="SEND_REQUEST",F[F.Jr=7247757318]="TRACKER_MANAGER_INIT",(G=i.zr||(i.zr={}))[G.Dt=7516192768]="BASE_CODE",G[G.Zr=7516192769]="SORT_PARTNERS",(x=i.ns||(i.ns={}))[x.Dt=7784628224]="BASE_CODE",x[x.rs=7784628225]="CHOOSE_PARTNER",(B=i.ss||(i.ss={}))[B.Dt=8053063680]="BASE_CODE",B[B.es=8053063681]="CONSTRUCT_FRAGMENT_REQUEST_MESSAGE",B[B.hs=8053063682]="SEND_FRAGMENT_REQUEST",B[B.us=8053063683]="RECEIVE_CHUNK",B[B.fs=8053063684]="SEND_ACK",B[B.cs=8053063685]="CLEAN_UP_NOT_PENDING",B[B.ls=8053063686]="STOP_TRANSFER",B[B.vs=8053063687]="RECEIVE_EXPIRED_CHUNK",(V=i.ds||(i.ds={}))[V.Dt=8321499136]="BASE_CODE",V[V.Es=8321499137]="CONSTRUCT_CHUNK_RESPONSE",V[V.ps=8321499138]="START_SENDING_CHUNK",V[V.ws=8321499139]="SEND_CHUNK",V[V.gs=8321499140]="UNKNOWN_ACK",(q=i.bs||(i.bs={}))[q.Dt=8589934592]="BASE_CODE",q[q.ys=8589934593]="NO_PARTNER_FOUND",q[q.Ts=8589934594]="FILTER_IN_PARTNERS",q[q.ms=8589934595]="SET_REQUEST_TIMEOUT",q[q.Os=8589934596]="REMOVE_REQUEST",q[q.Ss=8589934597]="CANCEL_ON_NON_EXISTING_SESSION",q[q.Rs=8589934598]="DO_NOT_HAVE",q[q.Is=8589934599]="REQUESTED_TO_NON_PARTNER",(Q=i._s||(i._s={}))[Q.Dt=8858370048]="BASE_CODE",Q[Q.As=8858370049]="RESPOND_TO_PEER",Q[Q.Ns=8858370050]="REQUEST_SATISFIED",Q[Q.Cs=8858370051]="REQUEST_PARTIALLY_SATISFIED",Q[Q.ks=8858370052]="REQUEST_NOT_SATISFIED",Q[Q.Ds=8858370053]="SEND_DO_NOT_HAVE",Q[Q.Ms=8858370054]="SEND_NO_PARTNERS",(W=i.js||(i.js={}))[W.Dt=9126805504]="BASE_CODE",W[W.Ps=9126805505]="VIOLATE_SPOOFING_HANDLER",W[W.Hs=9126805506]="VIOLATE_SPOOFING_RULES",W[W.Ls=9126805507]="ADD_OR_UPDATE_SPOOFING_MAPS",W[W.Us=9126805508]="PERIODIC_CHECK_IP_SPOOFING",(Y=i.Fs||(i.Fs={}))[Y.Dt=9395240960]="BASE_CODE",Y[Y.Gs=9395240961]="REQUEST_COMPLETED",Y[Y.xs=9395240962]="REQUEST_NOT_EXISTING_COMPLETED",Y[Y.Bs=9395240963]="REQUEST_PARTIALLY_FAILED",Y[Y.Vs=9395240964]="REQUEST_NOT_EXISTING_PARTIALLY_FAILED",Y[Y.qs=9395240965]="REQUEST_FAILED",Y[Y.Qs=9395240966]="REQUEST_NOT_EXISTING_FAILED",(K=i.Ws||(i.Ws={}))[K.Dt=9663676416]="BASE_CODE",K[K.Ys=9663676417]="UPDATE_WANTED_SESSIONS",K[K.Ks=9663676418]="CONFIGURE_PREFETCHING",K[K.$s=9663676419]="START_PREFETCHING",K[K.Xs=9663676420]="FRAGMENT_RETRIEVED_SESSION_NOT_EXISTING",K[K.Js=9663676421]="ATTEMPT_PREFETCH_BEFORE_PLAYER_REQUEST",K[K.zs=9663676422]="FORWARD_IF_NECESSARY",K[K.Zs=9663676423]="IS_ALLOWED_TO_PREFETCH",K[K.te=9663676424]="PREFETCH_PROCESS",K[K.ie=9663676425]="CHECK_PLAYER_DISTANCE",K[K.ne=9663676426]="OFFLOAD_LEADER",K[K.re=9663676427]="UPGRADE_PREFETCH",($=i.se||(i.se={}))[$.Dt=9932111872]="BASE_CODE",$[$.ee=9932111873]="REQUEST_TIMEOUT",(X=i.he||(i.he={}))[X.Dt=10200547328]="BASE_CODE",X[X.oe=10200547329]="PLAYER_REQUEST_ERROR",X[X.ue=10200547330]="PLAYER_ABORT_ERROR",(J=i.ae||(i.ae={}))[J.Dt=10468982784]="BASE_CODE",J[J.fe=10468982785]="ADD_HAVE",J[J.ce=10468982786]="REMOVE_PEER",(Z=z=i.le||(i.le={}))[Z.Dt=10737418240]="BASE_CODE",Z[Z.ve=10737418241]="CONSTRUCT_SWARM",Z[Z.de=10737418242]="INIT_SWARM",Z[Z.Ee=10737418243]="SWITCH_STATE",Z[Z.ee=10737418244]="REQUEST_TIMEOUT",(tt=i.pe||(i.pe={}))[tt.Dt=11005853696]="BASE_CODE",tt[tt.we=11005853697]="SERIALIZE_MESSAGE",tt[tt.ge=11005853698]="EXTRACT_MESSAGE",(nt=it=i.be||(i.be={}))[nt.Dt=11274289152]="BASE_CODE",nt[nt.ye=11274289153]="NO_MATCHING_SESSION",nt[nt.Te=11274289154]="UNABLE_RESOLVE_TICKET",nt[nt.me=11274289155]="UNABLE_INIT_TECHS",nt[nt.Oe=11274289156]="NO_TOKEN_FOUND",nt[nt.Se=11274289157]="NO_VALID_TICKET",nt[nt.Re=11274289158]="ON_ACTIVE_SESSION_CB_ERROR",nt[nt.Ie=11274289159]="NO_VISIBILITY_LISTENER",nt[nt._e=11274289160]="STATUS_CODE",(rt=i.Ae||(i.Ae={}))[rt.Dt=11542724608]="BASE_CODE",rt[rt.Ne=11542724609]="CALCULATE_BATCH_LOCALITY",(et=st=i.Ce||(i.Ce={}))[et.Dt=11811160064]="BASE_CODE",et[et.ke=11811160065]="BITRATE_TOO_HIGH",et[et.De=11811160066]="NUM_BITRATES_NONE",et[et.Me=11811160067]="NUM_BITRATES_OK",et[et.je=11811160068]="NUM_BITRATES_WARNING",et[et.Pe=11811160069]="NUM_BITRATES_ERROR",et[et.He=11811160070]="NUM_BITRATES_ATATUS_ERROR_NONE",et[et.Le=11811160071]="NUM_BITRATES_ATATUS_ERROR_HIGH",(ht=i.Ue||(i.Ue={}))[ht.Dt=12079595520]="BASE_CODE",ht[ht.we=12079595521]="SERIALIZE_MESSAGE",ht[ht.qr=12079595522]="SEND_REQUEST",ht[ht.Xr=12079595523]="SERVICE_CONNECTION_DOWN",ht[ht.Fr=12079595524]="GET_CONNECTIVITY_INFO",i.GENERIC_ERROR=1,i.Fe=((r={})[st.ke]="The detected bitrate ({0}) is higher than the maximum certified bitrate ({1}). You may encounter issues watching the stream.",r[st.De]="{0} stream detected with missing video bitrate metadata. This is likely caused by an incorrect manifest served by the video platform application.",r[st.Me]="{0} stream detected {1} video bitrates: {2}",r[st.je]="{0} stream detected with {1} video bitrates: {2}. Hive Streaming recommends four or fewer video bitrates to insure optimal networking savings.",r[st.Pe]="{0} stream detected with {1} video bitrates: {2}. This is likely caused by an incorrect configuration in the video encoder, video streaming origin or transcoding service.",r[st.He]="Stream has zero available bitrates.",r[st.Le]="Stream has too many available bitrates.",r),i.It=((s={})[o.Mt]=e.Ct,s[o.jt]=e.Ct,s[b.Ki]=e.Ct,s[A.Xn]=e.Ct,s[C.Er]=e.Ct,s[D.Xn]=e.Ct,s[j.Rr]=e.Ct,s[z.ve]=e.Ct,s[it.ye]=e.Ct,s[it.Te]=e.Ct,s[it.me]=e.Ct,s[it.Oe]=e.Ct,s[it.Se]=e.Ct,s)},function(i,t,n){(function(K,$){
/*!
 *
 * Copyright 2009-2017 Kris Kowal under the terms of the MIT
 * license found at https://github.com/kriskowal/q/blob/v1/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):i.exports=t()}(function(){"use strict";var o=!1;try{throw new Error}catch(t){o=!!t.stack}function i(){}var s,e=T(),c=function(){var n={Ge:void 0,next:null},i=n,r=!1,s=void 0,e=!1,t=!1;try{t=navigator&&("Microsoft Internet Explorer"===navigator.appName||null!=navigator.appVersion.match(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i))}catch(t){}var h=[];function o(){for(var t,i;n.next;)t=(n=n.next).Ge,n.Ge=void 0,(i=n.domain)&&(n.domain=void 0,i.xe()),u(t,i);for(;h.length;)u(t=h.pop());r=!1}function u(t,i){try{t()}catch(t){if(e)throw i&&i.Be(),setTimeout(o,0),i&&i.xe(),t;setTimeout(function(){throw t},0)}i&&i.Be()}if(c=function(t){"undefined"!=typeof Framework&&Framework.U()?Framework.setTimeout(t,0):(i=i.next={Ge:t,domain:e&&K.domain,next:null},r||(r=!0,s()))},"object"==typeof K&&K&&"[object process]"===K.toString()&&K.Ve)e=!0,s=function(){K.Ve(o)};else if("function"!=typeof $||t)if("undefined"==typeof MessageChannel||t)s=function(){setTimeout(o,0)};else{var a=new MessageChannel;a.port1.onmessage=function(){s=f,(a.port1.onmessage=o)()};var f=function(){a.port2.postMessage(0)};s=function(){setTimeout(o,0),f()}}else s="undefined"!=typeof window?$.bind(window,o):function(){$(o)};return c.qe=function(t){h.push(t),r||(r=!0,s())},c}(),n=Function.call;function t(t){return function(){return n.apply(t,arguments)}}var h,u=t(Array.prototype.slice),a=t(Array.prototype.reduce||function(t,i){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){i=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(i=t(i,this[n],n));return i}),r=t(Array.prototype.indexOf||function(t){for(var i=0;i<this.length;i++)if(this[i]===t)return i;return-1}),f=t(Array.prototype.map||function(r,s){var e=this,h=[];return a(e,function(t,i,n){h.push(r.call(s,i,n,e))},void 0),h}),l=Object.create||function(t){function i(){}return i.prototype=t,new i},v=Object.defineProperty||function(t,i,n){return t[i]=n.value,t},d=t(Object.prototype.hasOwnProperty),E=Object.keys||function(t){var i=[];for(var n in t)d(t,n)&&i.push(n);return i},p=t(Object.prototype.toString);h="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var w="From previous event:";function g(t,i){if(o&&i.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=i;r;r=r.source)r.stack&&(!t.Qe||t.Qe>r.We)&&(v(t,"__minimumStackCounter__",{value:r.We,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var s=function(t){for(var i=t.split("\n"),n=[],r=0;r<i.length;++r){var s=i[r];!y(s)&&(-1===(e=s).indexOf("(module.js:")&&-1===e.indexOf("(node.js:"))&&s&&n.push(s)}var e;return n.join("\n")}(n.join("\n"+w+"\n"));v(t,"stack",{value:s,configurable:!0})}}function b(t){var i=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(i)return[i[1],Number(i[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var i=b(t);if(!i)return!1;var n=i[0],r=i[1];return n===s&&e<=r&&r<=Y}function T(){if(o)try{throw new Error}catch(t){var i=t.stack.split("\n"),n=b(0<i[0].indexOf("@")?i[1]:i[2]);if(!n)return;return s=n[0],n[1]}}function m(t){return t instanceof _?t:k(t)?function(t){var i=S();return m.Ve(function(){try{t.then(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}}),i.promise}(t):x(t)}(m.resolve=m).Ve=c,m.Ye=!1;var O=1;function S(){var s,e=[],h=[],t=l(S.prototype),i=l(_.prototype);if(i.Ke=function(t,i,n){var r=u(arguments);e?(e.push(r),"when"===i&&n[1]&&h.push(n[1])):m.Ve(function(){s.Ke.apply(s,r)})},i.valueOf=function(){if(e)return i;var t=N(s);return C(t)&&(s=t),t},i.$e=function(){return s?s.$e():{state:"pending"}},m.Ye&&o)try{throw new Error}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1),i.We=O++}function n(n){s=n,m.Ye&&o&&(i.source=n),a(e,function(t,i){m.Ve(function(){n.Ke.apply(n,i)})},void 0),h=e=void 0}return t.promise=i,t.resolve=function(t){s||n(m(t))},t.fulfill=function(t){s||n(x(t))},t.reject=function(t){s||n(G(t))},t.notify=function(n){s||a(h,function(t,i){m.Ve(function(){i(n)})},void 0)},t}function R(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var i=S();try{t(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}return i.promise}function I(s){return R(function(t,i){for(var n=0,r=s.length;n<r;n++)m(s[n]).then(t,i)})}function _(s,e,i){void 0===e&&(e=function(t){return G(new Error("Promise does not support operation: "+t))}),void 0===i&&(i=function(){return{state:"unknown"}});var h=l(_.prototype);if(h.Ke=function(t,i,n){var r;try{r=s[i]?s[i].apply(h,n):e.call(h,i,n)}catch(t){r=G(t)}t&&t(r)},h.$e=i){var t=i();"rejected"===t.state&&(h.exception=t.reason),h.valueOf=function(){var t=i();return"pending"===t.state||"rejected"===t.state?h:t.value}}return h}function A(t,i,n,r){return m(t).then(i,n,r)}function N(t){if(C(t)){var i=t.$e();if("fulfilled"===i.state)return i.value}return t}function C(t){return t instanceof _}function k(t){return function(t){return t===Object(t)}(t)&&"function"==typeof t.then}"object"==typeof K&&K&&K.Xe&&K.Xe.Je&&(m.Ye=!0),(m.defer=S).prototype.ze=function(){var n=this;return function(t,i){t?n.reject(t):2<arguments.length?n.resolve(u(arguments,1)):n.resolve(i)}},m.Promise=R,(m.promise=R).race=I,R.all=q,R.reject=G,(R.resolve=m).Ze=function(t){return t},_.prototype.Ze=function(){return this},m.join=function(t,i){return m(t).join(i)},_.prototype.join=function(t){return m([this,t]).th(function(t,i){if(t===i)return t;throw new Error("Q can't join: not the same: "+t+" "+i)})},m.race=I,_.prototype.race=function(){return this.then(m.race)},(m.ih=_).prototype.toString=function(){return"[object Promise]"},_.prototype.then=function(i,n,r){var s=this,e=S(),h=!1;return m.Ve(function(){s.Ke(function(t){h||(h=!0,e.resolve(function(t){try{return"function"==typeof i?i(t):t}catch(t){return G(t)}}(t)))},"when",[function(t){h||(h=!0,e.resolve(function(t){if("function"==typeof n){g(t,s);try{return n(t)}catch(t){return G(t)}}return G(t)}(t)))}])}),s.Ke(void 0,"when",[void 0,function(t){var i,n=!1;try{i=function(t){return"function"==typeof r?r(t):t}(t)}catch(t){if(n=!0,!m.onerror)throw t;m.onerror(t)}n||e.notify(i)}]),e.promise},m.nh=function(t,i){return m(t).nh(i)},_.prototype.nh=function(i){return i=m(i),this.then(function(t){return i.sh(t).rh(t)})},m.when=A,_.prototype.rh=function(t){return this.then(function(){return t})},m.rh=function(t,i){return m(t).rh(i)},_.prototype.eh=function(t){return this.then(function(){throw t})},m.eh=function(t,i){return m(t).eh(i)},m.hh=N,m.oh=C,m.uh=k,m.ah=function(t){return C(t)&&"pending"===t.$e().state},_.prototype.ah=function(){return"pending"===this.$e().state},m.fh=function(t){return!C(t)||"fulfilled"===t.$e().state},_.prototype.fh=function(){return"fulfilled"===this.$e().state},m.lh=function(t){return C(t)&&"rejected"===t.$e().state},_.prototype.lh=function(){return"rejected"===this.$e().state};var D,M,j,P=[],H=[],L=[],U=!0;function F(){P.length=0,H.length=0,U=U||!0}function G(i){var t=_({when:function(t){return t&&function(i){if(U){var n=r(H,i);-1!==n&&("object"==typeof K&&K&&"function"==typeof K.vh&&m.Ve.qe(function(){var t=r(L,i);-1!==t&&(K.vh("rejectionHandled",P[n],i),L.splice(t,1))}),H.splice(n,1),P.splice(n,1))}}(this),t?t(i):this}},function(){return this},function(){return{state:"rejected",reason:i}});return function(t,i){U&&("object"==typeof K&&K&&"function"==typeof K.vh&&m.Ve.qe(function(){-1!==r(H,t)&&(K.vh("unhandledRejection",i,t),L.push(t))}),H.push(t),i&&void 0!==i.stack?P.push(i.stack):P.push("(no stack) "+i))}(t,i),t}function x(n){return _({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},delete:function(t){delete n[t]},dh:function(t,i){return null==t?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return E(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function B(t,i,n){return m(t).th(i,n)}function V(t,i,n){return m(t).Eh(i,n)}function q(t){return A(t,function(s){var e=0,h=S();return a(s,function(t,i,n){var r;C(i)&&"fulfilled"===(r=i.$e()).state?s[n]=r.value:(++e,A(i,function(t){s[n]=t,0==--e&&h.resolve(s)},h.reject,function(t){h.notify({index:n,value:t})}))},void 0),0===e&&h.resolve(s),h.promise})}function Q(s){if(0===s.length)return m.resolve();var e=m.defer(),h=0;return a(s,function(t,i,n){var r=s[n];h++,A(r,function(t){e.resolve(t)},function(t){if(0===--h){var i=t||new Error(""+t);i.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+i.message,e.reject(i)}},function(t){e.notify({index:n,value:t})})},void 0),e.promise}function W(t){return A(t,function(t){return t=f(t,m),A(q(f(t,function(t){return A(t,i,i)})),function(){return t})})}m.ph=F,m.wh=function(){return P.slice()},m.gh=function(){F(),U=!1},F(),m.reject=G,m.fulfill=x,m.bh=function(n){return _({yh:function(){}},function(t,i){return V(n,t,i)},function(){return m(n).$e()})},m.th=B,_.prototype.th=function(i,t){return this.all().then(function(t){return i.apply(void 0,t)},t)},m.async=function(i){return function(){function t(t,i){var n;if("undefined"==typeof StopIteration){try{n=r[t](i)}catch(t){return G(t)}return n.done?m(n.value):A(n.value,s,e)}try{n=r[t](i)}catch(t){return function(t){return"[object StopIteration]"===p(t)||t instanceof h}(t)?m(t.value):G(t)}return A(n,s,e)}var r=i.apply(this,arguments),s=t.bind(t,"next"),e=t.bind(t,"throw");return s()}},m.Th=function(t){m.done(m.async(t)())},m.mh=function(t){throw new h(t)},m.Oh=function(n){return function(){return B([this,q(arguments)],function(t,i){return n.apply(t,i)})}},m.Eh=V,_.prototype.Eh=function(t,i){var n=this,r=S();return m.Ve(function(){n.Ke(r.resolve,t,i)}),r.promise},m.get=function(t,i){return m(t).Eh("get",[i])},_.prototype.get=function(t){return this.Eh("get",[t])},m.set=function(t,i,n){return m(t).Eh("set",[i,n])},_.prototype.set=function(t,i){return this.Eh("set",[t,i])},m.Sh=m.delete=function(t,i){return m(t).Eh("delete",[i])},_.prototype.Sh=_.prototype.delete=function(t){return this.Eh("delete",[t])},m.Rh=m.dh=function(t,i,n){return m(t).Eh("post",[i,n])},_.prototype.Rh=_.prototype.dh=function(t,i){return this.Eh("post",[t,i])},m.send=m.Ih=m._h=function(t,i){return m(t).Eh("post",[i,u(arguments,2)])},_.prototype.send=_.prototype.Ih=_.prototype._h=function(t){return this.Eh("post",[t,u(arguments,1)])},m.Ah=function(t,i){return m(t).Eh("apply",[void 0,i])},_.prototype.Ah=function(t){return this.Eh("apply",[void 0,t])},m.Nh=m.sh=function(t){return m(t).Eh("apply",[void 0,u(arguments,1)])},_.prototype.sh=function(){return this.Eh("apply",[void 0,u(arguments)])},m.Ch=function(t){var i=m(t),n=u(arguments,1);return function(){return i.Eh("apply",[this,n.concat(u(arguments))])}},_.prototype.Ch=function(){var t=this,i=u(arguments);return function(){return t.Eh("apply",[this,i.concat(u(arguments))])}},m.keys=function(t){return m(t).Eh("keys",[])},_.prototype.keys=function(){return this.Eh("keys",[])},m.all=q,_.prototype.all=function(){return q(this)},m.kh=Q,_.prototype.kh=function(){return Q(this)},m.Dh=(D=W,M="allResolved",j="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(M+" is deprecated, use "+j+" instead.",new Error("").stack),D.apply(D,arguments)}),_.prototype.Dh=function(){return W(this)},m.allSettled=function(t){return m(t).allSettled()},_.prototype.allSettled=function(){return this.then(function(t){return q(f(t,function(t){function i(){return t.$e()}return(t=m(t)).then(i,i)}))})},m.fail=m.catch=function(t,i){return m(t).then(void 0,i)},_.prototype.fail=_.prototype.catch=function(t){return this.then(void 0,t)},m.progress=function(t,i){return m(t).then(void 0,void 0,i)},_.prototype.progress=function(t){return this.then(void 0,void 0,t)},m.Mh=m.finally=function(t,i){return m(t).finally(i)},_.prototype.Mh=_.prototype.finally=function(i){if(!i||"function"!=typeof i.apply)throw new Error("Q can't apply finally callback");return i=m(i),this.then(function(t){return i.sh().then(function(){return t})},function(t){return i.sh().then(function(){throw t})})},m.done=function(t,i,n,r){return m(t).done(i,n,r)},_.prototype.done=function(t,i,n){var r=function(t){m.Ve(function(){if(g(t,s),!m.onerror)throw t;m.onerror(t)})},s=t||i||n?this.then(t,i,n):this;"object"==typeof K&&K&&K.domain&&(r=K.domain.bind(r)),s.then(void 0,r)},m.timeout=function(t,i,n){return m(t).timeout(i,n)},_.prototype.timeout=function(t,i){var n=S(),r=setTimeout(function(){i&&"string"!=typeof i||((i=new Error(i||"Timed out after "+t+" ms")).code="ETIMEDOUT"),n.reject(i)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},m.delay=function(t,i){return void 0===i&&(i=t,t=void 0),m(t).delay(i)},_.prototype.delay=function(n){return this.then(function(t){var i=S();return setTimeout(function(){i.resolve(t)},n),i.promise})},m.jh=function(t,i){return m(t).jh(i)},_.prototype.jh=function(t){var i=S(),n=u(t);return n.push(i.ze()),this.Ah(n).fail(i.reject),i.promise},m.Ph=function(t){var i=u(arguments,1);return m(t).jh(i)},_.prototype.Ph=function(){var t=u(arguments),i=S();return t.push(i.ze()),this.Ah(t).fail(i.reject),i.promise},m.Hh=m.Lh=function(n){if(void 0===n)throw new Error("Q can't wrap an undefined function");var r=u(arguments,1);return function(){var t=r.concat(u(arguments)),i=S();return t.push(i.ze()),m(n).Ah(t).fail(i.reject),i.promise}},_.prototype.Hh=_.prototype.Lh=function(){var t=u(arguments);return t.unshift(this),m.Lh.apply(void 0,t)},m.Uh=function(n,r){var s=u(arguments,2);return function(){var t=s.concat(u(arguments)),i=S();return t.push(i.ze()),m(function(){return n.apply(r,arguments)}).Ah(t).fail(i.reject),i.promise}},_.prototype.Uh=function(){var t=u(arguments,0);return t.unshift(this),m.Uh.apply(void 0,t)},m.Fh=m.Gh=function(t,i,n){return m(t).Gh(i,n)},_.prototype.Fh=_.prototype.Gh=function(t,i){var n=u(i||[]),r=S();return n.push(r.ze()),this.Eh("post",[t,n]).fail(r.reject),r.promise},m.xh=m.Bh=m.Vh=function(t,i){var n=u(arguments,2),r=S();return n.push(r.ze()),m(t).Eh("post",[i,n]).fail(r.reject),r.promise},_.prototype.xh=_.prototype.Bh=_.prototype.Vh=function(t){var i=u(arguments,1),n=S();return i.push(n.ze()),this.Eh("post",[t,i]).fail(n.reject),n.promise},m.qh=function(t,i){return m(t).qh(i)},_.prototype.qh=function(i){if(!i)return this;this.then(function(t){m.Ve(function(){i(null,t)})},function(t){m.Ve(function(){i(t)})})},m.Qh=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var Y=T();return m})}).call(this,n(37),n(101).setImmediate)},function(t,i,n){"use strict";n(11);var s=n(71),r=n(12),e=n(53),h=n(13);function o(t,n,i,r){if(!(this instanceof o))return new o(t,n,i,r);n=n||Object.Wh,i=i||Object.hash,r=r||Function.Yh,this.Kh=n,this.$h=i,this.Xh=r,this.store=new s(void 0,function(t,i){return n(t.key,i.key)},function(t){return i(t.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).Map=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),Object.defineProperty(o.prototype,"size",r.Jh),o.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.$h,this.Xh)},o.prototype.log=function(t,r,i,n){r=r||this.Zh,this.store.log(t,function(t,i,n){r(t.value.value,i,n)},i,n)},o.prototype.Zh=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),s=(e.to=5e3,e.io=6,e.no=1e4,e.ro=.2,e.so=10,e);function e(){}var h=(o.eo="0.0.1",o.ho=3e4,o.oo=4e7,o.uo=1,o.ao=.8,o.fo=!1,o.co=2e4,o.lo=1e4,o);function o(){}var u=(a.vo=r.ut.do,a.Eo=3,a.po=1e4,a);function a(){}var f=(c.wo=1.2,c.bo=1.5,c.yo=1.2,c.To=.5,c);function c(){}var l=(v.mo=r.ut.Oo,v.So=2e4,v.Ro=5e3,v);function v(){}var d=(E.Io=[412,404],E);function E(){}var p=(w._o=2e3,w.Ao=!0,w.No=!1,w.Co=!0,w.ko=1,w.Do=.04,w.Mo=2,w.jo=!0,w.Po=!1,w.Ho=!1,w.Lo=1e4,w.Uo=4e4,w.Fo=3700,w.Go=2e4,w.xo=1,w.Bo=5,w.Vo=.4,w.qo=1,w.Qo=!0,w.Wo=2,w.Yo=1.5,w);function w(){}var g=(b.Ko=30,b.$o=2e4,b.Xo=3e4,b);function b(){}var y=(T.Jo=3e7,T.zo=3e4,T.Zo=!1,T.tu=10,T);function T(){}var m=(O.iu=3,O.nu=!1,O.ru=3e4,O.su=3,O.eu=.2,O.hu=.2,O.ou=1e4,O);function O(){}var S=(R.uu=!1,R);function R(){}var I=(_.au=64e3,_.fu=5e3,_.cu=1,_.lu=1,_.vu=!1,_.du=!0,_);function _(){}var A=(N.Eu=4e3,N.pu=3e4,N.wu=4096,N.gu=!0,N.bu=5e3,N.yu=1e4,N);function N(){}var C=(k.Tu=100,k.mu=200,k);function k(){}var D=(M.Ou=20,M.Su=20,M.Ru=20,M.Iu=5,M.TIMEOUT=6e4,M);function M(){}var j=(P._u="site",P.Au="externalAs",P.Nu="availableSendRate",P.Cu="remoteAddress",P.ku="localAddress",P.Du=2e4,P);function P(){}var H=(L.Mu=3e4,L);function L(){}var U=(F.ju=300,F);function F(){}var G=(x.Pu=!0,x.Hu=!0,x);function x(){}var B=(V.Lu=1,V.Uu=6,V.Fu=12,V.Gu=4,V.xu=27,V);function V(){}var q=(Q.Bu=s,Q.Vu=h,Q.qu=u,Q.Qu=f,Q.Wu=l,Q.Yu=d,Q.Ku=p,Q.$u=g,Q.Cache=y,Q.Xu=m,Q.N=S,Q.Ju=I,Q.UDPBroadcast=A,Q.zu=C,Q.Zu=D,Q.ta=j,Q.ia=H,Q.na=U,Q.ra=G,Q.sa=B,Q);function Q(){}i.ea=q},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(30),s=n(0),r=n(19),e=(h.prototype.ha=function(){return void 0!==this.oa},h.prototype.ua=function(t,i){return this.oa=Math.min(this.aa,i/t*8e3),this},h.prototype.fa=function(t){return this.oa=Math.max(this.aa,t),this},h.prototype.ca=function(t){t.ha()&&(this.ha()?this.oa=this.oa*(1-this.ALPHA)+t.oa*this.ALPHA:this.oa=t.oa)},h.prototype.la=function(t){return this.ha()?Math.round(8e3*t/this.oa):NaN},h.prototype.va=function(){return this.ha()?this.oa:NaN},h.prototype.da=function(){return this.ha()?this.oa/1e3:NaN},h.prototype.Ea=function(){return this.ha()?this.oa/1e6:NaN},h.prototype.pa=function(){return this.ha()?1e6<this.oa?(this.oa/1e6).toFixed(2)+"Mb/s":1e3<this.oa?(this.oa/1e3).toFixed(2)+"Kb/s":this.oa+"b/s":"NaN"},h);function h(){this.ALPHA=.25,this.aa=1e8,this.wa=1e4}i.ga=e;var o=(a.ba=function(t,i){return i?t+"-"+i:t},a.appendBuffer=function(t,i){var n=new Uint8Array(t.byteLength+i.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(i),t.byteLength),n.buffer},a.ya=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},a.Ta=function(t,i,n){void 0===n&&(n=!0);for(var r=0;r<t.length;)if(t[r]===i){if(t.splice(r,1),n)break}else r++},a.ma=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},a.Oa=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},a.Sa=function(t){for(var i=t.length-1;0<i;i--){var n=Math.floor(s.Framework.random()*(i+1)),r=t[i];t[i]=t[n],t[n]=r}return t},a.Ra=function(t){var i=new Array;for(var n in t)t.hasOwnProperty(n)&&!/^\d+$/.test(n)&&i.push(n);return i},a.Ia=function(t){return Object.keys(t).map(function(t){return parseInt(t,10)}).filter(function(t){return!isNaN(t)})},a._a=function(t,i){return t[i]?t[i]:null},a.Aa=function(t,i){return new u(i).Na(t).toString()},a.Ca=function(t){void 0===t&&(t="");var i=t.toLowerCase().indexOf("(format=mpd-time-csf)");return-1!=i&&(t=t.substr(0,i)),-1==(i=t.indexOf("?"))&&(i=t.length),t.substr(0,i)},a.ka=function(t){var i,n,r,s,e=new u(t),h=e.origin(),o=e.path();for("/"!==o.charAt(0)&&(i=!0,o="/"+o),"/.."!==o.slice(-3)&&"/."!==o.slice(-2)||(o+="/"),o=o.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(n=(n=o.substring(1).match(/^(\.\.\/)+/)||"")&&n[0]);-1!==(r=o.search(/\/\.\.(\/|$)/));)o=0!==r?(-1===(s=o.substring(0,r).lastIndexOf("/"))&&(s=r),o.substring(0,s)+o.substring(r+3)):o.substring(3);return h+o},a.Da=function(t){return 0==t.length?0:t.reduce(function(t,i){return t+i})/t.length},a.Ma=function(t){for(var i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0,s=t.length;r<s;r++)n[r]=t.charCodeAt(r);return i},a.createEvent=function(t,i,n,r){var s=new t(i,n),e=r||n.currentTarget;return e&&Object.defineProperties(s,{currentTarget:{value:e,enumerable:!0,writable:!1},target:{value:e,enumerable:!0,writable:!1}}),s},a.ja=function(t){return t.replace(this.Pa,"\\$&")},a.Ha=new r.Counter,a.Pa=/[-\/\\^$*+?.()|[\]{}]/g,a);function a(){}i.La=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ua=!0,s.Fa=!0,s.Ga="undefined"!=typeof HIVE_COMM_JS_PROXY&&HIVE_COMM_JS_PROXY,s.xa="3.13.3",s.Ba="bitmovin",s.Va="undefined"!=typeof HIVE_PLUGIN_TIMEOUT?HIVE_PLUGIN_TIMEOUT:3e4,s.qa="6.0.0",s.Qa=!1,s.Wa=!0,s.Ya="undefined"!=typeof INCLUDE_VOD_CACHE&&INCLUDE_VOD_CACHE,s.Ka="undefined"!=typeof INCLUDE_UDP_BROADCAST&&INCLUDE_UDP_BROADCAST,s.$a="undefined"!=typeof INCLUDE_UDP_LEADER_ELECTION&&INCLUDE_UDP_LEADER_ELECTION,s.Xa="undefined"!=typeof LEADER_SCORE_EQUALITY&&LEADER_SCORE_EQUALITY,s.Ja="undefined"!=typeof INCLUDE_DEFAULT_NETWORK&&INCLUDE_DEFAULT_NETWORK,s.za="undefined"!=typeof HIVE_RESTRICTED_CONNINFO&&HIVE_RESTRICTED_CONNINFO,s.Oo="undefined"!=typeof HIVE_DISCOVERY?HIVE_DISCOVERY:"ws://127.0.0.1:8000/hive",s.Za="undefined"!=typeof P2PDispatcherDetailedLog&&P2PDispatcherDetailedLog,s.if="undefined"!=typeof NetworkManagerDetailedLog&&NetworkManagerDetailedLog,s.ot="undefined"!=typeof ATATUS_KEY?ATATUS_KEY:"592835a6b4204dd197c00488610003e0",s.at="undefined"!=typeof ATATUS_VERSION?ATATUS_VERSION:"0.8",s.ft="undefined"==typeof ATATUS_DEFAULT_ENABLED||ATATUS_DEFAULT_ENABLED,s.ct="undefined"!=typeof ATATUS_ROWS_TO_EXCLUDE?ATATUS_ROWS_TO_EXCLUDE:5,s.nf="undefined"==typeof HIVE_DETECT_PRIVATEIP||HIVE_DETECT_PRIVATEIP,s.rf=!0,s.sf=!1,s.ef=!0,s.do="undefined"==typeof HIVE_IP_SPOOFING_ENABLED||HIVE_IP_SPOOFING_ENABLED,s);function s(){}i.ut=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.hf="statsClient",s.R="servicesClient",s.uf="ticketResolver",s.u="identityProvider",s.af="connInfoProvider",s.ff="peerInfo",s.cf="streamInfoProvider",s.lf="reporting",s.vf="statsStore",s.df="trackManager",s.Ef="trackClient",s);function s(){}i.pf=r},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.wf||(i.wf={}))[r.gf=0]="AUDIO",r[r.bf=1]="VIDEO",r[r.yf=2]="METADATA",r[r.Tf=3]="OTHER"},function(t,i,n){"use strict";var r,s;Object.defineProperty(i,"s",{value:!0}),n(60),(r=i.mf||(i.mf={}))[r.Of=0]="TRACKER",r[r.k=1]="UDP",(s=i.Sf||(i.Sf={}))[s.Rf=1]="PLAYER",s[s.If=2]="P2P_AGENT",s[s._f=3]="PREFETCHER_FIRST_TIER",s[s.Af=4]="PREFETCHER_SECOND_TIER";function e(){}i.TrackerPeerStreamInfo=e;function h(t,i,n){this.isLeader=n,this.internalAs=0,this.externalAs=0,this.type=t,n||(this.isLeader=!1),i&&(this.guid=i.guid,this.internalAs=i.internalAs,this.externalAs=i.externalAs,this.nat=i.nat,this.bandwidth=i.bandwidth,this.watchingBitrate=i.watchingBitrate,this.streams=i.streams,this.rankValue=i.rankValue,this.timestamp=i.timestamp,this.privateIpString=i.privateIpString,this.publicIpString=i.publicIpString)}i.Nf=h},function(t,i,n){n(68),n(38),n(69),n(105)},function(t,i,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}(t.exports=r).Cf=Object.freeze([]),r.prototype.hiveAddEach=function(i){if(i&&Object(i)===i)if("function"==typeof i.forEach)i.forEach(this.hiveAdd,this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else Object.keys(i).forEach(function(t){this.hiveAdd(i[t],t)},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},r.prototype.kf=function(t,i){return t.forEach(function(t){this.delete(t,i)},this),this},r.prototype.forEach=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)},void 0)},r.prototype.map=function(e){var h=arguments[1],o=[];return this.reduce(function(t,i,n,r,s){o.push(e.call(h,i,n,r,s))},void 0),o},r.prototype.enumerate=function(n){null==n&&(n=0);var r=[];return this.reduce(function(t,i){r.push([n++,i])},void 0),r},r.prototype.group=function(e,h,o){o=o||Object.Wh;var u=[],a=[];return this.forEach(function(t,i,n){i=e.call(h,t,i,n);var r,s=a.indexOf(i,o);-1===s?(r=[],u.push([i,r]),a.push(i)):r=u[s][1],r.push(t)}),u},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.Df=function(){var r={};return this.reduce(function(t,i,n){r[n]=i},void 0),r},r.prototype.filter=function(e){var h=arguments[1],o=this.zh();return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)&&o.hiveAdd(i,n)},void 0),o},r.prototype.every=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t&&e.call(h,i,n,r,s)},!0)},r.prototype.some=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t||e.call(h,i,n,r,s)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.kh=function(){return this.some(Boolean)},r.prototype.min=function(n){n=n||this.Mf||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):n(i,t)<0?i:t},void 0)},r.prototype.max=function(n){n=n||this.Mf||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):0<n(i,t)?i:t},void 0)},r.prototype.jf=function(t){return t=void 0===t?0:t,this.reduce(function(t,i){return t+i},t)},r.prototype.Pf=function(t){var n=void 0===t?0:t,r=void 0===t?0:t;return this.reduce(function(t,i){n+=i,r+=1},void 0),n/r},r.prototype.concat=function(){for(var t=this.zh(this),i=0;i<arguments.length;i++)t.hiveAddEach(arguments[i]);return t},r.prototype.Hf=function(){var n=this;return this.reduce(function(t,i){return i.forEach(function(t){this.push(t)},t,n),t},[])},r.prototype.Lf=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),Array.Uf(t)},r.prototype.join=function(n){return this.reduce(function(t,i){return void 0===t?i:t+n+i},void 0)},r.prototype.Ff=function(n,i,r){return(n=n||this.Mf||Object.compare).Gf?(i=n.Gf,n=n.compare||this.Mf||Object.compare):i=i||Function.identity,void 0===r&&(r=1),this.map(function(t){return{Gf:i(t),value:t}}).sort(function(t,i){return n(t.Gf,i.Gf)*r}).map(function(t){return t.value})},r.prototype.reversed=function(){return this.zh(this).reverse()},r.prototype.clone=function(n,r){if(void 0===n)n=1/0;else if(0===n)return this;var s=this.zh();return this.forEach(function(t,i){s.hiveAdd(Object.clone(t,n-1,r),i)},this),s},r.prototype.only=function(){if(1===this.length)return this.xf()},r.prototype.iterator=function(){return this.Bf.apply(this,arguments)},r.Jh={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(r.prototype,"size",r.Jh),n(68)},function(t,i,n){n(11);var r=Object.prototype.hasOwnProperty;function h(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function o(t,i,n,r){var s,e,h,o=t.active,u=t.Vf,a=u.length,f=a;for(o.length>a&&(o.length=a);a--;)o[a]=u[a];for(e=0;e<f;e++)if(h=o[e],!e||0<=u.indexOf(h)){if(!(s=h[t.qf]||h[t.Qf]||h).call)throw new Error("No event listener for "+t.Wf+" or "+t.Yf+" or call on "+s);s.call(h,n,i,r)}}(t.exports=h).debug=!0,h.prototype.Kf=function(t){this.$f||Object.defineProperty(this,"$f",{value:{},enumerable:!1,configurable:!0,writable:!0});var i=this.$f;if(!r.call(i,t)){var n=String(t);n=n&&n[0].toUpperCase()+n.slice(1),i[t]={Xf:{Vf:[],active:[],qf:"handle"+n+"WillChange",Qf:"handlePropertyWillChange"},Jf:{Vf:[],active:[],qf:"handle"+n+"Change",Qf:"handlePropertyChange"}}}return i[t]},h.prototype.zf=function(t){if(!this.$f)return!1;if(!t)return!0;var i=this.$f;return!!r.call(i,t)},h.prototype.Zf=function(t,i,n){this.tc&&!this.ic&&this.tc();var r,s=h.Kf(this,t);r=n?s.Xf:s.Jf,h.rc(this,t),r.Vf.push(i);var e=this;return function(){h.sc(e,t,i,n),e=null}},h.prototype.ec=function(t,i){return h.Zf(this,t,i,!0)},h.prototype.sc=function(t,i,n){var r,s=h.Kf(this,t),e=(r=n?s.Xf:s.Jf).Vf.lastIndexOf(i);if(-1===e)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(t));r.Vf.splice(e,1)},h.prototype.hc=function(t,i){return h.sc(this,t,i,!0)},h.prototype.oc=function(t,i,n){var r,s=h.Kf(this,t);if(!s.isActive){s.isActive=!0,r=n?s.Xf:s.Jf;try{o(r,t,i,this)}finally{s.isActive=!1}}},h.prototype.uc=function(t,i){return h.oc(this,t,i,!0)},h.prototype.rc=function(s){var e,h,t=this.ac;if(t){if(r.call(t,s))return}else{if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(s)+" observable on "+this+" because object is not extensible");t={},Object.defineProperty(this,"ac",{value:t,enumerable:!1,writable:!0,configurable:!0})}"object"==typeof this.fc?e=this.fc:(e={},Object.defineProperty(this,"fc",{value:e,writable:!0,enumerable:!1})),e[s]=this[s];var i,n=this;do{if(h=Object.getOwnPropertyDescriptor(n,s))break;n=Object.getPrototypeOf(n)}while(n);if(h){if(!h.configurable)return;if(!h.writable&&!h.set)return}else h={value:void 0,enumerable:!0,writable:!0,configurable:!0};i="value"in(t[s]=h)?{get:function(){return h.value},set:function(t){var i,n;if(t!==h.value){if(!(n=(i=this.$f[s]).isActive)){i.isActive=!0;try{o(i.Xf,s,h.value,this)}finally{}}if(h.value=t,e[s]=t,!n)try{o(i.Jf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0}:{get:h.get,set:function(t){var i,n,r=this[s];if(h.set.call(this,t),(t=this[s])!==r){if(!(n=(i=this.$f[s]).isActive)){i.isActive=!0;try{o(i.Xf,s,r,this)}finally{}}if(e[s]=t,!n)try{o(i.Jf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0},Object.defineProperty(this,s,i)},h.Kf=function(t,i){return t.Kf?t.Kf(i):h.prototype.Kf.call(t,i)},h.zf=function(t,i){return t.zf?t.zf(i):h.prototype.zf.call(t,i)},h.Zf=function(t,i,n,r){if(Object.cc(t))return t.Zf?t.Zf(i,n,r):h.prototype.Zf.call(t,i,n,r)},h.sc=function(t,i,n,r){if(Object.cc(t))return t.sc?t.sc(i,n,r):h.prototype.sc.call(t,i,n,r)},h.oc=function(t,i,n,r){if(Object.cc(t))return t.oc?t.oc(i,n,r):h.prototype.oc.call(t,i,n,r)},h.ec=function(t,i,n){return h.Zf(t,i,n,!0)},h.hc=function(t,i,n){return h.sc(t,i,n,!0)},h.uc=function(t,i,n){return h.oc(t,i,n,!0)},h.rc=function(t,i){return t.rc?t.rc(i):h.prototype.rc.call(t,i)}},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e=n(43),h=n(7),o=(u.DashFilterBitrates=null,u.DashRemoveBitrateSize=!1,u);function u(){}var a=(f.AudioAccounting=!0,f);function f(){}var c,l=(c=e.HiveConfig.DebugLogs,s(v,c),v.TrackerLogs=0,v);function v(){return null!==c&&c.apply(this,arguments)||this}var d=(E.usiz=null,E);function E(){}var p=(w.restrictedConnectivityInfo=h.ut.za,w.hiddenHostnameValue="[Hidden]",w);function w(){}var g=(b.vc=null,b.dc=null,b);function b(){}var y=(T.detectPrivateIP=h.ut.nf,T);function T(){}var m=(O.Dash=o,O.Stats=a,O.DebugLogs=l,O.UDPBroadcast=d,O.SensitiveInfo=p,O.ClientInfo=g,O.ConnInfo=y,O);function O(){}i.HiveConfig=m,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Dash=m.Dash,window.HiveConfig.Stats=m.Stats,window.HiveConfig.UDPBroadcast=m.UDPBroadcast,window.HiveConfig.DebugLogs=m.DebugLogs,window.HiveConfig.SensitiveInfo=m.SensitiveInfo,window.HiveConfig.ClientInfo=m.ClientInfo,window.HiveConfig.ConnInfo=m.ConnInfo)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(3),o=n(30);function h(i,r,s,e){void 0===r&&(r=""),void 0===s&&(s=[]),void 0===e&&(e=!1);function t(n){if(i.hasOwnProperty(n)){var t=i[n];Array.isArray(t)?t.forEach(function(t,i){"object"==typeof t&&h(t,r+"."+n+"["+i+"]",s,e)}):"object"==typeof t?h(t,r+"."+n,s,e):"number"==typeof t&&isNaN(t)&&(s.push(r+"."+n),e||(i[n]=null))}}for(var n in i)t(n);return s}function a(t,i){var n;switch(typeof i){case"number":n=parseInt(t);break;case"boolean":n="true"===t;break;default:n=t}return n}function s(t,i,n,r,s){void 0===r&&(r=!0),void 0===s&&(s={});var e=u.defer();try{var h=new XMLHttpRequest;if(h.open(t,i,r),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),s)for(var o in s)s.hasOwnProperty(o)&&null!==s[o]&&h.setRequestHeader(o,s[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.statusText,body:h.responseText})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send()}catch(t){e.reject({status:-1,reason:t})}return e.promise}i.pa=function(t,i){return void 0===i&&(i=2),1e6<t?(t/1e6).toFixed(i)+"MB":1e3<t?(t/1e3).toFixed(i)+"KB":t+"B"},i.Ec=function(t,i,n){return void 0===i&&(i=""),void 0===n&&(n=[]),h(t,i,n,!0)},i.pc=h,i.wc=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=t[0],r=1;r<t.length;r++){var s=new RegExp("\\{"+(r-1)+"\\}","gm");n=n.replace(s,t[r])}return n},i.updateOptions=function(t,i){for(var n in t)t.hasOwnProperty(n)&&i.hasOwnProperty(n)&&(i[n]=t[n])},i.parseParameterOptions=function(t,i,n){var r=new o(t).query(!0);for(var s in r)try{if(r.hasOwnProperty(s)&&i.hasOwnProperty(s)&&n.hasOwnProperty(i[s])){var e=i[s],h=r[s];n[e]=a(h,n[e])}}catch(t){}},i.gc=function(i,n){var r=u.defer();return u.Ve(function t(){if(!i())return r.resolve(!0);u.when(n(),t,r.reject)}),r.promise},i.bc=function(t,i,n,r){return void 0===n&&(n=!0),void 0===r&&(r={}),s("GET",t,i,n,r)},i.yc=s,i.Tc=function(t,i,n,r,s){void 0===s&&(s=!0);var e=u.defer();try{var h=new XMLHttpRequest;if(h.open("POST",t,s),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),null!=r&&null!=r)for(var o in r)r.hasOwnProperty(o)&&null!==r[o]&&h.setRequestHeader(o,r[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.response})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send(i)}catch(t){e.reject({status:-1,reason:t})}return e.promise},i.mc=function(){"function"!=typeof Object.assign&&(Object.assign=function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var s=arguments[r];if(null!=s)for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=s[e])}return n})},i.ya=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Oc=function(t,i){var n=0,r=0,s=!1;if(i)for(;r<i.length&&!s;)t>=i.start(r)&&t<i.end(r)&&(n=i.end(r)-t,s=!0),r++;return n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Sc="snapAccountingManager",s.Rc="membership",s.Ic="partnership",s._c="inPartnership",s.Ac="outPartnership",s.Nc="inPrefetcherPartnership",s.Cc="outPrefetcherPartnership",s.kc="cache",s.Dc="livecache",s.Mc="vodcache",s.jc="objIndex",s.Pc="centrFragment",s.Hc="hcache",s.Lc="responder",s.Uc="requester",s.Fc="p2pRequester",s.Gc="peer",s.xc="contextResolver",s.Bc="videoPrefetcher",s.Vc="prefetchManager",s.qc="picker",s.Qc="trackerClient",s.Wc="scoreUpdater",s.O="serverManager",s.Yc="requestTracker",s.Kc="trackerManager",s.$c="renderStats",s.Xc="udpBroadcaster",s.Jc="udpDiscovery",s.$a="udpLeaderElection",s.zc="nodeInfo",s.Zc="ipspoofing",s.tl="localityScore",s.il="localityService",s);function s(){}i.nl=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(1),e=n(2);i.loggerId="[HiveServices] ";var r=(h.rl=250,h);function h(){}i.et=r;var o=(u.prototype.sl=function(){try{var t=[new Uint8Array([this.service>>8,255&this.service]),new Uint8Array([this.msgId]),this.msg];return new Blob(t,{type:"application/octet-binary"})}catch(t){throw s.ErrorMonitor.lt().logError("Error serializing message to send to the services",u.loggerId,e.pe.we,t),new Error(t)}},u.el=function(t){try{String.fromCharCode.apply(null,new Uint8Array(t));var i=String.fromCharCode.apply(null,new Uint8Array(t.slice(3))),n=new Uint8Array(t.slice(0,2)),r=new Uint8Array(t.slice(2,3));return new u((n[0]<<8)+n[1],r[0],i)}catch(t){throw s.ErrorMonitor.lt().logError("Error extracting message from the services",this.loggerId,e.pe.ge,t),new Error(t)}},u.loggerId="[Message] ",u);function u(t,i,n){this.msgId=i,this.service=t,this.msg=n}i.hl=o,i.logger=function(){if(this.H)return this.H;var t=window&&window.window?window.window.ol:void 0;if(void 0!==t&&t.log&&t.debug&&t.info&&t.warn&&t.error&&(this.H=t),!this.H){var i=!(void 0===window.console),n=i?console.log.bind(console):function(){};this.H={log:n,debug:i&&window.console.debug?window.console.debug.bind(console):n,info:i&&window.console.info?window.console.info.bind(console):n,warn:i&&window.console.warn?window.console.warn.bind(console):n,error:i&&window.console.error?window.console.error.bind(console):n}}return this.H}},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),a=n(3),o=n(0),u=n(24),f=n(8),c=n(31);(e=i.ul||(i.ul={}))[e.STOP=0]="STOP",e[e.IDLE=1]="IDLE",e[e.al=2]="PLAY";var l=(v.prototype.close=function(t){t?(this.fl.delete(t),0==this.fl.length&&this.cl.close()):(this.fl.clear(),this.cl.close())},v.prototype.ll=function(t){return this.fl.has(t)},v);function v(){this.p2pId=null,this.reportingId=null,this.fl=new h,this.logger=o.Framework.resolve(o.Framework.ht.m).log(),this.logger.debug("INIT REPORTING"),this.cl=o.Framework.resolve(f.pf.R),this.vl=o.Framework.resolve(f.pf.u)}i.dl=l;var d=(E.prototype.El=function(t,i,n){this.app=new p(t,i),this.pl.El(this.app),this.wl.El(this.app,n)},E.prototype.gl=function(t){this.bl.gl(t)},E.prototype.yl=function(){return this.renderStatsCallback},E.prototype.Tl=function(t){this.renderStatsCallback=t},E.prototype.ml=function(){this.Sl.Ol()},E);function E(t,i,n,r){this.ticket=t,this.cl=i,this.app=n,this.identity=r,this.pl=o.Framework.resolve(f.pf.vf),this.bl=o.Framework.resolve(f.pf.hf),this.wl=o.Framework.resolve(f.pf.df),this.Sl=new u.Rl(this.wl)}i.Il=d;var p=function(t,i){this.app=t,this.version=i};i._l=p;var w,g=(s(b,w=l),b.prototype.initSession=function(t,i,n,r,s){var e=this,h=a.defer(),o=this.vl.Al(),u=this.Cl.Nl(i);return u.pluginId=t,null!=r&&(u.testId=r),null!=u?o.then(function(t){return e.kl(t,u,h,n)}).fail(h.reject):h.reject("Ticket URL not valid"),h.promise},b.prototype.kl=function(e,t,h,i){var o=this;this.p2pId=e.Dl(),this.reportingId=e.Ml();var n=this.cl.init(this.p2pId,t),r=this.Cl.resolve(n.jl,t,i);n.promise.then(function(t){r.then(function(t){var i=t.sessionId;if(o.fl.has(i)){var n=o.fl.get(i);o.logger.warn("SESSION ALREADY EXISTING "+n.pl.ticket)}else{var r=new p(c.Hive.Pl(),c.Hive.getVersion()),s=new d(t,o.cl,r,e);s.pl.init(o.reportingId,t,r,i),s.wl.init(o.reportingId,r),s.wl.Hl(t),o.fl.set(i,s),o.logger.debug("SESSION SET ",i),h.resolve(s)}}).fail(function(t){return h.reject(t||"Error resolving the ticket")}),t.onerror(function(t){h.reject("Error establishing connection to Hive Services")})}).fail(function(t){return h.reject(t)}),this.cl.connect()},b);function b(){var t=w.call(this)||this;return t.Cl=o.Framework.resolve(f.pf.uf),t}i.Ll=g;var y,T=(s(m,y=l),m.prototype.initSession=function(t,i,n,r,s){var e=this,h=this.vl.Al();return i.pluginId=t,null!=r&&(i.testId=r),h.then(function(t){return e.kl(t,i,null,!1,s)}).fail(a.reject)},m.prototype.kl=function(e,h,t,i,n){var o=this;this.p2pId=e.Dl(),this.reportingId=e.Ml();var r=this.cl.init(this.p2pId,h,n);return this.cl.connect(),r.then(function(t){var i=h.sessionId;if(o.fl.has(i)){var n=o.fl.get(i);o.logger.warn("SESSION ALREADY EXISTING "+n.pl.ticket)}else{var r=new p(c.Hive.Pl(),c.Hive.getVersion()),s=new d(h,o.cl,r,e);s.pl.init(o.reportingId,h,r,i),s.wl.init(o.reportingId,r),s.wl.Hl(h),o.fl.set(i,s),o.logger.debug("SESSION SET ",i)}return s}).fail(function(t){return a.reject(t)})},m);function m(){return null!==y&&y.apply(this,arguments)||this}i.Ul=T},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(28),r=(s.prototype.next=function(){return this.count++,this.count},s);function s(){this.count=0}i.Counter=r;var h=(o.prototype.add=function(t){t<=0||(this.Fl+=t,this.Gl++,t>this.xl&&(this.xl=t),t<this.Bl&&(this.Bl=t))},o.prototype.min=function(t){void 0===t&&(t=!0);var i=this.Bl==Number.POSITIVE_INFINITY?0:this.Bl;return t&&this.reset(),i},o.prototype.max=function(t){void 0===t&&(t=!0);var i=this.xl==Number.NEGATIVE_INFINITY?0:this.xl;return t&&this.reset(),i},o.prototype.jf=function(t){void 0===t&&(t=!0);var i=this.Fl;return t&&this.reset(),i},o.prototype.Da=function(t){void 0===t&&(t=!0);var i=0<this.Gl?this.Fl/this.Gl:0;return t&&this.reset(),i},o.prototype.reset=function(){this.Bl=Number.POSITIVE_INFINITY,this.xl=Number.NEGATIVE_INFINITY,this.Fl=0,this.Gl=0},o);function o(){this.reset()}i.Vl=h;var u=(a.prototype.sl=function(t,i,n){this.protocol.ql(i,e.Ql.ONEWAY,n),t.write(this.protocol),this.protocol.Wl();var r=this.Kl.Yl(),s=this.$l(r,",",4);return r.slice(s+1,r.length-1)},a.prototype.Xl=function(t,i,n,r){var s="["+n+', "'+i+'", 4, 0,'+t+"]";this.Kl.Jl(s),this.protocol.zl();var e=new r;return e.read(this.protocol),this.protocol.Zl(),e},a.prototype.$l=function(t,i,n){return t.split(i,n).join(i).length},a);function a(){this.Kl=new e.tv,this.protocol=new e.nv(this.Kl)}i.rv=u},function(t,c,i){"use strict";Object.defineProperty(c,"s",{value:!0});var l,n,s=i(3),r=i(159),v=i(36),e=i(4),d=i(32),E=i(0),h=i(161),a=i(168),p=i(5),f=i(6),o=i(16),w=i(1),g=i(2);c.sv=!1,(n=l=c.ev||(c.ev={}))[n.Have=1]="Have",n[n.Chunk=2]="Chunk",n[n.Request=3]="Request",n[n.Cancel=4]="Cancel",n[n.Ack=5]="Ack",n[n.Close=6]="Close",n[n.DoNotHave=7]="DoNotHave",n[n.hv=8]="OutPartRequest",n[n.ov=9]="OutPartResp",n[n.uv=10]="UDPHandshakeReq",n[n.UDPHandshakeResponse=11]="UDPHandshakeResponse",n[n.UDPSwitchLeadershipRequest=12]="UDPSwitchLeadershipRequest",n[n.av=13]="UDPSwitchAck",n[n.Bitrate=14]="Bitrate",n[n.Haves=15]="Haves",n[n.fv=16]="PeerInfo",n[n.Ping=17]="Ping",n[n.Pong=18]="Pong",n[n.cv=19]="NoPartnerResp";var u=(b.prototype.lv=function(t){try{var i=null,n=E.Framework.resolve(o.nl.Gc).vv(t);return null==n?(this.logger.warn("MSG RECEIVED FROM UNKNOWN SWARM"),null):(i=new h.dv(n,this.Kl.Ev,this.Kl.otherGuid,this.Kl),this.pv.has(t)||this.pv.set(t,i),this.pv.get(t))}catch(t){w.ErrorMonitor.lt().logError("Error creating new dispatcher",this.loggerId,g.fi.ci,t)}},b.prototype.wv=function(t){this.pv.delete(t)},b.prototype.gv=function(t){return this.pv.get(t)},b);function b(t){this.loggerId="[DispatcherManager] ",this.pv=new e,this.logger=E.Framework.resolve(E.Framework.ht.m).log(),this.Kl=t}c.bv=u;var y=(T.prototype.init=function(t,i){this.Ev=t,this.otherGuid=i,this.yv=E.Framework.resolve(E.Framework.ht.v)},T.prototype.Tv=function(){var n=!1;return this.mv.pv.forEach(function(t,i){(t.sender.Tv()||t.receiver.Tv())&&(n=!0)}),n},T.prototype.reset=function(){this.mv.pv.forEach(function(t,i){t.sender.Ov()})},T.prototype.close=function(t){return this.mv.wv(t),0==this.mv.pv.length&&this.yv.disconnect(this.otherGuid),s("ok")},T.prototype.Sv=function(i,n,t){try{this.Rv=E.Framework.time();var r=t.Ma(),s=r.byteLength,e=d.Av._v.Iv.create(r),h=d.Av.Nv(e),o=new v;o.Cv(i),o.kv(n),o.Cv(s),o.kv(h.toString()),o.append(r),o.Dv();var u=o.Ma(),a=i===l.Chunk&&E.Framework.U()?u.byteLength+p.ea.Ju.au:u.byteLength;c.sv&&this.Mv.log(n).debug(this.vt+" SEND MSG ID "+i+","+a+" HASH "+h.toString()+" TO "+this.otherGuid)}catch(t){w.ErrorMonitor.lt().logError("Error constructing message",this.loggerId,g.ei.hi,{jv:l[i]})}try{var f=this.yv.send(this.otherGuid,u,a);return f||w.ErrorMonitor.lt().logError("Error message dropped",this.loggerId,g.ei.oi,{jv:l[i],otherGuid:this.otherGuid}),f}catch(t){w.ErrorMonitor.lt().logError("Error sending message",this.loggerId,g.ei.ui,{jv:l[i],otherGuid:this.otherGuid}),this.Mv.log(n).warn("ERROR SENDING MESSAGE TO "+this.otherGuid+" "+t.stack)}},T.prototype.Pv=function(){this.mv.pv.forEach(function(t){return t.Pv()})},T.prototype.Hv=function(h){var o=this;c.sv&&this.Mv.log().debug(this.vt+" GOT MSG "+h.byteLength);try{var u=E.Framework.time();this.Rv=u,this.Lv(h).then(function(t){if(c.sv&&o.Mv.log().debug(o.vt+" RECEIVING "+t.byteLength+" after "+(E.Framework.time()-u)),t.byteLength>T.Uv)throw new RangeError("P2P Message too big to be processed");var i=o.message;if(null===i){var n=v.wrap(t),r=n.Fv();if(c.sv&&o.Mv.log().debug("MSG ID "+r),r>Object.keys(l).length)return o.Mv.log().warn("MSG OF WRONG ID RECEIVED: "+r),void(o.message=null);if((i=o.message=new a.xv).Gv=r,i.swarmId=n.Bv(),i.length=n.Fv(),i.hash=n.Bv(),i.Vv=n.Ma(),i.length>T.Uv)throw new RangeError("P2P Message too big to be processed");c.sv&&o.Mv.log(i.swarmId).debug("MSG ID "+i.Gv+" L "+i.length+" SWID "+i.swarmId+" H "+i.hash+" TR "+i.Vv.byteLength)}else{if(c.sv&&o.Mv.log().debug("APPENDING TO P2P MESSAGE "+i.Gv),null!=i.Vv.byteLength&&i.Vv.byteLength>T.Uv)throw new RangeError("P2P Message too big to be processed");i.Vv=f.La.appendBuffer(i.Vv,h)}if(i.Vv.byteLength===i.length){var s=d.Av._v.Iv.create(i.Vv);if(d.Av.Nv(s).toString()!==i.hash)return void o.Mv.log(i.swarmId).warn(" INTEGRITY CHECK FAILED ");var e=o.mv.gv(i.swarmId);e||(e=o.mv.lv(i.swarmId),o.Mv.log(i.swarmId).debug("CREATED NEW DISPATCHER FOR "+o.otherGuid)),e&&e.Eh(i),i.Vv=null,o.message=null}})}catch(t){w.ErrorMonitor.lt().logError("Error receiving message",this.loggerId,g.ei.ai,t),this.message=null}},T.prototype.Lv=function(i){var t=!E.Framework.U()&&-1<navigator.userAgent.toLowerCase().indexOf("firefox"),n=s.defer();if(t){var r=new FileReader;r.onload=function(t){i=this.result,n.resolve(i)},r.onerror=n.reject,r.readAsArrayBuffer(i)}else n.resolve(i);return n.promise},T.prototype.qv=function(){return this.Rv},T.Qv=r.Yv(i(169)).Wv("HiveMsgs"),T.Kv=0,T.Uv=136+Math.ceil(1.2*p.ea.Ju.au),T);function T(){this.loggerId="[Transport] ",this.message=null,this.Mv=E.Framework.resolve(E.Framework.ht.m),this.mv=new u(this),this.vt=T.Kv++,this.Rv=E.Framework.time()}c.$v=y},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.monitorPort=e.et.Xv?h.zv.Jv:h.zv.Zv,this.playerPort=e.et.Xv?h.zv.td:h.zv.nd,this.feedbackPeriod=2e3,this.idleTimePeriod=6e4,this.useSessionCheck=e.et.rd,this.debugLevel="notice",this.isSDNDebug=!1,this.hiveTechOrder=[],this.telemetryId=null,this.silent=!1,this.loggerTimestamp=s.HiveConfig.Framework.LoggerTimestamp,this.testId=null,this.pluginTimeout=o.ut.Va,this.readyCheckTimeout=0,this.onSourceSetCompleted=function(t){},this.onLoadingCompleted=function(t){},this.detectPrivateIP=o.ut.nf,this.authTokenEnabled=!0,this.dashRemoveBitrateSize=!1,this.dashFilterBitrates=null,this.staticPartnerId=null,this.staticCustomerId=null,this.audioMetrics=!0,this.logJsonSnapshots=void 0,this.onActiveSession=function(t){},this.onError=function(t){}}var s=n(43),e=n(29),h=n(44),o=n(7);i.Options=r;function u(){this.initTimeout=3e4,this.onError=function(t){return!0},this.onActiveSession=function(t){}}i.HiveTechOptions=u;function a(){this.hivePlayerPort="playerPort",this.hiveMonitorPort="monitorPort",this.hiveSilent="silent",this.hiveDebugLevel="debugLevel",this.isSDNDebug="isSDNDebug",this.hiveDebugTimestamp="loggerTimestamp",this.hiveSetupTimeout="setupTimeout",this.hiveJavaTimeout="initTimeout",this.hiveWarnJavaTimeout="warnSlowRespTimeout",this.hiveTestId="testId",this.hiveDetectPrivateIP="detectPrivateIP",this.hiveAuthTokenEnabled="authTokenEnabled",this.hiveDashRemoveBitrateSize="dashRemoveBitrateSize",this.hiveDashFilterBitrates="dashFilterBitrates",this.hiveLogJsonSnapshots="logJsonSnapshots",this.hiveStaticPartnerId="staticPartnerId",this.hiveStaticCustomerId="staticCustomerId",this.hiveAudioMetrics="audioMetrics"}i.UrlConfigurableOptions=a;var f=(c.enabledRUM=!1,c.enableKeyCombination=!0,c.enabledErrorFilter=!0,c);function c(){}i.Nt=f;var l=(v.sd=function(t){"dashRemoveBitrateSize"in t&&t.dashRemoveBitrateSize&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashRemoveBitrateSize=t.dashRemoveBitrateSize),"dashFilterBitrates"in t&&t.dashFilterBitrates&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashFilterBitrates=t.dashFilterBitrates),"staticCustomerId"in t&&t.staticCustomerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.dc=t.staticCustomerId),"staticPartnerId"in t&&t.staticPartnerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.vc=t.staticPartnerId),"audioMetrics"in t&&!t.audioMetrics&&window.HiveConfig&&window.HiveConfig.Stats&&(window.HiveConfig.Stats.AudioAccounting=t.audioMetrics),"detectPrivateIP"in t&&"boolean"==typeof t.detectPrivateIP&&window.HiveConfig&&window.HiveConfig.ConnInfo&&(window.HiveConfig.ConnInfo.detectPrivateIP=t.detectPrivateIP),"logJsonSnapshots"in t&&t.logJsonSnapshots&&window.HiveConfig&&window.HiveConfig.DebugLogs&&(window.HiveConfig.DebugLogs.MetricSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackerLogs=1)},v);function v(){}i.hd=l,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.ErrorMonitor=f)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(3),e=n(27),h=n(14),o=n(1),u=(a.od=function(t,i,n){this.ud[t]={ad:n,request:i}},a.getOriginalXhr=function(){return"undefined"!=typeof OriginalXMLHttpRequest?new OriginalXMLHttpRequest:new XMLHttpRequest},a.clear=function(){a.mapping={}},a.clearPluginState=function(t){if(t in a.mapping){var i=a.mapping[t];for(var n in i)"tech"!==n&&delete i[n]}},a.clearPlugin=function(t){t in a.mapping&&delete a.mapping[t]},a.registerTech=function(t,i){t in a.mapping||(a.mapping[t]={tech:null,fd:!1}),a.mapping[t].tech=i},a.mapping={},a.ld=!1,a.loggerId="[HiveRequestFactory]",a.ud={},a);function a(t){if(!t){if(0==Object.keys(a.mapping).length&&!a.ld)return o.ErrorMonitor.lt().logError("No registered default HiveRequestFactory tech",a.loggerId),a.ld=!0,a.getOriginalXhr();t=Object.keys(a.mapping)[0]}if(!(t in a.mapping))return a.ld||(o.ErrorMonitor.lt().logError("no registered HiveRequestFactory tech for plugin",{pluginId:t}),a.ld=!0),a.getOriginalXhr();var i=a.mapping[t],n=a.ud[i.tech];return n?i.fd?new n.request(t):(i.fd=!0,new n.ad(t)):a.getOriginalXhr()}i.HiveRequestFactory=u;var f=(c.prototype.isActive=function(t,i){return void 0===i&&(i=!1),null!==this.tech&&this.tech.isActive(t,this,i)},c.prototype.vd=function(t){this.dd!=t&&(this.dd=t,this.tech&&this.tech.gl(this,t))},c.prototype.getTechName=function(){return this.tech&&this.tech.getName()||void 0},c.prototype.Ed=function(){return this.dd},c.prototype.close=function(t,i){if(void 0===i&&(i=!0),this.dd=!0,null!=this.tech)return this.tech.pd(this,t,i)},c.prototype.toString=function(){return this.ticket.toString()},c.prototype.toHiveSession=function(){var t=new e.HiveSession;return t.id=this.id,t.ticketUrl=this.ticketUrl,t.manifest=this.manifest,t.tech=this.tech.getName(),t},c.prototype.wd=function(){return this.gd.promise},c.prototype.bd=function(t){this.yd=t,this.gd.resolve(this.yd)},c);function c(t,i,n,r){this.dd=!1,this.ticketUrl=t,this.ticket=i,this.manifest=n,this.gd=s.defer(),this.yd=r,this.yd&&this.gd.resolve(this.yd)}i.HiveSessionInternal=f;var l=(Object.defineProperty(v.prototype,"fullscreen",{get:function(){return this.Td},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"totalBuffering",{get:function(){return this.md},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"bufferLength",{get:function(){return this.Od},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"playingPoint",{get:function(){return this.Sd},enumerable:!0,configurable:!0}),v.prototype.Rd=function(){isNaN(this.playingPoint)&&(this.Sd=0),isNaN(this.bufferLength)&&(this.Od=0),isNaN(this.totalBuffering)&&(this.md=0)},v);function v(t,i,n,r,s,e){this.Sd=t,this.Od=i,this.md=n,this._width=r,this._height=s,this.Td=e,this.Rd()}i.Id=l;var d=function(){this.success=0,this.failed=0,this.bytes=0};i.Ad=d;var E=(p.prototype.accountCompleted=function(t,i,n,r){void 0===r&&(r=!0);var s=t?this.Nd:this.Cd;s.has(i)||s.set(i,new d);var e=s.get(i);isNaN(n)?o.ErrorMonitor.lt().logError("[ExtendedStats] Toal bytes of a downloaded fragment is NaN"):e.bytes+=n,r&&e.success++},p.prototype.accountFailed=function(t,i){var n=t?this.Nd:this.Cd;n.has(i)||n.set(i,new d),n.get(i).failed++},p.prototype.updateBandwidth=function(t){t===1/0||isNaN(t)||(this.bandwidth=t)},p.prototype.bitrateSwitchUp=function(){this.kd++},p.prototype.bitrateSwitchDown=function(){this.Dd++},p.prototype.getBandwidth=function(){return this.bandwidth},p.prototype.getVideoBitrates=function(){return this.Nd},p.prototype.getAudioBitrates=function(){return this.Cd},p.prototype.getBitrateSwitchUp=function(){return this.kd},p.prototype.getBitrateSwitchDown=function(){return this.Dd},p);function p(){this.kd=0,this.Dd=0,this.Nd=new r,this.Cd=new r}i.HivePlayerExtendedStats=E;var w=(g.lt=function(t){return t&&(this.logger=t),void 0===this.vt&&(this.vt=new g),this.vt},g.prototype.Md=function(){var i=this,n=!document[this.hidden];this.jd.forEach(function(t){t.call(i,n)})},g.prototype.Pd=function(t){this.jd.push(t)},g.prototype.Hd=function(){document.removeEventListener(this.Ld,this.Md,!1),this.jd.length=0},g);function g(){if(g.vt)throw new Error("Error: Instantiation failed: Use VisibilityChangeListener.getInstance() instead of new.");void 0!==document.hidden?(this.hidden="hidden",this.Ld="visibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.Ld="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.Ld="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==document[this.hidden]?document.addEventListener(this.Ld,this.Md.bind(this),!1):g.logger&&g.logger.debug("warn - visibilityChange listener not supported"),this.jd=new Array}i.Ud=w;var b=(y.getItem=function(t){try{return window.sessionStorage?window.sessionStorage.getItem(t):null}catch(t){return null}},y.setItem=function(t,i){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(t,i),!0)}catch(t){return!1}},y.removeItem=function(t){try{window.sessionStorage&&window.sessionStorage.removeItem(t)}catch(t){return null}},y);function y(){}i.Fd=b;var T=(m.prototype.check=function(t){var i=Date.now();return this.isEqual(this.Gd,t)||(this.xd=i),this.Gd=t,i-this.xd>=this.Bd},m.prototype.isEqual=function(t,i){return!(!t||!i)&&[i.playingPoint-t.playingPoint,i.bufferLength-t.bufferLength,i.totalBuffering-t.totalBuffering].reduce(function(t,i){return t&&Math.abs(i)<10},!0)},m);function m(t){this.Bd=t}i.Vd=T;var O=(S.getPrivateIp=function(t){var i=t.getPrivateIp();return h.HiveConfig.SensitiveInfo.restrictedConnectivityInfo&&i&&(i=i.replace(/[0-9]*$/,"0")),i},S.qd=function(t){return h.HiveConfig.SensitiveInfo.restrictedConnectivityInfo?h.HiveConfig.SensitiveInfo.hiddenHostnameValue:t.getHostName()},S);function S(){}i.Qd=O},function(t,i){t.exports=void 0},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e=n(22),h=n(54),o=n(3),u=n(0),a=n(8),f=n(25),c=n(17),l=n(14),v=(d.Wd="hive-client-track",d.Yd="trackevent",d.Kd="NULLID",d.$d="",d);function d(){}var E,p="[TRACK] ";(E=i.PlayerEvents||(i.PlayerEvents={}))[E.PLAYING=0]="PLAYING",E[E.BUFFERING=1]="BUFFERING",E[E.PAUSED=2]="PAUSED",E[E.SKIP=3]="SKIP",E[E.STOPPED=4]="STOPPED",E[E.ERROR=5]="ERROR",E[E.WINDOW_SIZE=6]="WINDOW_SIZE",E[E.FULLSCREEN=7]="FULLSCREEN",E[E.VISIBLE=8]="VISIBLE",E[E.HIDDEN=9]="HIDDEN";var w=function(){};i.Xd=w;function g(){}var b=function(){};i.Jd=g;var y=function(){this.type=2},T=(m.prototype.zd=function(i,t){var n;this.sessions.forEach(function(t){t.sessionId==i&&(n=t)}),n||((n=new O).sessionId=i,this.sessions.push(n)),n.events.push(t)},m);function m(){this.sessions=new Array}var O=function(){this.events=new Array},S=(R.prototype.Zd=function(t){this.client=t},R.prototype.init=function(t,i){this.tE=t,this.El(i),this.logger.debug(p+"INIT ID: "+t)},R.prototype.El=function(t,i){this.app=t,i&&(this.iE=i)},R.prototype.updatePlayerInfo=function(t){this.nE=t},R.prototype.Hl=function(t){var i=new A(t,this);this.rE.push(i),this.sE=null,this.client.eE(!0)},R.prototype.fd=function(t,i,n){if(!this.sE)for(var r=0;r<this.rE.length;r++){var s=this.rE[r];if(s.ticket.sessionId===t){this.logger.debug(p+"Activating Track for session "+t),this.sE=s;break}}if(this.sE)if(this.sE.ticket.sessionId==t){if(!this.sE.hE){var e=new C(t,i,n);this.sE.oE(e),this.client.eE()}}else this.logger.warn(p+"ignoring manifest not matching event "+this.sE.ticket.sessionId+" != "+t)},R.prototype.uE=function(t,i,n){null!=this.sE&&(this.sE.hE||this.sE.aE.push(new F(t,i,n)))},R.prototype.fE=function(t,i,n){this.cE.push(new j(t,i,n)),this.client.eE()},R.prototype.lE=function(t,i,n){this.vE.push(new L(t,i,n)),this.client.eE()},R.prototype.dE=function(t){var i=this;t&&t.forEach(function(t){i.vE.push(t)})},R.prototype.EE=function(){var t=new b;this.iE?(t.partnerId=this.iE.partnerId,t.customerId=this.iE.customerId):l.HiveConfig.ClientInfo.vc&&l.HiveConfig.ClientInfo.dc?(t.partnerId=l.HiveConfig.ClientInfo.vc,t.customerId=l.HiveConfig.ClientInfo.dc):this.sE&&(t.partnerId=this.sE.ticket.pE(),t.customerId=this.sE.ticket.wE()),t.version=this.app.app+"_"+(this.iE?this.iE.version:this.app.version),this.iE&&(t.installVersion=this.iE.installVersion,t.installTs=this.iE.installTs);var i=new h.gE;return i.bE(navigator.userAgent),t.os=i.yE().name+" "+i.yE().version,this.nE&&(t.commVersion=this.nE.commVersion,t.pluginName=this.nE.pluginName,t.pluginVersion=this.nE.pluginVersion,t.playerTech=this.nE.playerTech,t.playerVersion=this.nE.playerVersion,this.nE.telemetryId&&(t.telemetryId=this.nE.telemetryId)),t},R.prototype.TE=function(){return this.sE?this.sE:this.rE&&0<this.rE.length?this.rE[this.rE.length-1]:void 0},R.prototype.mE=function(t){var n=this;if(void 0===t&&(t=!0),0==this.rE.length&&0==this.cE.length)return t?o.reject("nothing to send"):(this.logger.debug(p+" NOTHING TO SEND"),null);var r=new w;r.app=v.Wd,r.createdAt=u.Framework.time(),r.guid=this.tE,r.name=v.Yd;var i=this.TE();if(i){var s=i.ticket.OE().replace(/[\[\]]/g,"");r.tags=[s],r.tags.push(i.ticket.pE()),r.tags.push(i.ticket.wE())}else r.tags=new Array;var e=new T;if(e.peer=this.EE(),this.rE.forEach(function(t){t.hE||e.zd(t.ticket.sessionId,t)}),this.cE.forEach(function(t){e.zd(t.sessionId,t)}),this.vE.forEach(function(t){e.zd(t.sessionId,t)}),r.data=e,t)return this.SE.getConnectivityInfo().then(function(t){var i=n.RE(t);return e.zd("null",i),r}).fail(function(t){return r});var h=this.RE(this.SE.IE());return e.zd("null",h),r},R.prototype.RE=function(t){var i=new y;i.ts=u.Framework.time();var n=t.getNetworkChanged();return n.getPublicIp()&&(i.pubIp=n.getPublicIp()),n.getPrivateIp()&&(i.privIp=e.Qd.getPrivateIp(n)),t.getHostName()&&(i.hostname=e.Qd.qd(t)),n.getCidr()&&(i.netmask=n.getCidr()),n.getNic()&&(i.nic=n.getNic()),n.getNicName()&&(i.nicName=n.getNicName()),n.getMacAddress()&&(i.mac=n.getMacAddress()),i},R.prototype._E=function(){return this.iE?this.iE.userAgent:navigator.userAgent},R.prototype.reset=function(){this.rE=new Array,this.cE=new Array,this.vE=new Array},R.prototype.AE=function(t){},R);function R(){this.logger=u.Framework.resolve(u.Framework.ht.m).log(),this.SE=u.Framework.resolve(a.pf.af),this.rE=new Array,this.cE=new Array,this.vE=new Array}i.NE=S;var I=(_.prototype.eE=function(t){void 0===t&&(t=!1);var i=t?f.DE.kE.CE:f.DE.kE.ME;this.jE?i<this.PE-(new Date).getTime()&&(u.Framework.clearTimeout(this.jE),this.PE=null,this.HE(i)):this.HE(i)},_.prototype.Ol=function(){this.jE&&(u.Framework.clearTimeout(this.jE),this.PE=this.jE=null)},_.prototype.HE=function(t,i){var n=this;void 0===i&&(i=!1),this.jE=u.Framework.setTimeout(function(){n.LE()},t,i),this.PE=(new Date).getTime()+t},_.prototype.LE=function(t){var i=this;void 0===t&&(t=!0),this.jE=null,this.PE=null;var n=this.wl.mE(t);t?(this.logger.debug(p+"TAKING A TRACK SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.debug(p+" ERROR GENERATING/SENDING THE TRACK SNAPSHOT: ",t)}).finally(function(){return i.wl.reset()}).done()):(this.logger.debug(p+"FLUSHING TRACK SNAPSHOT"),this.forward(n),this.wl.reset())},_.prototype.forward=function(t){if(this.client&&this.client.UE()&&t){var i=JSON.stringify(t);switch(this.FE){case 0:default:this.logger.debug(p+"TRACK EVENT");break;case 1:this.logger.debug(p+"TRACK EVENT:"+i)}var n=new c.hl(HiveStreamingServices.GE,2,i);this.client.UE().send(n)}},_.prototype.xE=function(t){void 0===t&&(t=!0),t?(this.Ol(),this.HE(f.DE.kE.BE,!0)):this.LE(!1)},_);function _(t){this.FE=isNaN(l.HiveConfig.DebugLogs.TrackSnapshotLogs)?0:l.HiveConfig.DebugLogs.TrackSnapshotLogs,this.wl=t,this.logger=u.Framework.resolve(u.Framework.ht.m).log(),this.client=u.Framework.resolve(a.pf.R),this.wl.Zd(this)}i.Rl=I;var A=(N.prototype.oE=function(t){this.manifests.push(t)},N.prototype.toJSON=function(){var n={type:0,ticket:{}};n.ticket.url=this.ticket.ticketUrl,n.ticket.reqTs=this.ticket.VE,n.ticket.respTs=this.ticket.qE,n.ticket.userAgent=this.wl._E(),null!=this.ticket.testId&&(n.ticket.testId=this.ticket.testId),n.manifests=[],this.manifests.forEach(function(t){var i={};i.url=t.url,i.respTs=t.qE,i.respCode=t.respCode,n.manifests.push(i)});var i=-1,r=-1,s=-1;return this.aE.forEach(function(t){0<t.QE&&(-1==i&&(i=t.ts,r=t.QE),s=t.QE)}),-1!=i&&(n.playTs=i),-1!=s&&(n.buffTime=s),-1!=r&&(n.initBuffTime=r),n},N);function N(t,i){this.createdAt=(new Date).getTime(),this.hE=!1,this.ticket=t,this.manifests=new Array,this.aE=new Array,this.wl=i}i.WE=A;var C=function(t,i,n){this.eventId=t,this.url=i,this.qE=(new Date).getTime(),this.respCode=n},k=(D.prototype.toJSON=function(){var t={};return t.type=this.YE+this.event,t.ts=this.ts,this.KE&&(t.parameters=this.KE),t},D);function D(t,i,n,r){this.ts=(new Date).getTime(),this.sessionId=t,this.sessionId||(this.sessionId="null"),this.event=i,this.KE=n,r&&(this.ts=r)}var M,j=(s(P,M=k),P);function P(t,i,n,r){var s=M.call(this,t,i,n,r)||this;return s.YE=100,s}var H,L=(s(U,H=k),U);function U(t,i,n,r){var s=H.call(this,t,i,n,r)||this;return s.YE=200,s}i.$E=L;var F=function(t,i,n){this.ts=(new Date).getTime(),this.playingPoint=t,this.XE=i,this.QE=n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),s=(e.JE="wss://bee.hivestreaming.com:443/v1/hivejs",e.zE="ws://127.0.0.1:8001/v1/hivejs",e.ZE="wss://bee-test.hivestreaming.com:443/v1/hivejs",e.tp="https://api-groot-test.hivestreaming.com/v1/auth/stream",e.np="https://api-groot-prod.hivestreaming.com/v1/auth/stream",e.rp={iceServers:[{url:"stun:stun.hivestreaming.com:3478"}]},e.sp=3e4,e.ME=3e5,e.CE=8e4,e.BE=1e3,e.ep=3e4,e.hp=100,e.op=1e4,e.up=!1,e.ap=!1,e);function e(){}var h=(o.kE=s,o.Wa=r.ut.Wa,o.rf=r.ut.rf,o);function o(){}i.DE=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,e=n(0),s=n(6);(r=i.fp||(i.fp={}))[r.cp=0]="UPPER_LAYER",r[r.lp=1]="CDN",r[r.vp=2]="CDN_PREFETCH",r[r.dp=3]="CDN_COMPENSATION",r[r.Ep=4]="P2P",r[r.pp=5]="P2P_PREFETCH";var h=function(){this.wp=!1,this.gp=!1,this.bp=0,this.yp=0,this.Tp=0,this.mp=0,this.Op=0,this.p2pAgenTrafficSuccessQt=0,this.Sp=0,this.srcOtherRespQt=0,this.Rp=0,this.Ip=0,this._p=0,this.Ap=0,this.Np=0};i.Cp=h;var o=(u.prototype.kp=function(){return this.type},u.prototype.Dp=function(){return this.Mp.Dp()},u.prototype.jp=function(){return this.Mp.jp()},u.prototype.Pp=function(){return this.jp()+"-"+this.Hp},u.prototype.Lp=function(){return this.Mp.Up()},u.prototype.Fp=function(){return this.Mp.Gp()},u.prototype.loaded=function(){this.xp=e.Framework.time()},u.prototype.Bp=function(){return this.xp?Math.max(1,this.xp-this.Vp._p):Math.max(1,this.Vp.Ap-this.Vp._p)},u.prototype.qp=function(){return this.xp?Math.max(1,this.xp-this.Vp.Ip):Math.max(1,this.Vp.Ap-this.Vp.Ip)},u.prototype.Qp=function(){return 0!=this.Vp.Op?(new s.ga).ua(this.Bp(),this.Vp.Op):(new s.ga).ua(this.qp(),this.Vp.yp)},u);function u(t,i,n,r,s){this.Wp=!1,this.type=void 0,this.Vp=new h,this.Yp=!1,this.Kp=!1,this.$p="",this.Xp=new ArrayBuffer(0),this.Jp=0,this.type=n,this.zp=t,this.Hp=i,this.Zp=s,this.Mp=r,this.Vp.Rp=e.Framework.time()}i.tw=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.savings=0,this.cdnRequests=0,this.cdnResponses=0,this.cdnResponseErrors=0,this.cdnResponseBytes=0,this.p2pRequests=0,this.p2pResponses=0,this.p2pResponseErrors=0,this.p2pResponseBytes=0,this.p2pPartnerTotalSentBytes=0,this.partners={}}i.iw=r;function s(){this.uuid="",this.sentBytes=0,this.receivedBytes=0,this.successTransfers=0,this.failedTransfers=0,this.rateReceived=0,this.nw=0}i.rw=s;function e(){}var h,o,u,a;i.HiveSession=e,(o=h=i.HiveSessionErrorCode||(i.HiveSessionErrorCode={}))[o.GENERIC_ERROR=0]="GENERIC_ERROR",o[o.NO_TECH_AVAILABLE=1]="NO_TECH_AVAILABLE",o[o.NO_TECH_RESOLVED=2]="NO_TECH_RESOLVED",o[o.TECH_ERROR=3]="TECH_ERROR",o[o.TICKET_ERROR=4]="TICKET_ERROR",(a=u=u||{})[a["sw"]=0]="Generic Undefined Error",a[a["ew"]=1]="No Tech available to resolve the ticket",a[a["hw"]=2]="No available Tech could resolved the ticket",a[a["ow"]=3]="Stopped resolving session on last tech onError",a[a["uw"]=4]="The ticket could not be resolved";var f=(c.getHiveSessionErrorMessage=function(t){return u[t]},c.getHiveSessionError=function(t,i,n){var r=new c;return r.ticketUrl=t,r.code=i,r.message=c.getHiveSessionErrorMessage(i),r.detailedMessage=n,r},c.HiveSessionErrorCode=h,c);function c(){}i.HiveSessionError=f;function l(t,i){this.code=t,this.message=i}var v,d,E;i.HiveTechError=l,(v=i.aw||(i.aw={}))[v.fw=0]="NOT_READY",v[v.cw=1]="PLUGIN_ERROR",v[v.lw=2]="SESSION_ERROR",v[v.TICKET_ERROR=3]="TICKET_ERROR",v[v.vw=4]="VERSION_ERROR",v[v.dw=5]="TIMEOUT_ERROR",(E=d=i.MainStatusCode||(i.MainStatusCode={}))[E.Ew=0]="OK",E[E.pw=1]="HIVE_NOT_ALLOWED",E[E.ww=2]="TICKET_NOT_RESOLVED",E[E.gw=3]="TIMEOUT_RESOLVING_TICKET",i.bw=function(t){switch(t){case d.Ew:return"OK";case d.pw:return"HIVE_NOT_ALLOWED";case d.ww:return"TICKET_NOT_RESOLVED";case d.gw:return"TIMEOUT_RESOLVING_TICKET";default:return}};var p=(w.prototype.getPluginStatusCode=function(){return this.yw.getStatusCode()},w);function w(t){this.yw=t}i.HivePluginReference=p},function(module,exports,__webpack_require__){var Thrift={Tw:"0.9.3",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},Ql:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},Ow:function(t){var i=0;for(var n in t)t.hasOwnProperty(n)&&i++;return i},Sw:function(t,i,n){function r(){}r.prototype=i.prototype,t.prototype=new r,t.prototype.name=n||""}},copyList,copyMap;Thrift.Rw=function(t){this.message=t},Thrift.Sw(Thrift.Rw,Error,"TException"),Thrift.Rw.prototype.Iw=function(){return this.message},Thrift._w={Aw:0,Nw:1,Cw:2,kw:3,Dw:4,Mw:5,jw:6,Pw:7,Hw:8,Lw:9,Uw:10},Thrift.Fw=function(t,i){this.message=t,this.code="number"==typeof i?i:0},Thrift.Sw(Thrift.Fw,Thrift.Rw,"TApplicationException"),Thrift.Fw.prototype.read=function(t){for(;;){var i=t.Gw();if(i.ftype==Thrift.Type.STOP)break;switch(i.fid){case 1:i.ftype==Thrift.Type.STRING?(i=t.xw(),this.message=i.value):i=t.Bw(i.ftype);break;case 2:i.ftype==Thrift.Type.I32?(i=t.Vw(),this.code=i.value):i=t.Bw(i.ftype);break;default:i=t.Bw(i.ftype)}t.qw()}t.Qw()},Thrift.Fw.prototype.write=function(t){t.Ww("TApplicationException"),this.message&&(t.Yw("message",Thrift.Type.STRING,1),t.Kw(this.Iw()),t.$w()),this.code&&(t.Yw("type",Thrift.Type.I32,2),t.Xw(this.code),t.$w()),t.Jw(),t.zw()},Thrift.Fw.prototype.Zw=function(){return this.code},Thrift.Ju=Thrift.tv=function(t,i){this.url=t,this.tg=0,this.ig=0,this.ng=i&&i.ng,this.rg="",this.sg=""},Thrift.tv.prototype={eg:function(){try{return new XMLHttpRequest}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw"Your browser doesn't support XHR."},flush:function(t,i){var n=this;if(t&&!i||void 0===this.url||""===this.url)return this.rg;var r,s=this.eg();if(s.overrideMimeType&&s.overrideMimeType("application/vnd.apache.thrift.json; charset=utf-8"),i&&(s.onreadystatechange=(r=i,function(){4==this.readyState&&200==this.status&&(n.Jl(this.responseText),r())})),s.open("POST",this.url,!!t),s.setRequestHeader&&(s.setRequestHeader("Accept","application/vnd.apache.thrift.json; charset=utf-8"),s.setRequestHeader("Content-Type","application/vnd.apache.thrift.json; charset=utf-8")),s.send(this.rg),!t||!i){if(4!=s.readyState)throw"encountered an unknown ajax ready state: "+s.readyState;if(200!=s.status)throw"encountered a unknown request status: "+s.status;this.sg=s.responseText,this.hg=this.sg.length,this.tg=this.sg.length,this.ig=0}},og:function(i,t,n,r){if("undefined"==typeof jQuery||void 0===jQuery.ug)throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var s=this;return jQuery.ag({url:this.url,data:t,type:"POST",fg:!1,contentType:"application/vnd.apache.thrift.json; charset=utf-8",cg:"text thrift",lg:{vg:function(t){return s.Jl(t),r.call(i)}},context:i,success:jQuery.dg(n).pop()})},Jl:function(t){this.sg=t,this.hg=this.sg.length,this.tg=this.sg.length,this.ig=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(t){var i=this.tg-this.ig;if(0==i)return"";var n=t;i<t&&(n=i);var r=this.Eg.substr(this.ig,n);return this.ig+=n,r},pg:function(){return this.sg},write:function(t){this.rg=t},Yl:function(){return this.rg}},Thrift.wg=function(t){this.gg(t)},Thrift.wg.prototype={gg:function(t){this.url=t,this.bg=null,this.callbacks=[],this.yg=[],this.rg="",this.sg="",this.Tg=0,this.mg=0},flush:function(t,i){var n,r=this;this.isOpen()?(this.bg.send(this.rg),this.callbacks.push((n=i,function(t){r.Jl(t),n()}))):this.yg.push({Og:this.rg,Sg:i})},Rg:function(){var n=this;0<this.yg.length&&(this.yg.forEach(function(t){var i;this.bg.send(t.Og),this.callbacks.push((i=t.Sg,function(t){n.Jl(t),i()}))}),this.yg=[])},Ig:function(t){this.gg(this.url)},_g:function(t){this.callbacks.length&&this.callbacks.shift()(t.data)},Ag:function(t){console.log("Thrift WebSocket Error: "+t.toString()),this.bg.close()},Jl:function(t){this.sg=t,this.hg=this.sg.length,this.tg=this.sg.length,this.ig=0},isOpen:function(){return this.bg&&this.bg.readyState==this.bg.OPEN},open:function(){this.bg&&this.bg.readyState!=this.bg.CLOSED||(this.bg=new WebSocket(this.url),this.bg.onopen=this.Rg.bind(this),this.bg.onmessage=this._g.bind(this),this.bg.onerror=this.Ag.bind(this),this.bg.onclose=this.Ig.bind(this))},close:function(){this.bg.close()},read:function(t){var i=this.tg-this.ig;if(0==i)return"";var n=t;i<t&&(n=i);var r=this.Eg.substr(this.ig,n);return this.ig+=n,r},pg:function(){return this.sg},write:function(t){this.rg=t},Yl:function(){return this.rg}},Thrift.nv=Thrift.Ng=function(t){this.Cg=[],this.kg=[],this.Kl=t},Thrift.Ng.Type={},Thrift.Ng.Type[Thrift.Type.BOOL]='"tf"',Thrift.Ng.Type[Thrift.Type.BYTE]='"i8"',Thrift.Ng.Type[Thrift.Type.I16]='"i16"',Thrift.Ng.Type[Thrift.Type.I32]='"i32"',Thrift.Ng.Type[Thrift.Type.I64]='"i64"',Thrift.Ng.Type[Thrift.Type.DOUBLE]='"dbl"',Thrift.Ng.Type[Thrift.Type.STRUCT]='"rec"',Thrift.Ng.Type[Thrift.Type.STRING]='"str"',Thrift.Ng.Type[Thrift.Type.MAP]='"map"',Thrift.Ng.Type[Thrift.Type.LIST]='"lst"',Thrift.Ng.Type[Thrift.Type.SET]='"set"',Thrift.Ng.Dg={},Thrift.Ng.Dg.tf=Thrift.Type.BOOL,Thrift.Ng.Dg.i8=Thrift.Type.BYTE,Thrift.Ng.Dg.i16=Thrift.Type.I16,Thrift.Ng.Dg.i32=Thrift.Type.I32,Thrift.Ng.Dg.i64=Thrift.Type.I64,Thrift.Ng.Dg.dbl=Thrift.Type.DOUBLE,Thrift.Ng.Dg.rec=Thrift.Type.STRUCT,Thrift.Ng.Dg.str=Thrift.Type.STRING,Thrift.Ng.Dg.map=Thrift.Type.MAP,Thrift.Ng.Dg.lst=Thrift.Type.LIST,Thrift.Ng.Dg.set=Thrift.Type.SET,Thrift.Ng.Tw=1,Thrift.Ng.prototype={Mg:function(){return this.Kl},ql:function(t,i,n){this.Cg=[],this.kg=[],this.Cg.push([Thrift.Ng.Tw,'"'+t+'"',i,n])},Wl:function(){var t=this.Cg.pop();this.jg=this.Cg.pop(),this.jg.push(t),this.Pg="["+this.jg.join(",")+"]",this.Kl.write(this.Pg)},Ww:function(t){this.kg.push(this.Cg.length),this.Cg.push({})},zw:function(){var t=this.kg.pop(),i=this.Cg[t],n="{",r=!0;for(var s in i)r?r=!1:n+=",",n+=s+":"+i[s];n+="}",this.Cg[t]=n},Yw:function(t,i,n){this.kg.push(this.Cg.length),this.Cg.push({Hg:'"'+n+'"',Lg:Thrift.Ng.Type[i]})},$w:function(){var t=this.Cg.pop(),i=this.Cg.pop();this.Cg[this.Cg.length-1][i.Hg]="{"+i.Lg+":"+t+"}",this.kg.pop()},Jw:function(){},Ug:function(t,i,n){this.kg.push(this.Cg.length),this.Cg.push([Thrift.Ng.Type[t],Thrift.Ng.Type[i],0])},Fg:function(){var t=this.kg.pop();if(t!=this.Cg.length){(this.Cg.length-t-1)%2!=0&&this.Cg.push("");var i=(this.Cg.length-t-1)/2;this.Cg[t][this.Cg[t].length-1]=i;for(var n="}",r=!0;this.Cg.length>t+1;){var s=this.Cg.pop(),e=this.Cg.pop();r?r=!1:n=","+n,isNaN(e)||(e='"'+e+'"'),n=e+":"+s+n}n="{"+n,this.Cg[t].push(n),this.Cg[t]="["+this.Cg[t].join(",")+"]"}},Gg:function(t,i){this.kg.push(this.Cg.length),this.Cg.push([Thrift.Ng.Type[t],i])},xg:function(){for(var t=this.kg.pop();this.Cg.length>t+1;){var i=this.Cg[t+1];this.Cg.splice(t+1,1),this.Cg[t].push(i)}this.Cg[t]="["+this.Cg[t].join(",")+"]"},Bg:function(t,i){this.kg.push(this.Cg.length),this.Cg.push([Thrift.Ng.Type[t],i])},Vg:function(){for(var t=this.kg.pop();this.Cg.length>t+1;){var i=this.Cg[t+1];this.Cg.splice(t+1,1),this.Cg[t].push(i)}this.Cg[t]="["+this.Cg[t].join(",")+"]"},qg:function(t){this.Cg.push(t?1:0)},Qg:function(t){this.Cg.push(t)},Wg:function(t){this.Cg.push(t)},Xw:function(t){this.Cg.push(t)},Yg:function(t){this.Cg.push(t)},Kg:function(t){this.Cg.push(t)},Kw:function(t){if(null===t)this.Cg.push(null);else{for(var i="",n=0;n<t.length;n++){var r=t.charAt(n);i+='"'===r?'\\"':"\\"===r?"\\\\":"\b"===r?"\\b":"\f"===r?"\\f":"\n"===r?"\\n":"\r"===r?"\\r":"\t"===r?"\\t":r}this.Cg.push('"'+i+'"')}},$g:function(t){this.Kw(t)},zl:function(){this.Xg=[],this.ig=[],"undefined"!=typeof JSON&&"function"==typeof JSON.parse?this.Jg=JSON.parse(this.Kl.pg()):"undefined"!=typeof jQuery?this.Jg=jQuery.zg(this.Kl.pg()):this.Jg=eval(this.Kl.pg());var r={},version=this.Jg.shift();if(version!=Thrift.Ng.Tw)throw"Wrong thrift protocol version: "+version;return r.fname=this.Jg.shift(),r.Zg=this.Jg.shift(),r.tb=this.Jg.shift(),this.Xg.push(this.Jg.shift()),r},Zl:function(){},ib:function(t){var i={fname:""};return this.Xg[this.Xg.length-1]instanceof Array&&this.Xg.push(this.Xg[this.Xg.length-1].shift()),i},Qw:function(){this.Xg[this.Xg.length-2]instanceof Array&&this.Xg.pop()},Gw:function(){var t={},i=-1,n=Thrift.Type.STOP;for(var r in this.Xg[this.Xg.length-1])if(null!==r){i=parseInt(r,10),this.ig.push(this.Xg.length);var s=this.Xg[this.Xg.length-1][i];delete this.Xg[this.Xg.length-1][i],this.Xg.push(s);break}if(-1!=i)for(var e in this.Xg[this.Xg.length-1])null!==Thrift.Ng.Dg[e]&&(n=Thrift.Ng.Dg[e],this.Xg[this.Xg.length-1]=this.Xg[this.Xg.length-1][e]);return t.fname="",t.ftype=n,t.fid=i,t},qw:function(){for(var t=this.ig.pop();this.Xg.length>t;)this.Xg.pop()},nb:function(){var t=this.Xg.pop(),i=t.shift();i instanceof Array&&(this.Xg.push(t),i=(t=i).shift());var n={};return n.rb=Thrift.Ng.Dg[i],n.sb=Thrift.Ng.Dg[t.shift()],n.size=t.shift(),this.ig.push(this.Xg.length),this.Xg.push(t.shift()),n},eb:function(){this.qw()},hb:function(){var t=this.Xg[this.Xg.length-1],i={};return i.ob=Thrift.Ng.Dg[t.shift()],i.size=t.shift(),this.ig.push(this.Xg.length),this.Xg.push(t.shift()),i},ub:function(){this.qw()},ab:function(t,i){return this.hb(t,i)},fb:function(){return this.ub()},cb:function(){var t=this.Vw();return null!==t&&"1"==t.value?t.value=!0:t.value=!1,t},lb:function(){return this.Vw()},vb:function(){return this.Vw()},Vw:function(t){void 0===t&&(t=this.Xg[this.Xg.length-1]);var i={};if(t instanceof Array)0===t.length?i.value=void 0:i.value=t.shift();else if(t instanceof Object){for(var n in t)if(null!==n){this.Xg.push(t[n]),delete t[n],i.value=n;break}}else i.value=t,this.Xg.pop();return i},Eb:function(){return this.Vw()},pb:function(){return this.Vw()},xw:function(){return this.Vw()},wb:function(){return this.xw()},Bw:function(t){var i,n;switch(t){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.cb();case Thrift.Type.BYTE:return this.lb();case Thrift.Type.I16:return this.vb();case Thrift.Type.I32:return this.Vw();case Thrift.Type.I64:return this.Eb();case Thrift.Type.DOUBLE:return this.pb();case Thrift.Type.STRING:return this.xw();case Thrift.Type.STRUCT:for(this.ib();(i=this.Gw()).ftype!=Thrift.Type.STOP;)this.Bw(i.ftype),this.qw();return this.Qw(),null;case Thrift.Type.MAP:for(i=this.nb(),n=0;n<i.size;n++)0<n&&this.Xg.length>this.ig[this.ig.length-1]+1&&this.Xg.pop(),this.Bw(i.rb),this.Bw(i.sb);return this.eb(),null;case Thrift.Type.SET:for(i=this.ab(),n=0;n<i.size;n++)this.Bw(i.ob);return this.fb(),null;case Thrift.Type.LIST:for(i=this.hb(),n=0;n<i.size;n++)this.Bw(i.ob);return this.ub(),null}}},Thrift.gb=function(t,i,n,r){Thrift.Ng.call(this,i,n,r),this.bb=t},Thrift.Sw(Thrift.gb,Thrift.Ng,"multiplexProtocol"),Thrift.gb.prototype.ql=function(t,i,n){i===Thrift.Ql.CALL||i===Thrift.Ql.ONEWAY?Thrift.Ng.prototype.ql.call(this,this.bb+":"+t,i,n):Thrift.Ng.prototype.ql.call(this,t,i,n)},Thrift.yb=function(){this.Tb=0},Thrift.yb.prototype.mb=function(t,i,n){i.Rl&&(i=i.Rl);var r=this;return i.prototype.Ob=function(){return r.Tb+=1,r.Tb},new i(new Thrift.gb(t,n))},copyList=function(t,i){if(!t)return t;var n,r,s,e=n=void 0===i.shift?i:i[0],h=t.length,o=[];for(r=0;r<h;r++)s=t[r],null===n?o.push(s):n===copyMap||n===copyList?o.push(n(s,i.slice(1))):o.push(new e(s));return o},copyMap=function(t,i){if(!t)return t;var n,r,s=n=void 0===i.shift?i:i[0],e={};for(var h in t)t.hasOwnProperty(h)&&(r=t[h],e[h]=null===n?r:n===copyMap||n===copyList?n(r,i.slice(1)):new s(r));return e},Thrift.Sb=copyMap,Thrift.Rb=copyList,module.exports=Thrift},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Xv="undefined"!=typeof location&&"https:"===location.protocol,s.rd=!0,s.Ib=1e4,s.Mu=6e4,s._b="X-Hive-TestId",s);function s(){}i.et=r},function(n,r,s){var e,h,o;
/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.1
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */
/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.19.1
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.io/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *
 */
!function(t,i){"use strict";n.exports?n.exports=i(s(23),s(23),s(23)):(h=[s(23),s(23),s(23)],void 0===(o="function"==typeof(e=i)?e.apply(r,h):e)||(n.exports=o))}(0,function(o,i,a,n){"use strict";var r=n&&n.Ab;function w(t,i){var n=1<=arguments.length;if(!(this instanceof w))return n?2<=arguments.length?new w(t,i):new w(t):new w;if(void 0===t){if(n)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}if(null===t&&n)throw new TypeError("null is not a valid argument for URI");return this.href(t),void 0!==i?this.Na(i):this}w.version="1.19.1";var t=w.prototype,f=Object.prototype.hasOwnProperty;function u(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function h(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function c(t){return"Array"===h(t)}function l(t,i){var n,r,s={};if("RegExp"===h(i))s=null;else if(c(i))for(n=0,r=i.length;n<r;n++)s[i[n]]=!0;else s[i]=!0;for(n=0,r=t.length;n<r;n++){(s&&void 0!==s[t[n]]||!s&&i.test(t[n]))&&(t.splice(n,1),r--,n--)}return t}function v(t,i){var n,r;if(c(i)){for(n=0,r=i.length;n<r;n++)if(!v(t,i[n]))return!1;return!0}var s=h(i);for(n=0,r=t.length;n<r;n++)if("RegExp"===s){if("string"==typeof t[n]&&t[n].match(i))return!0}else if(t[n]===i)return!0;return!1}function d(t,i){if(!c(t)||!c(i))return!1;if(t.length!==i.length)return!1;t.sort(),i.sort();for(var n=0,r=t.length;n<r;n++)if(t[n]!==i[n])return!1;return!0}function E(t){return t.replace(/^\/+|\/+$/g,"")}function s(t){return escape(t)}function e(t){return encodeURIComponent(t).replace(/[!'()*]/g,s).replace(/\*/g,"%2A")}w.Nb=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,Cb:null,kb:w.kb,Db:w.Db,Mb:w.Mb}},w.kb=!1,w.Db=!1,w.Mb=!0,w.jb=/^[a-z][a-z0-9.+-]*$/i,w.Pb=/[^a-z0-9\._-]/i,w.Hb=/(xn--)/i,w.Lb=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w.Ub=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,w.Fb=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/gi,w.Gb={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?]+$/,xb:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},w.Bb={Vb:"80",qb:"443",Qb:"21",Wb:"70",Yb:"80",Kb:"443"},w.$b=["http","https"],w.Xb=/[^a-zA-Z0-9\.\-:_]/,w.Jb={a:"href",zb:"cite",link:"href",Zb:"href",ty:"src",form:"action",iy:"src",ny:"href",sy:"src",ey:"src",source:"src",track:"src",input:"src",hy:"src",video:"src"},w.oy=function(t){if(t&&t.nodeName){var i=t.nodeName.toLowerCase();if("input"!==i||"image"===t.type)return w.Jb[i]}},w.encode=e,w.decode=decodeURIComponent,w.uy=function(){w.encode=escape,w.decode=unescape},w.unicode=function(){w.encode=e,w.decode=decodeURIComponent},w.ay={pathname:{encode:{ly:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{ly:/[\/\?#]/g,map:{vy:"%2F",Ey:"%3F",py:"%23"}}},wy:{encode:{ly:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":",gy:"/",by:"?",yy:"#",Ty:"[",my:"]","%40":"@",Oy:"!","%24":"$","%26":"&",Sy:"'",Ry:"(",Iy:")",_y:"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},Ay:{encode:{ly:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{Oy:"!","%24":"$",Sy:"'",Ry:"(",Iy:")",_y:"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{ly:/[\/\?#:]/g,map:{vy:"%2F",Ey:"%3F",py:"%23",Ny:"%3A"}}}},w.Cy=function(t,i){var n=w.encode(t+"");return void 0===i&&(i=w.Mb),i?n.replace(/%20/g,"+"):n},w.ky=function(i,t){i+="",void 0===t&&(t=w.Mb);try{return w.decode(t?i.replace(/\+/g,"%20"):i)}catch(t){return i}};function p(n,r){return function(i){try{return w[r](i+"").replace(w.ay[n][r].ly,function(t){return w.ay[n][r].map[t]})}catch(t){return i}}}var g,b={encode:"encode",decode:"decode"};for(g in b)w[g+"PathSegment"]=p("pathname",b[g]),w[g+"UrnPathSegment"]=p("urnpath",b[g]);function y(e,h,o){return function(t){var i;i=o?function(t){return w[h](w[o](t))}:w[h];for(var n=(t+"").split(e),r=0,s=n.length;r<s;r++)n[r]=i(n[r]);return n.join(e)}}function T(n){return function(t,i){return void 0===t?this.Nb[n]||"":(this.Nb[n]=t||null,this.Wv(!i),this)}}function m(n,r){return function(t,i){return void 0===t?this.Nb[n]||"":(null!==t&&(t+="").charAt(0)===r&&(t=t.substring(1)),this.Nb[n]=t,this.Wv(!i),this)}}w.Dy=y("/","decodePathSegment"),w.My=y(":","decodeUrnPathSegment"),w.jy=y("/","encodePathSegment","decode"),w.Py=y(":","encodeUrnPathSegment","decode"),w.Hy=p("reserved","encode"),w.parse=function(t,i){var n;return i=i||{kb:w.kb},-1<(n=t.indexOf("#"))&&(i.Cb=t.substring(n+1)||null,t=t.substring(0,n)),-1<(n=t.indexOf("?"))&&(i.query=t.substring(n+1)||null,t=t.substring(0,n)),"//"===t.substring(0,2)?(i.protocol=null,t=t.substring(2),t=w.Ly(t,i)):-1<(n=t.indexOf(":"))&&(i.protocol=t.substring(0,n)||null,i.protocol&&!i.protocol.match(w.jb)?i.protocol=void 0:"//"===t.substring(n+1,n+3)?(t=t.substring(n+3),t=w.Ly(t,i)):(t=t.substring(n+1),i.urn=!0)),i.path=t,i},w.Uy=function(t,i){var n,r,s=(t=(t=t||"").replace(/\\/g,"/")).indexOf("/");if(-1===s&&(s=t.length),"["===t.charAt(0))n=t.indexOf("]"),i.hostname=t.substring(1,n)||null,i.port=t.substring(n+2,s)||null,"/"===i.port&&(i.port=null);else{var e=t.indexOf(":"),h=t.indexOf("/"),o=t.indexOf(":",e+1);-1!==o&&(-1===h||o<h)?(i.hostname=t.substring(0,s)||null,i.port=null):(r=t.substring(0,s).split(":"),i.hostname=r[0]||null,i.port=r[1]||null)}return i.hostname&&"/"!==t.substring(s).charAt(0)&&(s++,t="/"+t),i.kb&&w.Fy(i.hostname,i.protocol),i.port&&w.Gy(i.port),t.substring(s)||"/"},w.Ly=function(t,i){return t=w.xy(t,i),w.Uy(t,i)},w.xy=function(t,i){var n,r=t.indexOf("/"),s=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<s&&(-1===r||s<r)?(n=t.substring(0,s).split(":"),i.username=n[0]?w.decode(n[0]):null,n.shift(),i.password=n[0]?w.decode(n.join(":")):null,t=t.substring(s+1)):(i.username=null,i.password=null),t},w.By=function(t,i){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,s,e={},h=t.split("&"),o=h.length,u=0;u<o;u++)n=h[u].split("="),r=w.ky(n.shift(),i),s=n.length?w.ky(n.join("="),i):null,f.call(e,r)?("string"!=typeof e[r]&&null!==e[r]||(e[r]=[e[r]]),e[r].push(s)):e[r]=s;return e},w.Wv=function(t){var i="";return t.protocol&&(i+=t.protocol+":"),t.urn||!i&&!t.hostname||(i+="//"),i+=w.Vy(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(i+="/"),i+=t.path),"string"==typeof t.query&&t.query&&(i+="?"+t.query),"string"==typeof t.Cb&&t.Cb&&(i+="#"+t.Cb),i},w.qy=function(t){var i="";return t.hostname?(w.Ub.test(t.hostname)?i+="["+t.hostname+"]":i+=t.hostname,t.port&&(i+=":"+t.port),i):""},w.Vy=function(t){return w.Qy(t)+w.qy(t)},w.Qy=function(t){var i="";return t.username&&(i+=w.encode(t.username)),t.password&&(i+=":"+w.encode(t.password)),i&&(i+="@"),i},w.Wy=function(t,i,n){var r,s,e,h,o="";for(s in t)if(f.call(t,s)&&s)if(c(t[s]))for(r={},e=0,h=t[s].length;e<h;e++)void 0!==t[s][e]&&void 0===r[t[s][e]+""]&&(o+="&"+w.Yy(s,t[s][e],n),!0!==i&&(r[t[s][e]+""]=!0));else void 0!==t[s]&&(o+="&"+w.Yy(s,t[s],n));return o.substring(1)},w.Yy=function(t,i,n){return w.Cy(t,n)+(null!==i?"="+w.Cy(i,n):"")},w.Ky=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&w.Ky(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[i])return void(t[i]=n);"string"==typeof t[i]&&(t[i]=[t[i]]),c(n)||(n=[n]),t[i]=(t[i]||[]).concat(n)}},w.$y=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&w.$y(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");t[i]=void 0===n?null:n}},w.Xy=function(t,i,n){var r,s,e;if(c(i))for(r=0,s=i.length;r<s;r++)t[i[r]]=void 0;else if("RegExp"===h(i))for(e in t)i.test(e)&&(t[e]=void 0);else if("object"==typeof i)for(e in i)f.call(i,e)&&w.Xy(t,e,i[e]);else{if("string"!=typeof i)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===h(n)?!c(t[i])&&n.test(t[i])?t[i]=void 0:t[i]=l(t[i],n):t[i]!==String(n)||c(n)&&1!==n.length?c(t[i])&&(t[i]=l(t[i],n)):t[i]=void 0:t[i]=void 0}},w.Jy=function(t,i,n,r){switch(h(i)){case"String":break;case"RegExp":for(var s in t)if(f.call(t,s)&&i.test(s)&&(void 0===n||w.Jy(t,s,n)))return!0;return!1;case"Object":for(var e in i)if(f.call(i,e)&&!w.Jy(t,e,i[e]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(h(n)){case"Undefined":return i in t;case"Boolean":return n===Boolean(c(t[i])?t[i].length:t[i]);case"Function":return!!n(t[i],i,t);case"Array":return!!c(t[i])&&(r?v:d)(t[i],n);case"RegExp":return c(t[i])?!!r&&v(t[i],n):Boolean(t[i]&&t[i].match(n));case"Number":n=String(n);case"String":return c(t[i])?!!r&&v(t[i],n):t[i]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},w.zy=function(){for(var t=[],i=[],n=0,r=0;r<arguments.length;r++){var s=new w(arguments[r]);t.push(s);for(var e=s.Zy(),h=0;h<e.length;h++)"string"==typeof e[h]&&i.push(e[h]),e[h]&&n++}if(!i.length||!n)return new w("");var o=new w("").Zy(i);return""!==t[0].path()&&"/"!==t[0].path().slice(0,1)||o.path("/"+o.path()),o.normalize()},w.tT=function(t,i){var n,r=Math.min(t.length,i.length);for(n=0;n<r;n++)if(t.charAt(n)!==i.charAt(n)){n--;break}return n<1?t.charAt(0)===i.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(n)&&"/"===i.charAt(n)||(n=t.substring(0,n).lastIndexOf("/")),t.substring(0,n+1))},w.iT=function(t,i,n){var r=(n=n||{}).start||w.Gb.start,s=n.end||w.Gb.end,e=n.trim||w.Gb.trim,h=n.xb||w.Gb.xb,o=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var u=r.exec(t);if(!u)break;var a=u.index;if(n.nT){var f=t.slice(Math.max(a-3,0),a);if(f&&o.test(f))continue}for(var c=a+t.slice(a).search(s),l=t.slice(a,c),v=-1;;){var d=h.exec(l);if(!d)break;var E=d.index+d[0].length;v=Math.max(v,E)}if(!((l=-1<v?l.slice(0,v)+l.slice(v).replace(e,""):l.replace(e,"")).length<=u[0].length||n.rT&&n.rT.test(l))){var p=i(l,a,c=a+l.length,t);void 0!==p?(p=String(p),t=t.slice(0,a)+p+t.slice(c),r.lastIndex=a+p.length):r.lastIndex=c}}return r.lastIndex=0,t},w.Fy=function(t,i){var n=!!t,r=!1;if(!!i&&(r=v(w.$b,i)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+i);if(t&&t.match(w.Xb)){if(!o)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(o.sT(t).match(w.Xb))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},w.Gy=function(t){if(t){var i=Number(t);if(!(function(t){return/^[0-9]+$/.test(t)}(i)&&0<i&&i<65536))throw new TypeError('Port "'+t+'" is not a valid port')}},w.Qh=function(t){if(t){var i={Ab:this.Qh()};return n.eT&&"function"==typeof n.eT.Qh&&(i.eT=n.eT.Qh()),n.hT&&"function"==typeof n.hT.Qh&&(i.hT=n.hT.Qh()),n.oT&&"function"==typeof n.oT.Qh&&(i.oT=n.oT.Qh()),i}return n.Ab===this&&(n.Ab=r),this},t.Wv=function(t){return!0===t?this.uT=!0:void 0!==t&&!this.uT||(this.aT=w.Wv(this.Nb),this.uT=!1),this},t.clone=function(){return new w(this)},t.valueOf=t.toString=function(){return this.Wv(!1).aT},t.protocol=T("protocol"),t.username=T("username"),t.password=T("password"),t.hostname=T("hostname"),t.port=T("port"),t.query=m("query","?"),t.Cb=m("fragment","#"),t.search=function(t,i){var n=this.query(t,i);return"string"==typeof n&&n.length?"?"+n:n},t.hash=function(t,i){var n=this.Cb(t,i);return"string"==typeof n&&n.length?"#"+n:n},t.pathname=function(t,i){if(void 0!==t&&!0!==t)return this.Nb.urn?this.Nb.path=t?w.Py(t):"":this.Nb.path=t?w.jy(t):"/",this.Wv(!i),this;var n=this.Nb.path||(this.Nb.hostname?"/":"");return t?(this.Nb.urn?w.My:w.Dy)(n):n},t.path=t.pathname,t.href=function(t,i){var n;if(void 0===t)return this.toString();this.aT="",this.Nb=w.Nb();var r=t instanceof w,s="object"==typeof t&&(t.hostname||t.path||t.pathname);t.nodeName&&(t=t[w.oy(t)]||"",s=!1);if(!r&&s&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this.Nb=w.parse(String(t),this.Nb);else{if(!r&&!s)throw new TypeError("invalid input");var e=r?t.Nb:t;for(n in e)"query"!==n&&f.call(this.Nb,n)&&(this.Nb[n]=e[n]);e.query&&this.query(e.query,!1)}return this.Wv(!i),this},t.is=function(t){var i=!1,n=!1,r=!1,s=!1,e=!1,h=!1,o=!1,u=!this.Nb.urn;switch(this.Nb.hostname&&(u=!1,n=w.Lb.test(this.Nb.hostname),r=w.Ub.test(this.Nb.hostname),e=(s=!(i=n||r))&&a&&a.has(this.Nb.hostname),h=s&&w.Pb.test(this.Nb.hostname),o=s&&w.Hb.test(this.Nb.hostname)),t.toLowerCase()){case"relative":return u;case"absolute":return!u;case"domain":case"name":return s;case"sld":return e;case"ip":return i;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return h;case"url":return!this.Nb.urn;case"urn":return!!this.Nb.urn;case"punycode":return o}return null};var O=t.protocol,S=t.port,R=t.hostname;t.protocol=function(t,i){if(t&&!(t=t.replace(/:(\/\/)?$/,"")).match(w.jb))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return O.call(this,t,i)},t.scheme=t.protocol,t.port=function(t,i){return this.Nb.urn?void 0===t?"":this:(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),w.Gy(t))),S.call(this,t,i))},t.hostname=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0!==t){var n={kb:this.Nb.kb};if("/"!==w.Uy(t,n))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=n.hostname,this.Nb.kb&&w.Fy(t,this.Nb.protocol)}return R.call(this,t,i)},t.origin=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t){var n=this.protocol();return this.fT()?(n?n+"://":"")+this.fT():""}var r=w(t);return this.protocol(r.protocol()).fT(r.fT()).Wv(!i),this},t.host=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t)return this.Nb.hostname?w.qy(this.Nb):"";if("/"!==w.Uy(t,this.Nb))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.Wv(!i),this},t.fT=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t)return this.Nb.hostname?w.Vy(this.Nb):"";if("/"!==w.Ly(t,this.Nb))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this.Wv(!i),this},t.cT=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0!==t)return"@"!==t[t.length-1]&&(t+="@"),w.xy(t,this.Nb),this.Wv(!i),this;var n=w.Qy(this.Nb);return n?n.substring(0,n.length-1):n},t.lT=function(t,i){var n;return void 0===t?this.path()+this.search()+this.hash():(n=w.parse(t),this.Nb.path=n.path,this.Nb.query=n.query,this.Nb.Cb=n.Cb,this.Wv(!i),this)},t.vT=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t){if(!this.Nb.hostname||this.is("IP"))return"";var n=this.Nb.hostname.length-this.domain().length-1;return this.Nb.hostname.substring(0,n)||""}var r=this.Nb.hostname.length-this.domain().length,s=this.Nb.hostname.substring(0,r),e=new RegExp("^"+u(s));if(t&&"."!==t.charAt(t.length-1)&&(t+="."),-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");return t&&w.Fy(t,this.Nb.protocol),this.Nb.hostname=this.Nb.hostname.replace(e,t),this.Wv(!i),this},t.domain=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Nb.hostname||this.is("IP"))return"";var n=this.Nb.hostname.match(/\./g);if(n&&n.length<2)return this.Nb.hostname;var r=this.Nb.hostname.length-this.dT(i).length-1;return r=this.Nb.hostname.lastIndexOf(".",r-1)+1,this.Nb.hostname.substring(r)||""}if(!t)throw new TypeError("cannot set domain empty");if(-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(w.Fy(t,this.Nb.protocol),!this.Nb.hostname||this.is("IP"))this.Nb.hostname=t;else{var s=new RegExp(u(this.domain())+"$");this.Nb.hostname=this.Nb.hostname.replace(s,t)}return this.Wv(!i),this},t.dT=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Nb.hostname||this.is("IP"))return"";var n=this.Nb.hostname.lastIndexOf("."),r=this.Nb.hostname.substring(n+1);return!0!==i&&a&&a.list[r.toLowerCase()]&&a.get(this.Nb.hostname)||r}var s;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!a||!a.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');s=new RegExp(u(this.dT())+"$"),this.Nb.hostname=this.Nb.hostname.replace(s,t)}else{if(!this.Nb.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");s=new RegExp(u(this.dT())+"$"),this.Nb.hostname=this.Nb.hostname.replace(s,t)}return this.Wv(!i),this},t.ET=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Nb.path&&!this.Nb.hostname)return"";if("/"===this.Nb.path)return"/";var n=this.Nb.path.length-this.filename().length-1,r=this.Nb.path.substring(0,n)||(this.Nb.hostname?"/":"");return t?w.Dy(r):r}var s=this.Nb.path.length-this.filename().length,e=this.Nb.path.substring(0,s),h=new RegExp("^"+u(e));return this.is("relative")||"/"!==(t=t||"/").charAt(0)&&(t="/"+t),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=w.jy(t),this.Nb.path=this.Nb.path.replace(h,t),this.Wv(!i),this},t.filename=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if("string"!=typeof t){if(!this.Nb.path||"/"===this.Nb.path)return"";var n=this.Nb.path.lastIndexOf("/"),r=this.Nb.path.substring(n+1);return t?w.pT(r):r}var s=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(s=!0);var e=new RegExp(u(this.filename())+"$");return t=w.jy(t),this.Nb.path=this.Nb.path.replace(e,t),s?this.wT(i):this.Wv(!i),this},t.suffix=function(t,i){if(this.Nb.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Nb.path||"/"===this.Nb.path)return"";var n,r,s=this.filename(),e=s.lastIndexOf(".");return-1===e?"":(n=s.substring(e+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",t?w.pT(r):r)}"."===t.charAt(0)&&(t=t.substring(1));var h,o=this.suffix();if(o)h=t?new RegExp(u(o)+"$"):new RegExp(u("."+o)+"$");else{if(!t)return this;this.Nb.path+="."+w.jy(t)}return h&&(t=w.jy(t),this.Nb.path=this.Nb.path.replace(h,t)),this.Wv(!i),this},t.Zy=function(t,i,n){var r=this.Nb.urn?":":"/",s=this.path(),e="/"===s.substring(0,1),h=s.split(r);if(void 0!==t&&"number"!=typeof t&&(n=i,i=t,t=void 0),void 0!==t&&"number"!=typeof t)throw new Error('Bad segment "'+t+'", must be 0-based integer');if(e&&h.shift(),t<0&&(t=Math.max(h.length+t,0)),void 0===i)return void 0===t?h:h[t];if(null===t||void 0===h[t])if(c(i)){h=[];for(var o=0,u=i.length;o<u;o++)(i[o].length||h.length&&h[h.length-1].length)&&(h.length&&!h[h.length-1].length&&h.pop(),h.push(E(i[o])))}else!i&&"string"!=typeof i||(i=E(i),""===h[h.length-1]?h[h.length-1]=i:h.push(i));else i?h[t]=E(i):h.splice(t,1);return e&&h.unshift(""),this.path(h.join(r),n)},t.gT=function(t,i,n){var r,s,e;if("number"!=typeof t&&(n=i,i=t,t=void 0),void 0===i){if(c(r=this.Zy(t,i,n)))for(s=0,e=r.length;s<e;s++)r[s]=w.decode(r[s]);else r=void 0!==r?w.decode(r):void 0;return r}if(c(i))for(s=0,e=i.length;s<e;s++)i[s]=w.encode(i[s]);else i="string"==typeof i||i instanceof String?w.encode(i):i;return this.Zy(t,i,n)};var I=t.query;return t.query=function(t,i){if(!0===t)return w.By(this.Nb.query,this.Nb.Mb);if("function"!=typeof t)return void 0!==t&&"string"!=typeof t?(this.Nb.query=w.Wy(t,this.Nb.Db,this.Nb.Mb),this.Wv(!i),this):I.call(this,t,i);var n=w.By(this.Nb.query,this.Nb.Mb),r=t.call(this,n);return this.Nb.query=w.Wy(r||n,this.Nb.Db,this.Nb.Mb),this.Wv(!i),this},t.$y=function(t,i,n){var r=w.By(this.Nb.query,this.Nb.Mb);if("string"==typeof t||t instanceof String)r[t]=void 0!==i?i:null;else{if("object"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var s in t)f.call(t,s)&&(r[s]=t[s])}return this.Nb.query=w.Wy(r,this.Nb.Db,this.Nb.Mb),"string"!=typeof t&&(n=i),this.Wv(!n),this},t.Ky=function(t,i,n){var r=w.By(this.Nb.query,this.Nb.Mb);return w.Ky(r,t,void 0===i?null:i),this.Nb.query=w.Wy(r,this.Nb.Db,this.Nb.Mb),"string"!=typeof t&&(n=i),this.Wv(!n),this},t.Xy=function(t,i,n){var r=w.By(this.Nb.query,this.Nb.Mb);return w.Xy(r,t,i),this.Nb.query=w.Wy(r,this.Nb.Db,this.Nb.Mb),"string"!=typeof t&&(n=i),this.Wv(!n),this},t.Jy=function(t,i,n){var r=w.By(this.Nb.query,this.Nb.Mb);return w.Jy(r,t,i,n)},t.bT=t.$y,t.yT=t.Ky,t.TT=t.Xy,t.mT=t.Jy,t.normalize=function(){return this.Nb.urn?this.RT(!1).wT(!1).ST(!1).OT(!1).Wv():this.RT(!1)._T(!1).IT(!1).wT(!1).ST(!1).OT(!1).Wv()},t.RT=function(t){return"string"==typeof this.Nb.protocol&&(this.Nb.protocol=this.Nb.protocol.toLowerCase(),this.Wv(!t)),this},t._T=function(t){return this.Nb.hostname&&(this.is("IDN")&&o?this.Nb.hostname=o.sT(this.Nb.hostname):this.is("IPv6")&&i&&(this.Nb.hostname=i.AT(this.Nb.hostname)),this.Nb.hostname=this.Nb.hostname.toLowerCase(),this.Wv(!t)),this},t.IT=function(t){return"string"==typeof this.Nb.protocol&&this.Nb.port===w.Bb[this.Nb.protocol]&&(this.Nb.port=null,this.Wv(!t)),this},t.wT=function(t){var i,n=this.Nb.path;if(!n)return this;if(this.Nb.urn)return this.Nb.path=w.Py(this.Nb.path),this.Wv(!t),this;if("/"===this.Nb.path)return this;var r,s,e="";for("/"!==(n=w.jy(n)).charAt(0)&&(i=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(e=(e=n.substring(1).match(/^(\.\.\/)+/)||"")&&e[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)n=0!==r?(-1===(s=n.substring(0,r).lastIndexOf("/"))&&(s=r),n.substring(0,s)+n.substring(r+3)):n.substring(3);return i&&this.is("relative")&&(n=e+n.substring(1)),this.Nb.path=n,this.Wv(!t),this},t.NT=t.wT,t.ST=function(t){return"string"==typeof this.Nb.query&&(this.Nb.query.length?this.query(w.By(this.Nb.query,this.Nb.Mb)):this.Nb.query=null,this.Wv(!t)),this},t.OT=function(t){return this.Nb.Cb||(this.Nb.Cb=null,this.Wv(!t)),this},t.CT=t.ST,t.kT=t.OT,t.uy=function(){var t=w.encode,i=w.decode;w.encode=escape,w.decode=decodeURIComponent;try{this.normalize()}finally{w.encode=t,w.decode=i}return this},t.unicode=function(){var t=w.encode,i=w.decode;w.encode=e,w.decode=unescape;try{this.normalize()}finally{w.encode=t,w.decode=i}return this},t.readable=function(){var t=this.clone();t.username("").password("").normalize();var i="";if(t.Nb.protocol&&(i+=t.Nb.protocol+"://"),t.Nb.hostname&&(t.is("punycode")&&o?(i+=o.DT(t.Nb.hostname),t.Nb.port&&(i+=":"+t.Nb.port)):i+=t.host()),t.Nb.hostname&&t.Nb.path&&"/"!==t.Nb.path.charAt(0)&&(i+="/"),i+=t.path(!0),t.Nb.query){for(var n="",r=0,s=t.Nb.query.split("&"),e=s.length;r<e;r++){var h=(s[r]||"").split("=");n+="&"+w.ky(h[0],this.Nb.Mb).replace(/&/g,"%26"),void 0!==h[1]&&(n+="="+w.ky(h[1],this.Nb.Mb).replace(/&/g,"%26"))}i+="?"+n.substring(1)}return i+=w.ky(t.hash(),!0)},t.Na=function(t){var i,n,r,s=this.clone(),e=["protocol","username","password","hostname","port"];if(this.Nb.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t instanceof w||(t=new w(t)),s.Nb.protocol)return s;if(s.Nb.protocol=t.Nb.protocol,this.Nb.hostname)return s;for(n=0;r=e[n];n++)s.Nb[r]=t.Nb[r];return s.Nb.path?(".."===s.Nb.path.substring(-2)&&(s.Nb.path+="/"),"/"!==s.path().charAt(0)&&(i=(i=t.ET())||(0===t.path().indexOf("/")?"/":""),s.Nb.path=(i?i+"/":"")+s.Nb.path,s.wT())):(s.Nb.path=t.Nb.path,s.Nb.query||(s.Nb.query=t.Nb.query)),s.Wv(),s},t.MT=function(t){var i,n,r,s,e,h=this.clone().normalize();if(h.Nb.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t=new w(t).normalize(),i=h.Nb,n=t.Nb,s=h.path(),e=t.path(),"/"!==s.charAt(0))throw new Error("URI is already relative");if("/"!==e.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(i.protocol===n.protocol&&(i.protocol=null),i.username!==n.username||i.password!==n.password)return h.Wv();if(null!==i.protocol||null!==i.username||null!==i.password)return h.Wv();if(i.hostname!==n.hostname||i.port!==n.port)return h.Wv();if(i.hostname=null,i.port=null,s===e)return i.path="",h.Wv();if(!(r=w.tT(s,e)))return h.Wv();var o=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return i.path=o+i.path.substring(r.length)||"./",h.Wv()},t.Wh=function(t){var i,n,r,s,e,h=this.clone(),o=new w(t),u={};if(h.normalize(),o.normalize(),h.toString()===o.toString())return!0;if(r=h.query(),s=o.query(),h.query(""),o.query(""),h.toString()!==o.toString())return!1;if(r.length!==s.length)return!1;for(e in i=w.By(r,this.Nb.Mb),n=w.By(s,this.Nb.Mb),i)if(f.call(i,e)){if(c(i[e])){if(!d(i[e],n[e]))return!1}else if(i[e]!==n[e])return!1;u[e]=!0}for(e in n)if(f.call(n,e)&&!u[e])return!1;return!0},t.kb=function(t){return this.Nb.kb=!!t,this},t.Db=function(t){return this.Nb.Db=!!t,this},t.Mb=function(t){return this.Nb.Mb=!!t,this},w})},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(8),e=n(7).ut.xa,h=(o.Reporting=function(){return o.app="STATS",r.Framework.resolve(s.pf.lf)},o.Pl=function(){return this.app},o.getVersion=function(){return this.version},o.version=e,o);function o(){}i.Hive=h},function(t,i){var g,E,e,a,n,h,r,o={userAgent:!1},u={};if(void 0===f||!f)var f={};f.jT=function(){var t,i,n,r=arguments,s=null;for(t=0;t<r.length;t+=1)for(n=(""+r[t]).split("."),s=f,i="YAHOO"==n[0]?1:0;i<n.length;i+=1)s[n[i]]=s[n[i]]||{},s=s[n[i]];return s},f.log=function(t,i,n){var r=f.HT.PT;return!(!r||!r.log)&&r.log(t,i,n)},f.register=function(t,i,n){var r,s,e,h,o,u=f.Xe.LT;for(u[t]||(u[t]={UT:[],FT:[]}),r=u[t],s=n.version,e=n.Wv,h=f.Xe.jd,r.name=t,r.version=s,r.Wv=e,r.UT.push(s),r.FT.push(e),r.GT=i,o=0;o<h.length;o+=1)h[o](r);i?(i.VERSION=s,i.xT=e):f.log("mainClass is undefined for module "+t,"warn")},f.Xe=f.Xe||{LT:[],jd:[]},f.Xe.getVersion=function(t){return f.Xe.LT[t]||null},f.Xe.BT=function(t){function i(t){var i=0;return parseFloat(t.replace(/\./g,function(){return 1==i++?"":"."}))}var n,r={VT:0,opera:0,qT:0,QT:0,chrome:0,WT:null,YT:0,KT:0,$T:0,XT:0,JT:null,zT:0,ZT:0,tm:o&&o.im,nm:!1,os:null},s=t||o&&o.userAgent,e=u.location,h=e&&e.href;return r.nm=h&&0===h.toLowerCase().indexOf("https"),s&&(/windows|win32/i.test(s)?r.os="windows":/macintosh/i.test(s)?r.os="macintosh":/rhino/i.test(s)&&(r.os="rhino"),/KHTML/.test(s)&&(r.QT=1),(n=s.match(/AppleWebKit\/([^\s]*)/))&&n[1]&&(r.QT=i(n[1]),/ Mobile\//.test(s)?(r.WT="Apple",(n=s.match(/OS ([^\s]*)/))&&n[1]&&(n=i(n[1].replace("_","."))),r.JT=n,r.KT=r.XT=r.$T=0,(n=s.match(/iPad|iPod|iPhone/))&&n[0]&&(r[n[0].toLowerCase()]=r.JT)):((n=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(r.WT=n[0]),/webOS/.test(s)&&(r.WT="WebOS",(n=s.match(/webOS\/([^\s]*);/))&&n[1]&&(r.ZT=i(n[1]))),/ Android/.test(s)&&(r.WT="Android",(n=s.match(/Android ([^\s]*);/))&&n[1]&&(r.zT=i(n[1])))),(n=s.match(/Chrome\/([^\s]*)/))&&n[1]?r.chrome=i(n[1]):(n=s.match(/AdobeAIR\/([^\s]*)/))&&(r.YT=n[0])),r.QT||((n=s.match(/Opera[\s\/]([^\s]*)/))&&n[1]?(r.opera=i(n[1]),(n=s.match(/Version\/([^\s]*)/))&&n[1]&&(r.opera=i(n[1])),(n=s.match(/Opera Mini[^;]*/))&&(r.WT=n[0])):(n=s.match(/MSIE\s([^;]*)/))&&n[1]?r.VT=i(n[1]):(n=s.match(/Gecko\/([^\s]*)/))&&(r.qT=1,(n=s.match(/rv:([^\s\)]*)/))&&n[1]&&(r.qT=i(n[1]))))),r},f.Xe.rm=f.Xe.BT(),function(){if(f.jT("util","widget","example"),"undefined"!=typeof YAHOO_config){var t,i=YAHOO_config.listener,n=f.Xe.jd,r=!0;if(i){for(t=0;t<n.length;t++)if(n[t]==i){r=!1;break}r&&n.push(i)}}}(),f.lang=f.lang||{},E=f.lang,e=Object.prototype,a=[],n={sm:"&amp;",em:"&lt;",hm:"&gt;",om:"&quot;",um:"&#x27;",vy:"&#x2F;",am:"&#x60;"},h=["toString","valueOf"],r={isArray:function(t){return"[object Array]"===e.toString.apply(t)},fm:function(t){return"boolean"==typeof t},cm:function(t){return"function"==typeof t||"[object Function]"===e.toString.apply(t)},lm:function(t){return null===t},vm:function(t){return"number"==typeof t&&isFinite(t)},cc:function(t){return t&&("object"==typeof t||E.cm(t))||!1},dm:function(t){return"string"==typeof t},Em:function(t){return void 0===t},pm:f.Xe.rm.VT?function(t,i){var n,r,s;for(n=0;n<h.length;n+=1)s=i[r=h[n]],E.cm(s)&&s!=e[r]&&(t[r]=s)}:function(){},wm:function(t){return t.replace(/[&<>"'\/`]/g,function(t){return n[t]})},extend:function(t,i,n){if(!i||!t)throw new Error("extend failed, please check that all dependencies are included.");function r(){}var s;if(r.prototype=i.prototype,t.prototype=new r,(t.prototype.constructor=t).gm=i.prototype,i.prototype.constructor==e.constructor&&(i.prototype.constructor=i),n){for(s in n)E.hasOwnProperty(n,s)&&(t.prototype[s]=n[s]);E.pm(t.prototype,n)}},bm:function(t,i){if(!i||!t)throw new Error("Absorb failed, verify dependencies.");var n,r,s=arguments,e=s[2];if(e&&!0!==e)for(n=2;n<s.length;n+=1)t[s[n]]=i[s[n]];else{for(r in i)!e&&r in t||(t[r]=i[r]);E.pm(t,i)}return t},ym:function(t,i){if(!i||!t)throw new Error("Augment failed, verify dependencies.");var n,r=[t.prototype,i.prototype];for(n=2;n<arguments.length;n+=1)r.push(arguments[n]);return E.bm.apply(this,r),t},dump:function(t,i){var n,r,s=[];if(!E.cc(t))return t+"";if(t instanceof Date||"nodeType"in t&&"tagName"in t)return t;if(E.cm(t))return"f(){...}";if(i=E.vm(i)?i:3,E.isArray(t)){for(s.push("["),n=0,r=t.length;n<r;n+=1)E.cc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", ");1<s.length&&s.pop(),s.push("]")}else{for(n in s.push("{"),t)E.hasOwnProperty(t,n)&&(s.push(n+" => "),E.cc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", "));1<s.length&&s.pop(),s.push("}")}return s.join("")},Tm:function(t,i,n,r){for(var s,e,h,o,u,a,f,c,l,v=[],d=t.length;!((s=t.lastIndexOf("{",d))<0)&&!((e=t.indexOf("}",s))<s+1);)a=null,-1<(h=(o=f=t.substring(s+1,e)).indexOf(" "))&&(a=o.substring(h+1),o=o.substring(0,h)),u=i[o],n&&(u=n(o,u,a)),E.cc(u)?u=E.isArray(u)?E.dump(u,parseInt(a,10)):(-1<(c=(a=a||"").indexOf("dump"))&&(a=a.substring(4)),"[object Object]"===(l=u.toString())||-1<c?E.dump(u,parseInt(a,10)):l):E.dm(u)||E.vm(u)||(u="~-"+v.length+"-~",v[v.length]=f),t=t.substring(0,s)+u+t.substring(e+1),!1===r&&(d=s-1);for(s=v.length-1;0<=s;s-=1)t=t.replace(new RegExp("~-"+s+"-~"),"{"+v[s]+"}","g");return t},trim:function(i){try{return i.replace(/^\s+|\s+$/g,"")}catch(t){return i}},mm:function(){var t,i={},n=arguments,r=n.length;for(t=0;t<r;t+=1)E.bm(i,n[t],!0);return i},Om:function(t,i,n,r,s){t=t||0,i=i||{};var e,h,o=n,u=r;if(E.dm(n)&&(o=i[n]),!o)throw new TypeError("method undefined");return E.Em(r)||E.isArray(u)||(u=[r]),e=function(){o.apply(i,u||a)},h=s?setInterval(e,t):setTimeout(e,t),{interval:s,cancel:function(){this.interval?clearInterval(h):clearTimeout(h)}}},Sm:function(t){return E.cc(t)||E.dm(t)||E.vm(t)||E.fm(t)}},E.hasOwnProperty=e.hasOwnProperty?function(t,i){return t&&t.hasOwnProperty&&t.hasOwnProperty(i)}:function(t,i){return!E.Em(t[i])&&t.constructor.prototype[i]!==t[i]},r.bm(E,r,!0),(f.util.Lang=E).Rm=E.ym,f.Rm=E.ym,f.extend=E.extend,f.register("yahoo",f,{version:"2.9.0",Wv:"2800"});
/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */
var c,s,l,v,d,p,w,b,y,T,m,O,S,R,I,_,A=A||(c=Math,l=(s={})._v={},v=l.Im={extend:function(t){N.prototype=this;var i=new N;return t&&i._m(t),i.hasOwnProperty("init")||(i.init=function(){i.Am.init.apply(this,arguments)}),(i.init.prototype=i).Am=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},_m:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},d=l.Iv=v.extend({init:function(t,i){t=this.Nm=t||[],this.Cm=null!=i?i:4*t.length},toString:function(t){return(t||w).stringify(this)},concat:function(t){var i=this.Nm,n=t.Nm,r=this.Cm,s=t.Cm;if(this.km(),r%4)for(var e=0;e<s;e++){var h=n[e>>>2]>>>24-e%4*8&255;i[r+e>>>2]|=h<<24-(r+e)%4*8}else for(e=0;e<s;e+=4)i[r+e>>>2]=n[e>>>2];return this.Cm+=s,this},km:function(){var t=this.Nm,i=this.Cm;t[i>>>2]&=4294967295<<32-i%4*8,t.length=c.ceil(i/4)},clone:function(){var t=v.clone.call(this);return t.Nm=this.Nm.slice(0),t},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*c.random()|0);return new d.init(i,t)}}),p=s.Dm={},w=p.Mm={stringify:function(t){for(var i=t.Nm,n=t.Cm,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push((e>>>4).toString(16)),r.push((15&e).toString(16))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new d.init(n,i/2)}},b=p.jm={stringify:function(t){for(var i=t.Nm,n=t.Cm,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push(String.fromCharCode(e))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new d.init(n,i)}},y=p.Pm={stringify:function(t){try{return decodeURIComponent(escape(b.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return b.parse(unescape(encodeURIComponent(t)))}},T=l.Hm=v.extend({reset:function(){this.Lm=new d.init,this.Um=0},Fm:function(t){"string"==typeof t&&(t=y.parse(t)),this.Lm.concat(t),this.Um+=t.Cm},Gm:function(t){var i=this.Lm,n=i.Nm,r=i.Cm,s=this.blockSize,e=r/(4*s),h=(e=t?c.ceil(e):c.max((0|e)-this.xm,0))*s,o=c.min(4*h,r);if(h){for(var u=0;u<h;u+=s)this.Bm(n,u);var a=n.splice(0,h);i.Cm-=o}return new d.init(a,o)},clone:function(){var t=v.clone.call(this);return t.Lm=this.Lm.clone(),t},xm:0}),l.Vm=T.extend({qm:v.extend(),init:function(t){this.qm=this.qm.extend(t),this.reset()},reset:function(){T.reset.call(this),this.Qm()},update:function(t){return this.Fm(t),this.Gm(),this},Wm:function(t){return t&&this.Fm(t),this.Ym()},blockSize:16,Km:function(n){return function(t,i){return new n.init(i).Wm(t)}},$m:function(n){return function(t,i){return new m.Xm.init(n,i).Wm(t)}}}),m=s.Jm={},s);function N(){}!function(e){function O(t,i,n,r,s,e,h){return((t=t+(i&n|~i&r)+s+h)<<e|t>>>32-e)+i}function S(t,i,n,r,s,e,h){return((t=t+(i&r|n&~r)+s+h)<<e|t>>>32-e)+i}function R(t,i,n,r,s,e,h){return((t=t+(i^n^r)+s+h)<<e|t>>>32-e)+i}function I(t,i,n,r,s,e,h){return((t=t+(n^(i|~r))+s+h)<<e|t>>>32-e)+i}for(var t=A,i=(r=t._v).Iv,n=r.Vm,r=t.Jm,_=[],s=0;s<64;s++)_[s]=4294967296*e.abs(e.sin(s+1))|0;r=r.Nv=n.extend({Qm:function(){this.zm=new i.init([1732584193,4023233417,2562383102,271733878])},Bm:function(t,i){for(var n=0;n<16;n++){var r=t[h=i+n];t[h]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}n=this.zm.Nm;var s,e,h=t[i+0],o=(r=t[i+1],t[i+2]),u=t[i+3],a=t[i+4],f=t[i+5],c=t[i+6],l=t[i+7],v=t[i+8],d=t[i+9],E=t[i+10],p=t[i+11],w=t[i+12],g=t[i+13],b=t[i+14],y=t[i+15],T=n[0],m=I(m=I(m=I(m=I(m=R(m=R(m=R(m=R(m=S(m=S(m=S(m=S(m=O(m=O(m=O(m=O(m=n[1],e=O(e=n[2],s=O(s=n[3],T=O(T,m,e,s,h,7,_[0]),m,e,r,12,_[1]),T,m,o,17,_[2]),s,T,u,22,_[3]),e=O(e,s=O(s,T=O(T,m,e,s,a,7,_[4]),m,e,f,12,_[5]),T,m,c,17,_[6]),s,T,l,22,_[7]),e=O(e,s=O(s,T=O(T,m,e,s,v,7,_[8]),m,e,d,12,_[9]),T,m,E,17,_[10]),s,T,p,22,_[11]),e=O(e,s=O(s,T=O(T,m,e,s,w,7,_[12]),m,e,g,12,_[13]),T,m,b,17,_[14]),s,T,y,22,_[15]),e=S(e,s=S(s,T=S(T,m,e,s,r,5,_[16]),m,e,c,9,_[17]),T,m,p,14,_[18]),s,T,h,20,_[19]),e=S(e,s=S(s,T=S(T,m,e,s,f,5,_[20]),m,e,E,9,_[21]),T,m,y,14,_[22]),s,T,a,20,_[23]),e=S(e,s=S(s,T=S(T,m,e,s,d,5,_[24]),m,e,b,9,_[25]),T,m,u,14,_[26]),s,T,v,20,_[27]),e=S(e,s=S(s,T=S(T,m,e,s,g,5,_[28]),m,e,o,9,_[29]),T,m,l,14,_[30]),s,T,w,20,_[31]),e=R(e,s=R(s,T=R(T,m,e,s,f,4,_[32]),m,e,v,11,_[33]),T,m,p,16,_[34]),s,T,b,23,_[35]),e=R(e,s=R(s,T=R(T,m,e,s,r,4,_[36]),m,e,a,11,_[37]),T,m,l,16,_[38]),s,T,E,23,_[39]),e=R(e,s=R(s,T=R(T,m,e,s,g,4,_[40]),m,e,h,11,_[41]),T,m,u,16,_[42]),s,T,c,23,_[43]),e=R(e,s=R(s,T=R(T,m,e,s,d,4,_[44]),m,e,w,11,_[45]),T,m,y,16,_[46]),s,T,o,23,_[47]),e=I(e,s=I(s,T=I(T,m,e,s,h,6,_[48]),m,e,l,10,_[49]),T,m,b,15,_[50]),s,T,f,21,_[51]),e=I(e,s=I(s,T=I(T,m,e,s,w,6,_[52]),m,e,u,10,_[53]),T,m,E,15,_[54]),s,T,r,21,_[55]),e=I(e,s=I(s,T=I(T,m,e,s,v,6,_[56]),m,e,y,10,_[57]),T,m,c,15,_[58]),s,T,g,21,_[59]),e=I(e,s=I(s,T=I(T,m,e,s,a,6,_[60]),m,e,p,10,_[61]),T,m,o,15,_[62]),s,T,d,21,_[63]);n[0]=n[0]+T|0,n[1]=n[1]+m|0,n[2]=n[2]+e|0,n[3]=n[3]+s|0},Ym:function(){var t=this.Lm,i=t.Nm,n=8*this.Um,r=8*t.Cm;i[r>>>5]|=128<<24-r%32;var s=e.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.Cm=4*(i.length+1),this.Gm(),i=(t=this.zm).Nm,n=0;n<4;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t.zm=this.zm.clone(),t}}),t.Nv=n.Km(r),t.Zm=n.$m(r)}(Math),S=(_=(O=A)._v).Iv,R=_.Vm,I=[],_=O.Jm.tO=R.extend({Qm:function(){this.zm=new S.init([1732584193,4023233417,2562383102,271733878,3285377520])},Bm:function(t,i){for(var n=this.zm.Nm,r=n[0],s=n[1],e=n[2],h=n[3],o=n[4],u=0;u<80;u++){if(u<16)I[u]=0|t[i+u];else{var a=I[u-3]^I[u-8]^I[u-14]^I[u-16];I[u]=a<<1|a>>>31}a=(r<<5|r>>>27)+o+I[u],a=u<20?a+(1518500249+(s&e|~s&h)):u<40?a+(1859775393+(s^e^h)):u<60?a+((s&e|s&h|e&h)-1894007588):a+((s^e^h)-899497514),o=h,h=e,e=s<<30|s>>>2,s=r,r=a}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+e|0,n[3]=n[3]+h|0,n[4]=n[4]+o|0},Ym:function(){var t=this.Lm,i=t.Nm,n=8*this.Um,r=8*t.Cm;return i[r>>>5]|=128<<24-r%32,i[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),i[15+(64+r>>>9<<4)]=n,t.Cm=4*i.length,this.Gm(),this.zm},clone:function(){var t=R.clone.call(this);return t.zm=this.zm.clone(),t}}),O.tO=R.Km(_),O.iO=R.$m(_);
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
*/
var C,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="=";function M(t){var i,n,r,s="",e=0;for(i=0;i<t.length&&t.charAt(i)!=D;++i)(r=k.indexOf(t.charAt(i)))<0||(e=0==e?(s+=G(r>>2),n=3&r,1):1==e?(s+=G(n<<2|r>>4),n=15&r,2):2==e?(s+=G(n),s+=G(r>>2),n=3&r,3):(s+=G(n<<2|r>>4),s+=G(15&r),0));return 1==e&&(s+=G(n<<2)),s}function j(t,i,n){null!=t&&("number"==typeof t?this.nO(t,i,n):null==i&&"string"!=typeof t?this.rO(t,256):this.rO(t,i))}function P(){return new j(null)}C="Microsoft Internet Explorer"==o.appName?(j.prototype.sO=function(t,i,n,r,s,e){for(var h=32767&i,o=i>>15;0<=--e;){var u=32767&this[t],a=this[t++]>>15,f=o*u+a*h;s=((u=h*u+((32767&f)<<15)+n[r]+(1073741823&s))>>>30)+(f>>>15)+o*a+(s>>>30),n[r++]=1073741823&u}return s},30):"Netscape"!=o.appName?(j.prototype.sO=function(t,i,n,r,s,e){for(;0<=--e;){var h=i*this[t++]+n[r]+s;s=Math.floor(h/67108864),n[r++]=67108863&h}return s},26):(j.prototype.sO=function(t,i,n,r,s,e){for(var h=16383&i,o=i>>14;0<=--e;){var u=16383&this[t],a=this[t++]>>14,f=o*u+a*h;s=((u=h*u+((16383&f)<<14)+n[r]+s)>>28)+(f>>14)+o*a,n[r++]=268435455&u}return s},28),j.prototype.eO=C,j.prototype.hO=(1<<C)-1,j.prototype.oO=1<<C;j.prototype.uO=Math.pow(2,52),j.prototype.aO=52-C,j.prototype.fO=2*C-52;var H,L,U="0123456789abcdefghijklmnopqrstuvwxyz",F=new Array;for(H="0".charCodeAt(0),L=0;L<=9;++L)F[H++]=L;for(H="a".charCodeAt(0),L=10;L<36;++L)F[H++]=L;for(H="A".charCodeAt(0),L=10;L<36;++L)F[H++]=L;function G(t){return U.charAt(t)}function x(t){var i=P();return i.cO(t),i}function B(t){var i,n=1;return 0!=(i=t>>>16)&&(t=i,n+=16),0!=(i=t>>8)&&(t=i,n+=8),0!=(i=t>>4)&&(t=i,n+=4),0!=(i=t>>2)&&(t=i,n+=2),0!=(i=t>>1)&&(t=i,n+=1),n}function V(t){this.lO=t}function q(t){this.lO=t,this.vO=t.dO(),this.EO=32767&this.vO,this.pO=this.vO>>15,this.wO=(1<<t.eO-15)-1,this.gO=2*t.t}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
*/
function Q(t,i){return new j(t,i)}function W(t,i,n){for(var r="",s=0;r.length<i;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s]))),s+=1;return r}V.prototype.bO=function(t){return t.yO<0||0<=t.TO(this.lO)?t.mO(this.lO):t},V.prototype.OO=function(t){return t},V.prototype.reduce=function(t){t.SO(this.lO,null,t)},V.prototype.RO=function(t,i,n){t.IO(i,n),this.reduce(n)},V.prototype._O=function(t,i){t.AO(i),this.reduce(i)},q.prototype.bO=function(t){var i=P();return t.abs().NO(this.lO.t,i),i.SO(this.lO,null,i),t.yO<0&&0<i.TO(j.ZERO)&&this.lO.CO(i,i),i},q.prototype.OO=function(t){var i=P();return t.kO(i),this.reduce(i),i},q.prototype.reduce=function(t){for(;t.t<=this.gO;)t[t.t++]=0;for(var i=0;i<this.lO.t;++i){var n=32767&t[i],r=n*this.EO+((n*this.pO+(t[i]>>15)*this.EO&this.wO)<<15)&t.hO;for(t[n=i+this.lO.t]+=this.lO.sO(0,r,t,i,0,this.lO.t);t[n]>=t.oO;)t[n]-=t.oO,t[++n]++}t.km(),t.DO(this.lO.t,t),0<=t.TO(this.lO)&&t.CO(this.lO,t)},q.prototype.RO=function(t,i,n){t.IO(i,n),this.reduce(n)},q.prototype._O=function(t,i){t.AO(i),this.reduce(i)},j.prototype.kO=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.yO=this.yO},j.prototype.cO=function(t){this.t=1,this.yO=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.oO:this.t=0},j.prototype.rO=function(t,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void this.MO(t,i);n=2}this.t=0,this.yO=0;for(var r,s,e=t.length,h=!1,o=0;0<=--e;){var u=8==n?255&t[e]:(r=e,void 0,null==(s=F[t.charCodeAt(r)])?-1:s);u<0?"-"==t.charAt(e)&&(h=!0):(h=!1,0==o?this[this.t++]=u:o+n>this.eO?(this[this.t-1]|=(u&(1<<this.eO-o)-1)<<o,this[this.t++]=u>>this.eO-o):this[this.t-1]|=u<<o,(o+=n)>=this.eO&&(o-=this.eO))}8==n&&0!=(128&t[0])&&(this.yO=-1,0<o&&(this[this.t-1]|=(1<<this.eO-o)-1<<o)),this.km(),h&&j.ZERO.CO(this,this)},j.prototype.km=function(){for(var t=this.yO&this.hO;0<this.t&&this[this.t-1]==t;)--this.t},j.prototype.NO=function(t,i){var n;for(n=this.t-1;0<=n;--n)i[n+t]=this[n];for(n=t-1;0<=n;--n)i[n]=0;i.t=this.t+t,i.yO=this.yO},j.prototype.DO=function(t,i){for(var n=t;n<this.t;++n)i[n-t]=this[n];i.t=Math.max(this.t-t,0),i.yO=this.yO},j.prototype.jO=function(t,i){var n,r=t%this.eO,s=this.eO-r,e=(1<<s)-1,h=Math.floor(t/this.eO),o=this.yO<<r&this.hO;for(n=this.t-1;0<=n;--n)i[n+h+1]=this[n]>>s|o,o=(this[n]&e)<<r;for(n=h-1;0<=n;--n)i[n]=0;i[h]=o,i.t=this.t+h+1,i.yO=this.yO,i.km()},j.prototype.PO=function(t,i){i.yO=this.yO;var n=Math.floor(t/this.eO);if(n>=this.t)i.t=0;else{var r=t%this.eO,s=this.eO-r,e=(1<<r)-1;i[0]=this[n]>>r;for(var h=n+1;h<this.t;++h)i[h-n-1]|=(this[h]&e)<<s,i[h-n]=this[h]>>r;0<r&&(i[this.t-n-1]|=(this.yO&e)<<s),i.t=this.t-n,i.km()}},j.prototype.CO=function(t,i){for(var n=0,r=0,s=Math.min(t.t,this.t);n<s;)r+=this[n]-t[n],i[n++]=r&this.hO,r>>=this.eO;if(t.t<this.t){for(r-=t.yO;n<this.t;)r+=this[n],i[n++]=r&this.hO,r>>=this.eO;r+=this.yO}else{for(r+=this.yO;n<t.t;)r-=t[n],i[n++]=r&this.hO,r>>=this.eO;r-=t.yO}i.yO=r<0?-1:0,r<-1?i[n++]=this.oO+r:0<r&&(i[n++]=r),i.t=n,i.km()},j.prototype.IO=function(t,i){var n=this.abs(),r=t.abs(),s=n.t;for(i.t=s+r.t;0<=--s;)i[s]=0;for(s=0;s<r.t;++s)i[s+n.t]=n.sO(0,r[s],i,s,0,n.t);i.yO=0,i.km(),this.yO!=t.yO&&j.ZERO.CO(i,i)},j.prototype.AO=function(t){for(var i=this.abs(),n=t.t=2*i.t;0<=--n;)t[n]=0;for(n=0;n<i.t-1;++n){var r=i.sO(n,i[n],t,2*n,0,1);(t[n+i.t]+=i.sO(n+1,2*i[n],t,2*n+1,r,i.t-n-1))>=i.oO&&(t[n+i.t]-=i.oO,t[n+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.sO(n,i[n],t,2*n,0,1)),t.yO=0,t.km()},j.prototype.SO=function(t,i,n){var r=t.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t)return null!=i&&i.cO(0),void(null!=n&&this.kO(n));null==n&&(n=P());var e=P(),h=this.yO,o=t.yO,u=this.eO-B(r[r.t-1]);0<u?(r.jO(u,e),s.jO(u,n)):(r.kO(e),s.kO(n));var a=e.t,f=e[a-1];if(0!=f){var c=f*(1<<this.aO)+(1<a?e[a-2]>>this.fO:0),l=this.uO/c,v=(1<<this.aO)/c,d=1<<this.fO,E=n.t,p=E-a,w=null==i?P():i;for(e.NO(p,w),0<=n.TO(w)&&(n[n.t++]=1,n.CO(w,n)),j.ONE.NO(a,w),w.CO(e,e);e.t<a;)e[e.t++]=0;for(;0<=--p;){var g=n[--E]==f?this.hO:Math.floor(n[E]*l+(n[E-1]+d)*v);if((n[E]+=e.sO(0,g,n,p,0,a))<g)for(e.NO(p,w),n.CO(w,n);n[E]<--g;)n.CO(w,n)}null!=i&&(n.DO(a,i),h!=o&&j.ZERO.CO(i,i)),n.t=a,n.km(),0<u&&n.PO(u,n),h<0&&j.ZERO.CO(n,n)}}},j.prototype.dO=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.oO)%this.oO)?this.oO-i:-i},j.prototype.HO=function(){return 0==(0<this.t?1&this[0]:this.yO)},j.prototype.exp=function(t,i){if(4294967295<t||t<1)return j.ONE;var n=P(),r=P(),s=i.bO(this),e=B(t)-1;for(s.kO(n);0<=--e;)if(i._O(n,r),0<(t&1<<e))i.RO(r,s,n);else{var h=n;n=r,r=h}return i.OO(n)},j.prototype.toString=function(t){if(this.yO<0)return"-"+this.LO().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.UO(t);i=2}var n,r=(1<<i)-1,s=!1,e="",h=this.t,o=this.eO-h*this.eO%i;if(0<h--)for(o<this.eO&&0<(n=this[h]>>o)&&(s=!0,e=G(n));0<=h;)o<i?(n=(this[h]&(1<<o)-1)<<i-o,n|=this[--h]>>(o+=this.eO-i)):(n=this[h]>>(o-=i)&r,o<=0&&(o+=this.eO,--h)),0<n&&(s=!0),s&&(e+=G(n));return s?e:"0"},j.prototype.LO=function(){var t=P();return j.ZERO.CO(this,t),t},j.prototype.abs=function(){return this.yO<0?this.LO():this},j.prototype.TO=function(t){var i=this.yO-t.yO;if(0!=i)return i;var n=this.t;if(0!=(i=n-t.t))return this.yO<0?-i:i;for(;0<=--n;)if(0!=(i=this[n]-t[n]))return i;return 0},j.prototype.FO=function(){return this.t<=0?0:this.eO*(this.t-1)+B(this[this.t-1]^this.yO&this.hO)},j.prototype.mO=function(t){var i=P();return this.abs().SO(t,null,i),this.yO<0&&0<i.TO(j.ZERO)&&t.CO(i,i),i},j.prototype.GO=function(t,i){var n;return n=t<256||i.HO()?new V(i):new q(i),this.exp(t,n)},j.ZERO=x(0),j.ONE=x(1);var Y=20;function K(){this.n=null,this.e=0,this.d=null,this.xO=null,this.BO=null,this.VO=null,this.qO=null,this.QO=null}K.prototype.WO=function(t){return t.GO(this.e,this.n)},K.prototype.YO=function(t,i){this.KO=!0,"string"!=typeof t?(this.n=t,this.e=i):null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=Q(t,16),this.e=parseInt(i,16)):alert("Invalid RSA public key")},K.prototype.encrypt=function(t){var i=function(t,i){if(i<t.length+11)return alert("Message too long for RSA"),null;for(var n=new Array,r=t.length-1;0<=r&&0<i;){var s=t.charCodeAt(r--);s<128?n[--i]=s:127<s&&s<2048?(n[--i]=63&s|128,n[--i]=s>>6|192):(n[--i]=63&s|128,n[--i]=s>>6&63|128,n[--i]=s>>12|224)}n[--i]=0;for(var e=new SecureRandom,h=new Array;2<i;){for(h[0]=0;0==h[0];)e.$O(h);n[--i]=h[0]}return n[--i]=2,n[--i]=0,new j(n)}(t,this.n.FO()+7>>3);if(null==i)return null;var n=this.WO(i);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},K.prototype.XO=function(t,i){var n=function(t,i,n){if(t.length+2*Y+2>i)throw"Message too long for RSA";var r,s="";for(r=0;r<i-t.length-2*Y-2;r+=1)s+="\0";var e=rstr_sha1("")+s+""+t,h=new Array(Y);(new SecureRandom).$O(h);var o=W(h,e.length,n||rstr_sha1),u=[];for(r=0;r<e.length;r+=1)u[r]=e.charCodeAt(r)^o.charCodeAt(r);var a=W(u,h.length,rstr_sha1),f=[0];for(r=0;r<h.length;r+=1)f[r+1]=h[r]^a.charCodeAt(r);return new j(f.concat(u))}(t,this.n.FO()+7>>3,i);if(null==n)return null;var r=this.WO(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},K.prototype.type="RSA",
/*! asn1-1.0.9.js (c) 2013-2015 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
void 0!==g&&g||(g={}),void 0!==g.JO&&g.JO||(g.JO={}),g.JO.zO=new function(){this.ZO=function(t){var i=t.toString(16);return i.length%2==1&&(i="0"+i),i},this.tS=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var n=i.substr(1).length;n%2==1?n+=1:i.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";i=new j(r,16).xor(t).add(j.ONE).toString(16).replace(/^-/,"")}return i},this.iS=function(t,i){g.JO;var n=A.Dm.Mm.parse(t),r=A.Dm.nS.stringify(n).replace(/(.{64})/g,"$1\r\n");return"-----BEGIN "+i+"-----\r\n"+(r=r.replace(/\r\n$/,""))+"\r\n-----END "+i+"-----\r\n"},this.rS=function(t){var i=g.JO,n=Object.keys(t);if(1!=n.length)throw"key of param shall be only one.";var r=n[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":"))throw"undefined key: "+r;if("bool"==r)return new i.sS(t[r]);if("int"==r)return new i.eS(t[r]);if("bitstr"==r)return new i.hS(t[r]);if("octstr"==r)return new i.oS(t[r]);if("null"==r)return new i.uS(t[r]);if("oid"==r)return new i.aS(t[r]);if("enum"==r)return new i.fS(t[r]);if("utf8str"==r)return new i.cS(t[r]);if("numstr"==r)return new i.lS(t[r]);if("prnstr"==r)return new i.vS(t[r]);if("telstr"==r)return new i.dS(t[r]);if("ia5str"==r)return new i.ES(t[r]);if("utctime"==r)return new i.pS(t[r]);if("gentime"==r)return new i.wS(t[r]);if("seq"==r){for(var s=t[r],e=[],h=0;h<s.length;h++){var o=i.zO.rS(s[h]);e.push(o)}return new i.gS({bS:e})}if("set"==r){for(s=t[r],e=[],h=0;h<s.length;h++){o=i.zO.rS(s[h]);e.push(o)}return new i.yS({bS:e})}if("tag"==r){var u=t[r];if("[object Array]"===Object.prototype.toString.call(u)&&3==u.length){var a=i.zO.rS(u[2]);return new i.TS({tag:u[0],mS:u[1],OS:a})}var f={};if(void 0!==u.mS&&(f.mS=u.mS),void 0!==u.tag&&(f.tag=u.tag),void 0===u.OS)throw"obj shall be specified for 'tag'.";return f.OS=i.zO.rS(u.OS),new i.TS(f)}},this.RS=function(t){return this.rS(t).IS()}},g.JO.zO._S=function(t){for(var i="",n=parseInt(t.substr(0,2),16),r=(i=Math.floor(n/40)+"."+n%40,""),s=2;s<t.length;s+=2){var e=("00000000"+parseInt(t.substr(s,2),16).toString(2)).slice(-8);if(r+=e.substr(1,7),"0"==e.substr(0,1))i=i+"."+new j(r,2).toString(10),r=""}return i},g.JO.zO.NS=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function i(t){var i="",n=new j(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=o(s),r.splice(0,2);for(var e=0;e<r.length;e++)n+=i(r[e]);return n},g.JO.CS=function(){this.kS=function(){if(void 0===this.DS||null==this.DS)throw"this.hV is null or undefined.";if(this.DS.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.DS;var t=this.DS.length/2,i=t.toString(16);if(i.length%2==1&&(i="0"+i),t<128)return i;var n=i.length/2;if(15<n)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+i},this.IS=function(){return null!=this.MS&&!this.jS||(this.DS=this.PS(),this.HS=this.kS(),this.MS=this.LS+this.HS+this.DS,this.jS=!1),this.MS},this.US=function(){return this.IS(),this.DS},this.PS=function(){return""}},g.JO.FS=function(t){g.JO.FS.gm.constructor.call(this);this.GS=function(){return this.yO},this.xS=function(t){this.MS=null,this.jS=!0,this.yO=t,this.DS=stohex(this.yO)},this.BS=function(t){this.MS=null,this.jS=!0,this.yO=null,this.DS=t},this.PS=function(){return this.DS},void 0!==t&&("string"==typeof t?this.xS(t):void 0!==t.str?this.xS(t.str):void 0!==t.VS&&this.BS(t.VS))},f.lang.extend(g.JO.FS,g.JO.CS),g.JO.qS=function(t){g.JO.qS.gm.constructor.call(this);this.QS=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.WS=function(t,i,n){var r=this.YS,s=this.QS(t),e=String(s.getFullYear());"utc"==i&&(e=e.substr(2,2));var h=e+r(String(s.getMonth()+1),2)+r(String(s.getDate()),2)+r(String(s.getHours()),2)+r(String(s.getMinutes()),2)+r(String(s.getSeconds()),2);if(!0===n){var o=s.getMilliseconds();if(0!=o){var u=r(String(o),3);h=h+"."+(u=u.replace(/[0]+$/,""))}}return h+"Z"},this.YS=function(t,i){return t.length>=i?t:new Array(i-t.length+1).join("0")+t},this.GS=function(){return this.yO},this.xS=function(t){this.MS=null,this.jS=!0,this.yO=t,this.DS=stohex(t)},this.KS=function(t,i,n,r,s,e){var h=new Date(Date.UTC(t,i-1,n,r,s,e,0));this.$S(h)},this.PS=function(){return this.DS}},f.lang.extend(g.JO.qS,g.JO.CS),g.JO.XS=function(t){g.JO.FS.gm.constructor.call(this);this.JS=function(t){this.MS=null,this.jS=!0,this.zS=t},this.ZS=function(t){this.MS=null,this.jS=!0,this.zS.push(t)},this.zS=new Array,void 0!==t&&void 0!==t.bS&&(this.zS=t.bS)},f.lang.extend(g.JO.XS,g.JO.CS),g.JO.sS=function(){g.JO.sS.gm.constructor.call(this),this.LS="01",this.MS="0101ff"},f.lang.extend(g.JO.sS,g.JO.CS),g.JO.eS=function(t){g.JO.eS.gm.constructor.call(this),this.LS="02",this.tR=function(t){this.MS=null,this.jS=!0,this.DS=g.JO.zO.tS(t)},this.iR=function(t){var i=new j(String(t),10);this.tR(i)},this.nR=function(t){this.DS=t},this.PS=function(){return this.DS},void 0!==t&&(void 0!==t.rR?this.tR(t.rR):void 0!==t.sR?this.iR(t.sR):"number"==typeof t?this.iR(t):void 0!==t.VS&&this.nR(t.VS))},f.lang.extend(g.JO.eS,g.JO.CS),g.JO.hS=function(t){g.JO.hS.gm.constructor.call(this),this.LS="03",this.eR=function(t){this.MS=null,this.jS=!0,this.DS=t},this.hR=function(t,i){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.MS=null,this.jS=!0,this.DS=n+i},this.oR=function(t){var i=8-(t=t.replace(/0+$/,"")).length%8;8==i&&(i=0);for(var n=0;n<=i;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var s=t.substr(n,8),e=parseInt(s,2).toString(16);1==e.length&&(e="0"+e),r+=e}this.MS=null,this.jS=!0,this.DS="0"+i+r},this.uR=function(t){for(var i="",n=0;n<t.length;n++)1==t[n]?i+="1":i+="0";this.oR(i)},this.aR=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=!1;return i},this.PS=function(){return this.DS},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.eR(t):void 0!==t.VS?this.eR(t.VS):void 0!==t.fR?this.oR(t.fR):void 0!==t.bS&&this.uR(t.bS))},f.lang.extend(g.JO.hS,g.JO.CS),g.JO.oS=function(t){g.JO.oS.gm.constructor.call(this,t),this.LS="04"},f.lang.extend(g.JO.oS,g.JO.FS),g.JO.uS=function(){g.JO.uS.gm.constructor.call(this),this.LS="05",this.MS="0500"},f.lang.extend(g.JO.uS,g.JO.CS),g.JO.aS=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function e(t){var i="",n=new j(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}g.JO.aS.gm.constructor.call(this),this.LS="06",this.nR=function(t){this.MS=null,this.jS=!0,this.yO=null,this.DS=t},this.cR=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),r=40*parseInt(n[0])+parseInt(n[1]);i+=o(r),n.splice(0,2);for(var s=0;s<n.length;s++)i+=e(n[s]);this.MS=null,this.jS=!0,this.yO=null,this.DS=i},this.lR=function(t){if(void 0===g.JO.ER.dR.vR[t])throw"DERObjectIdentifier oidName undefined: "+t;var i=g.JO.ER.dR.vR[t];this.cR(i)},this.PS=function(){return this.DS},void 0!==t&&("string"==typeof t&&t.match(/^[0-2].[0-9.]+$/)?this.cR(t):void 0!==g.JO.ER.dR.vR[t]?this.cR(g.JO.ER.dR.vR[t]):void 0!==t.pR?this.cR(t.pR):void 0!==t.VS?this.nR(t.VS):void 0!==t.name&&this.lR(t.name))},f.lang.extend(g.JO.aS,g.JO.CS),g.JO.fS=function(t){g.JO.fS.gm.constructor.call(this),this.LS="0a",this.tR=function(t){this.MS=null,this.jS=!0,this.DS=g.JO.zO.tS(t)},this.iR=function(t){var i=new j(String(t),10);this.tR(i)},this.nR=function(t){this.DS=t},this.PS=function(){return this.DS},void 0!==t&&(void 0!==t.sR?this.iR(t.sR):"number"==typeof t?this.iR(t):void 0!==t.VS&&this.nR(t.VS))},f.lang.extend(g.JO.fS,g.JO.CS),g.JO.cS=function(t){g.JO.cS.gm.constructor.call(this,t),this.LS="0c"},f.lang.extend(g.JO.cS,g.JO.FS),g.JO.lS=function(t){g.JO.lS.gm.constructor.call(this,t),this.LS="12"},f.lang.extend(g.JO.lS,g.JO.FS),g.JO.vS=function(t){g.JO.vS.gm.constructor.call(this,t),this.LS="13"},f.lang.extend(g.JO.vS,g.JO.FS),g.JO.dS=function(t){g.JO.dS.gm.constructor.call(this,t),this.LS="14"},f.lang.extend(g.JO.dS,g.JO.FS),g.JO.ES=function(t){g.JO.ES.gm.constructor.call(this,t),this.LS="16"},f.lang.extend(g.JO.ES,g.JO.FS),g.JO.pS=function(t){g.JO.pS.gm.constructor.call(this,t),this.LS="17",this.$S=function(t){this.MS=null,this.jS=!0,this.wR=t,this.yO=this.WS(this.wR,"utc"),this.DS=stohex(this.yO)},this.PS=function(){return void 0===this.wR&&void 0===this.yO&&(this.wR=new Date,this.yO=this.WS(this.wR,"utc"),this.DS=stohex(this.yO)),this.DS},void 0!==t&&(void 0!==t.str?this.xS(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.xS(t):void 0!==t.VS?this.BS(t.VS):void 0!==t.wR&&this.$S(t.wR))},f.lang.extend(g.JO.pS,g.JO.qS),g.JO.wS=function(t){g.JO.wS.gm.constructor.call(this,t),this.LS="18",this.gR=!1,this.$S=function(t){this.MS=null,this.jS=!0,this.wR=t,this.yO=this.WS(this.wR,"gen",this.gR),this.DS=stohex(this.yO)},this.PS=function(){return void 0===this.wR&&void 0===this.yO&&(this.wR=new Date,this.yO=this.WS(this.wR,"gen",this.gR),this.DS=stohex(this.yO)),this.DS},void 0!==t&&(void 0!==t.str?this.xS(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.xS(t):void 0!==t.VS?this.BS(t.VS):void 0!==t.wR&&this.$S(t.wR),!0===t.bR&&(this.gR=!0))},f.lang.extend(g.JO.wS,g.JO.qS),g.JO.gS=function(t){g.JO.gS.gm.constructor.call(this,t),this.LS="30",this.PS=function(){for(var t="",i=0;i<this.zS.length;i++){t+=this.zS[i].IS()}return this.DS=t,this.DS}},f.lang.extend(g.JO.gS,g.JO.XS),g.JO.yS=function(t){g.JO.yS.gm.constructor.call(this,t),this.LS="31",this.yR=!0,this.PS=function(){for(var t=new Array,i=0;i<this.zS.length;i++){var n=this.zS[i];t.push(n.IS())}return 1==this.yR&&t.sort(),this.DS=t.join(""),this.DS},void 0!==t&&void 0!==t.TR&&0==t.TR&&(this.yR=!1)},f.lang.extend(g.JO.yS,g.JO.XS),g.JO.TS=function(t){g.JO.TS.gm.constructor.call(this),this.LS="a0",this.DS="",this.mR=!0,this.OR=null,this.SR=function(t,i,n){this.LS=i,this.mR=t,this.OR=n,this.mR?(this.DS=this.OR.IS(),this.MS=null,this.jS=!0):(this.DS=null,this.MS=n.IS(),this.MS=this.MS.replace(/^../,i),this.jS=!1)},this.PS=function(){return this.DS},void 0!==t&&(void 0!==t.tag&&(this.LS=t.tag),void 0!==t.mS&&(this.mR=t.mS),void 0!==t.OS&&(this.OR=t.OS,this.SR(this.mR,this.LS,this.OR)))},f.lang.extend(g.JO.TS,g.JO.CS),
/*! crypto-1.1.8.js (c) 2013-2016 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
void 0!==g&&g||(g={}),void 0!==g.crypto&&g.crypto||(g.crypto={}),g.crypto.RR=new function(){this.IR={sha1:"3021300906052b0e03021a05000414",_R:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",AR:"3041300d060960864801650304020205000430",NR:"3051300d060960864801650304020305000440",CR:"3020300c06082a864886f70d020205000410",kR:"3020300c06082a864886f70d020505000410",DR:"3021300906052b2403020105000414"},this.MR={kR:"cryptojs",sha1:"cryptojs",_R:"cryptojs",sha256:"cryptojs",AR:"cryptojs",NR:"cryptojs",DR:"cryptojs",jR:"cryptojs",PR:"cryptojs",HR:"cryptojs",LR:"cryptojs",UR:"cryptojs",FR:"cryptojs",GR:"cryptojs",xR:"cryptojs/jsrsa",BR:"cryptojs/jsrsa",VR:"cryptojs/jsrsa",qR:"cryptojs/jsrsa",QR:"cryptojs/jsrsa",WR:"cryptojs/jsrsa",YR:"cryptojs/jsrsa",KR:"cryptojs/jsrsa",$R:"cryptojs/jsrsa",XR:"cryptojs/jsrsa",JR:"cryptojs/jsrsa",zR:"cryptojs/jsrsa",ZR:"cryptojs/jsrsa",tI:"cryptojs/jsrsa",iI:"cryptojs/jsrsa",nI:"cryptojs/jsrsa",rI:"cryptojs/jsrsa",sI:"cryptojs/jsrsa",eI:"cryptojs/jsrsa",hI:"cryptojs/jsrsa",oI:"cryptojs/jsrsa",uI:"cryptojs/jsrsa",aI:"cryptojs/jsrsa",fI:"cryptojs/jsrsa"},this.cI={kR:A.Jm.Nv,sha1:A.Jm.tO,_R:A.Jm.lI,sha256:A.Jm.vI,AR:A.Jm.dI,NR:A.Jm.EI,DR:A.Jm.pI},this.wI=function(t,i){if(void 0===this.IR[i])throw"alg not supported in Util.DIGESTINFOHEAD: "+i;return this.IR[i]+t},this.gI=function(t,i,n){var r=this.wI(t,i),s=n/4;if(r.length+22>s)throw"key is too short for SigAlg: keylen="+n+","+i;for(var e="00"+r,h="",o=s-"0001".length-e.length,u=0;u<o;u+=2)h+="ff";return"0001"+h+e},this.bI=function(t,i){return new g.crypto.TI({mI:i}).yI(t)},this.OI=function(t,i){return new g.crypto.TI({mI:i}).SI(t)},this.sha1=function(t){return new g.crypto.TI({mI:"sha1",RI:"cryptojs"}).yI(t)},this.sha256=function(t){return new g.crypto.TI({mI:"sha256",RI:"cryptojs"}).yI(t)},this.II=function(t){return new g.crypto.TI({mI:"sha256",RI:"cryptojs"}).SI(t)},this.NR=function(t){return new g.crypto.TI({mI:"sha512",RI:"cryptojs"}).yI(t)},this._I=function(t){return new g.crypto.TI({mI:"sha512",RI:"cryptojs"}).SI(t)},this.kR=function(t){return new g.crypto.TI({mI:"md5",RI:"cryptojs"}).yI(t)},this.DR=function(t){return new g.crypto.TI({mI:"ripemd160",RI:"cryptojs"}).yI(t)},this.AI=function(t){}},g.crypto.TI=function(t){this.NI=function(i,t){if(null!=i&&void 0===t&&(t=g.crypto.RR.MR[i]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==t){try{this.CI=g.crypto.RR.cI[i].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.kI=function(t){this.CI.update(t)},this.DI=function(t){var i=A.Dm.Mm.parse(t);this.CI.update(i)},this.digest=function(){return this.CI.Wm().toString(A.Dm.Mm)},this.yI=function(t){return this.kI(t),this.digest()},this.SI=function(t){return this.DI(t),this.digest()}}if(-1!=":sha256:".indexOf(i)&&"sjcl"==t){try{this.CI=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.kI=function(t){this.CI.update(t)},this.DI=function(t){var i=sjcl.jI.VS.MI(t);this.CI.update(i)},this.digest=function(){var t=this.CI.Wm();return sjcl.jI.VS.HI(t)},this.yI=function(t){return this.kI(t),this.digest()},this.SI=function(t){return this.DI(t),this.digest()}}},this.kI=function(t){throw"updateString(str) not supported for this alg/prov: "+this.LI+"/"+this.UI},this.DI=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.LI+"/"+this.UI},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.LI+"/"+this.UI},this.yI=function(t){throw"digestString(str) not supported for this alg/prov: "+this.LI+"/"+this.UI},this.SI=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.LI+"/"+this.UI},void 0!==t&&void 0!==t.mI&&(this.LI=t.mI,void 0===t.RI&&(this.UI=g.crypto.RR.MR[this.LI]),this.NI(this.LI,this.UI))},g.crypto.FI=function(t){this.NI=function(t,i){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===i&&(i=g.crypto.RR.MR[t]),this.GI=t+"/"+i;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==i){try{var r=g.crypto.RR.cI[n];this.mac=A.Jm.Xm.create(r,this.xI)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.kI=function(t){this.mac.update(t)},this.DI=function(t){var i=A.Dm.Mm.parse(t);this.mac.update(i)},this.BI=function(){return this.mac.Wm().toString(A.Dm.Mm)},this.VI=function(t){return this.kI(t),this.BI()},this.qI=function(t){return this.DI(t),this.BI()}}},this.kI=function(t){throw"updateString(str) not supported for this alg/prov: "+this.GI},this.DI=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.GI},this.BI=function(){throw"digest() not supported for this alg/prov: "+this.GI},this.VI=function(t){throw"digestString(str) not supported for this alg/prov: "+this.GI},this.qI=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.GI},this.QI=function(t){if("string"==typeof t){var i=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(i=rstrtohex(t)),void(this.xI=A.Dm.Mm.parse(i))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;i=null;if(void 0!==t.VS){if(t.VS.length%2!=0||!t.VS.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.VS;i=t.VS}if(void 0!==t.WI&&(i=utf8tohex(t.WI)),void 0!==t.YI&&(i=rstrtohex(t.YI)),void 0!==t.KI&&(i=M(t.KI)),void 0!==t.$I&&(i=b64utohex(t.$I)),null==i)throw"KJUR.crypto.Mac unsupported password type: "+t;this.xI=A.Dm.Mm.parse(i)},void 0!==t&&(void 0!==t.xI&&this.QI(t.xI),void 0!==t.mI&&(this.LI=t.mI,void 0===t.RI&&(this.UI=g.crypto.RR.MR[this.LI]),this.NI(this.LI,this.UI)))},g.crypto.Signature=function(t){var i=null;if(this.XI=function(){this.LI.match(/^(.+)with(.+)$/)&&(this.JI=RegExp.$1.toLowerCase(),this.zI=RegExp.$2.toLowerCase())},this.ZI=function(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t},this.NI=function(t,i){if(this.XI(),"cryptojs/jsrsa"!=i)throw"provider not supported: "+i;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.JI)){try{this.CI=new g.crypto.TI({mI:this.JI})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.JI+"/"+t}this.init=function(t,i){var n=null;try{n=void 0===i?KEYUTIL.getKey(t):KEYUTIL.getKey(t,i)}catch(t){throw"init failed:"+t}if(!0===n.t_)this.i_=n,this.state="SIGN";else{if(!0!==n.KO)throw"init failed.:"+n;this.n_=n,this.state="VERIFY"}},this.r_=function(t){"string"==typeof t.s_&&"string"==typeof t.e_?(this.s_=t.s_,this.e_=t.e_):this.i_=t,this.state="SIGN"},this.h_=function(t){"string"==typeof t.o_&&"string"==typeof t.e_?(this.o_=t.o_,this.e_=t.e_):t instanceof g.crypto.u_?this.n_=t:t instanceof K&&(this.n_=t),this.state="VERIFY"},this.a_=function(t){var i=new X509;i.f_(t),this.n_=i.c_,this.state="VERIFY"},this.kI=function(t){this.CI.kI(t)},this.DI=function(t){this.CI.DI(t)},this.sign=function(){if(this.l_=this.CI.digest(),void 0!==this.s_&&void 0!==this.e_){var t=new g.crypto.u_({curve:this.e_});this.v_=t.d_(this.l_,this.s_)}else if(this.i_ instanceof K&&"rsaandmgf1"==this.zI)this.v_=this.i_.E_(this.l_,this.JI,this.p_);else if(this.i_ instanceof K&&"rsa"==this.zI)this.v_=this.i_.w_(this.l_,this.JI);else if(this.i_ instanceof g.crypto.u_)this.v_=this.i_.w_(this.l_);else{if(!(this.i_ instanceof g.crypto.g_))throw"Signature: unsupported public key alg: "+this.zI;this.v_=this.i_.w_(this.l_)}return this.v_},this.b_=function(t){return this.kI(t),this.sign()},this.d_=function(t){return this.DI(t),this.sign()},this.verify=function(t){if(this.l_=this.CI.digest(),void 0!==this.o_&&void 0!==this.e_)return new g.crypto.u_({curve:this.e_}).y_(this.l_,t,this.o_);if(this.n_ instanceof K&&"rsaandmgf1"==this.zI)return this.n_.T_(this.l_,t,this.JI,this.p_);if(this.n_ instanceof K&&"rsa"==this.zI)return this.n_.m_(this.l_,t);if(this.n_ instanceof g.crypto.u_)return this.n_.m_(this.l_,t);if(this.n_ instanceof g.crypto.g_)return this.n_.m_(this.l_,t);throw"Signature: unsupported public key alg: "+this.zI}}},this.init=function(t,i){throw"init(key, pass) not supported for this alg:prov="+this.O_},this.h_=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.O_},this.a_=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.O_},this.r_=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.O_},this.kI=function(t){throw"updateString(str) not supported for this alg:prov="+this.O_},this.DI=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.O_},this.sign=function(){throw"sign() not supported for this alg:prov="+this.O_},this.b_=function(t){throw"digestString(str) not supported for this alg:prov="+this.O_},this.d_=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.O_},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.O_},void 0!==(this.S_=t)&&(void 0!==t.mI&&(this.LI=t.mI,void 0===t.RI?this.UI=g.crypto.RR.MR[this.LI]:this.UI=t.RI,this.O_=this.LI+":"+this.UI,this.NI(this.LI,this.UI),this.XI()),void 0!==t.R_&&(this.p_=t.R_),void 0!==t.I_)){if(void 0!==t.__)throw"both prvkeypem and prvkeypas parameters not supported";try{(i=new K).A_(t.I_),this.r_(i)}catch(t){throw"fatal error to load pem private key: "+t}}},g.crypto.dR=new function(){this.N_={C_:"rsaEncryption",k_:"ecPublicKey",D_:"dsa",M_:"secp256r1",j_:"secp192k1",P_:"secp224r1",H_:"secp256k1",L_:"secp521r1",U_:"secp384r1",F_:"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}};
/*! rsasign-1.2.7.js (c) 2012 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
var $=new RegExp("");function X(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t}function J(t,i){var n,r=(n=t,g.crypto.RR.bI(n,i));return this.w_(r,i)}function z(t){return J.call(this,t,"sha1")}function Z(t){return J.call(this,t,"sha256")}function tt(t,i,n){for(var r="",s=0;r.length<i;)r+=hextorstr(n(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s])))),s+=1;return r}function it(t,i,n){var r,s=(r=rstrtohex(t),g.crypto.RR.OI(r,i));return void 0===n&&(n=-1),this.E_(s,i,n)}function nt(t,i,n){return function(t,i,n){var r=new K;return r.YO(i,n),r.WO(t)}(t,i,n).toString(16).replace(/^1f+00/,"")}function rt(t){for(var i in g.crypto.RR.IR){var n=g.crypto.RR.IR[i],r=n.length;if(t.substring(0,r)==n)return[i,t.substring(r)]}return[]}function st(t,i){return function(t,i,n,r){var s=rt(nt(i,n,r));if(0==s.length)return!1;var e,h=s[0];return s[1]==(e=t,g.crypto.RR.bI(e,h))}(i,Q(t,16),this.n.toString(16),this.e.toString(16))}function et(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.FO()>this.n.FO())return 0;var r=rt(this.WO(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var s,e=r[0];return r[1]==(s=t,g.crypto.RR.bI(s,e))}function ht(t,i,n,r){var s,e=(s=rstrtohex(t),g.crypto.RR.OI(s,n));return void 0===r&&(r=-1),this.T_(e,i,n,r)}$.compile("[^0-9a-f]","gi"),K.prototype.w_=function(t,i){var n=Q(g.crypto.RR.gI(t,i,this.n.FO()),16);return X(this.G_(n).toString(16),this.n.FO())},K.prototype.b_=J,K.prototype.x_=z,K.prototype.B_=Z,K.prototype.sign=J,K.prototype.V_=z,K.prototype.q_=Z,K.prototype.E_=function(t,i,n){function r(t){return g.crypto.RR.OI(t,i)}var s,e=hextorstr(t),h=e.length,o=this.n.FO()-1,u=Math.ceil(o/8);if(-1===n||void 0===n)n=h;else if(-2===n)n=u-h-2;else if(n<-2)throw"invalid salt length";if(u<h+n+2)throw"data too long";var a="";0<n&&(a=new Array(n),(new SecureRandom).$O(a),a=String.fromCharCode.apply(String,a));var f=hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+e+a))),c=[];for(s=0;s<u-n-h-2;s+=1)c[s]=0;var l=String.fromCharCode.apply(String,c)+""+a,v=tt(f,l.length,r),d=[];for(s=0;s<l.length;s+=1)d[s]=l.charCodeAt(s)^v.charCodeAt(s);var E=65280>>8*u-o&255;for(d[0]&=~E,s=0;s<h;s++)d.push(f.charCodeAt(s));return d.push(188),X(this.G_(new j(d)).toString(16),this.n.FO())},K.prototype.Q_=it,K.prototype.W_=it,K.Y_=-1,K.K_=-2,K.prototype.m_=function(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.FO()>this.n.FO())return 0;var r=rt(this.WO(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==t)},K.prototype.X_=et,K.prototype.J_=st,K.prototype.verify=et,K.prototype.z_=st,K.prototype.T_=function(t,i,n,r){var s=new j(i,16);if(s.FO()>this.n.FO())return!1;function e(t){return g.crypto.RR.OI(t,n)}var h,o=hextorstr(t),u=o.length,a=this.n.FO()-1,f=Math.ceil(a/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=f-u-2;else if(r<-2)throw"invalid salt length";if(f<u+r+2)throw"data too long";var c=this.WO(s).Z_();for(h=0;h<c.length;h+=1)c[h]&=255;for(;c.length<f;)c.unshift(0);if(188!==c[f-1])throw"encoded message does not end in 0xbc";var l=(c=String.fromCharCode.apply(String,c)).substr(0,f-u-1),v=c.substr(l.length,u),d=65280>>8*f-a&255;if(0!=(l.charCodeAt(0)&d))throw"bits beyond keysize not zero";var E=tt(v,l.length,e),p=[];for(h=0;h<l.length;h+=1)p[h]=l.charCodeAt(h)^E.charCodeAt(h);p[0]&=~d;var w=f-u-r-2;for(h=0;h<w;h+=1)if(0!==p[h])throw"leftmost octets not zero";if(1!==p[w])throw"0x01 marker not found";return v===hextorstr(e(rstrtohex("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,p.slice(-r)))))},K.prototype.tA=ht,K.prototype.iA=ht,K.nA=-2,i.rA=j,i.sA=K,i.Signature=g.crypto.Signature,i.TI=g.crypto.TI,i.Av=A,i.eA=M,i.hA=function(t){var i,n=M(t),r=new Array;for(i=0;2*i<n.length;++i)r[i]=parseInt(n.substring(2*i,2*i+2),16);return r}},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(82),o=n(83),u=(e=o.oA,s(a,e),a.prototype.send=function(){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");if(!this.pluginId){var t=Object.keys(a.uA);0<t.length&&(this.pluginId=a.uA[t[0]])}h.aA.Api().request(this,this.pluginId)},a.prototype.abort=function(){h.aA.Api().abort(this,this.pluginId)},a.Kv=0,a);function a(t){var i=e.call(this,t)||this;return i.DONE=4,i.LOADING=3,i.HEADERS_RECEIVED=2,i.OPENED=1,i.UNSENT=0,i.internal=!1,i.id=a.Kv++,i}i.HiveRequest=u},function(t,i,n){"use strict";n(11);var s=n(134),r=n(12),e=n(53),h=n(13);function o(t,n,r,i){if(!(this instanceof o))return new o(t,n,r,i);n=n||Object.Wh,r=r||Object.compare,i=i||Function.Yh,this.Kh=n,this.Mf=r,this.Xh=i,this.store=new s(null,function(t,i){return n(t.key,i.key)},function(t,i){return r(t.key,i.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).SortedMap=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.Mf,this.Xh)},o.prototype.log=function(t,r,i,n){r=r||this.Zh,this.store.log(t,function(t,i,n){r(t.value,i,n)},i,n)},o.prototype.Zh=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(9),f=n(32),s=(e.prototype.Dp=function(){return this.fA},e.prototype.cA=function(){return this.lA},e.prototype.getDuration=function(){return this.duration},e.prototype.getBitrate=function(){return this.bitrate},e.prototype.Gp=function(){return this.vA},e.prototype.dA=function(){return this.EA},e.prototype.jp=function(){return this.pA},e.prototype.Up=function(){return this.url},e.prototype.toString=function(){return r.wf[this.Dp()]+"-"+this.jp()},e);function e(t,i,n,r,s,e,h,o){this.contextId=o,this.url=t,this.EA=n,this.fA=i,this.lA=r,this.duration=s,this.bitrate=e,this.vA=h;var u=(this.contextId?this.contextId:this.url).replace(/http(s)?:\/\//,""),a=f.Av.tO(u).toString(f.Av.Dm.Mm);this.pA=a+"-"+this.lA+"-"+this.bitrate}i.wA=s},function(t,i,n){var r,s,e;
/**
 * @license ByteBuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
 * [BUILD] ByteBufferAB - Backing buffer: ArrayBuffer, Accessor: Uint8Array
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/ByteBuffer.js for details
 */s=[n(160)],void 0===(e="function"==typeof(r=function(u){"use strict";var d=function(t,i,n){if(void 0===t&&(t=d.gA),void 0===i&&(i=d.bA),void 0===n&&(n=d.yA),!n){if((t|=0)<0)throw RangeError("Illegal capacity");i=!!i,n=!!n}this.buffer=0===t?e:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.TA=-1,this.mA=t,this.OA=void 0!==i&&!!i,this.SA=!!n};d.VERSION="4.1.0",d.RA=!0,d.IA=!1,d.gA=16,d.bA=d.IA,d.yA=!1,d._A=u||null;var h=d.prototype;h.AA,Object.defineProperty(h,"AA",{value:!0,enumerable:!1,configurable:!1});var e=new ArrayBuffer(0),n=String.fromCharCode;function o(t){var i=0;return function(){return i<t.length?t.charCodeAt(i++):null}}function a(){var t=[],i=[];return function(){if(0===arguments.length)return i.join("")+n.apply(String,t);1024<t.length+arguments.length&&(i.push(n.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}function r(t,i,n,r,s){var e,h,o=8*s-r-1,u=(1<<o)-1,a=u>>1,f=-7,c=n?s-1:0,l=n?-1:1,v=t[i+c];for(c+=l,e=v&(1<<-f)-1,v>>=-f,f+=o;0<f;e=256*e+t[i+c],c+=l,f-=8);for(h=e&(1<<-f)-1,e>>=-f,f+=r;0<f;h=256*h+t[i+c],c+=l,f-=8);if(0===e)e=1-a;else{if(e===u)return h?NaN:1/0*(v?-1:1);h+=Math.pow(2,r),e-=a}return(v?-1:1)*h*Math.pow(2,e-r)}function s(t,i,n,r,s,e){var h,o,u,a=8*e-s-1,f=(1<<a)-1,c=f>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:e-1,d=r?1:-1,E=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,h=f):(h=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-h))<1&&(h--,u*=2),2<=(i+=1<=h+c?l/u:l*Math.pow(2,1-c))*u&&(h++,u/=2),f<=h+c?(o=0,h=f):1<=h+c?(o=(i*u-1)*Math.pow(2,s),h+=c):(o=i*Math.pow(2,c-1)*Math.pow(2,s),h=0));8<=s;t[n+v]=255&o,v+=d,o/=256,s-=8);for(h=h<<s|o,a+=s;0<a;t[n+v]=255&h,v+=d,h/=256,a-=8);t[n+v-d]|=128*E}d.NA=function(){return Uint8Array},d.CA=function(t,i,n){return new d(t,i,n)},d.concat=function(t,i,n,r){"boolean"!=typeof i&&"string"==typeof i||(r=n,n=i,i=void 0);for(var s,e=0,h=0,o=t.length;h<o;++h)d.kA(t[h])||(t[h]=d.wrap(t[h],i)),0<(s=t[h].mA-t[h].offset)&&(e+=s);if(0===e)return new d(0,n,r);var u,a=new d(e,n,r);for(h=0;h<o;)(s=(u=t[h++]).mA-u.offset)<=0||(a.view.set(u.view.subarray(u.offset,u.mA),a.offset),a.offset+=s);return a.mA=a.offset,a.offset=0,a},d.kA=function(t){return!0===(t&&t.AA)},d.type=function(){return ArrayBuffer},d.wrap=function(t,i,n,r){if("string"!=typeof i&&(r=n,n=i,i=void 0),"string"==typeof t)switch(void 0===i&&(i="utf8"),i){case"base64":return d.DA(t,n);case"hex":return d.MA(t,n);case"binary":return d.jA(t,n);case"utf8":return d.PA(t,n);case"debug":return d.HA(t,n);default:throw Error("Unsupported encoding: "+i)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var s;if(d.kA(t))return(s=h.clone.call(t)).TA=-1,s;if(t instanceof Uint8Array)s=new d(0,n,r),0<t.length&&(s.buffer=t.buffer,s.offset=t.byteOffset,s.mA=t.byteOffset+t.byteLength,s.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)s=new d(0,n,r),0<t.byteLength&&(s.buffer=t,s.offset=0,s.mA=t.byteLength,s.view=0<t.byteLength?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");(s=new d(t.length,n,r)).mA=t.length;for(var e=0;e<t.length;++e)s.view[e]=t[e]}return s},h.LA=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+"+t+") <= "+this.buffer.byteLength)}var r=this.slice(i,i+t);return n&&(this.offset+=t),r},h.UA=h.append,h.FA=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.Qg=h.FA,h.GA=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return 128==(128&n)&&(n=-(255-n+1)),i&&(this.offset+=1),n},h.lb=h.GA,h.xA=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.BA=h.xA,h.VA=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return i&&(this.offset+=1),n},h.qA=h.VA,h.QA=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.OA?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.WA=h.QA,h.YA=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.OA?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),32768==(32768&n)&&(n=-(65535-n+1)),i&&(this.offset+=2),n},h.KA=h.YA,h.$A=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.OA?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.XA=h.$A,h.JA=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.OA?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),i&&(this.offset+=2),n},h.zA=h.JA,h.ZA=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.OA?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.Cv=h.ZA,h.tN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.OA?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),n|=0,i&&(this.offset+=4),n},h.Fv=h.tN,h.iN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.OA?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.nN=h.iN,h.rN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.OA?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i&&(this.offset+=4),n},h.sN=h.rN,u&&(h.eN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"==typeof t)t=u.nO(t);else if("string"==typeof t)t=u.rO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.nO(t):"string"==typeof t&&(t=u.rO(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.OA?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.hN=h.eN,h.oN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.OA?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!1);return i&&(this.offset+=8),s},h.uN=h.oN,h.aN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"==typeof t)t=u.nO(t);else if("string"==typeof t)t=u.rO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.nO(t):"string"==typeof t&&(t=u.rO(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.OA?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.fN=h.aN,h.cN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.OA?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!0);return i&&(this.offset+=8),s},h.lN=h.cN),h.vN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,s(this.view,t,i,this.OA,23,4),n&&(this.offset+=4),this},h.dN=h.vN,h.EN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.OA,23,4);return i&&(this.offset+=4),n},h.pN=h.EN,h.wN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=8;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=8,s(this.view,t,i,this.OA,52,8),n&&(this.offset+=8),this},h.Kg=h.wN,h.gN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.OA,52,8);return i&&(this.offset+=8),n},h.pb=h.gN,d.bN=5,d.yN=function(t){return(t>>>=0)<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},d.TN=function(t){return((t|=0)<<1^t>>31)>>>0},d.mN=function(t){return t>>>1^-(1&t)|0},h.ON=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=d.yN(t);i+=s;var e=this.buffer.byteLength;for(e<i&&this.resize((e*=2)>i?e:i),i-=s,t>>>=0;128<=t;)r=127&t|128,this.view[i++]=r,t>>>=7;return this.view[i++]=t,n?(this.offset=i,this):s},h.SN=function(t,i){return this.ON(d.TN(t),i)},h.RN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=0,s=0;do{if(!this.SA&&t>this.mA){var e=Error("Truncated");throw e.IN=!0,e}n=this.view[t++],r<5&&(s|=(127&n)<<7*r),++r}while(0!=(128&n));return s|=0,i?(this.offset=t,s):{value:s,length:r}},h._N=function(t){var i=this.RN(t);return"object"==typeof i?i.value=d.mN(i.value):i=d.mN(i),i},u&&(d.AN=10,d.NN=function(t){"number"==typeof t?t=u.nO(t):"string"==typeof t&&(t=u.rO(t));var i=t.CN()>>>0,n=t.kN(28).CN()>>>0,r=t.kN(56).CN()>>>0;return 0==r?0==n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10},d.DN=function(t){return"number"==typeof t?t=u.nO(t,!1):"string"==typeof t?t=u.rO(t,!1):!1!==t.MN&&(t=t.jN()),t.shiftLeft(1).xor(t.HN(63)).PN()},d.LN=function(t){return"number"==typeof t?t=u.nO(t,!1):"string"==typeof t?t=u.rO(t,!1):!1!==t.MN&&(t=t.jN()),t.kN(1).xor(t.and(u.ONE).jN().LO()).jN()},h.UN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("number"==typeof t)t=u.nO(t);else if("string"==typeof t)t=u.rO(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.nO(t,!1):"string"==typeof t?t=u.rO(t,!1):!1!==t.MN&&(t=t.jN());var r=d.NN(t),s=t.CN()>>>0,e=t.kN(28).CN()>>>0,h=t.kN(56).CN()>>>0;i+=r;var o=this.buffer.byteLength;switch(o<i&&this.resize((o*=2)>i?o:i),i-=r,r){case 10:this.view[i+9]=h>>>7&1;case 9:this.view[i+8]=9!==r?128|h:127&h;case 8:this.view[i+7]=8!==r?e>>>21|128:e>>>21&127;case 7:this.view[i+6]=7!==r?e>>>14|128:e>>>14&127;case 6:this.view[i+5]=6!==r?e>>>7|128:e>>>7&127;case 5:this.view[i+4]=5!==r?128|e:127&e;case 4:this.view[i+3]=4!==r?s>>>21|128:s>>>21&127;case 3:this.view[i+2]=3!==r?s>>>14|128:s>>>14&127;case 2:this.view[i+1]=2!==r?s>>>7|128:s>>>7&127;case 1:this.view[i]=1!==r?128|s:127&s}return n?(this.offset+=r,this):r},h.FN=function(t,i){return this.UN(d.DN(t),i)},h.GN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,r=0,s=0,e=0,h=0;if(h=this.view[t++],r=127&h,128&h&&(h=this.view[t++],r|=(127&h)<<7,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<14,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<21,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],s=127&h,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<7,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<14,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<21,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],e=127&h,(128&h||this.SA&&void 0===h)&&(h=this.view[t++],e|=(127&h)<<7,128&h||this.SA&&void 0===h))))))))))throw Error("Buffer overrun");var o=u.HI(r|s<<28,s>>>4|e<<24,!1);return i?(this.offset=t,o):{value:o,length:t-n}},h.xN=function(t){var i=this.GN(t);return i&&i.value instanceof u?i.value=d.LN(i.value):i=d.LN(i),i}),h.kv=function(t,i){var n=void 0===i;n&&(i=this.offset);var r,s=t.length;if(!this.SA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(r=0;r<s;++r)if(0===t.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=c.BN(o(t))[1],i+=s+1;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=s+1,c.VN(o(t),function(t){this.view[i++]=t}.bind(this)),this.view[i++]=0,n?(this.offset=i,this):s},h.Bv=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=t,s=-1;return c.qN(function(){if(0===s)return null;if(t>=this.mA)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.mA);return 0===(s=this.view[t++])?null:s}.bind(this),n=a(),!0),i?(this.offset=t,n()):{string:n(),length:t-r}},h.QN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=i;r=c.BN(o(t),this.SA)[1],i+=4+r;var e=this.buffer.byteLength;if(e<i&&this.resize((e*=2)>i?e:i),i-=4+r,this.OA?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r):(this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),i+=4,c.VN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==s+4+r)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+r));return n?(this.offset=i,this):i-s},h.WN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n,r=0,s=t;this.OA?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var e,h=(t+=4)+r;return c.qN(function(){return t<h?this.view[t++]:null}.bind(this),e=a(),this.SA),n=e(),i?(this.offset=t,n):{string:n,length:t-s}},d.YN="c",d.KN="b",h.$N=function(t,i){var n,r=void 0===i;if(r&&(i=this.offset),!this.SA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var s=i;n=c.BN(o(t))[1],i+=n;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=n,c.VN(o(t),function(t){this.view[i++]=t}.bind(this)),r?(this.offset=i,this):i-s},h.Kw=h.$N,d.XN=function(t){return c.BN(o(t))[0]},d.JN=function(t){return c.BN(o(t))[1]},d.zN=d.JN,h.ZN=function(t,i,n){"number"==typeof i&&(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===i&&(i=d.YN),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var s,e=0,h=n;if(i===d.YN){if(s=a(),c.tC(function(){return e<t&&n<this.mA?this.view[n++]:null}.bind(this),function(t){++e,c.iC(t,s)}),e!==t)throw RangeError("Illegal range: Truncated data, "+e+" == "+t);return r?(this.offset=n,s()):{string:s(),length:n-h}}if(i!==d.KN)throw TypeError("Unsupported metrics: "+i);if(!this.SA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+t+") <= "+this.buffer.byteLength)}var o=n+t;if(c.qN(function(){return n<o?this.view[n++]:null}.bind(this),s=a(),this.SA),n!==o)throw RangeError("Illegal range: Truncated data, "+n+" == "+o);return r?(this.offset=n,s()):{string:s(),length:n-h}},h.xw=h.ZN,h.nC=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.SA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s,e=i;r=c.BN(o(t),this.SA)[1],s=d.yN(r),i+=s+r;var h=this.buffer.byteLength;if(h<i&&this.resize((h*=2)>i?h:i),i-=s+r,i+=this.ON(r,i),c.VN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==e+r+s)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+r+s));return n?(this.offset=i,this):i-e},h.rC=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=this.RN(t),s=t;t+=r.length,r=r.value;var e=t+r,h=a();return c.qN(function(){return t<e?this.view[t++]:null}.bind(this),h,this.SA),n=h(),i?(this.offset=t,n):{string:n,length:t-s}},h.append=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.SA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.mA-t.offset;if(s<=0)return this;n+=s;var e=this.buffer.byteLength;return e<n&&this.resize((e*=2)>n?e:n),n-=s,this.view.set(t.view.subarray(t.offset,t.mA),n),t.offset+=s,r&&(this.offset+=s),this},h.sC=function(t,i){return t.append(this,i),this},h.assert=function(t){return this.SA=!t,this},h.eC=function(){return this.buffer.byteLength},h.clear=function(){return this.offset=0,this.mA=this.buffer.byteLength,this.TA=-1,this},h.clone=function(t){var i=new d(0,this.OA,this.SA);return t?(i.buffer=new ArrayBuffer(this.buffer.byteLength),i.view=new Uint8Array(i.buffer)):(i.buffer=this.buffer,i.view=this.view),i.offset=this.offset,i.TA=this.TA,i.mA=this.mA,i},h.compact=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(0===t&&i===this.buffer.byteLength)return this;var n=i-t;if(0==n)return this.buffer=e,this.view=null,0<=this.TA&&(this.TA-=t),this.offset=0,this.mA=0,this;var r=new ArrayBuffer(n),s=new Uint8Array(r);return s.set(this.view.subarray(t,i)),this.buffer=r,this.view=s,0<=this.TA&&(this.TA-=t),this.offset=0,this.mA=n,this},h.hC=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t===i)return new d(0,this.OA,this.SA);var n=i-t,r=new d(n,this.OA,this.SA);return r.offset=0,r.mA=n,0<=r.TA&&(r.TA-=t),this.kO(r,0,t,i),r},h.kO=function(t,i,n,r){var s,e;if(!this.SA&&!d.kA(t))throw TypeError("Illegal target: Not a ByteBuffer");if(i=(e=void 0===i)?t.offset:0|i,n=(s=void 0===n)?this.offset:0|n,r=void 0===r?this.mA:0|r,i<0||i>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+i+" <= "+t.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var h=r-n;return 0==h?t:(t.oC(i+h),t.view.set(this.view.subarray(n,r),i),s&&(this.offset+=h),e&&(t.offset+=h),this)},h.oC=function(t){var i=this.buffer.byteLength;return i<t?this.resize((i*=2)>t?i:t):this},h.fill=function(t,i,n){var r=void 0===i;if(r&&(i=this.offset),"string"==typeof t&&0<t.length&&(t=t.charCodeAt(0)),void 0===i&&(i=this.offset),void 0===n&&(n=this.mA),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=i)return this;for(;i<n;)this.view[i++]=t;return r&&(this.offset=i),this},h.Dv=function(){return this.mA=this.offset,this.offset=0,this},h.mark=function(t){if(t=void 0===t?this.offset:t,!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.TA=t,this},h.order=function(t){if(!this.SA&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.OA=!!t,this},h.uC=function(t){return this.OA=void 0===t||!!t,this},h.aC=function(t){return this.OA=void 0!==t&&!t,this},h.prepend=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.SA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.mA-t.offset;if(s<=0)return this;var e=s-n;if(0<e){var h=new ArrayBuffer(this.buffer.byteLength+e),o=new Uint8Array(h);o.set(this.view.subarray(n,this.buffer.byteLength),s),this.buffer=h,this.view=o,this.offset+=e,0<=this.TA&&(this.TA+=e),this.mA+=e,n+=e}else new Uint8Array(this.buffer);return this.view.set(t.view.subarray(t.offset,t.mA),n-s),t.offset=t.mA,r&&(this.offset-=s),this},h.fC=function(t,i){return t.prepend(this,i),this},h.cC=function(t){"function"!=typeof t&&(t=console.log.bind(console)),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.lC(!0))},h.vC=function(){return this.mA-this.offset},h.reset=function(){return 0<=this.TA?(this.offset=this.TA,this.TA=-1):this.offset=0,this},h.resize=function(t){if(!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var i=new ArrayBuffer(t),n=new Uint8Array(i);n.set(this.view),this.buffer=i,this.view=n}return this},h.reverse=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}return t===i||Array.prototype.reverse.call(this.view.subarray(t,i)),this},h.Bw=function(t){if(!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var i=this.offset+t;if(!this.SA&&(i<0||i>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=i,this},h.slice=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=t,n.mA=i,n},h.dC=function(t){var i=this.offset,n=this.mA;if(!this.SA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(!t&&0===i&&n===this.buffer.byteLength)return this.buffer;if(i===n)return e;var r=new ArrayBuffer(n-i);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(i,n),0),r},h.Ma=h.dC,h.toString=function(t,i,n){if(void 0===t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.TA+",limit="+this.mA+",capacity="+this.eC()+")";switch("number"==typeof t&&(n=i=t="utf8"),t){case"utf8":return this.EC(i,n);case"base64":return this.pC(i,n);case"hex":return this.wC(i,n);case"binary":return this.gC(i,n);case"debug":return this.lC();case"columns":return this.bC();default:throw Error("Unsupported encoding: "+t)}};var f=function(){for(var t={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],h=[],i=0,n=s.length;i<n;++i)h[s[i]]=i;return t.encode=function(t,i){for(var n,r;null!==(n=t());)i(s[n>>2&63]),r=(3&n)<<4,null!==(n=t())?(i(s[63&((r|=n>>4&15)|n>>4&15)]),r=(15&n)<<2,null!==(n=t())?(i(s[63&(r|n>>6&3)]),i(s[63&n])):(i(s[63&r]),i(61))):(i(s[63&r]),i(61),i(61))},t.decode=function(t,i){var n,r,s;function e(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(r=h[n])&&e(n),null!==(n=t())&&(void 0===(s=h[n])&&e(n),i(r<<2>>>0|(48&s)>>4),null!==(n=t()))){if(void 0===(r=h[n])){if(61===n)break;e(n)}if(i((15&s)<<4>>>0|(60&r)>>2),null!==(n=t())){if(void 0===(s=h[n])){if(61===n)break;e(n)}i((3&r)<<6>>>0|s)}}},t.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t}();h.pC=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),i|=0,(t|=0)<0||i>this.eC||i<t)throw RangeError("begin, end");var n;return f.encode(function(){return t<i?this.view[t++]:null}.bind(this),n=a()),n()},d.DA=function(t,i){if("string"!=typeof t)throw TypeError("str");var n=new d(t.length/4*3,i),r=0;return f.decode(o(t),function(t){n.view[r++]=t}),n.mA=r,n},d.btoa=function(t){return d.jA(t).pC()},d.atob=function(t){return d.DA(t).gC()},h.gC=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.mA),i|=0,(t|=0)<0||i>this.eC()||i<t)throw RangeError("begin, end");if(t===i)return"";for(var n=[],r=[];t<i;)n.push(this.view[t++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d.jA=function(t,i){if("string"!=typeof t)throw TypeError("str");for(var n,r=0,s=t.length,e=new d(s,i);r<s;){if(255<(n=t.charCodeAt(r)))throw RangeError("illegal char code: "+n);e.view[r++]=n}return e.mA=s,e},h.lC=function(t){for(var i,n=-1,r=this.buffer.byteLength,s="",e="",h="";n<r;){if(-1!==n&&(i=this.view[n],s+=i<16?"0"+i.toString(16).toUpperCase():i.toString(16).toUpperCase(),t&&(e+=32<i&&i<127?String.fromCharCode(i):".")),++n,t&&0<n&&n%16==0&&n!==r){for(;s.length<51;)s+=" ";h+=s+e+"\n",s=e=""}n===this.offset&&n===this.mA?s+=n===this.TA?"!":"|":n===this.offset?s+=n===this.TA?"[":"<":n===this.mA?s+=n===this.TA?"]":">":s+=n===this.TA?"'":t||0!==n&&n!==r?" ":""}if(t&&" "!==s){for(;s.length<51;)s+=" ";h+=s+e+"\n"}return t?h:s},d.HA=function(t,i,n){for(var r,s,e=t.length,h=new d((e+1)/3|0,i,n),o=0,u=0,a=!1,f=!1,c=!1,l=!1,v=!1;o<e;){switch(r=t.charAt(o++)){case"!":if(!n){if(f||c||l){v=!0;break}f=c=l=!0}h.offset=h.TA=h.mA=u,a=!1;break;case"|":if(!n){if(f||l){v=!0;break}f=l=!0}h.offset=h.mA=u,a=!1;break;case"[":if(!n){if(f||c){v=!0;break}f=c=!0}h.offset=h.TA=u,a=!1;break;case"<":if(!n){if(f){v=!0;break}f=!0}h.offset=u,a=!1;break;case"]":if(!n){if(l||c){v=!0;break}l=c=!0}h.mA=h.TA=u,a=!1;break;case">":if(!n){if(l){v=!0;break}l=!0}h.mA=u,a=!1;break;case"'":if(!n){if(c){v=!0;break}c=!0}h.TA=u,a=!1;break;case" ":a=!1;break;default:if(!n&&a){v=!0;break}if(s=parseInt(r+t.charAt(o++),16),!n&&(isNaN(s)||s<0||255<s))throw TypeError("Illegal str: Not a debug encoded string");h.view[u++]=s,a=!0}if(v)throw TypeError("Illegal str: Invalid symbol at "+o)}if(!n){if(!f||!l)throw TypeError("Illegal str: Missing offset or limit");if(u<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+e)}return h},h.wC=function(t,i){if(t=void 0===t?this.offset:t,i=void 0===i?this.mA:i,!this.SA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}for(var n,r=new Array(i-t);t<i;)(n=this.view[t++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.MA=function(t,i,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,s=t.length,e=new d(s/2|0,i),h=0,o=0;h<s;h+=2){if(r=parseInt(t.substring(h,h+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");e.view[o++]=r}return e.mA=o,e};var c=function(){var r={yC:1114111,TC:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?i(127&n):(n<2048?i(n>>6&31|192):(n<65536?i(n>>12&15|224):(i(n>>18&7|240),i(n>>12&63|128)),i(n>>6&63|128)),i(63&n|128)),n=null},tC:function(t,i){for(var n,r,s,e,h=function(t){t=t.slice(0,t.indexOf(null));var i=Error(t.toString());throw i.name="TruncatedError",i.bytes=t,i};null!==(n=t());)if(0==(128&n))i(n);else if(192==(224&n))null===(r=t())&&h([n,r]),i((31&n)<<6|63&r);else if(224==(240&n))null!==(r=t())&&null!==(s=t())||h([n,r,s]),i((15&n)<<12|(63&r)<<6|63&s);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=t())&&null!==(s=t())&&null!==(e=t())||h([n,r,s,e]),i((7&n)<<18|(63&r)<<12|(63&s)<<6|63&e)}},mC:function(t,i){for(var n,r=null;null!==(n=null!==r?r:t());)55296<=n&&n<=57343&&null!==(r=t())&&56320<=r&&r<=57343?(i(1024*(n-55296)+r-56320+65536),r=null):i(n);null!==r&&i(r)},iC:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?i(n):(i(55296+((n-=65536)>>10)),i(n%1024+56320)),n=null},VN:function(t,i){r.mC(t,function(t){r.TC(t,i)})},qN:function(t,i){r.tC(t,function(t){r.iC(t,i)})},OC:function(t){return t<128?1:t<2048?2:t<65536?3:4},SC:function(t){for(var i,n=0;null!==(i=t());)n+=i<128?1:i<2048?2:i<65536?3:4;return n},BN:function(t){var i=0,n=0;return r.mC(t,function(t){++i,n+=t<128?1:t<2048?2:t<65536?3:4}),[i,n]}};return r}();return h.EC=function(i,n){if(void 0===i&&(i=this.offset),void 0===n&&(n=this.mA),!this.SA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}var t;try{c.qN(function(){return i<n?this.view[i++]:null}.bind(this),t=a())}catch(t){if(i!==n)throw RangeError("Illegal range: Truncated data, "+i+" != "+n)}return t()},d.PA=function(t,i,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var r=new d(c.BN(o(t),!0)[1],i,n),s=0;return c.VN(o(t),function(t){r.view[s++]=t}),r.mA=s,r},d})?r.apply(i,s):r)||(t.exports=e)},function(t,i){var n,r,s=t.exports={};function e(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function o(i){if(n===setTimeout)return setTimeout(i,0);if((n===e||!n)&&setTimeout)return n=setTimeout,setTimeout(i,0);try{return n(i,0)}catch(t){try{return n.call(null,i,0)}catch(t){return n.call(this,i,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:e}catch(t){n=e}try{r="function"==typeof clearTimeout?clearTimeout:h}catch(t){r=h}}();var u,a=[],f=!1,c=-1;function l(){f&&u&&(f=!1,u.length?a=u.concat(a):c=-1,a.length&&v())}function v(){if(!f){var t=o(l);f=!0;for(var i=a.length;i;){for(u=a,a=[];++c<i;)u&&u[c].RC();c=-1,i=a.length}u=null,f=!1,function(i){if(r===clearTimeout)return clearTimeout(i);if((r===h||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(i);try{r(i)}catch(t){try{return r.call(null,i)}catch(t){return r.call(this,i)}}}(t)}}function d(t,i){this.IC=t,this.bS=i}function E(){}s.Ve=function(t){var i=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)i[n-1]=arguments[n];a.push(new d(t,i)),1!==a.length||f||o(v)},d.prototype.RC=function(){this.IC.apply(null,this.bS)},s.title="browser",s._C=!0,s.Xe={},s.AC=[],s.version="",s.UT={},s.on=E,s.addListener=E,s.NC=E,s.off=E,s.removeListener=E,s.CC=E,s.vh=E,s.kC=E,s.DC=E,s.jd=function(t){return[]},s.MC=function(t){throw new Error("process.binding is not supported")},s.jC=function(){return"/"},s.PC=function(t){throw new Error("process.chdir is not supported")},s.HC=function(){return 0}},function(t,i,n){"use strict";var h=n(39);t.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.cc=function(t){return Object(t)===t},Object.LC=function(t){return t&&"function"==typeof t.valueOf&&(t=t.valueOf()),t};var r=new h;Object.hash=function(t){return t&&"function"==typeof t.hash?""+t.hash():Object(t)===t?(r.has(t)||r.set(t,Math.random().toString(36).slice(2)),r.get(t)):""+t};var s=Object.prototype.hasOwnProperty;Object.UC=function(t,i){return s.call(t,i)},Object.has=function(t,i){if("object"!=typeof t)throw new Error("Object.has can't accept non-object: "+typeof t);if(t&&"function"==typeof t.has)return t.has(i);if("string"==typeof i)return i in t&&t[i]!==Object.prototype[i];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(t,i,n){if("object"!=typeof t)throw new Error("Object.get can't accept non-object: "+typeof t);return t&&"function"==typeof t.get?t.get(i,n):Object.has(t,i)?t[i]:n},Object.set=function(t,i,n){t&&"function"==typeof t.set?t.set(i,n):t[i]=n},Object.hiveAddEach=function(n,i){if(i)if("function"!=typeof i.forEach||i.hasOwnProperty("forEach"))if("number"==typeof i.length)for(var t=0;t<i.length;t++)n[t]=i[t];else Object.keys(i).forEach(function(t){n[t]=i[t]});else!0===i.isMap?i.forEach(function(t,i){n[i]=t}):i.forEach(function(t){n[t[0]]=t[1]});else;return n},Object.forEach=function(t,i,n){for(var r,s=Object.keys(t),e=0;r=s[e];e++)i.call(n,t[r],r,t)},Object.map=function(t,i,n){for(var r,s=Object.keys(t),e=0,h=[];r=s[e];e++)h.push(i.call(n,t[r],r,t));return h},Object.values=function(t){return Object.map(t,Function.identity)},Object.concat=function(){for(var t={},i=0;i<arguments.length;i++)Object.hiveAddEach(t,arguments[i]);return t},Object.from=Object.concat,Object.is=function(t,i){return t===i?0!==t||1/t==1/i:t!=t&&i!=i},Object.Wh=function(t,i,n,r){if(n=n||Object.Wh,(t=Object.LC(t))===(i=Object.LC(i)))return!0;if(Object.cc(t)){if((r=r||new h).has(t))return!0;r.set(t,!0)}if(Object.cc(t)&&"function"==typeof t.Wh)return t.Wh(i,n,r);if(Object.cc(i)&&"function"==typeof i.Wh)return i.Wh(t,n,r);if(Object.cc(t)&&Object.cc(i)&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(i)===Object.prototype){for(var s in t)if(!n(t[s],i[s],n,r))return!1;for(var s in i)if(!(s in t&&n(i[s],t[s],n,r)))return!1;return!0}return t!=t&&i!=i||(!t||!i)&&t===i},Object.compare=function(t,i){if((t=Object.LC(t))===(i=Object.LC(i)))return 0;var n=typeof t,r=typeof i;return"number"==n&&"number"==r?t-i:"string"==n&&"string"==r?t<i?-1/0:1/0:t&&"function"==typeof t.compare?t.compare(i):i&&"function"==typeof i.compare?-i.compare(t):0},Object.clone=function(t,i,n){if(t=Object.LC(t),n=n||new h,void 0===i)i=1/0;else if(0===i)return t;if(Object.cc(t)){if(!n.has(t))if(t&&"function"==typeof t.clone)n.set(t,t.clone(i,n));else{var r=Object.getPrototypeOf(t);if(null!==r&&r!==Object.prototype)throw new Error("Can't clone "+t);var s=Object.create(r);for(var e in n.set(t,s),t)s[e]=Object.clone(t[e],i-1,n)}return n.get(t)}return t},Object.clear=function(t){if(t&&"function"==typeof t.clear)t.clear();else for(var i=Object.keys(t),n=i.length;n;)delete t[i[--n]];return t}},function(T,t){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.FC=E);var i=!1;if("function"==typeof WeakMap){var n=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var t=new n,r=Object.freeze({});if(t.set(r,1),1===t.get(r))return T.exports=WeakMap;i=!0}}Object.prototype.hasOwnProperty;var s=Object.getOwnPropertyNames,e=Object.defineProperty,h=Object.isExtensible,o="weakmap:",u=o+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var a=new ArrayBuffer(25),f=new Uint8Array(a);crypto.getRandomValues(f),u=o+"rand:"+Array.prototype.map.call(f,function(t){return(t%36).toString(36)}).join("")+"___"}if(e(Object,"getOwnPropertyNames",{value:function(t){return s(t).filter(p)}}),"getPropertyNames"in Object){var c=Object.GC;e(Object,"getPropertyNames",{value:function(t){return c(t).filter(p)}})}!function(){var i=Object.freeze;e(Object,"freeze",{value:function(t){return w(t),i(t)}});var n=Object.seal;e(Object,"seal",{value:function(t){return w(t),n(t)}});var r=Object.preventExtensions;e(Object,"preventExtensions",{value:function(t){return w(t),r(t)}})}();var l=!1,v=0,d=function(){this instanceof d||b();var s=[],e=[],h=v++;return Object.create(d.prototype,{xC:{value:g(function(t,i){var n,r=w(t);return r?h in r?r[h]:i:0<=(n=s.indexOf(t))?e[n]:i})},BC:{value:g(function(t){var i=w(t);return i?h in i:0<=s.indexOf(t)})},VC:{value:g(function(t,i){var n,r=w(t);return r?r[h]=i:0<=(n=s.indexOf(t))?e[n]=i:(n=s.length,e[n]=i,s[n]=t),this})},qC:{value:g(function(t){var i,n,r=w(t);return r?h in r&&delete r[h]:!((i=s.indexOf(t))<0)&&(n=s.length-1,s[i]=void 0,e[i]=e[n],s[i]=s[n],s.length=n,e.length=n,!0)})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(t,i){return this.xC(t,i)},writable:!0,configurable:!0},has:{value:function(t){return this.BC(t)},writable:!0,configurable:!0},set:{value:function(t,i){return this.VC(t,i)},writable:!0,configurable:!0},delete:{value:function(t){return this.qC(t)},writable:!0,configurable:!0}}),"function"==typeof n?(i&&"undefined"!=typeof Proxy&&(Proxy=void 0),y.prototype=d.prototype,T.exports=y,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})):("undefined"!=typeof Proxy&&(Proxy=void 0),T.exports=d)}function E(t){t.QC&&t.QC(E)}function p(t){return!(t.substr(0,o.length)==o&&"___"===t.substr(t.length-3))}function w(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var i=t[u];if(i&&i.key===t)return i;if(h(t)){i={key:t};try{return e(t,u,{value:i,writable:!1,enumerable:!1,configurable:!1}),i}catch(t){return}}}function g(t){return t.prototype=null,Object.freeze(t)}function b(){l||"undefined"==typeof console||(l=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}function y(){this instanceof d||b();var t,r=new n,s=void 0,e=!1;return t=i?function(t,i){return r.set(t,i),r.has(t)||(s=s||new d).set(t,i),this}:function(i,n){if(e)try{r.set(i,n)}catch(t){(s=s||new d).VC(i,n)}else r.set(i,n);return this},Object.create(d.prototype,{xC:{value:g(function(t,i){return s?r.has(t)?r.get(t):s.xC(t,i):r.get(t,i)})},BC:{value:g(function(t){return r.has(t)||!!s&&s.BC(t)})},VC:{value:g(t)},qC:{value:g(function(t){var i=!!r.delete(t);return s&&s.qC(t)||i})},QC:{value:g(function(t){if(t!==E)throw new Error("bogus call to permitHostObjects___");e=!0})}})}}()},function(t,i,n){"use strict";var r=n(39),s=n(52),e=new r;function h(){throw new Error("Can't construct. RangeChanges is a mixin.")}(t.exports=h).prototype.WC=function(){return e.has(this)||e.set(this,s()),e.get(this)},h.prototype.YC=function(t){var i=this.WC();return t=t||"",i.has(t)||i.set(t,{isActive:!1,Jf:[],Xf:[]}),i.get(t)},h.prototype.KC=function(t,i,n){!this.ic&&this.tc&&this.tc();var r=this.YC(i);(n?r.Xf:r.Jf).push(t),Object.defineProperty(this,"$C",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.XC(t,i,n),s=null)}},h.prototype.XC=function(t,i,n){var r,s=this.YC(i),e=(r=n?s.Xf:s.Jf).lastIndexOf(t);if(-1===e)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(i));r.splice(e,1)},h.prototype.JC=function(s,e,h,o){var t=this.WC(),u="Range"+(o?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=o?t.Xf:t.Jf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+u;try{n.slice().forEach(function(t){if(!(n.indexOf(t)<0))if(t[r])t[r](s,e,h,this,o);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(this,s,e,h,this,o)}},this)}finally{t.isActive=!1}}},this)},h.prototype.zC=function(t,i){return this.KC(t,i,!0)},h.prototype.ZC=function(t,i){return this.XC(t,i,!0)},h.prototype.tk=function(t,i,n){return this.JC(t,i,n,!0)}},function(t,i){function n(){throw new Error("Can't construct. GenericSet is a mixin.")}(t.exports=n).prototype.ik=!0,n.prototype.nk=function(t){var i=this.zh(this);return i.hiveAddEach(t),i},n.prototype.rk=function(i){return this.zh(this.filter(function(t){return i.has(t)}))},n.prototype.sk=function(t){var i=this.zh(this);return i.kf(t),i},n.prototype.ek=function(t){var i=this.nk(t),n=this.rk(t);return i.sk(n)},n.prototype.hk=function(t){return+this.delete(t)},n.prototype.Wh=function(t,n){var r=this;return t&&"function"==typeof t.reduce&&this.length===t.length&&t.reduce(function(t,i){return t&&r.has(i,n)},!0)},n.prototype.toJSON=function(){return this.toArray()},n.prototype.contains=function(t){return this.has(t)},n.prototype.remove=function(t){return this.delete(t)},n.prototype.toggle=function(t){this.has(t)?this.delete(t):this.hiveAdd(t)}},function(t,i,n){t.exports=function s(e,h,o){function u(n,t){if(!h[n]){if(!e[n]){if(a)return a(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=h[n]={exports:{}};e[n][0].call(r.exports,function(t){var i=e[n][1][t];return u(i||t)},r,r.exports,s,e,h,o)}return h[n].exports}for(var a=!1,t=0;t<o.length;t++)u(o[t]);return u}({1:[function(t,i,n){var r=t("./kernel");n.I=r.I;var s=t("./type_binding");n.uk=s.uk;var e=t("./type_binding_scope");n.ak=e.ak},{"./kernel":2,"./type_binding":4,"./type_binding_scope":5}],2:[function(t,i,n){var r=t("./type_binding_scope"),s=t("./lookup"),e=function(){function t(){this.fk=new s.ck}return t.prototype.bind=function(t){this.fk.add(t.lk,t)},t.prototype.vk=function(i){try{this.fk.remove(i)}catch(t){throw new Error("Could not resolve service "+i)}},t.prototype.it=function(){this.fk=new s.ck},t.prototype.resolve=function(t){if(!this.fk.dk(t))return null;var i=this.fk.get(t)[0];if(i.scope===r.ak.Ek&&null!==i.fg)return i.fg;var n=this.pk(i.wk);return i.fg=n},t.prototype.gk=function(t){var i,n,r,s,e,h;return e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,h=/([^\s,]+)/g,i=t.toString().replace(e,""),n=i.indexOf("(")+1,r=i.indexOf(")"),null===(s="function"==typeof Map&&-1!==i.indexOf("class")&&-1===i.indexOf("constructor")?null:i.slice(n,r).match(h))&&(s=[]),s},t.prototype.pk=function(t){var i=this.gk(t);if(0===i.length)return new t;for(var n=[],r=null,s=0;s<i.length;s++){var e=i[s];r=this.resolve(e),n.push(r)}return this.bk(t,n)},t.prototype.bk=function(t,i){return new(Function.prototype.bind.apply(t,[null].concat(i)))},t}();n.I=e},{"./lookup":3,"./type_binding_scope":5}],3:[function(t,i,n){var s=function(t,i){this.key=t,this.value=new Array,this.value.push(i)},r=function(){function t(){this.yk=new Array}return t.prototype.Tk=function(t){for(var i=-1,n=0;n<this.yk.length;n++){var r=this.yk[n];r.key===t&&(i=n)}return i},t.prototype.add=function(t,i){if(null==t)throw new Error("Argument Null");if(null==i)throw new Error("Argument Null");var n=this.Tk(t);if(-1!==n){var r=this.yk[n];r.key===t&&r.value.push(i)}else this.yk.push(new s(t,i))},t.prototype.get=function(t){if(null==t)throw new Error("Argument Null");var i=this.Tk(t);if(-1===i)throw new Error("Key Not Found");var n=this.yk[i];return n.key===t?n.value:void 0},t.prototype.remove=function(t){if(null==t)throw new Error("Argument Null");var i=this.Tk(t);if(-1===i)throw new Error("Key Not Found");this.yk.splice(i,1)},t.prototype.dk=function(t){if(null==t)throw new Error("Argument Null");var i=this.Tk(t);return-1!==i},t}();n.ck=r},{}],4:[function(t,i,n){var r=t("./type_binding_scope"),s=function(t,i,n){if(this.lk=t,this.wk=i,this.fg=null,void 0===n)this.scope=r.ak.mk;else{if(!r.ak[n])throw new Error("Invalid scope type "+n);this.scope=n}};n.uk=s},{"./type_binding_scope":5}],5:[function(t,i,n){var r;!function(t){t[t.mk=0]="Transient",t[t.Ek=1]="Singleton"}(r=r||{}),n.ak=r},{}]},{},[1])(1)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.LoggerTimestamp=!0,s);function s(){}var e=(h.MetricSnapshotLogs=0,h.TrackSnapshotLogs=0,h);function h(){}var o=(u.Framework=r,u.DebugLogs=e,u);function u(){}i.HiveConfig=o,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Framework=o.Framework,window.HiveConfig.DebugLogs=o.DebugLogs)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ok="127.0.0.1",s.nd=8999,s.td=8998,s.Zv=8899,s.Jv=8898,s.Sk="//{0}:{1}/?callback={2}{3}hivePluginId={4}",s.Rk="//{0}:{1}/?callback={2}",s.rd=!0,s.Ik=/((http|https):\/\/(.*):([0-9]*)\/([0-9a-z-]*).ism\/)(.*)/,s._k="2013.1.1",s.Ak="2018.1",s);function s(){}i.zv=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(43),h=n(4);(s=r=i.Nk||(i.Nk={}))[s.off=0]="off",s[s.error=1]="error",s[s.warn=2]="warn",s[s.notice=3]="notice",s[s.info=4]="info",s[s.debug=5]="debug",s[s.trace=6]="trace";var o=(u.prototype.Ck=function(t,i){e.HiveConfig.Framework.HiveDebugLevel&&null!=r[e.HiveConfig.Framework.HiveDebugLevel]?this.level=r[e.HiveConfig.Framework.HiveDebugLevel]:null!=r[t]?this.level=r[t]:console.log("Wrong logging level: "+t,r),this.kk(i)},u.prototype.kk=function(t){var i={log:this.Dk(this.logger.log,r.error,t),error:this.Dk(this.logger.error,r.error,t),warn:this.Dk(this.logger.warn,r.warn,t),notice:this.Dk(this.logger.info,r.notice,t),info:this.Dk(this.logger.info,r.info,t),debug:this.Dk(this.logger.debug,r.debug,t),trace:this.Dk(this.logger.trace,r.trace,t)};t?this.Mk.set(t,i):this.jk=i},u.prototype.Dk=function(t,i,n){if(!(this.level>=i))return function(){};try{return e.HiveConfig.Framework.LoggerTimestamp?n?Function.prototype.bind.call(t,console,"S["+n+"] %s",this.timestamp):Function.prototype.bind.call(t,console,"%s",this.timestamp):n?Function.prototype.bind.call(t,console,"S["+n+"]"):Function.prototype.bind.call(t,console)}catch(t){}},u.prototype.log=function(t){return t?(this.Mk.has(t)||this.Ck(r[this.level],t),this.Mk.get(t)):this.jk},u);function u(){this.timestamp=function(){},this.Mk=new h,this.level=r.debug,this.timestamp.toString=function(){var t=new Date;return"["+(("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)+":"+("00"+t.getUTCMilliseconds()).slice(-3))+"]"},this.logger="undefined"==typeof console?{log:function(){}}:console,this.logger.trace||(this.logger.trace=this.logger.log),this.logger.debug||(this.logger.debug=this.logger.log),this.logger.info||(this.logger.info=this.logger.log),this.logger.warn||(this.logger.warn=this.logger.log),this.logger.error||(this.logger.error=this.logger.log),this.Ck(r[this.level])}i.Pk=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(50),h=n(30),s=n(32),e=(o.prototype.Hk=function(t,i,n){this.SiteId=t,this.CROId=i,this.ContentId=n,this.Lk()},o.prototype.Uk=function(t){for(var i in t)if("SourceURLParams"===i)for(var n in t[i])this[i][n]=t[i][n];else this[i]=t[i];this.Lk()},o.prototype.Fk=function(){var t=this.ContentId+this.SiteId+this.CROId+this.SourceURL,i=new s.sA;i.YO("b6614c3e4cd1d14eed6b39ef2bf6b9a3e3d6dfcd26699d7270d887923bcbf83efb3dadb717c0bafb1d48dce361eb369b7cc46e57405ebfbdd86c3175532fe56cc77f473d345b2cb6feafb5ab0e24f364a3d259f27e4a2fd97468265bddfd3ddd3ac64251db650ca0280af2b2c45e8b1c8f040f2c433ac0a157d2b3fd91517253","010001");var n=s.eA(this.Signature);return i.X_(t,n)},o.prototype.Gk=function(t){this.ticketUrl=t;var i=h.parse(t),n=i.path.split("/").slice(3);if(this.SiteId=n[0],this.CROId=n[1],this.ContentId=n[2],this.xk=n[3],i.query)try{var r=i.query.split("&");for(var s in r){var e=r[s].split(/=(.+)/);this.SourceURLParams[e[0]]=e[1]}}catch(t){}this.Bk=-1<t.indexOf("api-test")},o.prototype.pE=function(){return this.SiteId},o.prototype.wE=function(){return this.CROId},o.prototype.Vk=function(){return this.ContentId},o.prototype.qk=function(){return this.xk},o.prototype.Qk=function(){return this.SourceURL},o.prototype.Wk=function(){if(this.Yk=this.SourceURL,null!=this.SourceURLParams){var t=new Array;for(var i in this.SourceURLParams)t.push(i+"="+this.SourceURLParams[i]);0<t.length&&this.Yk&&(this.Yk+=(0<this.Yk.indexOf("?")?"&":"?")+t.join("&"))}},o.prototype.Lk=function(){this.sessionId=r.Kk()},o.prototype.$k=function(){return this.Yk||this.Wk(),this.Yk},o.prototype.OE=function(){return"["+this.SiteId+"/"+this.CROId+"/"+this.ContentId+"]"},o.prototype.Xk=function(){return[this.SiteId,this.CROId,this.ContentId]},o.prototype.Jk=function(){return this.SourceURL+"-["+this.SiteId+"/"+this.CROId+"/"+this.ContentId+"]"},o.prototype.toString=function(){return this.OE()},o.zk="^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?",o.Zk="CROId",o.tD="SiteId",o.iD="ContentId",o);function o(){this.SourceURLParams={},this.testId=null,this.originalManifest=null}i.Ticket=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(24),o=n(0),r=n(17),s=n(4),e=(u.Zd=function(t,i,n){this.client=t,this.nD=i,this.guid=n},u.rD=function(t,i,n,r,s){var e=new h.Xd;e.app=t||"CustomSnapshot",e.guid=r||this.guid,e.createdAt=o.Framework.time(),e.name=n,e.tags=i||this.nD,e.data="string"==typeof s?JSON.parse(s):s,this.send(e)},u.send=function(t){var i=new r.hl(HiveStreamingServices.GE,2,JSON.stringify(t));this.client&&this.client.UE().send(i)},u.sD=function(t,i,n,r,s,e){try{var h=t+(i?i.join():"")+n+r,o=this.eD.has(h)?this.eD.get(h):[];o.push("string"==typeof s?JSON.parse(s):s),o.length>=e?(this.rD(t,i,n,r,{buffer:o}),this.eD.delete(h)):this.eD.set(h,o)}catch(t){console.log(t)}},u.eD=new s,u);function u(){}i.hD=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.oD=55,s.uD=6e5,s.aD=5,s.fD=10,s.cD=2,s.lD=10,s.vD="dist",s.dD="../scenarios/BrokenUdp",s.ED=null,s.pD=null,s.wD=null,s.gD=!0,s.bD=!0,s.yD=6e4,s);function s(){}i.TD=r;var e=(h.mD="BwEmulation",h);function h(){}i.OD=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a,r,v,s,f=n(59),c=n(4),l=n(26),d=n(0),E=n(5),e=n(9),p=n(33),w=n(10),g=n(1),b=n(2);(r=a=i.SD||(i.SD={}))[r.Rf=0]="PLAYER",r[r.RD=1]="LAN",r[r.ID=2]="SITE",(s=v=v||{})[s.RD=0]="LAN",s[s.ID=1]="SITE",s[s.AS=2]="AS",s[s.Tf=3]="OTHER";var h=function(){this._D=!1,this.fA=null,this.AD=-1,this.ND=0};i.CD=h;var o=(u.prototype.init=function(t){this.logger=d.Framework.resolve(d.Framework.ht.m).log(t.sessionId),this.kD=t.DD,this.MD=t.MD,this.jD=t.jD,this.fg=t.fg,this.pluginId=t.yd.ticket.pluginId,this.PD=t.PD,this.HD=t.HD,this.LD=t.LD,this.UD=t.UD},u.prototype.FD=function(){this.isActive=!0},u.prototype.GD=function(t,i){this.context=t,this.xD=i,this.LD.GD(i)},u.prototype.BD=function(t){return this.VD.has(t)},u.prototype.qD=function(){return this.xD},u.prototype.QD=function(i,t,n){var r=this;try{var s=new f;this.VD.forEach(function(t,i){s.hiveAdd(i)});var e=new f;if(e.hiveAddEach(i.keys()),this.xD.WD()){var h=this.xD.WD().bitrate;if(e.hiveAdd(h),e.forEach(function(t){s.delete(t)}),n){var o=[];s.forEach(function(t){r.VD.has(t)&&r.VD.get(t).YD==a.ID&&(o.push(t),e.hiveAdd(t))}),o.forEach(function(t){s.delete(t)})}var u=new c;e.forEach(function(t){r.VD.has(t)&&r.VD.get(t).YD==a.ID?u.set(t,a.ID):u.set(t,i.get(t))}),this.KD(s),this.$D(u,t)}}catch(t){g.ErrorMonitor.lt().logError("Error updating the prefetch sessions",this.loggerId,b.Ws.Ys,t)}},u.prototype.$D=function(t,n){var r=this;t.forEach(function(t,i){0!=i&&r.XD(i,t,n)})},u.prototype.KD=function(t){var i=this;t.forEach(function(t){i.PD.JD(t),i.logger.debug(i.loggerId+"Remove unwanted bitrate "+t),i.VD.delete(t)})},u.prototype.XD=function(t,i,n){this.VD.has(t)?this.zD(t,n):this.VD.has(t)||this.ZD(t,i,n)},u.prototype.zD=function(t,i){try{var n=this.VD.get(t);n.type=i,n.type!=a.ID&&(n.AD=-1),this.PD.tM(t,n)}catch(t){g.ErrorMonitor.lt().logError("Error configuring already existing prefetch sessions",this.loggerId,b.Ws.Ks,t)}},u.prototype.ZD=function(t,i,n){var r=this;try{var s=new h;s.fA=null,s.type=n,s.bitrate=t,s.YD=i,this.VD.set(t,s),this.VD.forEach(function(t,i){r.logger.debug(r.loggerId+"ABT "+i+" S "+a[t.type]+" PREF REASON "+a[t.YD])}),this.PD.tM(t,s)}catch(t){g.ErrorMonitor.lt().logError("Error constructing a new prefetch session",this.loggerId,b.Ws.$s,t)}},u.prototype.iM=function(n){var r=this;if(this.VD.has(n.getBitrate())){var t=this.VD.get(n.getBitrate());0<t.AD&&t.nM&&(t.AD=n.duration-(d.Framework.time()-t.nM)-t.ND,t.ND=50),t.fA=n,this.rM(n.getBitrate()),this.VD.forEach(function(t,i){t&&t.type!=a.Rf&&i!=n.getBitrate()&&r.sM(t,i)})}},u.prototype.eM=function(t){var i=this.VD.keys(),n=i.indexOf(t);return-1!=n&&i.splice(n,1),i},u.prototype.hM=function(t){var n=this;t.forEach(function(t){var i=n.VD.get(t);i&&i.type!=a.Rf&&n.sM(i,i.bitrate)})},u.prototype.sM=function(t,i){if(t.type!=a.Rf){var n=this.xD.WD();if(null!=n){var r=this.xD.oM(n.lA,i,e.wf.bf);null==r?(this.logger.debug(this.loggerId+"PREFETCHING "+i+" MISSING METADATA "),this._D(i)):(t.fA=r,this.rM(r.getBitrate()))}else this.logger.debug(this.loggerId+"PLAYER NOT PLAYING "),this._D(i)}},u.prototype.uM=function(t){var i=this.VD.get(t);i&&i._D&&(null!=i.fA?(this.logger.debug(this.loggerId+"RESTART PREFETCHING ON AVAILABLE METADATA"),i._D=!1,this.rM(i.bitrate)):(i._D=!1,this.sM(i,t)))},u.prototype.aM=function(t){var n=this;t?this.uM(t):this.VD.forEach(function(t,i){n.uM(i)})},u.prototype.rM=function(t){var i=this.xD.WD();if(i){var n=this.VD.get(t);if(n){if(n.fA&&i.getBitrate()==t){var r=this.fM(n.fA.cA(),t);this.PD.setDelta(r)}this.cM(n)}}else g.ErrorMonitor.lt().logError("Error attempting prefetch before having a player request",this.loggerId,b.Ws.Js)},u.prototype.cM=function(t){if(t.fA){var i=this.lM(t.fA);if(null!=i)this.vM(i,t);else{var n=t.bitrate;this.logger.debug(this.loggerId+"PREFETCHING "+n+" STOPPED BECAUSE OF MISSING METADATA "),this.VD.get(n)._D=!0,this._D(n)}}else t._D=!0,this._D(t.bitrate)},u.prototype.vM=function(h,t){var o=this,i=this.dM(h,t.type);if(i.EM)try{this.pM.has(h.jp())&&d.Framework.clearTimeout(this.pM.get(h.jp()));var n=i.type==l.fp.vp,r=1;if(n){var s=Math.max(0,t.AD);r=this.LD.wM(t.type,h.getBitrate(),h.cA(),s)}this.logger.debug(this.loggerId+"PREFETCHING "+h.url+" CDN PREFETCH "+n+" IN "+r+" MSECS");var u=this.VD.get(h.getBitrate());u.fA=h;var e=d.Framework.setTimeout(function(){o.pM.delete(h.jp());var s=new p.HiveRequest(o.pluginId);s.url=h.url,u.nM=d.Framework.time(),o.gM=0;var e=o.MD.bM(s,h,o.context,i.type);e&&(e.Yp=t.type==a.ID||t.type==a.RD,s.onerror=s.onload=function(){if(e.kp()==l.fp.vp&&(!s.status||s.status<200||299<s.status)){var t=o.VD.get(h.getBitrate());s=null;var i=t.fA.duration,n=t.fA.duration+E.ea.Ku._o,r=Math.floor(d.Framework.random()*(n-i))+i;t.AD=r-(d.Framework.time()-t.nM),t.ND=0,o.rM(t.fA.bitrate)}})},r);this.pM.set(h.jp(),e)}catch(t){g.ErrorMonitor.lt().logError("Error requesting for prefetch",this.loggerId,b.Ws.te,t)}},u.prototype.yM=function(){var n=this;this.pM.forEach(function(t,i){n.logger.debug(n.loggerId+"Clearing delayed prefetch timer id "+t),d.Framework.clearTimeout(t),n.pM.delete(i)}),this.isActive=!1},u.prototype._D=function(t){this.VD.has(t)&&(this.VD.get(t)._D=!0,this.xD.TM(t))},u.prototype.lM=function(t){try{var i=this.VD.get(t.getBitrate()),n=t,r=this.mM(n);return r&&r.jp()!=t.jp()?r:r&&r.jp()==i.fA.jp()?t:null}catch(t){return g.ErrorMonitor.lt().logError("Error forwarding to next segment",this.loggerId,b.Ws.zs,t),null}},u.prototype.mM=function(t){if(null==t)return null;var i=this.fg.OM(!0),n=t;if(i)for(;null!=n&&-1!=i.indexOf(n.jp());)if(!(n=this.xD.SM(n)))return n;return n},u.prototype.dM=function(t,i){try{var n=this.RM(t),r=n?l.fp.pp:l.fp.vp,s=!1;s=i!=a.Rf?!this.pM.has(t.jp())||r!=l.fp.vp:r==l.fp.pp;var e=this.xD.IM(),h=this._M(t.cA(),t.getBitrate(),r),o=i==a.ID;return this.logger.debug(this.loggerId+"PREFETCHING "+l.fp[r]+" (LAN LEADER: "+this.PD.AM()+" SITE LEADER: "+o+") CHECKS FOR "+t.jp()+" [HAVES:"+n+" NOTBUFFERING:"+e+" DISTANCE:"+h.valid+"("+h.NM+")]"),{EM:s&&e&&h.valid&&this.isActive,type:r}}catch(t){return g.ErrorMonitor.lt().logError("Error checking if allowed to prefetch",this.loggerId,b.Ws.Zs,t),{EM:!1,type:l.fp.vp}}},u.prototype._M=function(t,i,n){try{var r=this.xD.CM(t,i);return r<=this.xD.kM()?{NM:r,valid:!0}:{NM:r,valid:!1}}catch(t){return g.ErrorMonitor.lt().logError("Error checking the player distance",this.loggerId,b.Ws.ie,t),{NM:0,valid:!1}}},u.prototype.fM=function(t,i){var n=this.xD.WD();if(null==n)return-1;var r=n.cA();return this.xD.DM(r,i,t,i)},u.prototype.RM=function(t){var i=t.jp(),n=t.getDuration(),r=t.cA(),s=t.getBitrate();if(this.kD.contains(i)){var e=this.kD.MM(i),h=this.kD.jM(i);if(h.length>=E.ea.Ku.ko){if(E.ea.Ku.jo){var o=[];o[v.RD]=[],o[v.ID]=[],o[v.AS]=[],o[v.Tf]=[];var u=this.PD.PM(),a=this.PD.HM();h.forEach(function(t){if(t.LM.peerInfo.type!=w.mf.k){var i=t.LM.peerInfo.internalAs;if(0!=u&&i&&u==i)o[v.ID].push(t);else{if(E.ea.Ku.Qo){var n=t.LM.peerInfo.externalAs;if(0!=a&&a===n)return void o[v.AS].push(t)}t.LM.peerInfo.type==w.mf.Of&&o[v.Tf].push(t)}}else o[v.RD].push(t)});var f=null,c=!1,l=!0;return 0<o[v.RD].length&&(c=this.UM?!this.FM(o[v.RD],i):(f=v.RD,!0)),!this.PD.AM()&&this.PD.GM()||0<o[v.ID].length&&(f=v.ID,c=!0),!this.PD.xM()&&this.PD.BM()&&0<o[v.AS].length&&(f=v.AS,c=!0),0<o[v.Tf].length&&(this.PD.VM()||!(this.PD.xM()||this.PD.BM()&&E.ea.Ku.Qo))&&(f=v.Tf,c=!0),c&&f>=E.ea.Ku.Wo&&(l=this.qM(o[f],e,n,r,s)),!(!c||!l||(this.logger.debug("down from "+v[f]+" with haves : "+o[v.RD].length+" "+o[v.ID].length+" "+o[v.AS].length+" "+o[v.Tf].length),0))}return!0}}return!1},u.prototype.qM=function(t,e,h,o,u){var a=this;return t.some(function(t){var i=t.QM();if(0<i){var n=e.size/i,r=a.xD.CM(o,u),s=!1;return r<h?(s=n<=r*E.ea.Ku.Yo,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDistance: "+r*E.ea.Ku.Yo)):(s=n<=h*E.ea.Ku.Yo,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDuration: "+h*E.ea.Ku.Yo)),s}})},u.prototype.FM=function(t,i){try{return this.PD.WM().length>E.ea.Ku.Bo&&(this.PD.YM(),t.length==E.ea.Ku.xo&&t[0].guid==this.PD.KM().uuid&&d.Framework.random()>E.ea.Ku.Vo&&this.gM<E.ea.Ku.qo&&(this.logger.debug("SKIP PREFETCH CYCLE "+this.gM+" TO OFFLOAD LEADER"),this.gM++,!0))}catch(t){return g.ErrorMonitor.lt().logError("Error deciding to offload the leader",this.loggerId,b.Ws.ne,t),!1}},u.prototype.$M=function(t,i){try{t.XM=t.zp.id,t.zp=i,this.logger.debug(this.loggerId+"UPGRADE "+l.fp[t.kp()]+" REQ "+t.Hp+" FOR "+t.Mp.jp()),t.kp()==l.fp.pp?(t.Vp.p2pAgenTrafficSuccessQt=t.Jp,t.Kp?(t.type=l.fp.Ep,this.jD.JM(t)||(this.logger.debug(this.loggerId+"SET REQUEST TIMED-OUT WAS 0. CDN COMPENSATION"),this.jD.zM(t.ZM,"TIMED-OUT"))):(t.type=l.fp.cp,this.logger.debug(this.loggerId+"THE HIVE REQ "+t.jp()+" ARRIVED BEFORE THE P2P_PREFETCH INITIALIZED. CHANGE REQUEST TYPE TO "+l.fp[t.kp()]))):t.kp()==l.fp.vp&&(t.type=l.fp.cp)}catch(t){g.ErrorMonitor.lt().logError("Error upgrading prefetch",this.loggerId,b.Ws.re,t)}},u);function u(){this.loggerId="[Prefetcher] ",this.UM=!0,this.gM=0,this.isActive=!0,this.pM=new c,this.VD=new c}i.tj=o},function(t,i,n){var r=n(103),s=n(104),e=s;e.ij=r,e.Kk=s,t.exports=e},function(t,i,n){"use strict";t.exports=o;n(11);var r=n(12),s=n(70),e=n(13),h=n(40);function o(t,i,n){if(!(this instanceof o))return new o(t,i,n);var r=this.head=new this.Node;(r.next=r).nj=r,this.Kh=i||Object.Wh,this.Xh=n||Function.Yh,this.length=0,this.hiveAddEach(t)}function u(t){this.head=t,this.rj=t.next}function a(t){this.value=t,this.nj=null,this.next=null}o.sj=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,s.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.Xh)},o.prototype.find=function(t,i,n){i=i||this.Kh;for(var r=this.head,s=this.ej(n,r.next);s!==r;){if(i(s.value,t))return s;s=s.next}},o.prototype.findLast=function(t,i,n){i=i||this.Kh;for(var r=this.head,s=this.ej(n,r.nj);s!==r;){if(i(s.value,t))return s;s=s.nj}},o.prototype.has=function(t,i){return!!this.find(t,i)},o.prototype.get=function(t,i){var n=this.find(t,i);return n?n.value:this.Xh(t)},o.prototype.delete=function(t,i){var n=this.findLast(t,i);if(n){if(this.$C){var r=[],s=[t];this.tk(r,s,n.index)}return n.delete(),this.length--,this.$C&&(this.hj(n.next,n.index),this.JC(r,s,n.index)),!0}return!1},o.prototype.hk=function(t,i){i=i||this.Kh;for(var n=this.head,r=n.next,s=0;r!==n;)i(t,r.value)&&(r.delete(),s++),r=r.next;return this.length-=s,s},o.prototype.clear=function(){var t,i;this.$C&&(i=this.toArray(),t=[],this.tk(t,i,0)),this.head.next=this.head.nj=this.head,this.length=0,this.$C&&this.JC(t,i,0)},o.prototype.hiveAdd=function(t){var i=new this.Node(t);return this.$C&&(i.index=this.length,this.tk([t],[],i.index)),this.head.oj(i),this.length++,this.$C&&this.JC([t],[],i.index),!0},o.prototype.push=function(){var t=this.head;if(this.$C){var i=Array.prototype.slice.call(arguments),n=[],r=this.length;this.tk(i,n,r);var s=this.head.nj}for(var e=0;e<arguments.length;e++){var h=arguments[e],o=new this.Node(h);t.oj(o)}this.length+=arguments.length,this.$C&&(this.hj(s.next,void 0===s.index?0:s.index+1),this.JC(i,n,r))},o.prototype.unshift=function(){if(this.$C){var t=Array.prototype.slice.call(arguments),i=[];this.tk(t,i,0)}for(var n=this.head,r=0;r<arguments.length;r++){var s=arguments[r],e=new this.Node(s);n.uj(e),n=e}this.length+=arguments.length,this.$C&&(this.hj(this.head.next,0),this.JC(t,i,0))},o.prototype.pop=function(){var t,i=this.head;if(i.nj!==i){if(t=i.nj.value,this.$C){var n=[],r=[t],s=this.length-1;this.tk(n,r,s)}i.nj.delete(),this.length--,this.$C&&this.JC(n,r,s)}return t},o.prototype.shift=function(){var t,i=this.head;if(i.nj!==i){if(t=i.next.value,this.$C){var n=[],r=[t];this.tk(n,r,0)}i.next.delete(),this.length--,this.$C&&(this.hj(this.head.next,0),this.JC(n,r,0))}return t},o.prototype.aj=function(){if(this.head!==this.head.next)return this.head.next.value},o.prototype.fj=function(t){this.head!==this.head.next?this.head.next.value=t:this.push(t)},o.prototype.xf=function(){return this.aj()},o.prototype.ej=function(t,i){var n=this.head;if("number"!=typeof t)return t||i;var r=t;if(0<=r)for(t=n.next;r&&(r--,(t=t.next)!=n););else for(t=n;r<0&&(r++,(t=t.nj)!=n););return t},o.prototype.slice=function(t,i){var n=[],r=this.head;for(t=this.ej(t,r.next),i=this.ej(i,r);t!==i&&t!==r;)n.push(t.value),t=t.next;return n},o.prototype.splice=function(t,i){return this.cj(t,i,Array.prototype.slice.call(arguments,2))},o.prototype.cj=function(t,i,n){var r=t;t=this.ej(t,this.head),null==i&&(i=1/0),n=Array.from(n);for(var s,e,h=[],o=t;i--&&0<=i&&o!==this.head;)h.push(o.value),o=o.next;this.$C&&(s=t===this.head?this.length:t.nj===this.head?0:t.index,e=t.nj,this.tk(n,h,s));o=t;var u=0;for(o=t;u<h.length;u++,o=o.next)o.delete();null==r&&o===this.head&&(o=this.head.next);for(u=0;u<n.length;u++){var a=new this.Node(n[u]);o.oj(a)}return this.length+=n.length-h.length,this.$C&&(t===this.head?this.hj(this.head.next,0):this.hj(e.next,e.index+1),this.JC(n,h,s)),h},o.prototype.reverse=function(){if(this.$C){var t=this.toArray(),i=t.reversed();this.tk(i,t,0)}var n=this.head;do{var r=n.next;n.next=n.nj,n.nj=r,n=n.next}while(n!==this.head);return this.$C&&this.JC(i,t,0),this},o.prototype.sort=function(){this.cj(0,this.length,this.Ff())},o.prototype.reduce=function(t,i){for(var n=arguments[2],r=this.head,s=r.next;s!==r;)i=t.call(n,i,s.value,s,this),s=s.next;return i},o.prototype.reduceRight=function(t,i){for(var n=arguments[2],r=this.head,s=r.nj;s!==r;)i=t.call(n,i,s.value,s,this),s=s.nj;return i},o.prototype.hj=function(t,i){for(;t!==this.head;)t.index=i++,t=t.next},o.prototype.tc=function(){this.head.index=-1,this.hj(this.head.next,0),this.$C=!0},o.prototype.Bf=function(){return new u(this.head)},u.prototype.lj=null,Object.defineProperty(u.prototype,"vj",{get:function(){return this.lj||(this.lj={done:!1,value:null})}}),u.prototype.next=function(){if(this.rj===this.head)this.vj.done=!0,this.vj.value=void 0;else{var t=this.rj.value;this.rj=this.rj.next,this.vj.value=t}return this.vj},(o.prototype.Node=a).prototype.delete=function(){this.nj.next=this.next,this.next.nj=this.nj},a.prototype.oj=function(t){var i=this.nj;(((this.nj=t).nj=i).next=t).next=this},a.prototype.uj=function(t){var i=this.next;(((this.next=t).next=i).nj=t).nj=this}},function(t,i,n){"use strict";n(11);var r=n(12),s=n(53),e=n(13);function h(t,i){if(!(this instanceof h))return new h(t,i);i=i||Function.Yh,this.Xh=i,this.store=Object.create(null),this.length=0,this.hiveAddEach(t)}(t.exports=h).dj=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.zh=function(t){return new this.constructor(t,this.Xh)},h.prototype.Ej=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t)},Object.defineProperty(h.prototype,"pj",{writable:!0}),Object.defineProperty(h.prototype,"wj",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this.gj}}),Object.defineProperty(h.prototype,"gj",{get:function(){return this.pj},set:function(t){this.pj=t}}),h.prototype.get=function(t,i){return this.Ej(t),"__proto__"===t?this.wj?this.gj:1<arguments.length?i:this.Xh(t):t in this.store?this.store[t]:1<arguments.length?i:this.Xh(t)},h.prototype.set=function(t,i){this.Ej(t);var n="__proto__"===t;return(n?this.wj:t in this.store)?(this.bj&&this.yj(t,n?this.gj:this.store[t]),n?this.gj=i:this.store[t]=i,this.bj&&this.Tj(t,i),!1):(this.bj&&this.yj(t,void 0),this.length++,n?this.gj=i:this.store[t]=i,this.bj&&this.Tj(t,i),!0)},h.prototype.has=function(t){return this.Ej(t),"__proto__"===t?this.wj:t in this.store},h.prototype.delete=function(t){return this.Ej(t),"__proto__"===t?!!this.wj&&(this.bj&&this.yj(t,this.gj),this.gj=void 0,this.length--,this.bj&&this.Tj(t,void 0),!0):t in this.store&&(this.bj&&this.yj(t,this.store[t]),delete this.store[t],this.length--,this.bj&&this.Tj(t,void 0),!0)},h.prototype.clear=function(){var t;for(t in this.wj&&(this.bj&&this.yj("__proto__",this.gj),this.gj=void 0,this.bj&&this.Tj("__proto__",void 0)),this.store)this.bj&&this.yj(t,this.store[t]),delete this.store[t],this.bj&&this.Tj(t,void 0);this.length=0},h.prototype.reduce=function(t,i,n){this.wj&&(i=t.call(n,i,"$__proto__","__proto__",this));var r=this.store;for(var s in this.store)i=t.call(n,i,r[s],s,this);return i},h.prototype.reduceRight=function(n,t,r){var s=this,e=this.store;return t=Object.keys(this.store).reduceRight(function(t,i){return n.call(r,t,e[i],i,s)},t),this.wj?n.call(r,t,this.gj,"__proto__",s):t},h.prototype.xf=function(){var t;for(t in this.store)return this.store[t];return this.gj},h.prototype.toJSON=function(){return this.Df()}},function(t,i,n){"use strict";var r=n(38),s=n(106),e=n(13);function h(){throw new Error("Can't construct. GenericMap is a mixin.")}function o(t,i){this.key=t,this.value=i}t.exports=h,r.hiveAddEach(h.prototype,s.prototype),r.hiveAddEach(h.prototype,e.prototype),h.prototype.isMap=!0,h.prototype.hiveAddEach=function(i){if(i&&r(i)===i)if("function"==typeof i.forEach)!0===i.isMap?i.forEach(function(t,i){this.set(i,t)},this):i.forEach(function(t){this.set(t[0],t[1])},this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else r.keys(i).forEach(function(t){this.set(t,i[t])},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},h.prototype.get=function(t,i){var n=this.store.get(new this.mj(t));return n?n.value:1<arguments.length?i:this.Xh(t)},h.prototype.set=function(t,i){var n=new this.mj(t,i),r=this.store.get(n),s=!1;return r?(this.bj&&this.yj(t,r.value),r.value=i):(this.bj&&this.yj(t,void 0),this.store.hiveAdd(n)&&(this.length++,s=!0)),this.bj&&this.Tj(t,i),s},h.prototype.hiveAdd=function(t,i){return this.set(i,t)},h.prototype.has=function(t){return this.store.has(new this.mj(t))},h.prototype.delete=function(t){var i=new this.mj(t);if(this.store.has(i)){var n=this.store.get(i).value;return this.bj&&this.yj(t,n),this.store.delete(i),this.length--,this.bj&&this.Tj(t,void 0),!0}return!1},h.prototype.clear=function(){var t;this.bj&&(this.forEach(function(t,i){this.yj(i,t)},this),t=this.keys()),this.store.clear(),this.length=0,this.bj&&t.forEach(function(t){this.Tj(t)},this)},h.prototype.reduce=function(n,t,r){return this.store.reduce(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.reduceRight=function(n,t,r){return this.store.reduceRight(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.keys=function(){return this.map(function(t,i){return i})},h.prototype.values=function(){return this.map(Function.identity)},h.prototype.entries=function(){return this.map(function(t,i){return[i,t]})},h.prototype.items=function(){return this.entries()},h.prototype.Wh=function(i,n){return n=n||r.Wh,this===i||(i&&"function"==typeof i.every?i.length===this.length&&i.every(function(t,i){return n(this.get(i),t)},this):r.keys(i).length===this.length&&r.keys(i).every(function(t){return n(this.get(t),i[t])},this))},h.prototype.toJSON=function(){return this.entries()},(h.prototype.mj=o).prototype.Wh=function(t){return r.Wh(this.key,t.key)&&r.Wh(this.value,t.value)},o.prototype.compare=function(t){return r.compare(this.key,t.key)}},function(T,m,O){var S;
/*!
 * UAParser.js v0.7.20
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright  2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */
/*!
 * UAParser.js v0.7.20
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright  2012-2019 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */
!function(s,c){"use strict";var t="undefined",i="model",n="name",r="type",e="vendor",h="version",o="architecture",u="console",a="mobile",f="tablet",l="smarttv",v="wearable",d={extend:function(t,i){var n={};for(var r in t)i[r]&&i[r].length%2==0?n[r]=i[r].concat(t[r]):n[r]=t[r];return n},has:function(t,i){return"string"==typeof t&&-1!==i.toLowerCase().indexOf(t.toLowerCase())},Oj:function(t){return t.toLowerCase()},Sj:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:c},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={Rj:function(t,i){for(var n,r,s,e,h,o,u=0;u<i.length&&!h;){var a=i[u],f=i[u+1];for(n=r=0;n<a.length&&!h;)if(h=a[n++].exec(t))for(s=0;s<f.length;s++)o=h[++r],"object"==typeof(e=f[s])&&0<e.length?2==e.length?"function"==typeof e[1]?this[e[0]]=e[1].call(this,o):this[e[0]]=e[1]:3==e.length?"function"!=typeof e[1]||e[1].exec&&e[1].test?this[e[0]]=o?o.replace(e[1],e[2]):c:this[e[0]]=o?e[1].call(this,o,e[2]):c:4==e.length&&(this[e[0]]=o?e[3].call(this,o.replace(e[1],e[2])):c):this[e]=o||c;u+=2}},str:function(t,i){for(var n in i)if("object"==typeof i[n]&&0<i[n].length){for(var r=0;r<i[n].length;r++)if(d.has(i[n][r],t))return"?"===n?c:n}else if(d.has(i[n],t))return"?"===n?c:n;return t}},p={_C:{Ij:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419",Ey:"/"}}},_j:{Aj:{Nj:{Cj:["SD","KF"]}},kj:{Nj:{Dj:"7373KT"},vendor:{Mj:"APA",jj:"Sprint"}}},os:{Pj:{version:{Hj:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",Lj:["NT 5.1","NT 5.2"],Uj:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],Fj:"ARM"}}}},w={_C:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,h],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[n,h],[/(konqueror)\/([\w\.]+)/i],[[n,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],h],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[n,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[n,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[n,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[n,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[n,h],[/(QQ)\/([\d\.]+)/i],[n,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[n,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[n,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[n,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[n,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,h],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],h],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[h,E.str,p._C.Ij.version]],[/(webkit|khtml)\/([\w\.]+)/i],[n,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,h]],Gj:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,d.Oj]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",d.Oj]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,d.Oj]]],_j:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[i,e,[r,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[e,"Apple"],[r,f]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[e,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[e,i,[r,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[i,[e,"Amazon"],[r,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[i,E.str,p._j.Aj.Nj],[e,"Amazon"],[r,a]],[/android.+aft([bms])\sbuild/i],[i,[e,"Amazon"],[r,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,e,[r,a]],[/\((ip[honed|\s\w*]+);/i],[i,[e,"Apple"],[r,a]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[e,i,[r,a]],[/\(bb10;\s(\w+)/i],[i,[e,"BlackBerry"],[r,a]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[i,[e,"Asus"],[r,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[e,"Sony"],[i,"Xperia Tablet"],[r,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[e,"Sony"],[r,a]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[e,i,[r,u]],[/android.+;\s(shield)\sbuild/i],[i,[e,"Nvidia"],[r,u]],[/(playstation\s[34portablevi]+)/i],[i,[e,"Sony"],[r,u]],[/(sprint\s(\w+))/i],[[e,E.str,p._j.kj.vendor],[i,E.str,p._j.kj.Nj],[r,a]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[e,[i,/_/g," "],[r,a]],[/(nexus\s9)/i],[i,[e,"HTC"],[r,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[e,"Huawei"],[r,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[e,i,[r,a]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[e,"Microsoft"],[r,u]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[e,"Microsoft"],[r,a]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[e,"Motorola"],[r,a]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[e,"Motorola"],[r,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[e,d.trim],[i,d.trim],[r,l]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[e,"Samsung"],[r,l]],[/\(dtv[\);].+(aquos)/i],[i,[e,"Sharp"],[r,l]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[e,"Samsung"],i,[r,f]],[/smart-tv.+(samsung)/i],[e,[r,l],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[e,"Samsung"],i,[r,a]],[/sie-(\w*)/i],[i,[e,"Siemens"],[r,a]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[e,"Nokia"],i,[r,a]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[e,"Acer"],[r,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[e,"LG"],[r,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[e,"LG"],i,[r,f]],[/(lg) netcast\.tv/i],[e,i,[r,l]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[e,"LG"],[r,a]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[e,i,[r,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[e,"Lenovo"],[r,f]],[/(lenovo)[_\s-]?([\w-]+)/i],[e,i,[r,a]],[/linux;.+((jolla));/i],[e,i,[r,a]],[/((pebble))app\/[\d\.]+\s/i],[e,i,[r,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[e,i,[r,a]],[/crkey/i],[[i,"Chromecast"],[e,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[e,"Google"],[r,v]],[/android.+;\s(pixel c)[\s)]/i],[i,[e,"Google"],[r,f]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[i,[e,"Google"],[r,a]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,a]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[e,"Meizu"],[r,a]],[/(mz)-([\w-]{2,})/i],[[e,"Meizu"],i,[r,a]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[i,[e,"OnePlus"],[r,a]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[e,"RCA"],[r,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[i,[e,"Dell"],[r,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[e,"Verizon"],[r,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[e,"Barnes & Noble"],i,[r,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[e,"NuVision"],[r,f]],[/android.+;\s(k88)\sbuild/i],[i,[e,"ZTE"],[r,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[e,"Swiss"],[r,a]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[e,"Swiss"],[r,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[e,"Zeki"],[r,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[e,"Dragon Touch"],i,[r,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[i,[e,"Insignia"],[r,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[i,[e,"NextBook"],[r,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[e,"Voice"],i,[r,a]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[e,"LvTel"],i,[r,a]],[/android.+;\s(PH-1)\s/i],[i,[e,"Essential"],[r,a]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[e,"Envizen"],[r,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[e,"MachSpeed"],[r,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[e,"Rotor"],[r,f]],[/android.+(KS(.+))\s+build/i],[i,[e,"Amazon"],[r,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[e,i,[r,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[r,d.Oj],e,i],[/[\s\/\(](smart-?tv)[;\)]/i],[[r,l]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[e,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[n,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[n,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[h,E.str,p.os.Pj.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[h,E.str,p.os.Pj.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[n,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],h],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,h],[/(haiku)\s(\w+)/i],[n,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[n,h]]},g=function(t,i){if("object"==typeof t&&(i=t,t=c),!(this instanceof g))return new g(t,i).xj();var n=t||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:""),r=i?d.extend(w,i):w;return this.Bj=function(){var t={name:c,version:c};return E.Rj.call(t,n,r._C),t.Sj=d.Sj(t.version),t},this.Vj=function(){var t={qj:c};return E.Rj.call(t,n,r.Gj),t},this.Qj=function(){var t={vendor:c,Nj:c,type:c};return E.Rj.call(t,n,r._j),t},this.Wj=function(){var t={name:c,version:c};return E.Rj.call(t,n,r.engine),t},this.yE=function(){var t={name:c,version:c};return E.Rj.call(t,n,r.os),t},this.xj=function(){return{rm:this.Yj(),_C:this.Bj(),engine:this.Wj(),os:this.yE(),_j:this.Qj(),Gj:this.Vj()}},this.Yj=function(){return n},this.bE=function(t){return n=t,this},this};g.VERSION="0.7.20",g.Kj={$j:n,Xj:"major",VERSION:h},g.Jj={zj:o},g.Zj={tP:i,VENDOR:e,iP:r,nP:u,rP:a,sP:l,eP:f,hP:v,oP:"embedded"},g.uP={$j:n,VERSION:h},g.aP={$j:n,VERSION:h},typeof m!=t?(typeof T!=t&&T.exports&&(m=T.exports=g),m.gE=g):(S=function(){return g}.call(m,O,m,T))===c||(T.exports=S);var b=s&&(s.jQuery||s.fP);if(typeof b!=t&&!b.rm){var y=new g;b.rm=y.xj(),b.rm.get=function(){return y.Yj()},b.rm.set=function(t){y.bE(t);var i=y.xj();for(var n in i)b.rm[n]=i[n]}}}("object"==typeof window?window:this)},function(t,A,N){(function(h){var i=Object.getOwnPropertyDescriptors||function(t){for(var i=Object.keys(t),n={},r=0;r<i.length;r++)n[i[r]]=Object.getOwnPropertyDescriptor(t,i[r]);return n},o=/%[sdj%]/g;A.format=function(t){if(!b(t)){for(var i=[],n=0;n<arguments.length;n++)i.push(u(arguments[n]));return i.join(" ")}n=1;for(var r=arguments,s=r.length,e=String(t).replace(o,function(t){if("%%"===t)return"%";if(s<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),h=r[n];n<s;h=r[++n])w(h)||!a(h)?e+=" "+h:e+=" "+u(h);return e},A.cP=function(t,i){if(void 0!==h&&!0===h.lP)return t;if(void 0===h)return function(){return A.cP(t,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(h.vP)throw new Error(i);h.dP?console.trace(i):console.error(i),n=!0}return t.apply(this,arguments)}};var t,r={};function u(t,i){var n={EP:[],pP:e};return 3<=arguments.length&&(n.wP=arguments[2]),4<=arguments.length&&(n.gP=arguments[3]),p(i)?n.bP=i:i&&A.yP(n,i),y(n.bP)&&(n.bP=!1),y(n.wP)&&(n.wP=2),y(n.gP)&&(n.gP=!1),y(n.TP)&&(n.TP=!0),n.gP&&(n.pP=s),l(n,t,n.wP)}function s(t,i){var n=u.mP[i];return n?"["+u.gP[n][0]+"m"+t+"["+u.gP[n][1]+"m":t}function e(t,i){return t}function l(i,n,r){if(i.TP&&n&&S(n.$e)&&n.$e!==A.$e&&(!n.constructor||n.constructor.prototype!==n)){var t=n.$e(r,i);return b(t)||(t=l(i,t,r)),t}var s=function(t,i){if(y(i))return t.pP("undefined","undefined");if(b(i)){var n="'"+JSON.stringify(i).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.pP(n,"string")}if(g(i))return t.pP(""+i,"number");if(p(i))return t.pP(""+i,"boolean");if(w(i))return t.pP("null","null")}(i,n);if(s)return s;var e=Object.keys(n),h=function(t){var n={};return t.forEach(function(t,i){n[t]=!0}),n}(e);if(i.bP&&(e=Object.getOwnPropertyNames(n)),O(n)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return v(n);if(0===e.length){if(S(n)){var o=n.name?": "+n.name:"";return i.pP("[Function"+o+"]","special")}if(T(n))return i.pP(RegExp.prototype.toString.call(n),"regexp");if(m(n))return i.pP(Date.prototype.toString.call(n),"date");if(O(n))return v(n)}var u,a="",f=!1,c=["{","}"];E(n)&&(f=!0,c=["[","]"]),S(n)&&(a=" [Function"+(n.name?": "+n.name:"")+"]");return T(n)&&(a=" "+RegExp.prototype.toString.call(n)),m(n)&&(a=" "+Date.prototype.toUTCString.call(n)),O(n)&&(a=" "+v(n)),0!==e.length||f&&0!=n.length?r<0?T(n)?i.pP(RegExp.prototype.toString.call(n),"regexp"):i.pP("[Object]","special"):(i.EP.push(n),u=f?function(i,n,r,s,t){for(var e=[],h=0,o=n.length;h<o;++h)R(n,String(h))?e.push(d(i,n,r,s,String(h),!0)):e.push("");return t.forEach(function(t){t.match(/^\d+$/)||e.push(d(i,n,r,s,t,!0))}),e}(i,n,r,h,e):e.map(function(t){return d(i,n,r,h,t,f)}),i.EP.pop(),function(t,i,n){if(60<t.reduce(function(t,i){return 0,0<=i.indexOf("\n")&&0,t+i.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===i?"":i+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+i+" "+t.join(", ")+" "+n[1]}(u,a,c)):c[0]+a+c[1]}function v(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,i,n,r,s,e){var h,o,u;if((u=Object.getOwnPropertyDescriptor(i,s)||{value:i[s]}).get?o=u.set?t.pP("[Getter/Setter]","special"):t.pP("[Getter]","special"):u.set&&(o=t.pP("[Setter]","special")),R(r,s)||(h="["+s+"]"),o||(t.EP.indexOf(u.value)<0?-1<(o=w(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")&&(o=e?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.pP("[Circular]","special")),y(h)){if(e&&s.match(/^\d+$/))return o;h=(h=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),t.pP(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.pP(h,"string"))}return h+": "+o}function E(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function w(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function T(t){return a(t)&&"[object RegExp]"===n(t)}function a(t){return"object"==typeof t&&null!==t}function m(t){return a(t)&&"[object Date]"===n(t)}function O(t){return a(t)&&("[object Error]"===n(t)||t instanceof Error)}function S(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function f(t){return t<10?"0"+t.toString(10):t.toString(10)}A.OP=function(i){if(y(t)&&(t=h.Xe.SP||""),i=i.toUpperCase(),!r[i])if(new RegExp("\\b"+i+"\\b","i").test(t)){var n=h.RP;r[i]=function(){var t=A.format.apply(A,arguments);console.error("%s %d: %s",i,n,t)}}else r[i]=function(){};return r[i]},(A.$e=u).gP={bold:[1,22],IP:[3,23],_P:[4,24],inverse:[7,27],AP:[37,39],NP:[90,39],CP:[30,39],blue:[34,39],kP:[36,39],green:[32,39],DP:[35,39],red:[31,39],MP:[33,39]},u.mP={jP:"cyan",number:"yellow",PP:"yellow",undefined:"grey",null:"bold",string:"green",wR:"magenta",HP:"red"},A.isArray=E,A.fm=p,A.lm=w,A.LP=function(t){return null==t},A.vm=g,A.dm=b,A.UP=function(t){return"symbol"==typeof t},A.Em=y,A.FP=T,A.cc=a,A.GP=m,A.xP=O,A.cm=S,A.BP=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},A.isBuffer=N(123);var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}A.log=function(){console.log("%s - %s",function(){var t=new Date,i=[f(t.getHours()),f(t.getMinutes()),f(t.getSeconds())].join(":");return[t.getDate(),c[t.getMonth()],i].join(" ")}(),A.format.apply(A,arguments))},A.Sw=N(124),A.yP=function(t,i){if(!i||!a(i))return t;for(var n=Object.keys(i),r=n.length;r--;)t[n[r]]=i[n[r]];return t};var I="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function _(t,i){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return i(t)}A.VP=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(I&&e[I]){var t;if("function"!=typeof(t=e[I]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var n,r,t=new Promise(function(t,i){n=t,r=i}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,i){t?r(t):n(i)});try{e.apply(this,i)}catch(t){r(t)}return t}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),I&&Object.defineProperty(t,I,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},A.VP.qP=I,A.QP=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");function r(){return n.apply(s,arguments)}var s=this;e.apply(this,t).then(function(t){h.Ve(r,null,t)},function(t){h.Ve(_,t,r)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}}).call(this,N(37))},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(31),s=n(3),e=n(22),h=n(15),o=n(125),u=n(18),a=n(126),f=n(1),c=(l.prototype.getName=function(){return l.WP},l.prototype.id=function(){return"["+l.WP+"] "},l.prototype.getVersion=function(){return this.YP.getPluginVersion()},l.prototype.KP=function(){return!0},l.prototype.$P=function(){return s.resolve(!0)},l.prototype.initSession=function(t,i){var n=this.XP(t,i.ticket,i.ticket.$k(),i);return e.HiveRequestFactory.registerTech(this.YP.getPluginId(),this.getName()),s.resolve(n)},l.prototype.JP=function(){return this.options().initTimeout},l.prototype.isActive=function(t,i,n){var r=i.manifest.toLowerCase().indexOf("/manifest");if(-1<r&&(!n||t===i.manifest)){var s=i.manifest.substring(0,r);if(-1<t.indexOf(s))return!0}else if(t==i.manifest)return!0;return!1},l.prototype.pd=function(t,i,n){void 0===n&&(n=!0),t.yd&&r.Hive.Reporting().ll(t.id)&&(this.YP.logger().debug("[StatsJS] stopping session ["+t.id+"] complete close: "+i),t.yd.Sl.xE(n),t.yd.bl.zP(),t.yd.bl.reset(i)),i?r.Hive.Reporting().close(t.id):this.gl(t,!0)},l.prototype.gl=function(t,i){var n=i?u.ul.IDLE:u.ul.al;this.YP.logger().notice("[HiveComm] client state: "+u.ul[n]),t.yd&&t.yd.gl(n)},l.prototype.ZP=function(t,i){var n=this,r=0;return this.tH<i.totalBuffering&&(r=i.totalBuffering-this.tH,this.tH=i.totalBuffering),t.wd().then(function(){t.yd.pl.iH(r,i.bufferLength),t.yd.wl.uE(i.playingPoint,i.bufferLength,i.totalBuffering),n.nH()}).done(),s.resolve(!0)},l.prototype.rH=function(t,i,n){return t.wd().then(function(){t.yd.wl.fE(t.ticket.sessionId,i,n)}).done(),s.resolve(!0)},l.prototype.lE=function(t,i){return t.wd().then(function(){t.yd.wl.dE([i])}).done(),s.resolve(!0)},l.prototype.onError=function(t){var i=!0;if(null!=this.options().onError)try{i=this.options().onError(t)}catch(t){f.ErrorMonitor.lt().logError("exception in user-defined onError callback",this.id(),t)}return i},l.prototype.onActiveSession=function(r){var s=this;this.sH(),r.wd().then(function(t){s.eH=t;var i=new a.hH(s.YP.isLive(),s.YP.getStreamProtocol(),r.ticket.$k());s.eH.oH=i,s.eH.pl.oH=i,s.YP.updatePlayerInfo(s.eH),s.eH.bl.init(s.eH.pl,r.id),s.YP.options().testId&&s.eH.pl.uH(s.YP.options().testId),s.eH.wl.fd(r.ticket.sessionId,s.YP.getPlayerSource(),200);var n=s.YP.flushTechEvents();if(n&&0<n.length&&s.eH.wl.dE(n),null!=s.options_.onActiveSession)try{s.options_.onActiveSession(r.toHiveSession())}catch(t){f.ErrorMonitor.lt().logError("exception in user-defined onActiveSession callback",s.id(),t)}}).done()},l.prototype.aH=function(){},l.prototype.fH=function(){},l.prototype.cH=function(t){this.YP=t},l.prototype.options=function(){return this.options_},l.prototype.sH=function(){this.tH=0},l.prototype.XP=function(t,i,n,r){var s=new e.HiveSessionInternal(t,i,n,r);return s.lH=!1,s.id=i.sessionId,s},l.prototype.nH=function(){try{var t=this.YP.getExtendedStats();null!=t&&(this.eH.pl.vH.metrics.bitrateUpN+=t.getBitrateSwitchUp(),this.eH.pl.vH.metrics.bitrateDwnN+=t.getBitrateSwitchDown(),null!=t.getBandwidth()&&(this.eH.pl.vH.metrics.srcThroughput=t.getBandwidth()),null!=t.getVideoBitrates()&&this.dH(!0,t.getVideoBitrates()),null!=t.getAudioBitrates()&&this.dH(!1,t.getAudioBitrates()))}catch(t){f.ErrorMonitor.lt().logError("Error accounting extended stats",this.id(),t)}},l.prototype.dH=function(s,t){var e=this,h=0,o=0,u=0,a=0;t.forEach(function(t,i){var n=t.success+t.failed;if(h+=n,a+=t.bytes,o+=t.success,u+=t.failed,s){var r=e.eH.pl.EH(Number(i));e.pH(r,n,t.success,t.failed,t.bytes)}});var i=this.eH.pl.wH();this.pH(i,h,o,u,a)},l.prototype.pH=function(t,i,n,r,s){t.srcReqN+=i,t.srcRespN+=n,t.srcRespErrN+=r,t.srcRespQt+=s,t.respFallbackN+=n,t.respFallbackErrN+=r},l.WP="StatsJS",l);function l(t,i){this.YP=t,this.options_=new o.gH,void 0!==i[l.WP]&&h.updateOptions(i[l.WP],this.options_)}i.StatsJS=c},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e=n(58),h=n(137),c=n(9),l=n(35),o=n(33),u=n(0),v=n(1),d=n(2),a=n(138),f=n(147),E=n(6),p=n(87),w=(g.bH=function(t){return this.yH(t)||-1!=t.indexOf(g.TH)},g.yH=function(t){return-1!=t.toLowerCase().indexOf(g.mH.toLowerCase())||-1!=t.toLowerCase().indexOf(g.OH.toLowerCase())},g.SH=function(t,i){var n=i.replace("_definst_/","").match(new RegExp(t.replace(".mpd","")+g.RH));return n&&0<n.length},g.IH=1,g._H=2,g.AH=2e3,g.NH=3e4,g.CH=1e4,g.kH=!0,g.DH=!0,g.MH=500,g.jH=16,g.PH=3,g.HH=10,g.DASH_METADATA_MIN_FRAGMENTS=3,g.mH="(format=mpd-time-csf)",g.OH=".mpd",g.RH="_.*.mpd",g.TH=".m4s",g.LH=".ism/",g);function g(){}i.DASH=w;var b,y=(b=e.UH,s(T,b),T.prototype.YM=function(){return this.ticket},T.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},T.prototype.FH=function(){return this.GH},T.prototype.xH=function(){return this.BH.xH()},T.prototype.isLive=function(){return this.BH.isLive()},T.prototype.VH=function(){return this.qH},T.prototype.Gp=function(t){var i=this.Dp(t);if(i==c.wf.bf||i==c.wf.gf)return!0},T.prototype.Dp=function(i){try{if(w.yH(i))return c.wf.yf;if(this.QH(i))return c.wf.Tf;var t=this.BH.WH(i);return null!=t?t.type:-1!=i.indexOf("audio")?c.wf.gf:c.wf.Tf}catch(t){return v.ErrorMonitor.lt().logError("Error getting the entity type based on a url",this.loggerId,d.Wn.Yn,{detailedError:t,url:i}),c.wf.Tf}},T.prototype.YH=function(i){var t=c.wf.Tf,n=0,r=0,s=0,e=!0,h=!1,o=0;try{if(t=this.Dp(i),this.QH(i))e=!0;else if(t!=c.wf.yf){var u=this.BH.WH(i);if(null!=u){n=u.duration,r=u.bitrate,s=u.id,h=this.Gp(i);var a=this.BH.KH(i)/1e3;o=Math.round(n/a)}else{this.TM(),this.logger.warn("could not extract segment info for "+i);var f=this.BH.$H(i);f?(this.logger.warn("representation is",f),this.logger.warn("representation holds",f.XH.map(function(t,i){return i+" => "+t.id}))):this.logger.warn("no representation found for "+i)}}else e=!1;return new l.wA(i,t,e,s,o,r,h,this.getContextId())}catch(t){return v.ErrorMonitor.lt().logError("Error getting the entity characteristics based on a url",this.loggerId,d.Wn.Kn,{detailedError:t,url:i}),new l.wA(i,c.wf.Tf,!1,0,0,0,!1,this.getContextId())}},T.prototype.SM=function(i){try{var t=i.url,n=this.BH.JH(t);return null!=n?this.YH(n.zH):null}catch(t){return v.ErrorMonitor.lt().logError("Error getting the next entity",this.loggerId,d.Wn.$n,{detailedError:t,url:i.url}),null}},T.prototype.IM=function(){return b.prototype.ZH.call(this,w.IH,w._H)},T.prototype.tL=function(i){try{var t=i.url,n=E.La.Ca(t);return E.La.Ca(this.BH.iL),n===E.La.Ca(this.GH)||!(null==this.BH||!this.BH.QH(t))||!(w.yH(t)&&this.BH.iL!==t&&!w.SH(this.BH.iL,t))}catch(t){return v.ErrorMonitor.lt().logError("Error identifying if is current context",this.loggerId,d.Wn.Xn,{detailedError:t,url:i.url}),!1}},T.prototype.nL=function(i){try{this.rL=u.Framework.time();var t=i.sL,n=i.zp.url,r=this.BH.parse(n,t,i.zp.internal);this.hL.eL(),i.zp.responseText=r,i.zp.response=r,this.oL()}catch(t){v.ErrorMonitor.lt().logError("Error parsing received metadata",this.loggerId,d.Wn.Jn,{detailedError:t,url:i.zp.url}),i.sL&&(i.zp.responseText=i.sL,i.zp.response=i.sL)}try{this.uL.aM()}catch(t){v.ErrorMonitor.lt().logError("Error starting prefetcher after fetching metadata",this.loggerId,d.Wn.zn,{detailedError:t,url:i.zp.url})}this.aL()},T.prototype.fL=function(i){var n=this;try{b.prototype.fL.call(this,i),i.Dp()!==c.wf.bf&&i.Dp()!==c.wf.gf||(i.Dp()===c.wf.bf&&this.qH.cL(i),this.BH.fL(i).then(function(t){t&&n.aL(),i.Dp()==c.wf.bf&&n.uL.iM(i.Mp)}).done())}catch(t){v.ErrorMonitor.lt().logError("Error when received a fragment",this.loggerId,d.Wn.Zn,t)}},T.prototype.getContextId=function(){return this.ticket.Jk()},T.prototype.lL=function(t,i){var n=t;return n.vL=u.Framework.time(),b.prototype.lL.call(this,n,i)},T.prototype.DM=function(t,i,n,r){return this.BH.DM(t,i,n,r)},T.prototype.QH=function(t){return this.BH.QH(t)},T.prototype.aL=function(){var n=this;try{this.BH.dL?this.BH.dL.EL().then(function(t){if(t)n.pL=!0,n.logger.debug("Protection evaluation: can decrypt");else{var i="Protection evaluation: cannot decrypt ["+(w.kH?"error":"disabled")+"]";w.DH?(n.pL=!0,n.logger.debug(i+", metadata prefetch enabled")):n.logger.warn(i+", metadata prefetch DISABLED")}}).done():this.logger.debug("Protection evaluation: not encrypted")}catch(t){if(v.ErrorMonitor.lt().logError("Error evaluating the protection",this.loggerId,d.Wn.tr,t),w.DH){var i="Protection evaluation: cannot decrypt ["+(w.kH?"error":"disabled")+"]";this.pL=!0,this.logger.debug(i+", metadata prefetch enabled")}}},T.prototype.TM=function(){this.pL&&(null==this.wL&&this.BH.isLive()?this.gL():this.logger.debug("DASH PRE-FETCHING METADATA ALREADY SCHEDULED OR NOT LIVE"))},T.prototype.oL=function(){this.pL&&null!=this.wL&&(u.Framework.clearTimeout(this.wL),this.wL=null)},T.prototype.gL=function(){var t=this,i=(null!=this.rL?this.rL:0)+w.AH,n=Math.max(1,i-u.Framework.time()+w.MH);this.logger.debug("DASH PREFETCHING METADATA "+this.BH.iL+" IN "+n),this.wL=u.Framework.setTimeout(function(){t.bL(t.BH.iL,u.Framework.time())},n)},T.prototype.bL=function(t,i){var n=this.rL;if(null==n&&(n=0),i<n&&this.gL(),this.BH&&this.BH.yL)this.wL=null,this.rL=u.Framework.time();else{var r=new o.HiveRequest(this.ticket.pluginId);r.open("GET",t),r.internal=!0,r.send(),this.wL=null,this.rL=u.Framework.time()}},T.prototype.TL=function(t){this.BH.authenticationToken=t},T.prototype.CM=function(t,i){try{var n=this.WD(),r=this.mL(),s=n.cA(),e=this.BH.DM(s,n.bitrate,t,i),h=u.Framework.time()-r;return Math.max(0,e-h)}catch(t){return v.ErrorMonitor.lt().logError("Error calculating the distance duration",this.loggerId,d.Wn.ir,t),0}},T.prototype.OL=function(t,i){return this.BH.OL(t,i)},T.prototype.SL=function(){return w.CH},T.prototype.oM=function(t,i,n){var r=this.BH.RL(t,i);return null!=r?new l.wA(r.zH,n,!0,t,r.duration,i,!0,this.getContextId()):null},T.prototype.kM=function(){return w.NH},T);function T(t,i,n){var r=b.call(this,i)||this;return r.Kv=0,r.pL=!0,r.loggerId="[Dash Context] ",r.ticket=t,r.GH=t.$k(),r.qH=new h.IL(i.PD),0<r.GH.indexOf(w.OH)?r.BH=new a._L(i.sessionId,n):r.BH=new f.AL(i.sessionId,n),r.hL=new p.NL(r.BH),r}i.CL=y},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(34),e=n(35),h=n(0),a=n(135),s=n(9),u=n(26),f=n(49),o=n(5),d=n(2),E=n(1),c=(l.prototype.YM=function(){return null},l.prototype.kL=function(){return this.uL},l.prototype.ZH=function(t,i){try{var n=0,r=0;if(this.DL.length<i)return!0;for(var s=this.DL.keys().reverse(),e=s[0],h=this.DL.get(e).bitrate,o=s.slice(1),u=0;u<o.length;u++){var a=o[u],f=this.DL.get(a),c=f.vL,l=f.bitrate,v=Math.abs(f.vL-e);if(l!=h)return!1;if(v<t){if(++r>=i)return!1}else{if(++n>i)return!0;r=Math.max(0,r-1),e=c,h=l}}return!1}catch(t){return E.ErrorMonitor.lt().logError("Error calculating if the player is in buffering mode",this.ML,d.Mr.jr,t),!1}},l.prototype.getContextId=function(){return null},l.prototype.lL=function(t,i){if(this.jL(i)){var n=this.WD();if(n){var r=t.getBitrate(),s=n.getBitrate();s<r?this.HL.PL(!0):r<s&&this.HL.PL(!1)}else this.HL.PL(!0);if(this.DL.length>o.ea.$u.Ko){var e=this.DL.keys()[0];this.DL.delete(e)}this.DL.set(h.Framework.time(),t)}return this.LL(t,i)},l.prototype.LL=function(t,i){var n=new a.UL;try{if(this.uL.BD(t.bitrate)){if(this.GL.FL(t.jp())){n.xL=!0;var r=this.GL.BL(t.jp());this.VL(i,r,n)}if(this.GL.qL(t.jp()))for(var s=this.GL.QL(t.jp()),e=0,h=s;e<h.length;e++){var o=h[e];this.VL(i,o.kp(),n),n.WL=!0}}else{var u=f.SD.Rf;this.PD.AM()&&(u=f.SD.RD),this.uL.XD(t.bitrate,u,u)}return n}catch(t){return E.ErrorMonitor.lt().logError("Error configuring the request directive",this.ML,d.Mr.Pr,t),new a.UL}},l.prototype.VL=function(t,i,n){t!=u.fp.vp&&t!=u.fp.pp||i!=u.fp.cp&&i!=u.fp.pp&&i!=u.fp.vp||(n.YL=!0)},l.prototype.jL=function(t){return t!=u.fp.pp&&t!=u.fp.vp},l.prototype.KL=function(t,i,n){var r=[];try{for(var s=this.GL.QL(i.jp()),e=0,h=s;e<h.length;e++){var o=h[e];o.kp()!=u.fp.cp&&(this.uL.$M(o,t),r.push(o.XM))}return r}catch(t){return E.ErrorMonitor.lt().logError("Error attempting to upgrade prefetch",this.ML,d.Mr.Hr,t),[]}},l.prototype.$L=function(t){this.GL.$L(t)},l.prototype.XL=function(t,i){this.GL.XL(t,i)},l.prototype.JL=function(t){this.GL.JL(t)},l.prototype.zL=function(t){this.GL.ZL(t)},l.prototype.tU=function(t){this.GL.iU()||this.uL.rM(t)},l.prototype.WD=function(){var t=this.DL.keys();return 0<t.length?this.DL.get(t[t.length-1]):null},l.prototype.mL=function(){var t=this.DL.keys();if(0<t.length)return t[t.length-1]},l.prototype.nU=function(t){var i=this.rU(t);null!=i&&this.tU(i.bitrate)},l.prototype.rU=function(t){var i=t.fragmentId,n=i.slice(0,i.lastIndexOf("-")),r=n.slice(0,n.lastIndexOf("-")),s=t.getType();return new e.wA(r,s,!0,t.id,t.duration,t.bitrate,!0,this.getContextId())},l.prototype.fL=function(t){t.Dp()===s.wf.bf&&this.XL(t.jp(),t.Pp())},l);function l(t){this.ML="[VideoContext] ",this.DL=new r,this.logger=h.Framework.resolve(h.Framework.ht.m).log(t.sessionId),this.PD=t.PD,this.HL=t.sU,this.GL=t.GL,this.uL=t.eU,this.uL.GD(this,this)}i.UH=c},function(t,i,n){"use strict";t.exports=h;n(11);var s=n(136),r=n(41),e=n(13);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);s.call(this,t,i,n,r)}((h.SortedArraySet=h).prototype=Object.create(s.prototype)).constructor=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.hU=!0,h.prototype.hiveAdd=function(t){return!this.has(t)&&(s.prototype.hiveAdd.call(this,t),!0)},h.prototype.reduce=function(r,t){var s=this,e=arguments[2];return this.bS.reduce(function(t,i,n){return r.call(e,t,i,n,s)},t)},h.prototype.reduceRight=function(r,t){var s=this,e=arguments[2];return this.bS.reduceRight(function(t,i,n){return r.call(e,t,i,n,s)},t)}},function(t,i,n){var O=n(28),S=window.hive;void 0===S&&(S=window.hive={}),void 0===S.services&&(S.services={}),void 0===S.services.protocol&&(S.services.protocol={}),void 0===S.services.protocol.oU&&(S.services.protocol.oU={}),S.services.protocol.oU.Sf={1:"PLAYER",Rf:1,2:"P2P_AGENT",If:2,3:"PREFETCHER_FIRST_TIER",_f:3,4:"PREFETCHER_SECOND_TIER",Af:4},S.services.protocol.oU.uU={1:"Global",Global:1,2:"InternalAs",aU:2,3:"ExternalAs",fU:3},S.services.protocol.oU.cU={1:"Internal",lU:1,2:"External",External:2},S.services.protocol.oU.TrackerPeerStreamInfo=function(t){this.state=null,this.bitrate=null,this.delta=null,t&&(void 0!==t.state&&(this.state=t.state),void 0!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.delta&&(this.delta=t.delta))},S.services.protocol.oU.TrackerPeerStreamInfo.prototype={},S.services.protocol.oU.TrackerPeerStreamInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.state=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.I32?this.bitrate=t.Vw().value:t.Bw(n);break;case 3:n==O.Type.I32?this.delta=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerPeerStreamInfo.prototype.write=function(t){t.Ww("TrackerPeerStreamInfo"),null!==this.state&&void 0!==this.state&&(t.Yw("state",O.Type.I32,1),t.Xw(this.state),t.$w()),null!==this.bitrate&&void 0!==this.bitrate&&(t.Yw("bitrate",O.Type.I32,2),t.Xw(this.bitrate),t.$w()),null!==this.delta&&void 0!==this.delta&&(t.Yw("delta",O.Type.I32,3),t.Xw(this.delta),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerPeerInfo=function(t){this.guid=null,this.internalAs=null,this.externalAs=null,this.nat=null,this.bandwidth=null,this.watchingBitrate=null,this.privateIp=null,this.publicIp=null,this.streams=null,this.rankValue=null,this.timestamp=null,this.publicIpString=null,this.privateIpString=null,t&&(void 0!==t.guid&&(this.guid=t.guid),void 0!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.nat&&(this.nat=t.nat),void 0!==t.bandwidth&&(this.bandwidth=t.bandwidth),void 0!==t.watchingBitrate&&(this.watchingBitrate=t.watchingBitrate),void 0!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.streams&&(this.streams=t.streams),void 0!==t.rankValue&&(this.rankValue=t.rankValue),void 0!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.publicIpString&&(this.publicIpString=t.publicIpString),void 0!==t.privateIpString&&(this.privateIpString=t.privateIpString))},S.services.protocol.oU.TrackerPeerInfo.prototype={},S.services.protocol.oU.TrackerPeerInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.STRING?this.guid=t.wb().value:t.Bw(n);break;case 2:n==O.Type.I32?this.internalAs=t.Vw().value:t.Bw(n);break;case 3:n==O.Type.I32?this.externalAs=t.Vw().value:t.Bw(n);break;case 4:n==O.Type.I32?this.nat=t.Vw().value:t.Bw(n);break;case 5:n==O.Type.I32?this.bandwidth=t.Vw().value:t.Bw(n);break;case 6:n==O.Type.I32?this.watchingBitrate=t.Vw().value:t.Bw(n);break;case 7:n==O.Type.STRUCT?(this.privateIp=new InetAddress,this.privateIp.read(t)):t.Bw(n);break;case 8:n==O.Type.STRUCT?(this.publicIp=new InetAddress,this.publicIp.read(t)):t.Bw(n);break;case 9:if(n==O.Type.LIST){var s,e;this.streams=[];(e=t.hb()).ob,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new S.services.protocol.oU.TrackerPeerStreamInfo).read(t),this.streams.push(o)}t.ub()}else t.Bw(n);break;case 10:n==O.Type.DOUBLE?this.rankValue=t.pb().value:t.Bw(n);break;case 11:n==O.Type.I64?this.timestamp=t.Eb().value:t.Bw(n);break;case 12:n==O.Type.STRING?this.publicIpString=t.xw().value:t.Bw(n);break;case 13:n==O.Type.STRING?this.privateIpString=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerPeerInfo.prototype.write=function(t){if(t.Ww("TrackerPeerInfo"),null!==this.guid&&void 0!==this.guid&&(t.Yw("guid",O.Type.STRING,1),t.$g(this.guid),t.$w()),null!==this.internalAs&&void 0!==this.internalAs&&(t.Yw("internalAs",O.Type.I32,2),t.Xw(this.internalAs),t.$w()),null!==this.externalAs&&void 0!==this.externalAs&&(t.Yw("externalAs",O.Type.I32,3),t.Xw(this.externalAs),t.$w()),null!==this.nat&&void 0!==this.nat&&(t.Yw("nat",O.Type.I32,4),t.Xw(this.nat),t.$w()),null!==this.bandwidth&&void 0!==this.bandwidth&&(t.Yw("bandwidth",O.Type.I32,5),t.Xw(this.bandwidth),t.$w()),null!==this.watchingBitrate&&void 0!==this.watchingBitrate&&(t.Yw("watchingBitrate",O.Type.I32,6),t.Xw(this.watchingBitrate),t.$w()),null!==this.privateIp&&void 0!==this.privateIp&&(t.Yw("privateIp",O.Type.STRUCT,7),this.privateIp.write(t),t.$w()),null!==this.publicIp&&void 0!==this.publicIp&&(t.Yw("publicIp",O.Type.STRUCT,8),this.publicIp.write(t),t.$w()),null!==this.streams&&void 0!==this.streams){for(var i in t.Yw("streams",O.Type.LIST,9),t.Gg(O.Type.STRUCT,this.streams.length),this.streams)this.streams.hasOwnProperty(i)&&(i=this.streams[i]).write(t);t.xg(),t.$w()}null!==this.rankValue&&void 0!==this.rankValue&&(t.Yw("rankValue",O.Type.DOUBLE,10),t.Kg(this.rankValue),t.$w()),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",O.Type.I64,11),t.Yg(this.timestamp),t.$w()),null!==this.publicIpString&&void 0!==this.publicIpString&&(t.Yw("publicIpString",O.Type.STRING,12),t.Kw(this.publicIpString),t.$w()),null!==this.privateIpString&&void 0!==this.privateIpString&&(t.Yw("privateIpString",O.Type.STRING,13),t.Kw(this.privateIpString),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.CustomerKey=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&(this.customerId=t.customerId))},S.services.protocol.oU.CustomerKey.prototype={},S.services.protocol.oU.CustomerKey.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.STRING?this.partnerId=t.xw().value:t.Bw(n);break;case 2:n==O.Type.STRING?this.customerId=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.CustomerKey.prototype.write=function(t){t.Ww("CustomerKey"),null!==this.partnerId&&void 0!==this.partnerId&&(t.Yw("partnerId",O.Type.STRING,1),t.Kw(this.partnerId),t.$w()),null!==this.customerId&&void 0!==this.customerId&&(t.Yw("customerId",O.Type.STRING,2),t.Kw(this.customerId),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerAsQuery=function(t){this.asType=null,this.asn=null,t&&(void 0!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&(this.asn=t.asn))},S.services.protocol.oU.TrackerAsQuery.prototype={},S.services.protocol.oU.TrackerAsQuery.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.asType=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.I32?this.asn=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerAsQuery.prototype.write=function(t){t.Ww("TrackerAsQuery"),null!==this.asType&&void 0!==this.asType&&(t.Yw("asType",O.Type.I32,1),t.Xw(this.asType),t.$w()),null!==this.asn&&void 0!==this.asn&&(t.Yw("asn",O.Type.I32,2),t.Xw(this.asn),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerBitrateQuery=function(t){this.bitrate=null,this.asn=null,this.streamState=null,t&&(void 0!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&(this.streamState=t.streamState))},S.services.protocol.oU.TrackerBitrateQuery.prototype={},S.services.protocol.oU.TrackerBitrateQuery.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.bitrate=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.STRUCT?(this.asn=new S.services.protocol.oU.TrackerAsQuery,this.asn.read(t)):t.Bw(n);break;case 3:n==O.Type.I32?this.streamState=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerBitrateQuery.prototype.write=function(t){t.Ww("TrackerBitrateQuery"),null!==this.bitrate&&void 0!==this.bitrate&&(t.Yw("bitrate",O.Type.I32,1),t.Xw(this.bitrate),t.$w()),null!==this.asn&&void 0!==this.asn&&(t.Yw("asn",O.Type.STRUCT,2),this.asn.write(t),t.$w()),null!==this.streamState&&void 0!==this.streamState&&(t.Yw("streamState",O.Type.I32,3),t.Xw(this.streamState),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerRankQuery=function(t){this.rankType=null,this.asQuery=null,t&&(void 0!==t.rankType&&(this.rankType=t.rankType),void 0!==t.asQuery&&(this.asQuery=t.asQuery))},S.services.protocol.oU.TrackerRankQuery.prototype={},S.services.protocol.oU.TrackerRankQuery.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.rankType=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.STRUCT?(this.asQuery=new S.services.protocol.oU.TrackerAsQuery,this.asQuery.read(t)):t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerRankQuery.prototype.write=function(t){t.Ww("TrackerRankQuery"),null!==this.rankType&&void 0!==this.rankType&&(t.Yw("rankType",O.Type.I32,1),t.Xw(this.rankType),t.$w()),null!==this.asQuery&&void 0!==this.asQuery&&(t.Yw("asQuery",O.Type.STRUCT,2),this.asQuery.write(t),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerQuery=function(t){this.random=null,this.asns=null,this.watchers=null,this.streamers=null,this.rankings=null,t&&(void 0!==t.random&&(this.random=t.random),void 0!==t.asns&&(this.asns=t.asns),void 0!==t.watchers&&(this.watchers=t.watchers),void 0!==t.streamers&&(this.streamers=t.streamers),void 0!==t.rankings&&(this.rankings=t.rankings))},S.services.protocol.oU.TrackerQuery.prototype={},S.services.protocol.oU.TrackerQuery.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.random=t.Vw().value:t.Bw(n);break;case 2:if(n==O.Type.MAP){var s,e;this.asns={};(e=t.nb()).rb,e.sb,s=e.size;for(var h=0;h<s;++h){0<h&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var o,u=null;(u=new S.services.protocol.oU.TrackerAsQuery).read(t),o=t.Vw().value,this.asns[u]=o}t.eb()}else t.Bw(n);break;case 3:if(n==O.Type.MAP){var a,f;this.watchers={};(f=t.nb()).rb,f.sb,a=f.size;for(var c=0;c<a;++c){0<c&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var l,v=null;(v=new S.services.protocol.oU.TrackerBitrateQuery).read(t),l=t.Vw().value,this.watchers[v]=l}t.eb()}else t.Bw(n);break;case 4:if(n==O.Type.MAP){var d,E;this.streamers={};(E=t.nb()).rb,E.sb,d=E.size;for(var p=0;p<d;++p){0<p&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var w,g=null;(g=new S.services.protocol.oU.TrackerBitrateQuery).read(t),w=t.Vw().value,this.streamers[g]=w}t.eb()}else t.Bw(n);break;case 5:if(n==O.Type.LIST){var b,y;this.rankings=[];(y=t.hb()).ob,b=y.size;for(var T=0;T<b;++T){var m;m=t.Vw().value,this.rankings.push(m)}t.ub()}else t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerQuery.prototype.write=function(t){if(t.Ww("TrackerQuery"),null!==this.random&&void 0!==this.random&&(t.Yw("random",O.Type.I32,1),t.Xw(this.random),t.$w()),null!==this.asns&&void 0!==this.asns){t.Yw("asns",O.Type.MAP,2),t.Ug(O.Type.STRUCT,O.Type.I32,O.Ow(this.asns));for(var i=0;i<this.asns.length;i++){var n=(h=this.asns[i]).key,r=h.value;n.write(t),t.Xw(r)}t.Fg(),t.$w()}if(null!==this.watchers&&void 0!==this.watchers){t.Yw("watchers",O.Type.MAP,3),t.Ug(O.Type.STRUCT,O.Type.I32,O.Ow(this.watchers));for(i=0;i<this.watchers.length;i++){var s=(h=this.watchers[i]).key,e=h.value;s.write(t),t.Xw(e)}t.Fg(),t.$w()}if(null!==this.streamers&&void 0!==this.streamers){t.Yw("streamers",O.Type.MAP,4),t.Ug(O.Type.STRUCT,O.Type.I32,O.Ow(this.streamers));for(i=0;i<this.streamers.length;i++){var h,o=(h=this.streamers[i]).key,u=h.value;o.write(t),t.Xw(u)}t.Fg(),t.$w()}if(null!==this.rankings&&void 0!==this.rankings){for(var a in t.Yw("rankings",O.Type.LIST,5),t.Gg(O.Type.I32,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(a)&&(a=this.rankings[a],t.Xw(a));t.xg(),t.$w()}t.Jw(),t.zw()},S.services.protocol.oU.TrackerPeerRankingKey=function(t){this.rankType=null,this.internalAs=null,this.externalAs=null,t&&(void 0!==t.rankType&&(this.rankType=t.rankType),void 0!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&(this.externalAs=t.externalAs))},S.services.protocol.oU.TrackerPeerRankingKey.prototype={},S.services.protocol.oU.TrackerPeerRankingKey.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.rankType=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.I32?this.internalAs=t.Vw().value:t.Bw(n);break;case 3:n==O.Type.I32?this.externalAs=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerPeerRankingKey.prototype.write=function(t){t.Ww("TrackerPeerRankingKey"),null!==this.rankType&&void 0!==this.rankType&&(t.Yw("rankType",O.Type.I32,1),t.Xw(this.rankType),t.$w()),null!==this.internalAs&&void 0!==this.internalAs&&(t.Yw("internalAs",O.Type.I32,2),t.Xw(this.internalAs),t.$w()),null!==this.externalAs&&void 0!==this.externalAs&&(t.Yw("externalAs",O.Type.I32,3),t.Xw(this.externalAs),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerPeerRanking=function(t){this.key=null,this.ranking=null,this.groupSize=null,this.cumulatedRankValue=null,this.totalOfRankValues=null,t&&(void 0!==t.key&&(this.key=t.key),void 0!==t.ranking&&(this.ranking=t.ranking),void 0!==t.groupSize&&(this.groupSize=t.groupSize),void 0!==t.cumulatedRankValue&&(this.cumulatedRankValue=t.cumulatedRankValue),void 0!==t.totalOfRankValues&&(this.totalOfRankValues=t.totalOfRankValues))},S.services.protocol.oU.TrackerPeerRanking.prototype={},S.services.protocol.oU.TrackerPeerRanking.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.STRUCT?(this.key=new S.services.protocol.oU.TrackerPeerRankingKey,this.key.read(t)):t.Bw(n);break;case 2:n==O.Type.I32?this.ranking=t.Vw().value:t.Bw(n);break;case 3:n==O.Type.I32?this.groupSize=t.Vw().value:t.Bw(n);break;case 4:n==O.Type.DOUBLE?this.cumulatedRankValue=t.pb().value:t.Bw(n);break;case 5:n==O.Type.DOUBLE?this.totalOfRankValues=t.pb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerPeerRanking.prototype.write=function(t){t.Ww("TrackerPeerRanking"),null!==this.key&&void 0!==this.key&&(t.Yw("key",O.Type.STRUCT,1),this.key.write(t),t.$w()),null!==this.ranking&&void 0!==this.ranking&&(t.Yw("ranking",O.Type.I32,2),t.Xw(this.ranking),t.$w()),null!==this.groupSize&&void 0!==this.groupSize&&(t.Yw("groupSize",O.Type.I32,3),t.Xw(this.groupSize),t.$w()),null!==this.cumulatedRankValue&&void 0!==this.cumulatedRankValue&&(t.Yw("cumulatedRankValue",O.Type.DOUBLE,4),t.Kg(this.cumulatedRankValue),t.$w()),null!==this.totalOfRankValues&&void 0!==this.totalOfRankValues&&(t.Yw("totalOfRankValues",O.Type.DOUBLE,5),t.Kg(this.totalOfRankValues),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerRequest=function(t){this.info=null,this.contentId=null,this.query=null,this.streamType=null,this.sessionId=null,this.customerKey=null,t&&(void 0!==t.info&&(this.info=t.info),void 0!==t.contentId&&(this.contentId=t.contentId),void 0!==t.query&&(this.query=t.query),void 0!==t.streamType&&(this.streamType=t.streamType),void 0!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.customerKey&&(this.customerKey=t.customerKey))},S.services.protocol.oU.TrackerRequest.prototype={},S.services.protocol.oU.TrackerRequest.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.STRUCT?(this.info=new S.services.protocol.oU.TrackerPeerInfo,this.info.read(t)):t.Bw(n);break;case 2:n==O.Type.STRING?this.contentId=t.xw().value:t.Bw(n);break;case 3:n==O.Type.STRUCT?(this.query=new S.services.protocol.oU.TrackerQuery,this.query.read(t)):t.Bw(n);break;case 4:n==O.Type.I32?this.streamType=t.Vw().value:t.Bw(n);break;case 5:n==O.Type.STRING?this.sessionId=t.xw().value:t.Bw(n);break;case 6:n==O.Type.STRUCT?(this.customerKey=new S.services.protocol.oU.CustomerKey,this.customerKey.read(t)):t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerRequest.prototype.write=function(t){t.Ww("TrackerRequest"),null!==this.info&&void 0!==this.info&&(t.Yw("info",O.Type.STRUCT,1),this.info.write(t),t.$w()),null!==this.contentId&&void 0!==this.contentId&&(t.Yw("contentId",O.Type.STRING,2),t.Kw(this.contentId),t.$w()),null!==this.query&&void 0!==this.query&&(t.Yw("query",O.Type.STRUCT,3),this.query.write(t),t.$w()),null!==this.streamType&&void 0!==this.streamType&&(t.Yw("streamType",O.Type.I32,4),t.Xw(this.streamType),t.$w()),null!==this.sessionId&&void 0!==this.sessionId&&(t.Yw("sessionId",O.Type.STRING,5),t.Kw(this.sessionId),t.$w()),null!==this.customerKey&&void 0!==this.customerKey&&(t.Yw("customerKey",O.Type.STRUCT,6),this.customerKey.write(t),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.TrackerResponse=function(t){this.infos=null,this.rankings=null,this.peerInfo=null,this.sessionId=null,t&&(void 0!==t.infos&&(this.infos=t.infos),void 0!==t.rankings&&(this.rankings=t.rankings),void 0!==t.peerInfo&&(this.peerInfo=t.peerInfo),void 0!==t.sessionId&&(this.sessionId=t.sessionId))},S.services.protocol.oU.TrackerResponse.prototype={},S.services.protocol.oU.TrackerResponse.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:if(n==O.Type.LIST){var s,e;this.infos=[];(e=t.hb()).ob,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new S.services.protocol.oU.TrackerPeerInfo).read(t),this.infos.push(o)}t.ub()}else t.Bw(n);break;case 2:if(n==O.Type.LIST){var u,a;this.rankings=[];(a=t.hb()).ob,u=a.size;for(var f=0;f<u;++f){var c=null;(c=new S.services.protocol.oU.TrackerPeerRanking).read(t),this.rankings.push(c)}t.ub()}else t.Bw(n);break;case 3:n==O.Type.STRUCT?(this.peerInfo=new S.services.protocol.oU.TrackerPeerInfo,this.peerInfo.read(t)):t.Bw(n);break;case 4:n==O.Type.STRING?this.sessionId=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.TrackerResponse.prototype.write=function(t){if(t.Ww("TrackerResponse"),null!==this.infos&&void 0!==this.infos){for(var i in t.Yw("infos",O.Type.LIST,1),t.Gg(O.Type.STRUCT,this.infos.length),this.infos)this.infos.hasOwnProperty(i)&&(i=this.infos[i]).write(t);t.xg(),t.$w()}if(null!==this.rankings&&void 0!==this.rankings){for(var n in t.Yw("rankings",O.Type.LIST,2),t.Gg(O.Type.STRUCT,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(n)&&(n=this.rankings[n]).write(t);t.xg(),t.$w()}null!==this.peerInfo&&void 0!==this.peerInfo&&(t.Yw("peerInfo",O.Type.STRUCT,3),this.peerInfo.write(t),t.$w()),null!==this.sessionId&&void 0!==this.sessionId&&(t.Yw("sessionId",O.Type.STRING,4),t.Kw(this.sessionId),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.vU=function(t){this.timestamp=null,this.contentId=null,this.asType=null,this.asn=null,this.bitrate=null,this.streamState=null,this.rankType=null,t&&(void 0!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.contentId&&(this.contentId=t.contentId),void 0!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&(this.asn=t.asn),void 0!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.streamState&&(this.streamState=t.streamState),void 0!==t.rankType&&(this.rankType=t.rankType))},S.services.protocol.oU.vU.prototype={},S.services.protocol.oU.vU.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I32?this.timestamp=t.Vw().value:t.Bw(n);break;case 2:n==O.Type.STRING?this.contentId=t.xw().value:t.Bw(n);break;case 3:n==O.Type.I32?this.asType=t.Vw().value:t.Bw(n);break;case 4:n==O.Type.I32?this.asn=t.Vw().value:t.Bw(n);break;case 5:n==O.Type.I32?this.bitrate=t.Vw().value:t.Bw(n);break;case 6:n==O.Type.I32?this.streamState=t.Vw().value:t.Bw(n);break;case 7:n==O.Type.I32?this.rankType=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.vU.prototype.write=function(t){t.Ww("TrackerStoreIndexKey"),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",O.Type.I32,1),t.Xw(this.timestamp),t.$w()),null!==this.contentId&&void 0!==this.contentId&&(t.Yw("contentId",O.Type.STRING,2),t.Kw(this.contentId),t.$w()),null!==this.asType&&void 0!==this.asType&&(t.Yw("asType",O.Type.I32,3),t.Xw(this.asType),t.$w()),null!==this.asn&&void 0!==this.asn&&(t.Yw("asn",O.Type.I32,4),t.Xw(this.asn),t.$w()),null!==this.bitrate&&void 0!==this.bitrate&&(t.Yw("bitrate",O.Type.I32,5),t.Xw(this.bitrate),t.$w()),null!==this.streamState&&void 0!==this.streamState&&(t.Yw("streamState",O.Type.I32,6),t.Xw(this.streamState),t.$w()),null!==this.rankType&&void 0!==this.rankType&&(t.Yw("rankType",O.Type.I32,7),t.Xw(this.rankType),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.dU=function(t){this.guid=null,this.EU=null,this.key=null,t&&(void 0!==t.guid&&(this.guid=t.guid),void 0!==t.EU&&(this.EU=t.EU),void 0!==t.key&&(this.key=t.key))},S.services.protocol.oU.dU.prototype={},S.services.protocol.oU.dU.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.STRING?this.guid=t.wb().value:t.Bw(n);break;case 2:n==O.Type.DOUBLE?this.EU=t.pb().value:t.Bw(n);break;case 3:n==O.Type.STRUCT?(this.key=new S.services.protocol.oU.TrackerPeerRankingKey,this.key.read(t)):t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.dU.prototype.write=function(t){t.Ww("TrackerStoreRankPeer"),null!==this.guid&&void 0!==this.guid&&(t.Yw("guid",O.Type.STRING,1),t.$g(this.guid),t.$w()),null!==this.EU&&void 0!==this.EU&&(t.Yw("rank",O.Type.DOUBLE,2),t.Kg(this.EU),t.$w()),null!==this.key&&void 0!==this.key&&(t.Yw("key",O.Type.STRUCT,3),this.key.write(t),t.$w()),t.Jw(),t.zw()},S.services.protocol.oU.pU=function(t){this.timestamp=null,this.request=null,t&&(void 0!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.request&&(this.request=t.request))},S.services.protocol.oU.pU.prototype={},S.services.protocol.oU.pU.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==O.Type.STOP)break;switch(r){case 1:n==O.Type.I64?this.timestamp=t.Eb().value:t.Bw(n);break;case 2:n==O.Type.STRUCT?(this.request=new S.services.protocol.oU.TrackerRequest,this.request.read(t)):t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},S.services.protocol.oU.pU.prototype.write=function(t){t.Ww("TrackerRequestQueueMessage"),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",O.Type.I64,1),t.Yg(this.timestamp),t.$w()),null!==this.request&&void 0!==this.request&&(t.Yw("request",O.Type.STRUCT,2),this.request.write(t),t.$w()),t.Jw(),t.zw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r,s){this.id=t,this.bitrate=i,this.duration=n,this.uri=r,this.zH=s}i.wU=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),e=(s.prototype.size=function(){var t=this.end-this.start+1;return Number.isInteger(t)||(r.ErrorMonitor.lt().logError("Segment Size is a Float",{size:t}),t=Math.round(t)),0==this.end&&0==this.start?0:t},s.prototype.gU=function(){return 0==this.start&&(this.end==this.total-1||this.end==this.total&&0==this.total)},s.prototype.bU=function(){return this.end==this.total-1||this.end==this.total&&0==this.total},s.prototype.yU=function(t){return t.start<=this.start&&this.start<=t.end},s.prototype.toString=function(){return"R[S="+this.start+",E="+this.end+",T="+this.total+"]"},s);function s(t,i,n){this.start=t,this.end=i,this.total=n}i.TU=e;var h=(o.mU=function(t){return t.split("-")},o.OU=function(t){var i=t.split("=",4),n=i[1].substr(0,i[1].indexOf(",")),r=i[2].substr(0,i[2].indexOf(",")),s=i[3].substr(0,i[3].indexOf("]"));return new e(+n,+r,+s)},o);function o(){}i.SU=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.RU=function(t,i){var n=t._U.IU(!1),r=i._U.IU(!1);return r<n?1:n<r?0:-1},s);function s(){}i.AU=r;var e=(h.RU=function(t,i){var n=t.NU.IU(!1),r=i.NU.IU(!1);return r<n?1:n<r?0:-1},h);function h(){}i.CU=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ok="127.0.0.1",s.kU=11983,s.Sk="//{0}:{1}/proxy/?callback={2}{3}hivePluginId={4}",s.DU="//{0}:{1}/proxy/auth-token?hivePluginId={2}",s.MU="//{0}:{1}/proxy/{2}/session?manifest={3}",s.jU="//{0}:{1}/proxy/{2}/player?req={3}",s.PU="//{0}:{1}/proxy/{2}/info?{3}",s.HU="2018.1",s.LU="",s);function s(){}i.UU=r},function(t,i,u){"use strict";Object.defineProperty(i,"s",{value:!0});var h=u(50),v=u(3),o=u(4),n=u(109);i.FU=n.FU;var a=u(0),f=u(21);i.Options=f.Options,i.UrlConfigurableOptions=f.UrlConfigurableOptions;var c=u(110);i.TechName=c.TechName;var d=u(27);i.HiveSession=d.HiveSession,i.HivePluginReference=d.HivePluginReference,i.HiveSessionError=d.HiveSessionError,i.HiveSessionErrorCode=d.HiveSessionErrorCode,i.MainStatusCode=d.MainStatusCode;var l=u(43),E=u(22);i.HiveRequestFactory=E.HiveRequestFactory,i.HivePlayerExtendedStats=E.HivePlayerExtendedStats,i.HiveSessionInternal=E.HiveSessionInternal;var r=u(15);i.BasicUtils=r;var p=u(15),w=u(112),s=u(24),g=u(113),b=u(8),y=u(115),T=u(56);i.StatsJS=T.StatsJS;var m=u(31),O=u(1),S=u(2),R=u(46);i.Ticket=R.Ticket;var I=u(29),e=u(25),_=u(81),A=u(7);i.ut=A.ut;var N=u(127),C=A.ut.xa,k=A.ut.Fa,D=A.ut.Ua,M=A.ut.Ga;i.Tw=C,(D||M)&&u(14).HiveConfig;var j=(P.prototype.options=function(){return this.options_},P.prototype.logger=function(){return this.GU?this.H.log(this.GU.id):this.H.log()},P.prototype.loggerLevel=function(t){if("string"==typeof t&&this.H.Ck(t),this.logger)return this.H.level},P.prototype.getPluginId=function(){return this.pluginId},P.prototype.getPluginId4Java=function(){return this.xU},P.prototype.getCommVersion=function(){return C},P.prototype.updateCommsForInitSessions=function(){for(var t=0,i=this.initializedSessions;t<i.length;t++){var n=i[t];n.tech.cH(this),"HiveJS"===n.tech.getName()&&n.tech.BU&&n.tech.BU.cH(this)}},P.prototype.VU=function(t){var i=new T.StatsJS(this,t);if(this.qU.set(T.StatsJS.WP,i),D){var n=u(128).HiveJS;this.qU.set(n.WP,new n(this,t,i))}if(M){var r=u(201).HiveJsProxy;this.qU.set(r.WP,new r(this,t,i))}if(k){var s=u(204).HiveJava;this.qU.set(s.WP,new s(this,t))}var e=t.hiveTechOrder;if(!e||e instanceof Array)if(e&&0<e.length)for(var h=e.length;h--;){var o=e[h];"string"!=typeof o||-1==this.QU.indexOf(o)?(console.warn(this.loggerId+'The "'+o+'" Hive tech is undefined'),e.splice(h,1)):"string"==typeof o&&this.qU.has(o)||console.warn(this.loggerId+'The "'+o+'" Hive tech is not enabled on this plugin')}else e=this.QU;else console.warn(this.loggerId+"hiveTechOrder value not accepted. It must be an array of strings"),e=this.QU;t.hiveTechOrder=e},P.prototype.WU=function(){this.videoRepresentationsMap=new o({"qd-v":125e3,"ld-v":25e4,"md-v":5e5,"hd-v":12e5,"hd1-v":2e6,"a1-v":55e4,"b1-v":8e5,"c1-v":1e6,"d1-v":17e5,YU:11e5}),this.audioRepresentationsMap=new o({"qd-a":64e3,"ld-a":128e3,"md-a":256e3,"b1-a":68e3,KU:124e3})},P.prototype.$U=function(){return this.videoRepresentationsMap.concat(this.audioRepresentationsMap)},P.prototype.resolveTicketPromise=function(r){var s=this;this.logger().notice(this.loggerId+"resolving "+r);var i=v.defer();if(!r)return i.reject(d.HiveSessionError.getHiveSessionError("",d.HiveSessionErrorCode.TICKET_ERROR,"No ticket provided.")),i.promise;this.XU(r);var t=this.JU().values();0==t.length&&(O.ErrorMonitor.lt().logError("Error initializing all Techs",this.loggerId,S.be.me),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)));var e,h,o=!1,u=!1,a=0,f=null;return p.gc(function(){return!o&&!u&&a<t.length&&!e},function(){var n=t[a++];return n.fH(),(n.KP()&&!h?s.zU(r,s.options().testId):v.resolve(null)).then(function(t){null!=t&&(h=t);var i=n.JP();return n.initSession(r,h).timeout(i,"["+n.getName()+"] Error: initialization timed out after "+i+"ms").then(function(t){f=t,s.ZU(f,n),o=!0,!n.KP()&&h&&h.wl.reset(),O.ErrorMonitor.lt().yt({sessionId:f.id}),s.logger().notice(s.loggerId+"initializing Session:["+f.id+"] Ticket:"+f.ticket.toString()+" HiveTech:["+f.tech.getName()+"]"),v.resolve(!0)},function(t){t instanceof Error&&(t=new d.HiveTechError(d.aw.dw,t.message),n.aH(t)),t.ticketUrl=r,u=!n.onError(t),s.logger().debug(s.loggerId+"tech "+n.getName()+": "+t.message),v.resolve(!0)})},function(t){e=t,v.resolve(!0)})}).then(function(){e?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TICKET_ERROR,e)):u?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TECH_ERROR)):o?i.resolve(f):(O.ErrorMonitor.lt().logError("Error initializing all Techs",s.loggerId,S.be.me),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)))}).catch(function(t){O.ErrorMonitor.lt().logError("Error resolving ticket promise",s.loggerId,S.be.Te,t),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.GENERIC_ERROR,t.toString()))}).done(),i.promise},P.prototype.authenticate=function(f){var c=this,t=A.ut.Qa?e.DE.kE.tp:e.DE.kE.np;if(!this.tF(f))return v.reject({code:"Init Error",reason:JSON.stringify({code:"C_INVALID_DATA",description:"There are missing data in among the videoId, JWT or manifest lists"})});var l=(new Date).getTime();return p.Tc(t,JSON.stringify(f)).then(function(t){var i=Date.now();c.logger().warn("[Timing] Authentication request to service",i-l);var u=JSON.parse(t);c.logger().debug("Response: ",u),c.options().hiveTechOrder=u.techs;var n=v.defer(),r=c.JU().values(),a=!1,s=0,e=[];return p.gc(function(){return 0<e.length?(n.resolve(e),!1):!a&&s<r.length||(O.ErrorMonitor.lt().logError("Error initializing all Techs",c.loggerId,S.be.me),n.reject({code:"Init Error",reason:JSON.stringify({code:"C_"+d.HiveSessionErrorCode[d.HiveSessionErrorCode.NO_TECH_AVAILABLE],description:"No Tech successfully initialized"})}),!1)},function(){var o=r[s++];if(o.fH(),"HiveJsProxy"!==o.getName())return v.allSettled(u.validated.map(function(t){var h=t.videoId;if(0===f.filter(function(t){return t.videoId===h}).length)return O.ErrorMonitor.lt().logError("No Token found for the specific videoId",c.loggerId,S.be.Oe,{videoId:h}),v.reject(!1);var i=t.manifests;return c.logger().debug("Manifests: ",i),v.allSettled(i.map(function(r){var t,i=o.JP(),s=Date.now();if(o.KP()){var n=new R.Ticket;n.Hk(u.partnerId,u.customerId,u.validated[0].videoId),n.Yk=r.uri,n.VE=l,n.qE=(new Date).getTime(),t=m.Hive.Reporting().initSession(c.pluginId,n,!1,"",u.connectionEndpoint)}else t=v.resolve(null);var e=Date.now();return t.then(function(n){var t=Date.now();return c.logger().warn("[Timing] Init RI for "+o.getName(),t-s),n&&c.updatePlayerInfo(n),o.initSession(u.ticketEndpoint+"/"+r.jwt,n).timeout(i).then(function(t){c.ZU(t,o),a=!0,"HiveJava"===o.getName()&&t.ticket.Hk(u.partnerId,u.customerId,h),!o.KP()&&n&&n.wl.reset(),O.ErrorMonitor.lt().yt({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]"),t.ticket.originalManifest=r.uri;var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-e),t})}).fail(function(t){return t=c.iF(t,o,e),v.reject(t)})})).then(function(t){return c.nF(t,!1)})})).then(function(t){var i=c.nF(t,[],!1);i instanceof Array&&(e=i)});var n=Date.now();return o.rF(c.pluginId,u).then(function(t){c.ZU(t,o),a=!0,e.push(t),O.ErrorMonitor.lt().yt({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]");var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-n),t},function(t){return c.iF(t,o,n)})}).done(),n.promise}).fail(function(t){return c.logger().debug("Authentication Failed",t),v.reject(t)})},P.prototype.iF=function(t,i,n){this.logger().debug(this.loggerId+" init Session failed:",t.message),t instanceof Error&&(t=new d.HiveTechError(d.aw.dw,t.message),i.aH(t)),this.logger().debug(this.loggerId+"tech "+i.getName()+": "+t.message);var r=Date.now();return this.logger().warn("[Timing] Init Tech Failed for "+i.getName(),r-n),t},P.prototype.tF=function(t){return 0!==t.length&&t.every(function(t,i,n){return t.jwt&&t.videoId&&0<t.manifests.length})},P.prototype.nF=function(t,i,n){void 0===n&&(n=!0);for(var r=[],s=0,e=t;s<e.length;s++){var h=e[s];"fulfilled"===h.state&&(n?r.push(h.value):r=r.concat(h.value))}return 0<r.length?r:v.reject(i)},P.prototype.zU=function(i,t){var n=this;return m.Hive.Reporting().initSession(this.pluginId,i,!1,t).then(function(t){return n.logger().debug(n.loggerId+"verified ticket "+i),n.updatePlayerInfo(t),t}).catch(function(t){return v.reject("Ticket not verified, error: "+t.message)})},P.prototype.JU=function(){var t=JSON.parse(JSON.stringify(this.options().hiveTechOrder)),i=new o;for(var n in t)this.qU.has(t[n])&&i.set(t[n],this.qU.get(t[n]));return i},P.prototype.XU=function(t){var i=O.ErrorMonitor.lt();try{var n=new R.Ticket;n.Gk(t),n.pE()&&n.wE()&&n.Vk()?i.setTags([n.pE(),n.wE(),n.Vk()]):i.logError("Ticket not valid, we could not resolve the triple partnerId/CustomerId/ContentId",this.loggerId,S.be.Se,{partnerId:n.pE(),customerId:n.wE(),contentId:n.Vk()})}catch(t){this.logger().warn(this.loggerId+" "+t.message,t),i.notify(t)}},P.prototype.updatePlayerInfo=function(t){var i={commVersion:C,pluginName:this.getPluginName(),pluginVersion:this.getPluginVersion(),playerTech:this.getPlayerTech(),playerVersion:this.getPlayerVersion(),telemetryId:this.getTelemetryId()};t.wl.updatePlayerInfo(i)},P.prototype.onSetupTimeout=function(){window.HiveRequest=XMLHttpRequest,E.HiveRequestFactory.clear(),m.Hive.Reporting().close()},P.prototype.addTechEvent=function(t){this.GU&&this.GU.tech?(t.sessionId=this.GU.id,this.GU.tech.lE(this.GU,t)):this.sF.push(t)},P.prototype.flushTechEvents=function(){var t=this.sF;return this.sF=new Array,t},P.prototype.eF=function(){this.destroyHivePlugin(!1)},P.prototype.hF=function(){var t=window;this.eF=this.eF.bind(this),t.addEventListener?t.addEventListener("beforeunload",this.eF,!1):t.attachEvent("onbeforeunload",this.eF)},P.prototype.oF=function(){var t=window;t.removeEventListener?t.removeEventListener("beforeunload",this.eF,!1):t.detachEvent("onbeforeunload",this.eF)},P.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),this.logger().debug("Manually Closing Session"+(t?" because: "+t:"")),this.aF.uF(),this.fF=null,this.getActiveSession()&&E.HiveRequestFactory.clearPluginState(this.pluginId),this.resetSession(!0,i)},P.prototype.destroyHivePlugin=function(t){return void 0===t&&(t=!0),this.oF(),this.aF.uF(!0),this.closeHiveSession("Invoked Plugin Destroy",t),E.Ud.lt(this.logger()).Hd(),a.Framework.J(),this.options_.onLoadingCompleted=null,this.options_.onSourceSetCompleted=null,this.options_.onActiveSession=null,this.options_.onError=null,O.ErrorMonitor.lt().Rt(),a.Framework.G},P.prototype.resetSession=function(t,i){var n=this;void 0===i&&(i=!0),this.cF(t,i),!1===t?this.GU&&this.initializedSessions.every(function(t){return t.id!==n.GU.id})&&this.initializedSessions.unshift(this.GU):this.initializedSessions.length=0,this.lF(),this.GU=null,this.vF=0,this.dF=0},P.prototype.ZU=function(t,i){t.tech=i,this.initializedSessions.push(t)},P.prototype.onActivateSession=function(t,i){var n=this;if(void 0===i&&(i=!1),null==this.GU){for(var r=t||this.getPlayerSource(),s=0;s<this.initializedSessions.length;s++){var e=this.initializedSessions[s];if(e.isActive(r,i)){if(this.GU=e,this.GU.yd?this.GU.yd.cl.FD(this.GU.ticket):this.EF(),this.GU.tech.onActiveSession(this.GU),this.logger().notice(this.loggerId+"activating Session:["+this.GU.id+"] Ticket:"+this.GU.ticket.toString()+" HiveTech:["+this.GU.tech.getName()+"]"),this.options().onActiveSession)try{this.options().onActiveSession(e.toHiveSession())}catch(t){O.ErrorMonitor.lt().logError(this.loggerId+" exception in user-defined Generic onActiveSession callback: "+t,this.loggerId,S.be.Re)}break}}if(this.GU)return this.initializedSessions.forEach(function(t){t!=n.GU&&t.wd().then(function(t){return t.ml()})}),!(this.initializedSessions.length=0);O.ErrorMonitor.lt().logError("No matching session found",this.loggerId,S.be.ye,{playerSource:r,initializedSessions:this.initializedSessions.map(function(t){return t.manifest})}),this.resetSession()}return!1},P.prototype.getActiveSession=function(){if(this.GU)return this.GU.toHiveSession()},P.prototype.EF=function(){var i=!1;this.initializedSessions.forEach(function(t){t.yd&&(i=!0)}),i&&m.Hive.Reporting().close()},P.prototype.isSessionActive=function(){if(null!=this.GU){if(this.GU.isActive(this.getPlayerSource()))return!0;var t="Session src mismatch: "+this.getPlayerSource()+" != "+this.GU.manifest;this.logger().warn(this.loggerId+t),this.closeHiveSession(t)}return!1},P.prototype.cF=function(t,i){if(void 0===i&&(i=!0),null!=this.GU)this.logger().notice(this.loggerId+"Stopping session ["+this.GU.id+"]"),this.GU.close(t,i);else if(0<this.initializedSessions.length){var n=this.initializedSessions[0];this.logger().notice(this.loggerId+"Attempt to stopping session ["+n.id+"]"),n.close(t,i)}},P.prototype.pF=function(){var t=this;null==this.wF&&(this.wF=setInterval(function(){t.gF()},this.options().feedbackPeriod),this.gF())},P.prototype.lF=function(){clearInterval(this.wF),this.wF=null},P.prototype.gF=function(){var i=this;if(this.isSessionActive()){if(!this.isActive())return void this.resetSession();var t=this.getWindowSize(),n=new E.Id(this.getCurrentTime(),this.getBufferLen(),this.vF,t.width,t.height,this.isFullscreen());this.GU.vd(this.bF.check(n)),this.GU.tech.ZP(this.GU,n).fail(function(t){i.logger().warn(i.loggerId+"stats handling failed",t),i.lF()})}},P.prototype.registerGenericEvents=function(){var n=this;try{E.Ud.lt(this.logger()).Pd(function(t){var i=n.getPotentialSession();i&&!i.Ed()&&(n.onEventFeedback(t?s.PlayerEvents.VISIBLE:s.PlayerEvents.HIDDEN),n.logger().debug(t?"visible":"hidden"))})}catch(t){O.ErrorMonitor.lt().logError("error setting up the visibilityChange listener",this.loggerId,S.be.Ie,{error:t})}},P.prototype.onStartBuffering=function(t,i){void 0===i&&(i=!1),(i||this.isSessionActive())&&this.dF<=0&&(this.dF=Date.now(),null!=t&&!t||this.onEventFeedback(s.PlayerEvents.BUFFERING))},P.prototype.onEndBuffering=function(){var t=0==this.vF;if(0<this.dF){var i=Date.now()-this.dF;return this.vF+=i,this.logger().debug(this.loggerId+"reporting new buffering event of "+i),this.dF=0,t&&this.gF(),!0}return!1},P.prototype.onError=function(t,i,n){void 0===n&&(n=!0),this.onEventFeedback(s.PlayerEvents.ERROR,{code:-1,"player-code":t}),n&&this.closeHiveSession(i)},P.prototype.onEventFeedback=function(t,i){var n=this,r=this.getPotentialSession();null==r||r!=this.GU&&r.tech.getName()===c.yF[c.yF.HiveJava]||r.tech.rH(r,t,i).fail(function(t){n.logger().warn(n.loggerId+"error in forwarding player event to tech",t)})},P.prototype.TF=function(t,i){t!==this.fF&&this.onEventFeedback(t,i),this.fF=t},P.prototype.getPotentialSession=function(){return this.GU?this.GU:this.initializedSessions&&0<this.initializedSessions.length?this.initializedSessions[0]:void 0},P.prototype.initStatusCode=function(){this.mF=0},P.prototype.setStatusCode=function(t,i){this.initStatusCode(),this.mF+=t<<28,i&&0===t&&(this.mF+=1<<4*(6-c.yF[i.getName()])),0<t&&O.ErrorMonitor.lt().logError("Status Code Error",this.loggerId,S.be._e,{code:d.bw(t)},["Plugin Error Code",d.bw(t)])},P.prototype.getStatusCode=function(){return this.mF},P.prototype.getTelemetryId=function(){return this.options().telemetryId},P.logError=function(t,i,n,r){var s=O.ErrorMonitor.lt();s.logError.apply(s,arguments)},P.prototype.registerComm=function(t){_.OF.registerComm(this,t)},P.prototype.getPluginVersion=function(){return A.ut.qa},P);function P(t){this.QU=[c.yF[c.yF.HiveJava],c.yF[c.yF.HiveJsProxy],c.yF[c.yF.HiveJS],c.yF[c.yF.StatsJS]],this.qU=new o,this.sF=new Array,this.initializedSessions=new Array,this.GU=null,this.vF=0,this.dF=0,this.loggerId="[HiveComm] ",this.mF=0,this.videoRepresentationsMap=new o,this.audioRepresentationsMap=new o,this.aF=new N.default(this),this.pluginId=h.Kk(),a.Framework.F("peer0",new g.SF,new y.RF),this.xU=E.Fd.getItem("hivePluginId"),this.xU||(this.xU=Math.abs(Math.floor(68719476736*Math.random())).toString(16),E.Fd.setItem("hivePluginId",this.xU));var i=O.ErrorMonitor.lt(A.ut.qa);this.options_=new f.Options,this.VU(t),this.WU(),p.updateOptions(t,this.options_),p.parseParameterOptions(window.location.href,new f.UrlConfigurableOptions,this.options_),f.hd.sd(this.options_),this.H=a.Framework.resolve(a.Framework.ht.m),l.HiveConfig.Framework.LoggerTimestamp=this.options().loggerTimestamp,this.options().isSDNDebug&&(this.options().debugLevel="debug"),this.H.Ck(this.options().debugLevel),i.bt(this.H.log()),this.options().onError&&i.Ot(this.options().onError);var n=a.Framework.resolve(b.pf.u),r=a.Framework.resolve(b.pf.af);n.Al().then(function(t){i.setUser(t.Dl()),i.yt({reportingGuid:t.Ml()}),i.yt({p2pId:t.Dl()})});var s={};new w.IF(this),r.getConnectivityInfo().then(function(t){s={pIPAddr:t.getNetworkChanged().getPrivateIp()},i.yt({privateIp:s.pIPAddr})}),window.ol=this.H.log(),this.hF(),this.pluginReference=new d.HivePluginReference(this);var e=this.options().idleTimePeriod>this.options().feedbackPeriod?this.options().idleTimePeriod:I.et.Mu;this.bF=new E.Vd(e),this.registerGenericEvents()}i.Plugin=j,"undefined"!=typeof window&&(window.HiveRequestFactory=E.HiveRequestFactory),i._F=S.be,i.PlayerEvents=s.PlayerEvents,i.logError=function(t,i,n,r){var s=O.ErrorMonitor.lt();s.logError.apply(s,arguments)}},function(t,i){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var s=new Array(16);t.exports=function(){for(var t,i=0;i<16;i++)0==(3&i)&&(t=4294967296*Math.random()),s[i]=t>>>((3&i)<<3)&255;return s}}},function(t,i){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);t.exports=function(t,i){var n=i||0,r=s;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}},function(t,i,n){"use strict";n(69);var r=n(12),e=n(70),s=n(39);t.exports=Array;var u=Array.prototype.splice,a=Array.prototype.slice;function h(t,i){Array.prototype[t]||Object.defineProperty(Array.prototype,t,{value:i,writable:!0,configurable:!0,enumerable:!1})}function o(t,i,n){this.bS=t,this.start=null==i?0:i,this.end=n}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=Array.from||function(t){var i=[];return i.hiveAddEach(t),i},Array.Uf=function(t){for(var i=[],n=1/0,r=0;r<t.length;r++){var s=t[r];t[r]=s.toArray(),s.length<n&&(n=s.length)}for(r=0;r<t.length;r++){s=t[r];for(var e=0;e<s.length;e++)e<n&&e in s&&(i[e]=i[e]||[],i[e][r]=s[e])}return i},h("hiveAddEach",r.prototype.hiveAddEach),h("deleteEach",r.prototype.kf),h("toArray",r.prototype.toArray),h("toObject",r.prototype.Df),h("all",r.prototype.all),h("any",r.prototype.kh),h("min",r.prototype.min),h("max",r.prototype.max),h("sum",r.prototype.jf),h("average",r.prototype.Pf),h("only",r.prototype.only),h("flatten",r.prototype.Hf),h("zip",r.prototype.Lf),h("enumerate",r.prototype.enumerate),h("group",r.prototype.group),h("sorted",r.prototype.Ff),h("reversed",r.prototype.reversed),h("constructClone",function(t){var i=new this.constructor;return i.hiveAddEach(t),i}),h("has",function(t,i){return-1!==this.find(t,i)}),h("set",function(t,i){return this[t]=i,!0}),h("hiveAdd",function(t){return this.push(t),!0}),h("delete",function(t,i){var n=this.find(t,i);return-1!==n&&(this.splice(n,1),!0)}),h("deleteAll",function(t,i){i=i||this.Kh||Object.Wh;for(var n=0,r=0;r<this.length;)i(t,this[r])?(this.cj(r,1),n++):r++;return n}),h("find",function(t,i){i=i||this.Kh||Object.Wh;for(var n=0;n<this.length;n++)if(n in this&&i(t,this[n]))return n;return-1}),h("findLast",function(t,i){i=i||this.Kh||Object.Wh;var n=this.length;do{if(--n in this&&i(this[n],t))return n}while(0<n);return-1}),h("swap",function(t,i,n){var r,s,e,h,o;if(t>this.length&&(this.length=t),void 0===n)return void 0!==i?u.call(this,t,i):void 0!==t?u.call(this,t):[];if(r=[t,i],Array.isArray(n)||(n=a.call(n)),e=0,(s=n.length)<1e3){for(;e<s;e++)r[e+2]=n[e];return u.apply(this,r)}for(o=u.apply(this,r);e<s;){for(r=[t+e,0],h=2;h<1002&&e<s;h++,e++)r[h]=n[e];u.apply(this,r)}return o}),h("peek",function(){return this[0]}),h("poke",function(t){0<this.length&&(this[0]=t)}),h("peekBack",function(){if(0<this.length)return this[this.length-1]}),h("pokeBack",function(t){0<this.length&&(this[this.length-1]=t)}),h("one",function(){for(var t in this)if(Object.UC(this,t))return this[t]}),Array.prototype.clear||h("clear",function(){return this.length=0,this}),h("compare",function(t,i){var n,r,s;if(i=i||Object.compare,this===t)return 0;if(!t||!Array.isArray(t))return e.prototype.compare.call(this,t,i);for(r=Math.min(this.length,t.length),n=0;n<r;n++)if(n in this){if(!(n in t))return-1;if(s=i(this[n],t[n]))return s}else if(n in t)return 1;return this.length-t.length}),h("equals",function(t,i){i=i||Object.Wh;var n=0,r=this.length;if(this===t)return!0;if(!t||!Array.isArray(t))return e.prototype.Wh.call(this,t);if(r!==t.length)return!1;for(;n<r;++n)if(n in this){if(!(n in t))return!1;if(!i(this[n],t[n]))return!1}else if(n in t)return!1;return!0}),h("clone",function(t,i){if(null==t)t=1/0;else if(0===t)return this;if((i=i||new s).has(this))return i.get(this);var n=new Array(this.length);for(var r in i.set(this,n),this)n[r]=Object.clone(this[r],t-1,i);return n}),h("iterate",function(t,i){return new o(this,t,i)}),h("Iterator",o),o.prototype.lj=null,Object.defineProperty(o.prototype,"vj",{get:function(){return this.lj||(this.lj={done:!1,value:null})}}),o.prototype.next=function(){return this.start===(null==this.end?this.bS.length:this.end)?(this.vj.done=!0,this.vj.value=void 0):this.vj.value=this.bS[this.start++],this.vj}},function(t,i){t.exports=Function,Function.Yh=function(){},Function.identity=function(t){return t},Function.Gf=function(n,r){r=r||Object.compare,n=n||Function.identity;function t(t,i){return r(n(t),n(i))}return t.compare=r,t.Gf=n,t},Function.get=function(i){return function(t){return Object.get(t,i)}}},function(t,i,n){var e=n(38);function r(){throw new Error("Can't construct. GenericOrder is a mixin.")}(t.exports=r).prototype.Wh=function(t,i){if(i=i||this.Kh||e.Wh,this===t)return!0;if(!t)return!1;return this.length===t.length&&this.Lf(t).every(function(t){return i(t[0],t[1])})},r.prototype.compare=function(t,r){if(r=r||this.Mf||e.compare,this===t)return 0;if(!t)return 1;var s=Math.min(this.length,t.length),i=this.Lf(t).reduce(function(t,i,n){return 0===t?s<=n?t:r(i[0],i[1]):t},0);return 0===i?this.length-t.length:i},r.prototype.toJSON=function(){return this.toArray()}},function(t,i,n){"use strict";n(11);var r=n(51),s=n(107),e=n(12),h=n(41),o=n(13),u=n(40),a=n(108);function f(t,n,i,r){if(!(this instanceof f))return new f(t,n,i,r);n=n||Object.Wh,i=i||Object.hash,r=r||Function.Yh,this.Kh=n,this.$h=i,this.Xh=r,this.order=new this.AF(void 0,n),this.store=new this.NF(void 0,function(t,i){return n(t.value,i.value)},function(t){return i(t.value)}),this.length=0,this.hiveAddEach(t)}(t.exports=f).Set=f,Object.hiveAddEach(f.prototype,e.prototype),Object.hiveAddEach(f.prototype,h.prototype),Object.hiveAddEach(f.prototype,o.prototype),Object.hiveAddEach(f.prototype,u.prototype),Object.defineProperty(f.prototype,"size",e.Jh),f.prototype.AF=r,f.prototype.NF=s,f.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.$h,this.Xh)},f.prototype.has=function(t){var i=new this.order.Node(t);return this.store.has(i)},f.prototype.get=function(t,i){if(i)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(t);return(n=this.store.get(n))?n.value:this.Xh(t)},f.prototype.hiveAdd=function(t){var i=new this.order.Node(t);if(this.store.has(i))return!1;var n=this.length;return this.$C&&this.tk([t],[],n),this.order.hiveAdd(t),i=this.order.head.nj,this.store.hiveAdd(i),this.length++,this.$C&&this.JC([t],[],n),!0},f.prototype.delete=function(t,i){if(i)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(t);return!!this.store.has(n)&&(n=this.store.get(n),this.$C&&this.tk([],[t],n.index),this.store.delete(n),this.order.splice(n,1),this.length--,this.$C&&this.JC([],[t],n.index),!0)},f.prototype.pop=function(){if(this.length){var t=this.order.head.nj.value;return this.delete(t),t}},f.prototype.shift=function(){if(this.length){var t=this.order.head.next.value;return this.delete(t),t}},f.prototype.xf=function(){if(0<this.length)return this.store.xf().value},f.prototype.clear=function(){var t;this.$C&&(t=this.toArray(),this.tk([],t,0)),this.store.clear(),this.order.clear(),this.length=0,this.$C&&this.JC([],t,0)},f.prototype.reduce=function(n,t){var r=arguments[2],i=this.order,s=0;return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},f.prototype.reduceRight=function(n,t){var r=arguments[2],i=this.order,s=this.length-1;return i.reduceRight(function(t,i){return n.call(r,t,i,s--,this)},t,this)},f.prototype.Bf=function(){return this.order.Bf()},f.prototype.values=function(){return new a(this)},f.prototype.log=function(){var t=this.store;return t.log.apply(t,arguments)},f.prototype.tc=function(){this.order.tc()}},function(t,i,n){"use strict";function r(){}(t.exports=r).CF={rk:"+",kF:"-",DF:"+",MF:"+",jF:".",PF:"'",HF:"+",LF:"|"},r.UF={rk:"",kF:"",DF:"",MF:"",jF:"",PF:"",HF:"",LF:""},r.FF={rk:"",kF:"",DF:"",MF:"",jF:"",PF:"",HF:"",LF:""}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(22),r=n(4),h=n(28);n(116),n(117);var c=n(0),s=n(8),e=n(25),o=n(17),u=n(18),a=n(14),l=n(1),v=n(15),d="[SNAP]",E=function(){this.metrics=new hive.snapshots.Metrics,this.GF=new hive.snapshots.Traffic,this.xF=new r,this.BF=new r,this.VF=new r,this.qF=new r,this.player=new hive.snapshots.Player};i.QF=E;var p=(w.prototype.init=function(t,i,n,r){this.logger=c.Framework.resolve(c.Framework.ht.m).log(r),this.SE=c.Framework.resolve(s.pf.af),this.logger.debug(d+" INIT STATS STORE - ID: "+t),this.tE=t,this.ticket=i,this.El(n)},w.prototype.uH=function(t){this.testId=t},w.prototype.WF=function(t){this.YF=t},w.prototype.KF=function(t){this.$F=t},w.prototype.XF=function(t){this.JF=t},w.prototype.El=function(t){this.app=t},w.prototype.zF=function(t){this.PD=t},w.prototype.ZF=function(){this.tG=new E,this.tE=null,this.ticket=null,this.reset()},w.prototype.reset=function(){this.vH=new E,this.iG(this.vH.GF),this.nG(this.vH),this.rG.source=[]},w.prototype.iG=function(t){t.reqN=0,t.respFallbackN=0,t.respFallbackErrN=0,t.respP2pN=0,t.reqOtherN=0,t.respFallbackOtherN=0,t.respFallbackOthertErrN=0,t.srcReqN=0,t.srcRespN=0,t.srcRespErrN=0,t.srcReqQt=0,t.srcRespQt=0,t.srcOverQt=0,t.srcOtherReqN=0,t.srcOtherRespN=0,t.srcOtherRespErrN=0,t.srcOtherReqQt=0,t.srcOtherRespQt=0,t.srcOtherOverQt=0,t.p2pSubReqN=0,t.p2pSubRespN=0,t.p2pSubRespPartN=0,t.p2pSubRespErrN=0,t.p2pSubRespExpN=0,t.p2pSubReqQt=0,t.p2pSubRespQt=0,t.p2pDirectQt=0,t.p2pRelayQt=0,t.p2pNatQt=0,t.p2pUdpbQt=0,t.fallAgentRespN=0,t.fallAgentPredHitN=0,t.fallAgentFailedRespN=0,t.fallAgenTrafficSuccessQt=0,t.p2pAgentPredHitN=0,t.p2pAgentPredMissN=0,t.p2pAgentPredPartialHitN=0,t.p2pAgenTrafficSuccessQt=0,t.p2pAgenTrafficFailureQt=0},w.prototype.nG=function(t){t.metrics.videoBufN=0,t.metrics.videoBufQt=0,t.metrics.clientBufferMs=0,t.metrics.lookupNotFound=0,t.metrics.lookupTotal=0,t.metrics.lookupLatency=0,t.metrics.lookupReqAccept=0,t.metrics.lookupReqEstablished=0,t.metrics.lookupFailed=0,t.player.bufferingN=0,t.player.bufferingMs=0},w.prototype.Vf=function(t){var n=this;void 0===t&&(t=!0);var r=new hive.snapshots.MetricSnapshot;r.timestamp=c.Framework.time(),r.guid=this.tE,r.sessionId=this.ticket.sessionId,r.eventId=new EventId,r.eventId.partnerId=this.ticket.pE(),r.eventId.customerId=this.ticket.wE(),r.eventId.contentId=this.ticket.Vk();try{var i=new hive.snapshots.ClientInfo;i.clientType=this.sG();var s=this.app.version.split(".");if(i.majorVersion=parseInt(s[0]),i.minorVersion=parseInt(s[1]),i.patchVersion=parseInt(s[2]),r.client=i,null!=this.testId){var e=new TestInfo;e.testId=this.testId,r.testInfo=e}}catch(t){this.logger.warn(d+" error setting Snapshot ClientInfo",t)}if(this.PD){var h=new hive.snapshots.AgentInfo;h.firstTierBitrates=this.PD.eG(),h.secondTierBitrates=this.PD.hG(),r.agentInfo=h}r.streamInfo=this.oH.oG(),r.traffic=[];var o=new hive.snapshots.TrafficKey;if(r.traffic.push({key:o,value:this.vH.GF}),this.vH.xF.forEach(function(t,i){var n=new hive.snapshots.TrafficKey;n.bitrate=i,r.traffic.push({key:n,value:t})}),r.metrics=this.vH.metrics,this.YF&&(r.metrics.clientBufferMs=this.YF.min()),this.$F&&(r.metrics.trackerLatency=this.$F.min()),this.JF&&(r.metrics.uG=this.JF.min()),r.player=this.vH.player,0<this.rG.source.length&&(r.rG=this.rG),this.aG){var u=this.aG.fG();this.vH.metrics.prtOutN=u.cG+u.lG,this.vH.metrics.prtInN=u.vG+u.dG;var a=this.aG.EG();a.forEach(function(t,i){n.pG(i,t,r)}),this.vH.qF.filter(function(t,i){return!a.has(i)}).forEach(function(t,i){n.pG(i,t,r)})}return r.connInfo=new hive.snapshots.ConnectivityInfo,t?this.SE.getConnectivityInfo().then(function(t){return r.connInfo.privateIp=f.Qd.getPrivateIp(t.getNetworkChanged()),n.wG(n.gG(r))}).fail(function(t){return n.wG(n.gG(r))}):(r.connInfo.privateIp=f.Qd.getPrivateIp(this.SE.IE().getNetworkChanged()),this.wG(r))},w.prototype.gG=function(t){return t.connInfo.internalAs=this.bG,t.connInfo.externalAs=this.yG,t.connInfo.publicIp=this.TG,t},w.prototype.wG=function(t,i){void 0===i&&(i=[]);var n=v.Ec(t,"snapshot");return n.length&&l.ErrorMonitor.lt().logError("NaN found in MetricSnapshot",d,{keysWithNaN:n,snapshot:t}),i.length=0,i.push.apply(i,n),t},w.prototype.sG=function(){var t;switch(this.app.app){case"JS":t=ClientType.mG;break;case"PROXY":t=ClientType.OG;break;default:t=ClientType.SG}return t},w.prototype.pG=function(t,i,n){var r=this.vH.BF.get(t);i.traffic=r,n.partners||(n.partners=[]);var s=new hive.snapshots.PartnerKey;s.partnerGuid=t,n.partners.push({key:s,value:i})},w.prototype.iH=function(t,i){0<t&&(this.vH.metrics.videoBufN++,this.vH.metrics.videoBufQt+=t,this.vH.player.bufferingN++,this.vH.player.bufferingMs+=t),this.vH.player.playerBufferMs=i},w.prototype.wH=function(){return this.vH.GF},w.prototype.RG=function(){return this.tG.GF},w.prototype.IG=function(t){return this.tG.xF.has(t)||this.tG.xF.set(t,new hive.snapshots.Traffic),this.tG.xF.get(t)},w.prototype.EH=function(t){if(!this.vH.xF.has(t)){var i=new hive.snapshots.Traffic;this.iG(i),this.vH.xF.set(t,i)}return this.vH.xF.get(t)},w.prototype._G=function(){var t=new hive.snapshots.PartnerTraffic;return t.p2pSuccReq=0,t.p2pFailReq=0,t.p2pPartReq=0,t.p2pSuccReceived=0,t.p2pSuccReceivedLow=0,t.p2pFailReceived=0,t.p2pSuccResp=0,t.p2pFailResp=0,t.p2pPartResp=0,t.p2pSuccSent=0,t.p2pSuccSentLow=0,t.p2pFailSent=0,t},w.prototype.AG=function(t,i){return i.BF.has(t)||i.BF.set(t,this._G()),i.BF.get(t)},w.prototype.NG=function(t){return this.AG(t,this.vH)},w.prototype.CG=function(t){return this.AG(t,this.tG)},w.prototype.kG=function(t){this.SE=t},w.prototype.DG=function(t){this.aG=t},w.prototype.AE=function(t){},w.prototype.MG=function(i){var n=!1;this.rG.source.forEach(function(t){t.mF==i&&(t.count++,n=!0)}),n||this.rG.source.push(new hive.snapshots.jG({mF:i,count:1}))},w);function w(){this.ticket=null,this.bG=0,this.yG=0,this.testId=null,this.rG=new hive.snapshots.PG,this.ZF()}i.NF=p;var g=(b.prototype.init=function(t,i){this.logger=c.Framework.resolve(c.Framework.ht.m).log(i),this.logger.debug(d+" INIT CLIENT STATS"),this.store=t,this.HG()},b.prototype.HG=function(){var t=this;-1<this.LG&&c.Framework.clearInterval(this.LG),this.LG=c.Framework.setInterval(function(){t.snapshot()},e.DE.kE.sp)},b.prototype.gl=function(t){this.state=t},b.prototype.zP=function(){if(this.store)return this.snapshot(!1)},b.prototype.reset=function(t){c.Framework.clearInterval(this.LG),this.store&&(!1===t?this.store.reset():this.store.ZF())},b.prototype.snapshot=function(t){var i=this;void 0===t&&(t=!0);var n=this.store.Vf(t);t?(this.logger.debug("[SNAP] TAKING SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.warn("[SNAP] ERROR FORWARDING SNAPSHOT",t)}).finally(function(){i.store.reset()})):(this.logger.debug("[SNAP] FLUSHING SNAPSHOT"),this.forward(n))},b.prototype.forward=function(t){var i=this;if(this.state!==u.ul.IDLE&&this.state!==u.ul.STOP){if(this.client&&this.client.UE()){switch(this.UG){case 0:default:this.logger.debug(d+" SENDING SNAPSHOT");break;case 1:this.logger.debug(d+" SENDING SNAPSHOT "+JSON.stringify(t));break;case 2:this.logger.debug(d+" SENDING SNAPSHOT",t);break;case 3:this.logger.debug(d+" SENDING SNAPSHOT "+JSON.stringify(t),t)}this.protocol.ql("SNAPSHOT",h.Ql.ONEWAY,0),t.write(this.protocol),this.protocol.Wl();var n=this.Kl.Yl(),r=this.$l(n,",",4),s=n.slice(r+1,n.length-1),e=new o.hl(HiveStreamingServices.GE,1,s);this.client.UE().send(e).fail(function(t){i.logger.warn(d+" PROBLEM: ",t)})}}else this.logger.debug(d+" not send - state "+u.ul[this.state])},b.prototype.$l=function(t,i,n){return t.split(i,n).join(i).length},b);function b(){this.UG=isNaN(a.HiveConfig.DebugLogs.MetricSnapshotLogs)?0:a.HiveConfig.DebugLogs.MetricSnapshotLogs,this.state=u.ul.al,this.client=c.Framework.resolve(s.pf.R),this.Kl=new h.tv,this.protocol=new h.nv(this.Kl)}i.Rl=g},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var h=n(3),o=n(30),u=n(118),e=n(0),a=n(25),f=n(17),c=n(7).ut.Qa,l=(v.prototype.init=function(t,n){var r=this;if(this.FG)this.FG.then(function(){var t={partnerId:n.pE(),customerId:n.wE(),contentId:n.Vk(),secret:n.qk()},i=new f.hl(HiveStreamingServices.GG,1,JSON.stringify(t));r.connection.send(i)});else{var i=h.defer(),s=a.DE.kE.JE;n.Bk&&(c?s=a.DE.kE.ZE:(this.logger.warn("[HiveComm] Error trying to resolve test ticket against production services - use production ticket or test plugin"),i.reject(new Error("test ticket in production"))));var e=new o(s).Ky({"connection-id":t,partner_id:n.pE(),customer_id:n.wE(),content_id:n.Vk(),ticket:n.qk()}).toString();this.connection=new u.xG(e,a.DE.kE.ep,a.DE.kE.hp,a.DE.kE.op),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),i.resolve(r.connection)}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),i.reject(r.connection)}),this.FG=i.promise}return{jl:this.connection,promise:this.FG}},v.prototype.connect=function(){this.connection&&this.connection.connect(!0)},v.prototype.FD=function(t){},v.prototype.UE=function(){return this.connection},v.prototype.close=function(){this.connection&&(this.FG=null,this.connection.close(!1))},v);function v(){this.logger=e.Framework.resolve(e.Framework.ht.m).log(),this.logger.debug("INIT SERVICE CLIENT")}i.BG=l;var d,E=(s(p,d=l),p.prototype.init=function(t,i,n){var r=this;if(this.FG)return this.FG;var s=h.defer(),e=new o(n).Ky({"connection-id":t}).toString();return this.logger.debug(this.loggerId+" Connecting to serviceEndpoint "+e),this.connection=new u.xG(e,a.DE.kE.ep,a.DE.kE.hp,a.DE.kE.op),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),s.resolve(r.connection)}),this.connection.on(HiveStreamingServices.GG,0,function(t){r.logger.debug("FAKED RESOLVING")}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),s.reject(r.connection)}),this.FG=s.promise,this.FG},p);function p(){var t=null!==d&&d.apply(this,arguments)||this;return t.loggerId="[ServicesClientViaToken]",t}i.VG=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(119);var e=n(3),r=n(4),s=n(0),h=n(46),o=function(t){this.VE=(new Date).getTime(),this.qG=t},u=(a.prototype.resolve=function(t,i,n){var r=this,s=e.defer();return t&&(t.on(HiveStreamingServices.GG,0,function(t){r.QG(t)}),t.on(HiveStreamingServices.GG,2,function(t){r.QG(t)}),this.WG.set(i,new o(s))),s.promise},a.prototype.QG=function(t){var r=this,s=(new Date).getTime(),e=JSON.parse(t.msg),h=!1;this.WG.forEach(function(t,i){if(r.YG(i,e)){h=!0;var n=r.zU(i,e);n?(n.VE=t.VE,n.qE=s,t.qG.resolve(n)):t.qG.reject("Ticket verification failed"),r.WG.delete(n)}}),h||this.logger.warn("no pending ticket matching: "+t.msg)},a.prototype.Nl=function(t){if(new RegExp("^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?").test(t)){var i=this.KG();return i.Gk(t),i}return null},a.prototype.KG=function(){return new h.Ticket},a.prototype.YG=function(t,i){return t.pE()===i[h.Ticket.tD]&&t.wE()===i[h.Ticket.Zk]&&t.Vk()===i[h.Ticket.iD]},a.prototype.zU=function(t,i){return t.Uk(i),t.Fk()?t:null},a);function a(){this.WG=new r,this.logger=(s.Framework.resolve(s.Framework.ht.m)||console).log(),this.logger.debug("INIT TICKET RESOLVER")}i.$G=u},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e=n(50),o=n(3),h=n(0),u=n(25),a=n(120),f=(c.prototype.XG=function(){var t=this,i=o.defer(),n=indexedDB.open(this.JG);return n.onupgradeneeded=function(){n.result.createObjectStore(t.zG,{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},c.prototype.Al=function(){var s=this;if(this.ZG)return this.ZG;var e=o.defer();if(this.tE)e.resolve(new a.tx(this.tE));else if(u.DE.Wa&&this.indexedDB){var h=setTimeout(function(){s.logger.warn("[HiveComm] timeout retrieving persistent ID - generating random one"),s.tE=s.ix(),s.logger.debug("[HiveComm] Generated UUID: "+s.tE),e.resolve(new a.tx(s.tE))},4e3);try{this.XG().then(function(n){var r=n.transaction(s.zG,"readwrite").objectStore(s.zG).get("MYID");r.onsuccess=function(){if(clearTimeout(h),s.tE)e.resolve(new a.tx(s.tE));else if(null!=r.result&&u.DE.Wa){var t=r.result.value;s.logger.debug("[HiveComm] Retrieved persistent UUID: "+t),s.tE=t,n.close(),e.resolve(new a.tx(s.tE))}else{var i=s.ix();s.nx(n,i),e.resolve(new a.tx(s.tE))}},r.onerror=function(t){clearTimeout(h),s.tE||(s.logger.warn("[HiveComm] error retrieving persistent UUID: "+t),s.tE=s.ix(),s.logger.debug("[HiveComm] Generated UUID: "+s.tE)),e.resolve(new a.tx(s.tE))}}).fail(function(t){clearTimeout(h),s.tE||(s.logger.warn("[HiveComm] error opening indexedDB - generating random id. Error: "+t),s.tE=s.ix(),s.logger.debug("[HiveComm] Generated UUID: "+s.tE)),e.resolve(new a.tx(s.tE))})}catch(t){this.tE=this.ix(),this.logger.debug("[HiveComm] Persistence error - Generate UUID: "+this.tE,t),e.resolve(new a.tx(this.tE))}}else this.tE=this.ix(),this.logger.debug("[HiveComm] Persistence disabled - Generate UUID: "+this.tE),e.resolve(new a.tx(this.tE));return this.ZG=e.promise,this.ZG},c.prototype.nx=function(t,i){var n=this,r=t.transaction(this.zG,"readwrite");r.objectStore(this.zG).put({id:"MYID",value:i}),r.oncomplete=function(){n.logger.debug("[HiveComm] completed UUID persistence"),t.close()},this.logger.debug("[HiveComm] Generated UUID: "+i),this.tE=i},c.prototype.ix=function(){return e.Kk()},c);function c(){this.zG="IdentityStore",this.JG="IdentityDB",this.tE=null,this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,h.Framework&&h.Framework.resolve(h.Framework.ht.m)?this.logger=h.Framework.resolve(h.Framework.ht.m).log():this.logger=console}i.sx=f;var l,v=(s(d,l=f),d.prototype.Al=function(){var s=this;if(this.ex)return this.ex;var e=o.defer();return l.prototype.Al.call(this).then(function(t){var i=s.ix(),n=t.Ml(),r=new a.tx(i,n);e.resolve(r)}).fail(function(t){var i=s.ix(),n=new a.tx(i);e.resolve(n)}),this.ex=e.promise,this.ex},d);function d(){return l.call(this)||this}i.hx=v},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.ox=function(t){this.hostname=t},s.prototype.getHostName=function(){return this.hostname},s.prototype.ux=function(t){this.nc=t},s.prototype.getNetworkChanged=function(){return this.nc},s);function s(){}i.ax=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(8),h=n(121),o=n(1),u=(a.prototype.lx=function(){var t=new h.vx;this.Ex.ux(t)},a.prototype.IE=function(){return this.Ex},a.prototype.getConnectivityInfo=function(){var i=this;if(!this.connInfo)return r.reject("ConnInfo helper undefined");var n=setTimeout(function(){return i.logger.warn(i.loggerId+"Get connectivity info expired"),i.Ex?r.resolve(i.Ex):r.reject("expired")},2e3);try{return this.connInfo.getConnectivityInfo().then(function(t){return clearTimeout(n),i.Ex=t}).fail(function(t){return i.logger.debug(i.loggerId+" get connectivity info failed with error 1: ",t),i.Ex?i.Ex:r.reject(t)})}catch(t){return this.logger.debug(this.loggerId+" get connectivity info failed with error 2:",t),r.reject(t)}},a.prototype.px=function(t,i,n){},a.prototype.wx=function(t){},a);function a(){this.loggerId="[PreloadConnectivityInfoProvider] ",this.connInfo=window.myConnInfo,this.logger=s.Framework.resolve(s.Framework.ht.m).log(),this.Ex=s.Framework.resolve(e.pf.ff),this.connInfo||o.ErrorMonitor.lt().logError("helper undefined",this.loggerId),this.lx()}i.gx=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.bx=function(t){this.publicIp=t},s.prototype.getPublicIp=function(){return this.publicIp},s.prototype.yx=function(t){this.Tx=t},s.prototype.getMacAddress=function(){return this.Tx},s.prototype.mx=function(t){this.nic=t},s.prototype.getNic=function(){return this.nic},s.prototype.Ox=function(t){this.nicName=t},s.prototype.getNicName=function(){return this.nicName},s.prototype.Sx=function(t){this.privateIp=t},s.prototype.getPrivateIp=function(){return this.privateIp},s.prototype.Rx=function(t){this.netmask=t},s.prototype.getNetmask=function(){return this.netmask},s.prototype.Ix=function(t){this._x=t},s.prototype.getCidr=function(){return null},s);function s(){}i.Ax=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(3),r=n(4),e=n(0),h=n(8),o=n(79),u=n(122),a=n(14),c=n(25),f=n(47),l=(v.prototype.lx=function(){var t=new o.Ax;this.Ex.ux(t)},v.prototype.Nx=function(){var t=this;e.Framework.setInterval(function(){t.Cx=[],t.kx=[],t.Dx=new r,t.publicIp=null,t.Mx=null,t.getConnectivityInfo()},12e4)},v.prototype.getConnectivityInfo=function(){return this.Mx||(this.Mx=this.jx()),this.Mx},v.prototype.IE=function(){return this.Ex},v.prototype.jx=function(){var n=this,r=s.defer();if(this.Px=e.Framework.setTimeout(function(){r.reject({Hx:!0,message:"expired"})},4e3),a.HiveConfig.ConnInfo.detectPrivateIP&&this.Lx())try{this.Ux=new RTCPeerConnection(null),this.Fx=this.Ux.createDataChannel("sendChannel",{reliable:!1}),this.Gx=new RTCPeerConnection(null),this.Gx.ondatachannel=function(t){n.xx=t.channel,n.xx.onopen=function(t){if("open"===n.xx.readyState){if(n.Gx.close(),n.Ux.close(),n.Gx=null,n.Ux=null,n.logger.debug("Collected ips ["+n.Dx.map(function(t,i){return i+":"+t.Bx}).join(", ")+"]"),c.DE.kE.ap&&!n.Vx&&(setTimeout(function(){f.hD.rD(null,null,"local_ice",null,n.qx)},5e3),n.Vx=!0),0<n.Dx.length&&c.DE.kE.up){var i=n.Dx.entries().sort(function(t,i){return i[1].Bx-t[1].Bx});i=i.splice(0,1)[0],n.Dx.clear(),n.Dx.set(i[0],i[1])}n.Wx.Qx().then(function(t){n.kx=t,0<n.kx.length&&(n.logger.debug("Already known matching ips ["+n.kx.join(",")+"]"),n.kx.forEach(function(t){0<n.Dx.keys().indexOf(t)&&(n.Cx.push(t),n.Dx.delete(t))})),n.Cx=n.Cx.concat(n.Dx.keys())}).fail(function(t){n.logger.warn("Get Previous working ips failed with error "+t.message),n.Cx=n.Cx.concat(n.Dx.keys())}).finally(function(){n.logger.debug("Final private ip list ["+n.Cx.join(",")+"]"),r.resolve(n.Yx())})}}},this.Ux.onicecandidate=function(t){t.candidate&&n.Kx(t.candidate.candidate),t.candidate&&n.Gx.addIceCandidate(t.candidate).catch(function(t){r.reject({Hx:!0,message:t.message}),e.Framework.clearTimeout(n.Px),console.log("Error: Failure during addIceCandidate()")})},this.Gx.onicecandidate=function(t){t.candidate&&n.Kx(t.candidate.candidate),t.candidate&&n.Ux.addIceCandidate(t.candidate).catch(function(t){r.reject({Hx:!0,message:t.message}),e.Framework.clearTimeout(n.Px),console.log("Error: Failure during addIceCandidate()")})},this.Ux.createOffer().then(function(t){return n.Ux.setLocalDescription(t)}).then(function(){return n.Gx.setRemoteDescription(n.Ux.localDescription)}).then(function(){return n.Gx.createAnswer()}).then(function(t){return n.Gx.setLocalDescription(t)}).then(function(){return n.Ux.setRemoteDescription(n.Gx.localDescription)}).catch(function(t){r.reject({Hx:!0,message:t.message}),e.Framework.clearTimeout(n.Px),console.log("Error: Failure creating offer")})}catch(t){r.reject({Hx:!0,message:t.message})}else{e.Framework.clearTimeout(this.Px);var t=a.HiveConfig.ConnInfo.detectPrivateIP?"webrtc datachannel not supported":"private IP detection disabled";r.reject({Hx:!1,message:t})}return r.promise},v.prototype.Lx=function(){try{return"function"==typeof RTCPeerConnection.prototype.createDataChannel}catch(t){return!1}},v.prototype.Kx=function(t){var i="candidate:",n=t.indexOf(i)+i.length,r=t.substr(n).split(" "),s=r[0],e=r[1],h=r[2],o=r[3],u=r[4],a=r[5],f={$x:e,type:r[7],Xx:s,protocol:h,address:u,port:a,Bx:o};c.DE.kE.ap&&!this.Vx&&this.qx.push(f),this.Jx(f)},v.prototype.Jx=function(t){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(t.address);if(i){var n=i[0],r=this.Dx.get(n);(isNaN(r)||t.Bx>r)&&this.Dx.set(n,t)}},v.prototype.Yx=function(){var t=new o.Ax;return 0<this.Cx.length&&t.Sx(this.Cx[0]),this.publicIp&&t.bx(this.publicIp),this.Ex.ux(t),this.Ex},v.prototype.px=function(t,i,n){if(this.publicIp=t,this.zx(),0===n&&1<this.Cx.length)this.Cx.shift();else if(c.DE.rf&&0!==n&&-1==this.kx.indexOf(this.Cx[0]))this.kx.unshift(this.Cx[0]),this.Wx.Zx(this.kx.slice(0,2));else if(c.DE.rf&&0!==n&&0<this.kx.indexOf(this.Cx[0])){var r=this.kx.indexOf(this.Cx[0]);this.kx=this.kx.splice(r,1),this.kx.unshift(this.Cx[0]),this.Wx.Zx(this.kx.slice(0,2))}this.Yx()},v.prototype.zx=function(){var t=this.Cx.indexOf(this.publicIp);-1<t&&this.Cx.splice(t,1)},v.prototype.wx=function(t){},v);function v(){this.Ux=null,this.Gx=null,this.Fx=null,this.xx=null,this.Dx=new r,this.publicIp=null,this.Cx=[],this.failed=!1,this.Px=null,this.qx=[],this.Vx=!1,this.logger=e.Framework.resolve(e.Framework.ht.m).log(),this.Ex=e.Framework.resolve(h.pf.ff),this.Wx=new u.tB,this.kx=[],this.lx(),this.Nx()}i.iB=l},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(33),o=n(55),u=n(1),a=n(6),f=(e=h.HiveRequest,s(c,e),c.nB=function(t,i){c.rB[i]?c.rB[i].push(t):c.rB[i]=[t]},c.registerComm=function(t,i){c.sB[i]=t},c.eB=function(i,t){var n=c.rB[t],r=c.sB[t],s=n&&n.length||0;r?s?(c.rB[t]=c.rB[t].filter(function(t){return t.id!=i.id}),s===c.rB[t].length?r.logger().warn(c.loggerId+" Attempt to unregister a not found session (pluginId = "+t+", sessionId = "+i.id+")"):r.logger().debug(c.loggerId+" Unregistered session (pluginId = "+t+", sessionId = "+i.id+")")):r.logger().warn(c.loggerId+" Attempt to unregister a session for plugin with no sessions (pluginId = "+t+", sessionId = "+i.id+")"):console.log(c.loggerId+" Attempt to unregister session with no comm (pluginId = "+t+", sessionId = "+i.id+")")},c.prototype.send=function(){var i=this;if(!this.pluginId){var t=Object.keys(c.sB);0<t.length&&(this.pluginId=c.sB[t[0]])}var n=c.rB[this.pluginId],r=c.sB[this.pluginId],s=!1;n.forEach(function(t){o.LP(n)||o.LP(r)||t.ticket.Yk!==i.url||(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.hB(i),r.onActivateSession(i.url,!0),s=!0)}),s||(n.forEach(function(t){!o.LP(n)&&!o.LP(r)&&0<=i.url.indexOf(t.ticket.SourceURL)&&(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.hB(i),r.onActivateSession(i.url),s=!0)}),s||(u.ErrorMonitor.lt().logError("HiveJS Tech or Comm are not defined",this.loggerId),this.resolve()))},c.prototype.resolve=function(){var t=this,i=new XMLHttpRequest;i.open("GET",this.url),i.onreadystatechange=function(){4===i.readyState&&(t.response=i.responseText,t.responseText=i.responseText,t.readyState=4,t.status=i.status,t.dispatchEvent(a.La.createEvent(Event,"readystatechange",{currentTarget:t})),t.dispatchEvent(a.La.createEvent(ProgressEvent,"onload",{currentTarget:t})),console.debug("Returned Manifest Request "+t.url))},i.send()},c.sB={},c.rB={},c.loggerId="[HiveRequestManifest]",c);function c(){return null!==e&&e.apply(this,arguments)||this}i.OF=f},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(16),o=n(0),u=n(31),a=(e=u.Hive,s(f,e),f.Api=function(){return f.app="JS",o.Framework.resolve(h.nl.Gc)},f);function f(){return null!==e&&e.apply(this,arguments)||this}i.aA=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(6),r=n(1),s=(e.prototype.addEventListener=function(t,i,n){this.events[t]=this.events[t]||[],this.events[t].push(i)},e.prototype.removeEventListener=function(t,i,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==i}))},e.prototype.dispatchEvent=function(i){var n=this;this.events[i.type]&&this.events[i.type].forEach(function(t){try{"function"==typeof t?t.call(n,i):"function"==typeof t.rH&&t.rH(i)}catch(t){r.ErrorMonitor.lt().logError(n.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}});var t=this["on"+i.type];if("function"==typeof t)try{t.call(this,i)}catch(t){r.ErrorMonitor.lt().logError(this.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}return!1},e.prototype.msCachingEnabled=function(){return void 0!==this.msCaching},e.prototype.overrideMimeType=function(t){this.mimeType=t},e.register=function(t,i){e.uA[t]=i},e.prototype.oB=function(t){this.pluginId||(this.pluginId=e.uA[t])},e.prototype.open=function(t,i,n,r,s){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===s&&(s=null),this.url=i.trim(),this.method=t,this.username=r,this.password=s,this.async=n,this.readyState=this.OPENED;var e=h.La.createEvent(Event,"readystatechange",{currentTarget:this});this.dispatchEvent(e)},e.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");this.uB.push({key:t,value:i})},e.prototype.getResponseHeader=function(t){var i=this.getAllResponseHeaders();if(i){var n=[];return i.split(/[\r\n]+/).forEach(function(t){var i=t.match(/^([^:]+): ?(.+)$/);i&&(n[i[1]]=i[2])}),n[t.toLowerCase()]}return null},e.prototype.getAllResponseHeaders=function(){return this.$p},e.prototype.onload=function(t){},e.prototype.onloadend=function(t){},e.prototype.onerror=function(t){},e.prototype.onprogress=function(t){},e.prototype.onreadystatechange=function(t){},e.prototype.onabort=function(t){},e.prototype.onloadstart=function(t){},e.prototype.ontimeout=function(t){},e.uA={},e.Kv=0,e);function e(t){this.loggerId="[HiveXHR] ",this.DONE=4,this.LOADING=3,this.HEADERS_RECEIVED=2,this.OPENED=1,this.UNSENT=0,this.username=null,this.password=null,this.uB=[],this.responseType="",this.readyState=this.UNSENT,this.status=0,this.async=!0,this.timeout=0,this.events={},t&&(this.pluginId=t)}i.oA=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),f=n(26),s=n(9),c=n(0),l=n(5),v=n(2),d=n(1),e=n(47),h=n(4),o=(E.prototype.aB=function(t,i){try{var n=void 0,r=t.Mp.duration,s=t.size,e=-1,h=0,o=-1;if(this.fB.ha()&&(e=Math.max(10,this.fB.la(s))),h=-1<e?Math.max(0,r-e*l.ea.Qu.wo):.5*r,E.cB){var u=t.lB.QM();0<u&&(o=i/u*l.ea.Qu.yo),n=t.type===f.fp.pp?r*l.ea.Qu.bo:-1<o&&o<=h?h:-1<o&&o<=r*l.ea.Qu.To?r*l.ea.Qu.To:0}else t.type==f.fp.pp&&(h*=2),n=Math.max(this.vB(),h);if(l.ea.ra.Pu){var a=this.dB.has(t.jp())?this.dB.get(t.jp()):this.EB(t);a.push([c.Framework.time(),i,e,h,o,t.type,n]),this.dB.set(t.jp(),a)}return this.logger.debug("TIMER DETAILS duration: "+r+" left/total: "+i+"/"+s+" cdn: "+e+" remaining: "+h+" p2p: "+o+" timeout: "+n),n}catch(t){return d.ErrorMonitor.lt().logError("Error calculating the p2p timeout",this.loggerId,v.Cr.kr,t),0}},E.prototype.pB=function(t,i){return 5e3},E.prototype.wB=function(t){try{return this.fB.ha()?Math.min(this.fB.la(t),this.gB()):this.bB()}catch(t){return d.ErrorMonitor.lt().logError("Error calculating the delivery delay",this.loggerId,v.Cr.Dr,t),this.bB()}},E.prototype.cL=function(t){if(t.Dp()===s.wf.bf)switch(t.kp()){case f.fp.lp:case f.fp.cp:case f.fp.vp:case f.fp.dp:this.fB.ca(t.Qp());break;case f.fp.Ep:case f.fp.pp:this.yB.ca(t.Qp())}if(l.ea.ra.Pu){var i=this.dB.has(t.jp())?this.dB.get(t.jp()):this.EB(t);i.push([c.Framework.time(),t.kp()]),e.hD.sD(null,null,"p2p_timer",this.PD.getReportingGuid(),i,10)}},E.prototype.vB=function(){return E.TB},E.prototype.bB=function(){return E.mB},E.prototype.gB=function(){return E.OB},E.prototype.EB=function(t){return[[t.jp(),t.Mp.duration,t.size]]},E.cB=!0,E.TB=500,E.OB=1500,E.mB=500,E);function E(t){this.loggerId="[TIMER HANDLER] ",this.fB=new r.ga,this.yB=new r.ga,this.dB=new h,this.logger=c.Framework.resolve(c.Framework.ht.m).log(),this.PD=t}i.SB=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(34),s=n(139),h=n(141),e=n(86),w=n(0),a=n(142),f=n(9),E=n(61),o=n(143),u=n(144),g=n(57),c=n(14),p=n(1),b=n(2),l=n(145),v=n(6),y=n(146),d=(T.prototype.RB=function(t){var i="";return-1!==t.indexOf("/")&&(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),i=t.substring(0,t.lastIndexOf("/")+1)),i},T.prototype.isLive=function(){return this.live},T.prototype.xH=function(i){var n=[];return this.IB.forEach(function(t){void 0!==i&&t.type!==i||-1==n.indexOf(t.bandwidth)&&n.push(t.bandwidth)}),n},T.prototype.reset=function(){this.IB=[]},T.prototype._B=function(){return this.AB},T.prototype.parse=function(t,i,n){var h=this;try{this.reset(),this.iL=t,this.NB(t,i);var o=this.manifest.BaseURL;this.live="static"!==this.manifest.type;var u=this.manifest.Period_asArray[0];return u.AdaptationSet_asArray,u.AdaptationSet.forEach(function(t){var s=-1!=(t.mimeType?t.mimeType:t.Representation_asArray[0].mimeType).indexOf("audio")?f.wf.gf:f.wf.bf;s===f.wf.bf&&t.ContentProtection&&h.CB(t.ContentProtection);var e=t.SegmentTemplate;t.Representation_asArray&&t.Representation_asArray.forEach(function(t){var i=new a.kB,n=t.SegmentTemplate?t.SegmentTemplate:e;if(i.type=s,i.bandwidth=h.DB(t),i.timescale=parseInt(n.timescale)||1e3,i.MB=t.id,i.initialization=o+""+n.initialization,i.initialization=i.initialization.replace(T.jB,""+i.bandwidth),i.initialization=i.initialization.replace(T.PB,""+i.MB),i.initialization=v.La.ka(i.initialization),i.HB=o+""+n.media,i.HB=i.HB.replace(T.jB,""+i.bandwidth),i.HB=i.HB.replace(T.PB,""+i.MB),i.HB=v.La.ka(i.HB),i.LB=h.UB(i.HB),i.HB.match(T.FB)){if(i.GB=parseInt(n.duration),!i.GB)throw new Error("Expected duration on SegmentTemplate for Number-based template");i.startNumber=parseInt(n.startNumber)||0,i.xB=parseInt(u.start)||0,h.yL=!0}else{var r=h.BB(n.SegmentTimeline_asArray[0].S_asArray,i.HB,i.bandwidth,s);i.XH=r.VB,i.qB=r.QB}h.IB.push(i)})}),this.AB=!0,this.WB(i,n)}catch(t){throw p.ErrorMonitor.lt().logError("Error parsing the metadata",this.loggerId,b.nr.rr,t),this.AB=!1,new Error(t)}},T.prototype.DB=function(t){if(this.YB&&this.KB){var i=t.id.match(this.KB),n=i?i[0]:t.id;if(this.YB.has(n))return this.YB.get(n)}return parseInt(t.bandwidth)},T.prototype.$B=function(){if(this.YB){var t=this.YB.keys();t.length&&(this.KB=new RegExp("\\b("+t.join("|")+")\\b"))}else this.KB=null},T.prototype.UB=function(t){var i=t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),n=i.match(/\\\$Number%(\d+)d\\\$/);return n&&(i=i.replace("\\$Number%"+n[1]+"d\\$","(\\d{"+parseInt(n[1])+"})")),i=(i=i.replace("\\$Time\\$","([0-9]*)")).replace("\\$Number\\$","([0-9]*)"),new RegExp(i,"i")},T.prototype.BB=function(t,h,o,u){var a=this;try{var f,c=new r,l=new r,v=0,d=0;return this.XB(1,"Extracting segments using template "+h+" for",t),t.forEach(function(t){if(t.d){t.t?v=parseInt(t.t):v+=d;var i=parseInt(t.d),n=h.replace(T.JB,v+"");(e=new E.wU(v,o,i,n,n)).type=u,f&&(f.next=e),c.set(n,e),l.set(v,e),f=e;var r=0;t.r&&(r=parseInt(t.r));for(var s=0;s<r;s++){var e;v+=i,n=h.replace(T.JB,v+""),(e=new E.wU(v,o,i,n,n)).type=u,f&&(f.next=e),c.set(n,e),l.set(v,e),f=e}a.XB(2,"Segment",t,"parsed to",e),d=i}}),{VB:c,QB:l}}catch(t){throw p.ErrorMonitor.lt().logError("Error extracting segment maps",this.loggerId,b.nr.sr,t),new Error(t)}},T.prototype.CB=function(t){try{if(t){if(t.CryptoPeriod){var i=t.CryptoPeriod;this.dL&&!this.dL.zB()&&this.dL instanceof o.ZB||(this.dL=new o.ZB(i.keyUriTemplate,i.IV,this.authenticationToken))}else this.dL&&this.dL instanceof u.tV||(this.dL=new u.tV);this.dL&&g.DASH.kH&&this.dL.init()}}catch(t){throw p.ErrorMonitor.lt().logError("Error initializing the protection",this.loggerId,b.nr.er,t),new Error(t)}},T.prototype.$H=function(i){return i=v.La.Ca(i),this.IB.find(function(t){return t.LB.test(i)})},T.prototype.WH=function(t){t=v.La.Ca(t);try{var i=this.$H(t);if(i){var n;if(i.XH&&(n=i.XH.get(t)))return n;var r=t.match(i.LB);if(r){var s=parseInt(r[1]);return this.RL(s,i.bandwidth)}}throw new Error("No representation for "+t)}catch(t){return p.ErrorMonitor.lt().logError("Error getting the segment info",this.loggerId,b.nr.hr,t),null}},T.prototype.KH=function(t){t=v.La.Ca(t);try{return this.$H(t).timescale}catch(t){return p.ErrorMonitor.lt().logError("Error getting the representation for timescale",this.loggerId,b.nr.ur,t),1e4}},T.prototype.QH=function(i){return i=v.La.Ca(i),this.IB.some(function(t){return t.initialization===i})},T.prototype.JH=function(t){t=v.La.Ca(t);var i=this.WH(t);return null!=i?i.next:null},T.prototype.OL=function(t,i){var n=this.IB.find(function(t){return t.bandwidth===i});if(n){if(n.qB)return 1;var r=w.Framework.time(),s=this.manifest.availabilityStartTime.getTime()+(this.manifest.Period.start||0)+(t-n.startNumber+1)*n.GB*n.timescale;return Math.max(1,s-r)}return 1},T.prototype.DM=function(t,i,n,r){try{var s=this.IB.find(function(t){return t.bandwidth===r});if(s){if(s.qB&&s.qB.has(t)&&s.qB.has(n)){for(var e=s.qB.get(t),h=s.qB.get(n),o=0,u=e;u&&u!=h;)o+=u.duration,u=u.next;return Math.round(o/(s.timescale/1e3))}if(s.GB)return(n-t)*s.GB*s.timescale}return 0}catch(t){return p.ErrorMonitor.lt().logError("Error extracting the segment distance",this.loggerId,b.nr.ur,t),0}},T.prototype.iV=function(t){try{t instanceof Uint8Array&&(t=t.buffer);var i=h.nV(t),n=i.fetch("tfhd"),r=i.fetch("trun"),s=n?n.default_sample_duration:0;if(r){var e=0;return r.rV.forEach(function(t){e+=t.sample_duration}),isNaN(e)&&0<s&&(e=s*r.rV.length),e}}catch(t){return p.ErrorMonitor.lt().logError("Error extracting duration from the buffer",this.loggerId,b.nr.ar,t),0}},T.prototype.WB=function(t,i){var n=this.sV();if(!i&&(this.live||n||c.HiveConfig.Dash.DashRemoveBitrateSize))try{var r=new e({}),s=r.eV(t);return this.live&&this.hV(s),(n||c.HiveConfig.Dash.DashRemoveBitrateSize)&&this.oV(s,n,c.HiveConfig.Dash.DashRemoveBitrateSize),r.uV(s)}catch(t){this.logger.error(t)}return t},T.prototype.hV=function(c){var l=this,v=Math.max(1,g.DASH.DASH_METADATA_MIN_FRAGMENTS),d=Math.max(1,g.DASH.HH),E=[],p=!1;return c.MPD&&c.MPD.Period&&c.MPD.Period.AdaptationSet&&c.MPD.Period.AdaptationSet.forEach(function(t){if(!p)if(t.SegmentTemplate&&t.SegmentTemplate._media&&t.SegmentTemplate._media.match(T.FB)){p=!0;var i=w.Framework.time();c.MPD.Period._start=c.MPD.Period._start||"PT0S";var n=c.MPD.Period._start,r=y.default(n),s=parseInt(t.SegmentTemplate._timescale)||1e3,e=parseInt(t.SegmentTemplate._duration)*s,h=Math.max(0,Math.floor((i-(new Date(c.MPD._availabilityStartTime).getTime()+1e3*r))/e)-g.DASH.PH),o=Math.ceil(1e3*g.DASH.jH/e),u=Math.max(0,Math.min(h,o)),a=0<u?u*e/1e3:0;try{c.MPD.Period._start="PT"+(r+a)+"S",l.logger.debug("Trimmed "+a+" from period start "+n+" => "+c.MPD.Period._start)}catch(t){l.logger.warn("Could not modify period: "+t)}}else if(l.aV(t)&&t.Representation_asArray){var f=l.fV(t.SegmentTemplate,d,v);t.Representation_asArray.forEach(function(t){f.bitrate=parseInt(t._bandwidth)||0,E.push(f)})}else t.Representation_asArray&&0<t.Representation_asArray.length&&t.Representation_asArray.forEach(function(t){if(l.cV(t)){var i=l.fV(t.SegmentTemplate,d,v);i.bitrate=parseInt(t._bandwidth)||0,E.push(i)}})}),c},T.prototype.cV=function(t){return t&&("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))},T.prototype.fV=function(t,i,n){for(var r=0,s=0,e=t.SegmentTimeline.S_asArray,h=i*parseInt(t._timescale),o=0,u=0,a=0;a<e.length&&0<n;a++)n<(l=(c=e[o=a])._r?parseInt(c._r):1)?(u=n,n=0):(n-=l,u=l);for(var f=e.length-1;0<=f&&0<h&&o<=f;f--){var c,l=(c=e[f])._r?parseInt(c._r):1,v=0;if(!c._d)throw new Error("missing segment duration");var d=l*(v=parseInt(c._d));if((o<f||f==o&&0==u)&&d<=h)h-=d,e.splice(f,1),r+=l,s+=d;else{var E=Math.ceil(h/v);f==o&&(E=Math.min(E,l-u));var p=v*E;c._r=l-E+"",h-=p,r+=E,s+=p}}return this.logger.debug("DASH trimmed "+r+" segments for total duration: "+s),{count:r,lV:s}},T.prototype.aV=function(t){return!!t&&!!("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))&&!!t.SegmentTemplate.SegmentTimeline},T.prototype.sV=function(){if(c.HiveConfig.Dash.DashFilterBitrates)try{var t=null;t="string"==typeof c.HiveConfig.Dash.DashFilterBitrates?c.HiveConfig.Dash.DashFilterBitrates.split(","):c.HiveConfig.Dash.DashFilterBitrates;var n=[];return t.forEach(function(t){var i=parseInt(t);isNaN(i)||n.push(i)}),n}catch(t){p.ErrorMonitor.lt().logError("Error parsing DashFilterBitrates",this.loggerId,b.nr.wr,t)}},T.prototype.oV=function(t,r,s){var e=this;if(t.MPD&&t.MPD.Period){var h=[];t.MPD.Period.AdaptationSet.forEach(function(t){if(t.Representation_asArray&&(e.aV(t)||t.Representation_asArray.every(function(t){return e.cV(t)}))){var i=t.Representation_asArray;i.sort(function(t,i){return isNaN(t._bandwidth)&&(t._bandwidth=parseInt(t._bandwidth)),isNaN(i._bandwidth)&&(i._bandwidth=parseInt(i._bandwidth)),t._bandwidth-i._bandwidth});for(var n=i.length-1;0<=n;n--)s&&(delete i[n]._width,delete i[n]._height),r&&-1==r.indexOf(n)?i.splice(n,1):h.push(i[n]._bandwidth);e.logger.debug("DASH filtered-in bitrates: "+h.reverse().join(" ")+" - removed size: "+s)}})}},T.prototype.RL=function(n,i){try{var t=this.IB.find(function(t){return t.bandwidth===i});if(t&&t.qB&&t.qB.has(n))return t.qB.get(n);if(t&&t.GB){var r=t.HB.replace(T.FB,function(t,i){return l.vV(i||"%d",n)}),s=new E.wU(n,t.bandwidth,t.GB*t.timescale,r,r),e=t.HB.replace(T.FB,function(t,i){return l.vV(i||"%d",n+1)});return s.next=new E.wU(n+1,t.bandwidth,t.GB*t.timescale,r,e),s.next.type=s.type=t.type,s}return null}catch(t){return p.ErrorMonitor.lt().logError("Error getting the segment",this.loggerId,b.nr.yr,t),null}},T.prototype.XB=function(t){void 0===t&&(t=0);for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n]},T.jB="$Bandwidth$",T.JB="$Time$",T.PB="$RepresentationID$",T.FB=/\$Number([^$]+)?\$/,T);function T(t,i){this.YB=i,this.loggerId="[DASH METADATA] ",this.yL=!1,this.live=!1,this.logger=w.Framework&&w.Framework.resolve(w.Framework.ht.m)?w.Framework.resolve(w.Framework.ht.m).log(t):console,this.dV=new s.EV,this.$B(),this.reset()}i.pV=d},function(t,i,n){t.exports=function(g,b,y){null==b&&(b="_"),null==y&&(y=!1);var T=!1,m={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function O(t){var i=t.localName;return null==i&&(i=t.wV),null!=i&&""!=i||(i=t.nodeName),i}function n(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):t}function e(t,i,n,r){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+i;if(null!=n)for(var e=0;e<n.length;e++){var h=n[e],o=t[h];s+=" "+h.substr(1)+"='"+o+"'"}return s+=r?"/>":">"}function h(t,i){return"</"+(null!=t.__prefix?t.__prefix+":":"")+i+">"}function o(t,i){return!!(function(t,i){return-1!==t.indexOf(i,t.length-i.length)}(i.toString(),"_asArray")||0==i.toString().indexOf("_")||t[i]instanceof Function)}function u(t){var i=0;if(t instanceof Object)for(var n in t)o(t,n)||i++;return i}function a(t){var i=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf("_")&&i.push(n);return i}function f(t){var i="";return t instanceof Object?i+=function(t){var i="";return null!=t.__cdata&&(i+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(i+=T?n(t.__text):t.__text),i}(t):null!=t&&(i+=T?n(t):t),i}function c(t,i,n){var r="";if(0==t.length)r+=e(t,i,n,!0);else for(var s=0;s<t.length;s++)r+=e(t[s],i,a(t[s]),!1),r+=l(t[s]),r+=h(t[s],i);return r}function l(t){var i="";if(0<u(t))for(var n in t)if(!o(t,n)){var r=t[n],s=a(r);if(null==r||null==r)i+=e(r,n,s,!0);else if(r instanceof Object){if(r instanceof Array)i+=c(r,n,s);else 0<u(r)||null!=r.__text||null!=r.__cdata?(i+=e(r,n,s,!1),i+=l(r),i+=h(r,n)):i+=e(r,n,s,!0)}else i+=e(r,n,s,!1),i+=f(r),i+=h(r,n)}return i+=f(t)}this.gV=function(t){var i;window.DOMParser?i=(new window.DOMParser).parseFromString(t,"text/xml"):(0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(i=new ActiveXObject("Microsoft.XMLDOM")).async="false",i.bV(t));return i},this.yV=function(t){return function t(i){if(i.nodeType==m.DOCUMENT_NODE){var n,r,s=i.firstChild;for(n=0,r=i.childNodes.length;n<r;n+=1)if(i.childNodes[n].nodeType!==m.COMMENT_NODE){s=i.childNodes[n];break}return y?e=t(s):(e={})[u=O(s)]=t(s),e}if(i.nodeType!=m.ELEMENT_NODE)return i.nodeType==m.TEXT_NODE||i.nodeType==m.CDATA_SECTION_NODE?i.nodeValue:i.nodeType==m.COMMENT_NODE?null:void 0;var e;(e=new Object).__cnt=0;for(var h=i.childNodes,o=0;o<h.length;o++){var u=O(s=h.item(o));if(e.__cnt++,null==e[u])e[u]=t(s),e[u+"_asArray"]=new Array(1),e[u+"_asArray"][0]=e[u];else{if(null!=e[u]&&!(e[u]instanceof Array)){var a=e[u];e[u]=new Array,e[u][0]=a,e[u+"_asArray"]=e[u]}for(var f=0;null!=e[u][f];)f++;e[u][f]=t(s)}}for(var c=0;c<i.attributes.length;c++){var l=i.attributes.item(c);e.__cnt++;for(var v=l.value,d=0,E=g.length;d<E;d++){var p=g[d];try{p.test.call(this,l)&&(v=p.TV.call(this,l.value))}catch(t){p.test.call(this,l),console.error(t)}}e[b+l.name]=v}var w=function(t){return t.prefix}(i);return null!=w&&""!=w&&(e.__cnt++,e.__prefix=w),1==e.__cnt&&null!=e["#text"]&&(e=e["#text"]),null!=e["#text"]&&(e.__text=e["#text"],e.__text instanceof Array&&(e.__text=e.__text.join("\n")),T&&(e.__text=function(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}(e.__text)),delete e["#text"],delete e["#text_asArray"],""===e.__text.trim()&&delete e.__text),null!=e["#cdata-section"]&&(e.__cdata=e["#cdata-section"],delete e["#cdata-section"],delete e["#cdata-section_asArray"]),null==e.__text&&null==e.__cdata||(e.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),e}(t)},this.eV=function(t){var i=this.gV(t);return this.yV(i)},this.uV=function(t){return l(t)},this.mV=function(t){var i=this.uV(t);return this.gV(i)},this.getVersion=function(){return"1.0.11"},this.OV=function(t){T=t}}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v,r,d=n(2),E=n(2),s=n(0),p=n(15),w=n(1),g=E.Ce,b=n(9);(r=v=v||{})[r.SV=0]="INFO",r[r.RV=1]="WARN",r[r.ERROR=2]="ERROR";var e=(y.prototype.eL=function(){var t=this.metadata.xH(b.wf.bf),i=t.length,n=this.metadata.isLive();if(0===i||void 0!==n)for(var r=0;r<y._V.length;r++){var s=y._V[r],e=s[0],h=s[1],o=s[2];if(i<=e){if(-1===this.AV.indexOf(h)){var u=t.map(function(t){return p.pa(t)+"/s"}).join(", "),a=y.NV+p.wc(d.Fe[h],n?"Live":"VOD",i,u);switch(o){case v.SV:this.logger.info(a);break;case v.RV:this.logger.warn(a);break;default:this.logger.error(a);var f=0==i?g.He:g.Le;w.ErrorMonitor.lt().logError(d.Fe[f],y.NV,f,{isLive:n,CV:t})}this.AV.push(h)}break}}if(-1===this.AV.indexOf(g.ke)){var c=!1;for(r=0;r<t.length;r++){var l=t[r];if(y.kV<l){c=!0,a=y.NV+p.wc(d.Fe[E.Ce.ke],p.pa(l),p.pa(y.kV)),this.logger.warn(a);break}}c&&this.AV.push(g.ke)}},y.prototype.reset=function(){this.AV.length=0},y.NV="[StreamHealthChecker] ",y.kV=35e5,y._V=[[0,g.De,v.ERROR],[4,g.Me,v.SV],[7,g.je,v.RV],[1/0,g.Pe,v.ERROR]],y);function y(t){this.metadata=t,this.AV=[],this.logger=s.Framework.resolve(s.Framework.ht.m).log()}i.NL=e},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e=n(4),h=n(58),o=n(148),u=n(151),a=n(0),f=n(33),c=n(9),l=n(35),v=n(30),d=n(1),E=n(2),p=n(87),w=(g.bH=function(t){return this.yH(t)||-1!=t.indexOf(g.TH)},g.yH=function(t){return-1!=t.toLowerCase().indexOf(g.mH.toLowerCase())||-1!=t.toLowerCase().indexOf(g.DV.toLowerCase())||-1!=t.toLowerCase().indexOf(g.MV.toLowerCase())},g.jV=1,g.PV=2,g.HV=3e4,g.LV=4e3,g.UV=500,g.FV=!0,g.GV=1e4,g.xV=16,g.BV=3,g.mH=".m3u8",g.DV="(format=m3u8-aapl-v3)",g.MV="(video,format=m3u8-aapl-v3,audiotrack=audio)",g.TH=".ts",g);function g(){}i.HLS=w;var b,y=(b=h.UH,s(T,b),T.prototype.getStreamProtocol=function(){return StreamProtocol.HLS},T.prototype.VV=function(t){var i=t.lastIndexOf("/");return t.substr(0,i)},T.prototype.YM=function(){return this.ticket},T.prototype.xH=function(){return this.qV.xH()},T.prototype.isLive=function(){return this.qV.isLive()},T.prototype.VH=function(){return this.qH},T.prototype.getContextId=function(){return this.ticket.Jk()},T.prototype.FH=function(){return this.GH},T.prototype.tL=function(i){try{var t=i.url=this.QV(i.url);return t===this.GH?(this.WV&&this.logger.debug("SAME MANIFEST "+t+","+this.GH),!0):null!=this.qV&&this.qV.YV(t)?(this.WV&&this.logger.debug("CORRECT PLAYLIST "+t+","+this.GH),!0):null!=this.qV&&null!=this.qV.WH(t)?(this.WV&&this.logger.debug("CORRECT SEGMENT "+t+","+this.GH),!0):(w.yH(t)&&this.qV.KV()!==t&&this.WV&&this.logger.debug("FIRST REQUEST FOR MANIFEST "+t+","+this.GH),!1)}catch(t){return d.ErrorMonitor.lt().logError("Error getting the current context of the HiveRequest",this.loggerId,E.Tr.Xn,{detailedError:t,url:i.url}),!1}},T.prototype.QV=function(t){return v(t).NT().toString()},T.prototype.Dp=function(i){try{return w.yH(i)?c.wf.yf:null!=this.qV.WH(i)?c.wf.bf:c.wf.Tf}catch(t){return d.ErrorMonitor.lt().logError("Error getting the entityType",this.loggerId,E.Tr.Yn,{detailedError:t,url:i}),c.wf.Tf}},T.prototype.Gp=function(t){var i=this.Dp(t);if(i==c.wf.bf||i==c.wf.gf)return!0},T.prototype.YH=function(i){var t=0,n=0,r=0,s=!0,e=!1;try{var h=this.Dp(i);if(h!=c.wf.yf){var o=this.qV.WH(i);null!=o&&(t=o.duration,n=o.bitrate,r=o.id,e=this.Gp(i))}else s=!1,null!=this.qV&&this.qV.$V.has(i)&&(n=this.qV.$V.get(i).bitrate,this.rL.set(n,a.Framework.time()));return new l.wA(i,h,s,r,t,n,e,this.getContextId())}catch(t){return d.ErrorMonitor.lt().logError("Error getting the entityCharacteristics from the url",this.loggerId,E.Tr.Kn,{detailedError:t,url:i}),new l.wA(i,c.wf.Tf,!1,0,0,0,!1,this.getContextId())}},T.prototype.oM=function(t,i,n){var r=this.qV.RL(t,i);return null!=r?new l.wA(r.zH,n,!0,t,r.duration,i,!0,this.getContextId()):null},T.prototype.nL=function(i){try{var t=i.sL,n=i.Lp(),r=this.qV.parse(n,t);if(this.hL.eL(),this.qV.$V.has(n)){var s=this.qV.$V.get(n);this.uL.aM(s.bitrate)}i.zp.response=r,i.zp.responseText=r}catch(t){d.ErrorMonitor.lt().logError("Error receiving the metadata",this.loggerId,E.Tr.mr,{detailedError:t,url:i.Lp()}),i.sL&&(i.zp.responseText=i.sL,i.zp.response=i.sL)}},T.prototype.fL=function(t){b.prototype.fL.call(this,t),t.Dp()!=c.wf.yf&&t.Dp()!=c.wf.Tf&&(this.qH.cL(t),t.Dp()==c.wf.bf&&this.uL.iM(t.Mp))},T.prototype.lL=function(t,i){var n=t;return n.vL=a.Framework.time(),b.prototype.lL.call(this,n,i)},T.prototype.TM=function(t){w.FV&&(null==this.wL.get(t)&&this.qV.isLive()?this.gL(t):this.logger.debug("HLS PRE-FETCHING METADATA ALREADY SCHEDULED OR MISSING HLS INFO"))},T.prototype.gL=function(t){var i=this;try{var n=this.qV.XV.get(t);if(null!=n){var r=this.rL.has(t),s=this.rL.get(t),e=(r?s:0)+(null!=n.JV?n.JV[n.JV.length-1].duration:w.LV),h=Math.max(1,e-a.Framework.time()+w.UV);this.logger.info("HLS PREFETCHING METADATA "+n.zH+" BITRATE "+t+" IN "+h);var o=a.Framework.setTimeout(function(){i.bL(t,n.zH,a.Framework.time())},h);this.wL.set(t,o)}else this.logger.warn("NO STREAM WITH BT "+t)}catch(t){d.ErrorMonitor.lt().logError("Error scheduling metadata prefetch",this.loggerId,E.Tr.Or,t)}},T.prototype.bL=function(t,i,n){var r=this.rL.get(t);if(null==r&&(r=0),n<r)this.gL(t);else{var s=new f.HiveRequest(this.ticket.pluginId);s.open("GET",i),s.internal=!0,s.send(),this.wL.delete(t),this.rL.set(t,a.Framework.time())}},T.prototype.oL=function(){var n=this;this.wL.keys().forEach(function(t){var i=n.wL.get(t);a.Framework.clearTimeout(i),n.wL.delete(t)})},T.prototype.IM=function(){return b.prototype.ZH.call(this,w.jV,w.PV)},T.prototype.SM=function(t){try{var i=t.url,n=this.qV.JH(i);return null!=n?this.YH(n.zH):null}catch(t){return d.ErrorMonitor.lt().logError("Error getting the next entity",this.loggerId,E.Tr.$n,t),null}},T.prototype.DM=function(t,i,n,r){return n-t},T.prototype.kM=function(){return w.HV},T.prototype.SL=function(){return w.GV},T.prototype.TL=function(t){},T.prototype.CM=function(t,i){try{var n=this.WD(),r=this.mL(),s=n.cA(),e=0;if(s<t)for(var h=this.qV.RL(s,i);h&&h.id<t;)e+=h.duration,h=h.next;var o=a.Framework.time()-r;return Math.max(0,e-o)}catch(t){return d.ErrorMonitor.lt().logError("Error getting the distance duration",this.loggerId,E.Tr.ir,t),0}},T.prototype.OL=function(t,i){return 1},T);function T(t,i,n){var r=b.call(this,n)||this;return r.WV=!1,r.loggerId="[HLS Context] ",r.Kv=0,r.rL=new e,r.wL=new e,r.ticket=t,(r.zV=i)&&(r.ZV=r.VV(t.Qk())),r.GH=t.$k(),r.qH=new u.tq(n.PD),r.qV=new o.iq,r.hL=new p.NL(r.qV),r}i.CL=y},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),c=n(3),s=n(0),l=n(90),v=n(62),d=n(91),E=n(1),p=n(2),e=(h.prototype.init=function(t,i){this.nq=t,this.rq=i},h.prototype.put=function(t){var i=c.defer();try{var n=t.jp(),r=t.$p,s=t.Xp,e=t.Vp.bp-1,h=t.Vp.bp;-1==this.sq&&this.eq();var o=null,u=!1;if(this.hq.has(n)){o=this.hq.get(n);var a=new v.TU(0,e,h);u=!0,o.content.forEach(function(t,i){v.SU.OU(i).yU(a)&&(u=!1)})}else{var f=new v.TU(0,e,h).toString();o=new d.oq(t.Mp),t.lB&&(o.uq=t.lB.LM.peerInfo),o.content.set(f,new l.aq(h,s,t.Vp,t.kp())),this.hq.set(n,o),u=!0,this.fq.unshift(n)}null==o.headers&&null!=r&&(o.headers=r),u?i.resolve(!0):i.reject(!1)}catch(t){E.ErrorMonitor.lt().logError("Error adding fragment in LiveCache",this.loggerId,p.bi.di,t),i.reject("CACHE PUT ERROR "+t)}return i.promise},h.prototype.get=function(t){var i=c.defer();try{var n=this.hq.get(t);if(null!=n){var r=null;n.content.forEach(function(t,i){if(v.SU.OU(i).gU())return(r=t).headers=n.headers,void(r.uq=n.uq)}),i.resolve(r)}else i.reject(!1)}catch(t){E.ErrorMonitor.lt().logError("Error getting fragment from LiveCache",this.loggerId,p.bi.Ei,t),i.reject("CACHE GET ERROR "+t)}return i.promise},h.prototype.OM=function(t){try{return this.hq.keys()}catch(t){return E.ErrorMonitor.lt().logError("Error getting keys from LiveCache",this.loggerId,p.bi.wi,t),[]}},h.prototype.cq=function(t){var i=c.defer();try{i.resolve(this.hq.values())}catch(t){E.ErrorMonitor.lt().logError("Error getting elements from LiveCache",this.loggerId,p.bi.gi,t),i.reject("CACHE GET ELEMENTS ERROR "+t)}return i.promise},h.prototype.contains=function(t){var i=c.defer();try{this.hq.has(t)?i.resolve(!0):i.resolve(!1)}catch(t){E.ErrorMonitor.lt().logError("Error checking if LiveCache contains the fragment",this.loggerId,p.bi.pi,t),i.reject("CACHE CONTAINS ERROR "+t)}return i.promise},h.prototype.eq=function(){var t=this;this.lq(),this.logger.debug(this.loggerId+"Starting cache periodic purge"),this.sq=s.Framework.setInterval(function(){t.J()},this.rq)},h.prototype.lq=function(){-1!=this.sq&&(this.logger.debug(this.loggerId+" Stopping cache periodic purge"),s.Framework.clearInterval(this.sq),this.sq=-1)},h.prototype.J=function(){var r=this;try{var s=0,e=0,t=0;this.logger.debug(this.loggerId+" RUNNING GC"),this.fq.every(function(t,i){var n=r.hq.get(t).size();return s+n>r.nq?(e=i,!1):(s+=n,!0)})||(t=this.fq.length-e,this.fq.splice(e,this.fq.length-1).forEach(function(t){r.hq.delete(t)})),this.logger.debug(this.loggerId+" GC DONE - REMOVED: "+t+" - CURRENT ITEMS: "+this.hq.length+" SIZE: "+s+" "),0===this.hq.length&&(this.logger.debug(this.loggerId+" Cache contains no items, stopping purge timer"),this.lq())}catch(t){E.ErrorMonitor.lt().logError("Error purging LiveCache",this.loggerId,p.bi.yi,t)}},h.prototype.vq=function(){this.hq=new r,this.fq=[]},h.prototype.dq=function(){var n=this;this.hq.forEach(function(t,i){n.logger.debug("EID="+i),t.content.forEach(function(t,i){n.logger.debug("\tRANGE ",i)})})},h);function h(){this.loggerId="[LIVE CACHE] ",this.hq=new r,this.sq=-1,this.fq=[],this.logger=s.Framework.resolve(s.Framework.ht.m).log()}i.Eq=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.length=t,this.data=i,this.Vp=n,this.pq=r}i.aq=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(62),s=n(4),e=(h.prototype.size=function(){var n=0;return this.content.forEach(function(t,i){n+=r.SU.OU(i).size()}),n},h);function h(t){this.headers=null,this.uq=null,this.totalSize=0,this.wq=!1,this.Mp=t,this.content=new s}i.oq=e},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.gq||(i.gq={}))[r.bq=0]="ALL",r[r.AS=1]="AS",r[r.ID=2]="SITE"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(0),o=n(20),u=n(5),a=n(10),f=n(3),s=n(4),c=n(59),l=n(170),v=n(1),d=(E.prototype.init=function(t){this.yq=t,this.logger=h.Framework.resolve(h.Framework.ht.m).log(t.sessionId),this.PD=t.PD,this.Tq=t.Tq,this.LD=t.LD},E.prototype.mq=function(t,i){var n=this,r=f.defer();try{if(this.Oq){var s=null;t.privateIpString&&(s=t.privateIpString);var e=new l.Sq(t.guid,t.rankValue,s,t.isLeader);if(this.Rq.has(e.uuid)){var h=this.Rq.get(e.uuid);h.udpScore==e.udpScore&&h.Iq==e.Iq?r.resolve():(this.Rq.set(e.uuid,e),this._q(),this.Aq(e).then(function(){r.resolve()}).fail(function(t){n.Rq.delete(e.uuid),n._q(),r.reject(t)}))}else i?(e.Nq=i,this.logger.info(this.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.Iq),this.Rq.set(e.uuid,e),this._q(),this.Aq(e).then(function(){n.Cq(n.Rq.get(e.uuid)),r.resolve()}).fail(function(t){n.Rq.delete(e.uuid),n._q(),r.reject(t)})):this.kq(e).then(function(t){e.Nq=t,n.logger.info(n.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.Iq),n.Rq.set(e.uuid,e),n._q(),n.Aq(e).then(function(){r.resolve()}).fail(function(t){n.Rq.delete(e.uuid),n._q(),r.reject(t)})}).fail(function(t){r.reject(t)})}else r.reject("LEADER ELECTION NOT STARTED YET")}catch(t){r.reject("TRIGGER LEADER ELECTION ERROR "+t)}return r.promise},E.prototype.Cq=function(t){var i=new a.Nf(a.mf.k,null);i.guid=t.uuid,i.isLeader=t.Iq,i.rankValue=t.udpScore;var n=[i];this.Tq.Dq(n,!1)},E.prototype.kq=function(n){var r=this,s=f.defer();return this.Mq.has(n.uuid)||this.jq.has(n.uuid)?s.reject(e.Pq):(this.Mq.set(n.uuid,Date.now()),this.yv.connect(n.uuid).then(function(t){var i=t.mv.gv(r.yq.swarmId);null==i?(i=t.mv.lv(r.yq.swarmId),r.Hq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done()):r.Lq.get(n.uuid)?s.resolve(t):(r.Mq.delete(n.uuid),r.Hq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done())}).fail(function(t){r.Mq.delete(n.uuid),s.reject(t)}).done()),s.promise},E.prototype.Hq=function(t){var i=this,n=f.defer(),r=new o.$v.Qv.UDPHandshakeMessage;r.uuid=this.Uq.uuid,r.udpScore=this.Uq.udpScore,r.isLeader=this.Uq.Iq,r.streamId=this.Uq.streamId,this.logger.debug(this.loggerId+"MSG uuid "+r.uuid+" rankValue "+r.udpScore+" isLeader "+r.isLeader+" stream id "+r.streamId);var s=h.Framework.setTimeout(function(){i.Fq(t.otherGuid)},u.ea.UDPBroadcast.yu);return this.jq.set(t.otherGuid,{Gq:s,defer:n}),t.Sv(o.ev.uv,r),n.promise},E.prototype.Fq=function(t){if(this.jq.has(t)){this.logger.debug(this.loggerId+" HANDSHAKE REQ EXPIRED TO "+t);var i=this.jq.get(t);this.jq.delete(t),i.defer.reject("EXPIRED")}},E.prototype.xq=function(t,i){try{this.logger.debug(this.loggerId+"HANDSHAKE RESP RECEIVED FROM "+i.otherGuid);var n=i.otherGuid,r=this.jq.get(n);h.Framework.clearTimeout(r.Gq),this.jq.delete(n),r.defer.resolve(i)}catch(t){v.ErrorMonitor.lt().logError("HANDSHAKE RESPONSE RECEIVED FAILED",this.loggerId,t)}},E.prototype.Bq=function(t,i){var n=this;try{var r=new a.Nf(a.mf.k,null,t.isLeader);if(r.guid=t.uuid,r.rankValue=t.udpScore,t.streamId===this.PD.getContextId()){var s=i.mv.gv(this.yq.swarmId);this.Lq.set(t.uuid,t.uuid),this.Vq(s,"OK"),this.mq(r,i).then(function(){}).fail(function(t){v.ErrorMonitor.lt().logError("LEADER ELECTION FAILED",n.loggerId,t)})}}catch(t){v.ErrorMonitor.lt().logError("HANDSHAKE REQUEST FAILED",this.loggerId,t)}},E.prototype.Vq=function(t,i){var n=new o.$v.Qv.UDPHandshakeResponse;n.accept=i,t.Sv(o.ev.UDPHandshakeResponse,n),this.logger.debug(this.loggerId+"SEND HANDSHAKE RESPONSE TO "+t.otherGuid)},E.prototype.Aq=function(t){var i=this,n=f.defer();if(this.qq()){var r=!1;this.logger.info(this.loggerId+"I HAVE THE HIGHEST SCORE"),t.Iq&&!this.Qq.has(t.uuid)&&(r=!0,this.logger.info(this.loggerId+"SEND SWITCH REQUEST TO "+t.uuid),this.Wq(t).then(function(){n.resolve()}).fail(function(t){3==t.Yq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.Yq=2)&&n.reject(t)})),this.Uq.Iq||null==this.Kq||this.Kq.uuid==t.uuid||this.Qq.has(this.Kq.uuid)||(this.logger.info("SEND SWITCH REQUEST TO THE ALREADY KNOWN LEADER"),r=!0,this.Wq(this.Kq).then(function(){n.resolve()}).fail(function(t){3==t.Yq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.Yq=2)&&n.reject(t)})),null!=this.Kq||t.Iq||this.Uq.Iq||0!=this.Qq.length||(this.logger.info(this.loggerId+"BECOME LEADER"),this.$q()),r||n.resolve()}else this.Xq(t)&&(this.logger.info(this.loggerId+"PEER "+t.uuid+" HAS THE HIGHEST SCORE"),this.Jq(),this.Uq.Iq&&t.Iq&&this.stepDown(),this.zq(t)),n.resolve();return n.promise},E.prototype.zq=function(t){try{this.logger.info(this.loggerId+"UPDATE THE LEADERSHIP"),null!=this.Kq&&this.Rq.has(this.Kq.uuid)&&(this.Rq.get(this.Kq.uuid).Iq=!1),this.Rq.has(t.uuid)?(this.Rq.get(t.uuid).udpScore=t.udpScore,this.Kq=t,this.Rq.get(t.uuid).Iq=!0):(this.logger.warn(this.loggerId+"SET A LEADER THAT IS NOT A LAN MEMBER LIST. SHOULD NEVER HAPPEN"),this.Rq.set(t.uuid,t),this.Kq=t),this.PD.Zq(t),this.logger.info(this.loggerId+"NEW KNOWN LEADER "+this.PD.KM().uuid)}catch(t){v.ErrorMonitor.lt().logError(t,this.loggerId)}},E.prototype.stepDown=function(){this.logger.info(this.loggerId+"STEP DOWN"),this.Uq.Iq=!1,this.PD.tQ(!1),u.ea.Ku.jo&&(this.LD.iQ(),this.LD.nQ(!1))},E.prototype.Jq=function(){for(var t=0,i=this.Qq.keys();t<i.length;t++){var n=i[t],r=this.Qq.get(n);this.Qq.delete(n),h.Framework.clearTimeout(r.Gq),r.defer.reject({Yq:3,message:"CANCELED PENDING RESPONSES"})}},E.prototype.Xq=function(t){return t.uuid==this.rQ[0].uuid},E.prototype.qq=function(){return l.Sq.TO(this.Uq,this.rQ[0])<0},E.prototype._q=function(){var t=new c(this.Rq.values()),i=t.Ff(l.Sq.TO);t.push(this.Uq),this.PD.sQ(i);var n=new c(this.Rq.values());this.rQ=n.Ff(l.Sq.TO)},E.prototype.eQ=function(t){this.hQ(t)},E.prototype.hQ=function(t){this.logger.info(this.loggerId+"EVALUATE THE SWITCH REQUEST FROM "+t.uuid);var i=void 0;this.Rq.has(t.uuid)?i=this.Rq.get(t.uuid):this.logger.warn("I RECEIVED A SWITCH REQUEST FROM AN UNKNOWN MEMBER. THIS SHOULD NEVER HAPPEN"),i&&(this.Uq.Iq?this.qq()?this.oQ(i,!1):(this.stepDown(),this.Jq(),this.zq(i),this.oQ(i,!0)):this.Xq(i)?(this.zq(i),this.oQ(i,!0)):this.oQ(i,!1))},E.prototype.oQ=function(t,i){var n=this;this.uQ(t.Nq,i).then(function(){}).fail(function(t){v.ErrorMonitor.lt().logError("SEND SWITCH RESPONSE ERROR",n.loggerId,t)}).done()},E.prototype.uQ=function(t,i){var n=f.defer(),r=new o.$v.Qv.UDPSwitchLeadershipAck;return r.ok=i,t.mv.gv(this.yq.swarmId).Sv(o.ev.av,r),n.promise},E.prototype.Wq=function(i){var n=this,r=f.defer();return this.aQ(i.Nq).then(function(t){n.fQ(t,i),r.resolve()}).fail(function(t){r.reject(t)}).done(),r.promise},E.prototype.fQ=function(t,i){try{t?(this.Rq.get(i.uuid).Iq=!1,this.Kq=this.Uq,this.$q()):(this.Jq(),this.Rq.get(i.uuid).Iq=!0,this.stepDown(),this.zq(i))}catch(t){v.ErrorMonitor.lt().logError("HANDLE LEADERSHIP SWITCH RESPONSE ERROR",this.loggerId,t)}},E.prototype.cQ=function(t,i){if(this.Qq.has(i)){var n=this.Qq.get(i);h.Framework.clearTimeout(n.Gq),this.Qq.delete(i),n.defer.resolve(t.ok)}else this.logger.warn(this.loggerId+" SWITCH LEADERSHIP RESPONSE RECEIVED FROM UNKNOWN PEER "+i)},E.prototype.aQ=function(t){var i=this,n=f.defer(),r=new o.$v.Qv.UDPSwitchLeadershipRequest;r.uuid=this.Uq.uuid,r.udpScore=this.Uq.udpScore,this.logger.debug(this.loggerId+"SWITCH LEADERSHIP REQUEST TO "+t.otherGuid);var s=h.Framework.setTimeout(function(){i.lQ(t.otherGuid)},u.ea.UDPBroadcast.bu);this.Qq.set(t.otherGuid,{Gq:s,defer:n});var e=t.mv.gv(this.yq.swarmId);return h.Framework.setTimeout(function(){e.Sv(o.ev.UDPSwitchLeadershipRequest,r)},1),n.promise},E.prototype.lQ=function(t){if(this.Qq.has(t)){this.logger.info(this.loggerId+" SWITCH LEADERSHIP EXPIRED TO "+t);var i=this.Qq.get(t);this.Qq.delete(t),i.defer.reject({Yq:2,message:"EXPIRED"})}},E.prototype.$q=function(){this.logger.info(this.loggerId+"BECOMING LAN LEADER"),null!=this.Kq&&this.Rq.has(this.Kq.uuid)&&(this.Rq.get(this.Kq.uuid).Iq=!1),this.Uq.Iq=!0,this.Kq=this.Uq,this.PD.tQ(!0),this.PD.Zq(this.Uq),u.ea.Ku.jo&&(this.LD.iQ(),this.LD.nQ(!0))},E.prototype.AE=function(t){this.Uq=new l.Sq(this.PD.getId(),this.PD.vQ(),"",!1,this.PD.getContextId()),this.Oq=!0,this.logger.info(this.loggerId+" UDP LEADER ELECTION STARTED")},E.prototype.dQ=function(t){this.Rq.delete(t),this._q(),0==this.Rq.length?(this.Uq.Iq=!1,this.Kq=null,this.PD.tQ(!1),this.PD.EQ(!1),this.LD.iQ(),this.LD.nQ(!1)):this.qq()?this.$q():0<this.rQ.length&&this.zq(this.rQ[0])},E);function E(){this.Oq=!1,this.loggerId="[UDPLeaderElection] ",this.yv=h.Framework.resolve(h.Framework.ht.v),this.Rq=new s,this.Qq=new s,this.jq=new s,this.Mq=new s,this.Lq=new s,this.rQ=[]}i.pQ=d,(r=e=i.wQ||(i.wQ={}))[r.gQ=0]="FAILURE",r[r.Pq=1]="ALREADY_PENDING"},function(t,i){},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var v,e,d,h,o=n(3),u=n(4),E=n(0),p=n(163),w=n(5),a=n(20),f=n(10),c=n(164),l=n(16),g=hive.services.protocol.oU.TrackerPeerInfo,b=n(7),y=n(1),T=n(2),m=b.ut.$a;(e=v=i.bQ||(i.bQ={}))[e.yQ=1]="ACCEPT",e[e.TQ=2]="REJECT",(h=d=i.mQ||(i.mQ={}))[h.bq=0]="ALL",h[h.OQ=1]="IN",h[h.SQ=2]="OUT";var O,S=(O=c.RQ,s(R,O),R.prototype.init=function(t){O.prototype.init.call(this,t),this.yq=t,this.ticket=t.yd.ticket,this.Tq=t.Tq,this.LD=t.LD,this.IQ=t.IQ,this._Q.init(t),this.AQ.init(t)},R.prototype.start=function(t){try{this.logger.info(this.loggerId+"PARTNERSHIP STARTED "+t.getContextId()),this.context=t,this.contextId=t.getContextId(),this.NQ(w.ea.Bu.no),this.CQ(w.ea.Ku.Uo),this.kQ(w.ea.Vu.ho),this.active=!0}catch(t){y.ErrorMonitor.lt().logError("Error in partnership initialization",this.loggerId,T.Yi.Ki,t)}},R.prototype.stop=function(){return E.Framework.clearInterval(this.DQ),E.Framework.clearInterval(this.MQ),E.Framework.clearInterval(this.jQ),this.context=null,this.contextId=null,this.active=!1,this.PQ()},R.prototype.AE=function(t){this.logger.info("PARTNERSHIP SERVER CONNECTED"),this.tE=t,this.connected=!0,null==this.PD.getId()&&this.PD.setId(this.tE)},R.prototype.HQ=function(){this.connected=!1},R.prototype.LQ=function(i){try{this.UQ(i)||this.FQ.has(i.peerInfo.guid)||this.Mq.has(i.peerInfo.guid)||i.peerInfo.guid==this.tE?this.GQ(i):this.xQ(i),this.BQ(i)&&this.VQ(i)}catch(t){y.ErrorMonitor.lt().logError("Error in discoering new lan peer",this.loggerId,T.Yi.$i,{detailedError:t,otherGuid:i.peerInfo.guid})}},R.prototype.GQ=function(t){if(this.qQ.has(t.peerInfo.guid)){var i=this.qQ.get(t.peerInfo.guid);this.qQ.delete(t.peerInfo.guid),this.vG.set(t.peerInfo.guid,i),this.PD.EQ(!0)}},R.prototype.VQ=function(t){if(this.cG.has(t.peerInfo.guid)){var i=this.cG.get(t.peerInfo.guid);this.cG.delete(t.peerInfo.guid),this.lG.set(t.peerInfo.guid,i)}},R.prototype.NQ=function(t){var i=this;-1!=this.DQ&&E.Framework.clearInterval(this.DQ),this.DQ=E.Framework.setInterval(function(){i.QQ(!1)},t)},R.prototype.QQ=function(t){var i=this;t&&this.DQ&&(E.Framework.clearInterval(this.DQ),this.NQ(w.ea.Bu.no));try{if(this.connected){this.logger.debug(this.loggerId+"ADDING NEW PEERS IF POSSIBLE, NOW "+this.qQ.length+"/"+w.ea.Bu.io+","+this.vG.length+"/infinity OUT RND "+this.cG.length+" OUT LAN "+this.lG.length);var n=[].concat(this.FQ.keys()).concat(this.Mq.keys()),r=this.Tq.WQ(!0),s=void 0;s=this.PD.AM()||this.PD.VM()?this.AQ.YQ(w.ea.Bu.io,this.qQ.values(),n,r):this._Q.YQ(w.ea.Bu.io,this.qQ.values(),n,r),this.KQ=s.$Q(),s.XQ().forEach(function(t){i.xQ(t)})}else this.logger.warn(this.loggerId+"NOT RUNNING IN PARTNER CHOICE, SRV DISCONNECTED")}catch(t){y.ErrorMonitor.lt().logError("Error in choosing in partners",this.loggerId,T.Yi.Xi,t)}},R.prototype.xQ=function(s){var e=this,h=s.peerInfo.guid,t=s.peerInfo.privateIpString,i=s.peerInfo.publicIpString;this.logger.debug(this.loggerId+"IN PARTNER ADD PROCESS "+h),this.UQ(s)||this.FQ.has(h)||this.Mq.has(h)||this.IQ.JQ(h,t,i)||(this.Mq.set(h,Date.now()),this.yv.connect(h).then(function(t){var n=t.mv.gv(e.yq.swarmId);if(null==n&&(n=t.mv.lv(e.yq.swarmId)),n){var r=e.Mq.get(h);e.Mq.delete(h),e.active&&e.zQ(n).then(function(t){if(e.ZQ(n,s,t.msg,r),e.iW.tW(!1,!1),e.IQ.nW(h,s.peerInfo.privateIpString,s.peerInfo.publicIpString),e.rW(n),0<e.KQ.length&&!s.sW()){var i=e.KQ[0];e.eW(i.guid),i.oW.hW(d.SQ),e.KQ.splice(0,1)}}).fail(function(t){t&&"NOT ACCEPTED"!=t&&y.ErrorMonitor.lt().logError("Error in requesting partnership",e.loggerId,T.Yi.Zi,{otherGuid:h}),e.iW.tW(!1,!0),e.uW(h)})}}).fail(function(t){y.ErrorMonitor.lt().logError("Error in creating new p2p connection",e.loggerId,T.Yi.zi,{otherGuid:h}),e.iW.tW(!0,!0),e.Mq.delete(h),e.Tq.dQ(h)}).done())},R.prototype.aW=function(i,t){var n=this;try{var r=i.guid,s=null,e=null;if(i.privateIpString&&(e=i.privateIpString),i.publicIpString&&(s=i.publicIpString),this.fW(r))this.logger.info(this.loggerId+"ALREADY OUT PARTNER "+r);else{var h=i.contextId,o=t.mv.gv(this.yq.swarmId);if(this.contextId!==h||w.ea.Vu.eo!==i.p2pProtocolVersion||this.IQ.JQ(r,e,s))this.logger.info(this.loggerId+"PARTNERSHIP CANNOT BE ESTABLISHED WITH "+r+" CONTEXT ID "+h+" protocol version "+i.p2pProtocolVersion),this.cW(o,v.TQ);else{var u=this.lW(i),a=void 0,f=void 0;if(u){if(this.Tq.Dq([u],!1),!(a=(f=this.Tq.vW(r)).sW()||this.cG.length<w.ea.Bu.so)){this.logger.debug(this.loggerId+" got out part req from "+r+" - reached max "+this.cG.length+"/"+w.ea.Bu.so);var c=void 0;(c=this.PD.AM()||this.PD.VM()?this.EW.dW(this.PD,u,this.cG.values()):this.pW.dW(this.cG.values()))&&(this.logger.debug(this.loggerId+" chocking "+c.guid),this.cG.delete(c.guid),c.oW.hW(d.OQ),a=!0)}}else a=!1;if(a){var l=new p.Partner(r,this.iW,o,this.logger,!1,f);i.reportingGuid&&l.wW(i.reportingGuid),this.Tq.gW.has(r)?this.lG.set(r,l):this.cG.set(r,l),this.logger.info(this.loggerId+"ADDED OUT PART "+r),this.cW(o,v.yQ),this.IQ.nW(r,e,s),E.Framework.setTimeout(function(){n.bW(r)},500),this.iW.yW()}else this.logger.info(this.loggerId+" cannot establish partnership to "+r+" - reached max "+this.cG.length+"/"+w.ea.Bu.so),this.cW(o,v.TQ)}}}catch(t){y.ErrorMonitor.lt().logError("Error receiving out partnership request",this.loggerId,T.Yi.tn,{detailedError:t,otherGuid:i.guid})}},R.prototype.lW=function(i){try{var t=new g;t.guid=i.guid,i.internalAs&&(t.internalAs=i.internalAs),i.externalAs&&(t.externalAs=i.externalAs),i.publicIpString&&(t.publicIpString=i.publicIpString),i.privateIpString&&(t.privateIpString=i.privateIpString);var n=!1,r=this.Tq.vW(i.guid);if(r&&(n=r.peerInfo.isLeader),i.streamCharacteristics){var s=[];i.streamCharacteristics.forEach(function(t){var i=new f.TrackerPeerStreamInfo;i.state=t.streamState,i.bitrate=t.bitrate,i.delta=t.delta,s.push(i)}),t.streams=s}return new f.Nf(f.mf.Of,t,n)}catch(t){return y.ErrorMonitor.lt().logError("Error constructing discovered peer info",this.loggerId,T.Yi.in,{detailedError:t,otherGuid:i.guid}),null}},R.prototype.cW=function(i,t){var r=this;this.logger.debug(this.loggerId+"SEND PART RESPONSE TO "+i.otherGuid);try{var n=new a.$v.Qv.OutPartnershipResponse;if(n.accept=t,n.accept===v.yQ){this.PD.PM()&&(n.internalAs=this.PD.PM()),this.PD.HM()&&(n.externalAs=this.PD.HM()),this.PD.getPublicIp()&&(n.publicIpString=this.PD.getPublicIp()),this.PD.getPrivateIp()&&(n.privateIpString=this.PD.getPrivateIp()),n.reportingGuid=this.PD.getReportingGuid();var s=this.PD.TW(),e=[];s.forEach(function(t,i){var n=new a.$v.Qv.StreamCharacteristics;n.bitrate=i,n.streamState=t.type,n.delta=null!=r.PD.getDelta()?r.PD.getDelta():-1,e.push(n)}),0<e.length&&n.setStreamCharacteristics(e)}i.Sv(a.ev.ov,n)}catch(t){y.ErrorMonitor.lt().logError("Error constructing partnership response message",this.loggerId,T.Yi.nn,{detailedError:t,otherGuid:i.otherGuid})}},R.prototype.mW=function(t){this.logger.warn(this.loggerId+t)},R.prototype.ZQ=function(t,i,n,r){var s=t.otherGuid;if(n.externalAs&&(i.peerInfo.externalAs=n.externalAs),n.internalAs&&(i.peerInfo.internalAs=n.internalAs),n.publicIpString&&(i.peerInfo.publicIpString=n.publicIpString),n.privateIpString&&(i.peerInfo.privateIpString=n.privateIpString),n.streamCharacteristics){var e=[];n.streamCharacteristics.forEach(function(t){var i=new f.TrackerPeerStreamInfo;i.state=t.streamState,i.bitrate=t.bitrate,i.delta=t.delta,e.push(i)}),i.peerInfo.streams=e}try{var h=new p.Partner(s,this.iW,t,this.logger,!0,i,r);return n.reportingGuid&&(h.reportingGuid=n.reportingGuid,t.receiver.setReportingGuid(n.reportingGuid),t.sender.setReportingGuid(n.reportingGuid)),i.peerInfo.type==f.mf.k?(this.vG.set(s,h),this.PD.OW(!0),this.PD.SW(!0),this.PD.EQ(!0)):(0!=this.PD.HM()&&this.PD.HM()===i.peerInfo.externalAs&&this.PD.OW(!0),0!=this.PD.PM()&&this.PD.PM()===i.peerInfo.internalAs&&this.PD.SW(!0),this.qQ.set(s,h)),this.logger.debug(this.loggerId+s+" IS NOW IN PARTNER"),h}catch(t){y.ErrorMonitor.lt().logError("Error adding a new partner object in the list",this.loggerId,T.Yi.rn,{detailedError:t,otherGuid:s})}},R.prototype.dQ=function(i){try{this.logger.info(this.loggerId+"GOT PEER DISC "+i),this.RW(i)&&(this.logger.info(this.loggerId+"IN PRT DISC "+i),this.eW(i)),this.fW(i)&&(this.logger.info(this.loggerId+"OUT PRT DISC "+i),this.cG.delete(i),this.lG.delete(i))}catch(t){y.ErrorMonitor.lt().logError("Error removing disconected partner from the list",this.loggerId,T.Yi.sn,{detailedError:t,otherGuid:i})}},R.prototype.eW=function(i){try{this.logger.debug(this.loggerId+"IN PARTNER REMOVE "+i);var t=this.IW(i);if(this.DD._W(t),this.qQ.delete(i),this.vG.delete(i),0<this.vG.length)this.PD.OW(!0),this.PD.SW(!0);else{var n=this.PD.PM(),r=this.PD.HM(),s=!1,e=!1;0!=n||0!=r?(this.qQ.forEach(function(t){0<n&&n===t.LM.peerInfo.internalAs&&(s=!0),0<r&&r===t.LM.peerInfo.externalAs&&(e=!0)}),this.PD.SW(s),this.PD.OW(e)):(this.PD.SW(!1),this.PD.OW(!1))}}catch(t){y.ErrorMonitor.lt().logError("Error removing the in partner",this.loggerId,T.Yi.en,{detailedError:t,otherGuid:i})}},R.prototype.AW=function(i,t){try{this.logger.debug(this.loggerId+"CLOSE RECEIVED FROM "+i+" TYPE "+d[t.getType()]),t.getType()!=d.bq&&t.getType()!=d.SQ||(this.cG.has(i)&&this.cG.delete(i),this.lG.has(i)&&this.lG.delete(i)),t.getType()!=d.bq&&t.getType()!=d.OQ||this.eW(i)}catch(t){y.ErrorMonitor.lt().logError("Error when close received",this.loggerId,T.Yi.hn,{detailedError:t,otherGuid:i})}},R.prototype.zQ=function(i){var r=this,n=o.defer();try{var t=new a.$v.Qv.OutPartnershipRequest;t.guid=this.tE,t.contextId=this.contextId,t.p2pProtocolVersion=w.ea.Vu.eo,t.reportingGuid=this.PD.getReportingGuid(),this.PD.PM()&&(t.internalAs=this.PD.PM()),this.PD.HM()&&(t.externalAs=this.PD.HM()),this.PD.getPrivateIp()&&(t.privateIpString=this.PD.getPrivateIp()),this.PD.getPublicIp()&&(t.publicIpString=this.PD.getPublicIp());var s=this.PD.TW(),e=[];s.forEach(function(t,i){var n=new a.$v.Qv.StreamCharacteristics;n.bitrate=i,n.streamState=t.type,n.delta=null!=r.PD.getDelta()?r.PD.getDelta():-1,e.push(n)}),0<e.length&&t.setStreamCharacteristics(e),this.logger.debug(this.loggerId+"SEND PART REQ TO "+i.otherGuid+" WITH ID "+t.contextId+" internalAS "+t.internalAs+" externalAs "+t.externalAs+" private ip "+t.privateIpString+" public ip "+t.publicIpString+" rGuid "+this.PD.getReportingGuid());var h=E.Framework.setTimeout(function(){r.NW(n,i.otherGuid)},w.ea.Bu.to);this.FQ.set(i.otherGuid,{Gq:h,defer:n}),i.Sv(a.ev.hv,t)}catch(t){y.ErrorMonitor.lt().logError("Error sending partnership request",this.loggerId,T.Yi.un,{detailedError:t,otherGuid:i.otherGuid}),n.reject(t)}return n.promise},R.prototype.kW=function(t,i){var n=i.otherGuid,r=this.FQ.get(n);r?(E.Framework.clearTimeout(r.Gq),this.FQ.delete(n),t.accept===v.yQ?r.defer.resolve({Kl:i,msg:t}):r.defer.reject("NOT ACCEPTED")):y.ErrorMonitor.lt().logError("Error receiving out partnership response from an unknown peer",this.loggerId,T.Yi.cn,{otherGuid:n})},R.prototype.NW=function(t,i){if(this.FQ.has(i)){y.ErrorMonitor.lt().logError("Error partnership request expired",this.loggerId,T.Yi.an,{otherGuid:i});var n=this.FQ.get(i);this.FQ.delete(i),n.defer.reject("EXPIRED")}else y.ErrorMonitor.lt().logError("Error partnership request expired for unknown peer",this.loggerId,T.Yi.fn,{otherGuid:i})},R.prototype.PQ=function(){var i=this,n=o.defer(),r=this.qQ.values();this.vG.forEach(function(t,i){r.push(t)});var t=r.slice().map(function(t){return t.oW.close()});return o.all(t).then(function(t){n.resolve("resolved")}).fail(function(t){y.ErrorMonitor.lt().logError("Error closing partnership",i.loggerId,T.Yi.vn),n.reject("could not close")}),n.promise},R.prototype.uW=function(t){this.yv.disconnect(t)},R.prototype.CQ=function(t){var i=this;-1!=this.MQ&&E.Framework.clearInterval(this.MQ),this.MQ=E.Framework.setInterval(function(){i.DW()},t)},R.prototype.DW=function(){try{if(this.PD.GM()&&!this.PD.AM()&&m){var t=this.PD.KM(),i=this.context.WD().bitrate;if(i&&this.RW(t.uuid)){var n=this.IW(t.uuid);this.MW(n.oW,i)}}}catch(t){y.ErrorMonitor.lt().logError("Error announcing bitrate",this.loggerId,T.Yi.dn,t)}},R.prototype.MW=function(i,t){try{var n=new a.$v.Qv.Bitrate;n.guid=this.tE,n.bitrate=t,this.logger.debug(this.loggerId+"ANNOUNCE BITRATE "+n.bitrate+" TO PEER GUID "+i.otherGuid),i.Sv(a.ev.Bitrate,n)}catch(t){y.ErrorMonitor.lt().logError("Error constructing bitrate announcement",this.loggerId,T.Yi.En,{detailedError:t,otherGuid:i.otherGuid})}},R.prototype.jW=function(i){try{this.logger.debug(this.loggerId+"RECEIVED BITRATE "+i.bitrate+" FROM PEER GUID "+i.guid),this.Tq.gW.has(i.getGuid())&&(this.Tq.gW.get(i.guid).PW(i.bitrate),this.LD.HW())}catch(t){y.ErrorMonitor.lt().logError("Error receiving bitrate info",this.loggerId,T.Yi.pn,{detailedError:t,otherGuid:i.guid})}},R.prototype.LW=function(i){try{var t=i.guid,n=this.IW(t);n&&this.UW(n,i),(n=this.FW(t))&&this.UW(n,i),this.IQ.nW(t,i.privateIpString,i.publicIpString)}catch(t){y.ErrorMonitor.lt().logError("Error receiving peer info",this.loggerId,T.Yi.wn,{detailedError:t,otherGuid:i.guid})}},R.prototype.UW=function(t,i){var n=t.LM.peerInfo;if(i.privateIpString&&(n.privateIpString=i.privateIpString),i.publicIpString&&(n.publicIpString=i.publicIpString),i.externalAs&&(n.externalAs=i.externalAs),i.internalAs&&(n.internalAs=i.internalAs),i.streamCharacteristics){var r=[];i.streamCharacteristics.forEach(function(t){var i=new f.TrackerPeerStreamInfo;i.bitrate=t.bitrate,i.delta=t.delta,i.state=t.streamState,r.push(i)}),n.streams=r}},R.prototype.kQ=function(t){var i=this;this.jQ&&E.Framework.clearInterval(this.jQ),this.jQ=E.Framework.setInterval(function(){i.GW()},t)},R.prototype.GW=function(){var r=this;try{if(this.PD.getPrivateIp()||this.PD.getPublicIp()||this.PD.PM()||this.PD.HM()){var t=this.xW(),n=new a.$v.Qv.PeerInfoMessage;n.guid=this.PD.getId(),this.PD.getPrivateIp()&&(n.privateIpString=this.PD.getPrivateIp()),this.PD.getPublicIp()&&(n.publicIpString=this.PD.getPublicIp()),this.PD.HM()&&(n.externalAs=this.PD.HM()),this.PD.PM()&&(n.internalAs=this.PD.PM());var i=this.PD.TW(),s=[];i.forEach(function(t,i){var n=new a.$v.Qv.StreamCharacteristics;n.bitrate=i,n.streamState=t.type,n.delta=null!=r.PD.getDelta()?r.PD.getDelta():-1,s.push(n)}),0<s.length&&n.setStreamCharacteristics(s),t.forEach(function(t,i){t.oW.Sv(a.ev.fv,n)})}}catch(t){y.ErrorMonitor.lt().logError("Error announcing peer info to all partners",this.loggerId,T.Yi.gn,t)}},R.prototype.xW=function(){try{var n=new u;return this.cG.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.lG.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.vG.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.qQ.forEach(function(t,i){n.has(i)||n.set(i,t)}),n}catch(t){return y.ErrorMonitor.lt().logError("Error collecting all partners",this.loggerId,T.Yi.bn,t),new u}},R);function R(){var t=O.call(this)||this;return t.loggerId="[Partnership] ",t.FQ=new u,t.Mq=new u,t.DQ=-1,t.MQ=-1,t.jQ=-1,t.connected=!1,t.yv=E.Framework.resolve(E.Framework.ht.v),t._Q=E.Framework.resolve(l.nl._c),t.pW=E.Framework.resolve(l.nl.Ac),t.AQ=E.Framework.resolve(l.nl.Nc),t.EW=E.Framework.resolve(l.nl.Cc),t}i.BW=S},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.VW=!0,s.qW=3e4,s.QW=6e4,s.WW=3e4,s);function s(){}i.YW=r;var e=(h._u="site",h.Au="externalAs",h.Nu="availableSendRate",h.Cu="remoteAddress",h.ku="localAddress",h);function h(){}i.KW=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var E=n(98),p=n(5),w=n(0),g=n(1),b=n(2),r=(s.prototype.init=function(t){this.PD=t.PD},s.prototype.YQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-p.ea.Bu.ro)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.oW.Kl.Tv()}),f=w.Framework.time(),c=a.filter(function(t){return f-t.$W>p.ea.Vu.co}),l=Math.min(c.length,o);e=this.XW(l,c);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t._U.IU(!1))})}return 0<u&&(s=this.JW(u,i,n,r)),this.logger.debug("[PART] A/R: "+u+"/"+o+" ["+s.map(function(t){return t.peerInfo.guid.substring(0,8)})+"/"+e.map(function(t){return t.guid.substring(0,8)})+"] P:["+i.map(function(t){return t.guid.substring(0,8)})+"] M:["+r.map(function(t){return t.peerInfo.guid.substring(0,8)})+"]"),new E.zW(s,e)}catch(t){return g.ErrorMonitor.lt().logError("Error updating in partners",this.ML,b.yn.Tn,t),new E.zW([],[])}},s);function s(){this.ML="[BaseInPartnerSelection] ",this.logger=w.Framework.resolve(w.Framework.ht.m).log()}i.ZW=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.$Q=function(){return this.tY},s.prototype.XQ=function(){return this.iY},s);function s(t,i){this.iY=t,this.tY=i}i.zW=r},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(64),o=n(15),u=n(83),a=n(6),f=(e=u.oA,s(c,e),c.bt=function(t){c.logger=t},c.prototype.send=function(){if(c.logger&&c.logger.debug(this.method+" "+this.url),!this.pluginId){var t=Object.keys(c.uA);0<t.length&&(this.pluginId=c.uA[t[0]])}var i=this,n=new XMLHttpRequest;0===this.url.indexOf("//")&&(this.url=location.protocol+this.url);var r=o.wc(h.UU.jU,h.UU.Ok,h.UU.kU,this.pluginId,encodeURIComponent(this.url));n.open("GET",r),this.responseType&&(n.responseType=this.responseType),n.onreadystatechange=function(){},n.onload=function(){if(4===n.readyState)try{i.$p=n.getAllResponseHeaders(),i.response=n.response;var t=n.response.byteLength;"arraybuffer"!==n.responseType&&(i.responseText=n.response),i.readyState=4,i.status=n.status,i.dispatchEvent(a.La.createEvent(ProgressEvent,"progress",{lengthComputable:!0,loaded:t,total:t,currentTarget:i})),i.dispatchEvent(a.La.createEvent(Event,"readystatechange",{currentTarget:i,bubbles:!1,cancelable:!1})),i.dispatchEvent(a.La.createEvent(ProgressEvent,"load",{currentTarget:i,bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:t,total:0})),i.dispatchEvent(a.La.createEvent(ProgressEvent,"loadend",{currentTarget:i,bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:t,total:0}))}catch(t){c.logger&&c.logger.warn(t)}},n.onerror=function(t){c.logger&&c.logger.warn("onError: "+JSON.stringify(t)),i.dispatchEvent(a.La.createEvent(ErrorEvent,"error",t,i))},n.onabort=function(t){c.logger&&c.logger.warn("onAbort: "+JSON.stringify(t)),i.dispatchEvent(a.La.createEvent(ProgressEvent,"abort",t,i))},n.send()},c.prototype.abort=function(){},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.nY=f},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),h=this&&this.rY||function(){return(h=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};Object.defineProperty(i,"s",{value:!0});var e,o=n(3),u=n(65),a=n(207),f=(e=u.Plugin,s(c,e),c.prototype.sendHttpRequest=function(){var n=this;return function(t,i){return n.logger().debug("sendHttpRequest called",t,i),n.getPotentialSession()&&t.match(/manifest\/dash|manifest\/hls|audio|video/)?(n.logger().debug("Using HiveRequest",t,i),new a.sY(n,i)):null}},c.prototype.initSession=function(t,i){var n=this;return void 0===i&&(i=!1),this.getPlayerSource()&&!0!==i&&(this.player.unload(),this.logger().warn(this.loggerId+"Player already has a loaded source. Hive has unloaded source via `player.unload`. Perform this action manually to remove this warning.")),this.closeHiveSession("Starting a new session"),this.resolveTicketPromise(t).timeout(this.options().pluginTimeout).then(function(t){return n.eY(),t.toHiveSession()})},c.prototype.hY=function(t){var r=this;if(!t)return o.resolve(void 0);var s=h({},t),e=[],i=!1;return t.dash_ticket&&(e.push(["dash",t.dash_ticket]),i=!0),t.hls_ticket&&(e.push(["hls",t.hls_ticket]),i=!0),i&&this.logger().warn(this.loggerId+"The use of tickets inside player.setup/player.load is deprecated. See Hive documentation for more details."),o.allSettled(e.map(function(t){return r.resolveTicketPromise(t[1])})).timeout(this.options().pluginTimeout,"ticket resolution timeout").then(function(t){var n=!1;if(t.forEach(function(t,i){"fulfilled"===t.state&&(s[e[i][0]]=t.value.manifest,delete s[e[i][0]+"_ticket"]),n=!0}),!n&&e.length)throw new Error("Could not resolve any tickets.");return r.getPotentialSession()&&r.eY(),s},function(t){r.onSetupTimeout();var i=r.loggerId+"Could not resolve source config. Returning original source.";throw r.logger().warn(i,t),new Error(i)})},c.prototype.oY=function(t,i){throw this.logger().debug(this.loggerId+"Unable to resolve the sources",t),i},Object.defineProperty(c.prototype,"uY",{get:function(){switch(this.aY){case"8":return{ready:c.fY.player.PlayerEvent.SourceLoaded,play:c.fY.player.PlayerEvent.Play,playing:c.fY.player.PlayerEvent.Playing,error:c.fY.player.PlayerEvent.Error,finished:c.fY.player.PlayerEvent.PlaybackFinished,cY:c.fY.player.PlayerEvent.Seek,lY:c.fY.player.PlayerEvent.SegmentRequestFinished,vY:c.fY.player.PlayerEvent.ViewModeChanged,destroy:c.fY.player.PlayerEvent.Destroy,dY:c.fY.player.PlayerEvent.StallStarted,EY:c.fY.player.PlayerEvent.StallEnded,paused:c.fY.player.PlayerEvent.Paused,unload:c.fY.player.PlayerEvent.SourceUnloaded,pY:c.fY.player.PlayerEvent.VideoQualityChanged};case"7":return{ready:"onReady",play:"onPlay",error:"onError",finished:"onPlaybackFinished",cY:"onSeek",lY:"onSegmentRequestFinished",wY:"onFullscreenEnter",gY:"onFullscreenExit",destroy:"onDestroy",dY:"onStallStarted",EY:"onStallEnded",paused:"onPaused",unload:"onSourceUnloaded",pY:"onVideoDownloadQualityChanged"};case"6":return{ready:"onReady",play:"onPlay",error:"onError",finished:"onPlaybackFinished",cY:"onSeek",lY:"onSegmentRequestFinished",wY:"onFullscreenEnter",gY:"onFullscreenExit",destroy:"onDestroy",dY:"onStartBuffering",EY:"onStopBuffering",paused:"onPause",unload:"onSourceUnloaded",pY:"onVideoDownloadQualityChange"};default:throw new Error("Unknown event names for player version "+this.getPlayerVersion())}},enumerable:!0,configurable:!0}),c.initHiveSDN=function(t){return!!c.bY||(t?c.fY=t:"undefined"!=typeof bitmovin&&(c.fY=bitmovin),void 0===c.fY?(console.error("Could not find global `bitmovin` object."),!1):("function"==typeof c.fY.player?(c.bY=c.fY.player,c.fY.player=function(){var s=c.bY.apply(bitmovin,arguments),e=s.setup;return s.setup=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var r=h({},t);return r.network=r.network||{},r.network.sendHttpRequest?console.error("Player configuration already contains a network configuration for sendHttpRequest, cannot utilize Hive WebRTC"):r.network.sendHttpRequest=function(){if(s.yw){var t=s.yw.getPotentialSession();if(t&&t.tech.getName()===u.TechName.HiveJS)return s.yw.sendHttpRequest().apply(s.yw,arguments)}},e.apply(s,[r].concat(i))},s}):"undefined"!==c.fY.player&&"function"==typeof c.fY.player.Player&&(c.bY=c.fY.player.Player,c.fY.player.Player=function(t,i){var n,r=h({},i);return r.network=r.network||{},r.network.sendHttpRequest?console.error("Player configuration already contains a network configuration for sendHttpRequest, cannot utilize Hive WebRTC"):r.network.sendHttpRequest=function(){if(n&&n.yw){var t=n.yw.getPotentialSession();if(t&&t.tech.getName()===u.TechName.HiveJS)return n.yw.sendHttpRequest().apply(n.yw,arguments)}},n=new c.bY(t,r)}),Boolean(c.bY)))},c.deinitHiveSDN=function(){return!c.bY||(void 0!==c.fY&&("function"==typeof c.fY.player?(c.fY.player=c.bY,c.bY=void 0):"undefined"!==c.fY.player&&"function"==typeof c.fY.player.Player&&(c.fY.player.Player=c.bY,c.bY=void 0)),c.fY=void 0,!c.bY)},c.prototype.destroyHivePlugin=function(t){return void 0===t&&(t=!0),this.player.yw=void 0,e.prototype.destroyHivePlugin.call(this,t)},c.prototype.onActivateSession=function(t,i){void 0===i&&(i=!1);var n=e.prototype.onActivateSession.call(this,t,i);return n&&Boolean(!!this.player.getConfig().playback&&this.player.getConfig().playback.autoplay)&&(this.onStartBuffering(!1,!0),this.yY="8"!==this.aY),n},c.prototype.eY=function(){var t,i=this.uY,n=((t={})[i.ready]=this.ready,t[i.play]=this.play,t[i.error]=this.error,t[i.finished]=this.finished,t[i.cY]=this.cY,t[i.lY]=this.lY,t[i.dY]=this.dY,t[i.EY]=this.EY,t[i.paused]=this.paused,t[i.pY]=this.pY,t[i.unload]=this.unload,t);"8"===this.aY?(n[i.playing]=this.playing,n[i.vY]=this.vY):(n[i.wY]=this.vY,n[i.gY]=this.vY),this.aF.eY(n)},c.prototype.ready=function(){this.logger().debug("bitmovin.player.EVENT.ON_READY"),this.onActivateSession()&&(this.TY=new u.HivePlayerExtendedStats),this.pF()},c.prototype.playing=function(){this.logger().debug("bitmovin.player.EVENT.PLAYING"),!1===this.yY&&(this.onEndBuffering(),this.yY=!0)},c.prototype.play=function(){this.logger().debug("bitmovin.player.EVENT.ON_PLAY"),this.TF(u.PlayerEvents.PLAYING)},c.prototype.error=function(i){this.logger().debug("bitmovin.player.EVENT.ON_ERROR");var t=-1,n=null;if(null!=i)try{t=i.code,n=JSON.stringify(i,null)}catch(t){n=i}this.onError(t,n,!0)},c.prototype.finished=function(){this.logger().debug("bitmovin.player.EVENT.ON_PLAYBACK_FINISHED"),this.onEventFeedback(u.PlayerEvents.STOPPED,{code:1})},c.prototype.cY=function(){this.logger().debug("bitmovin.player.EVENT.ON_SEEK"),this.onEventFeedback(u.PlayerEvents.SKIP)},c.prototype.vY=function(){var t=this.isFullscreen();this.logger().debug("bitmovin.player.EVENT.ON_FULLSCREEN_"+(t?"ENTER":"EXIT")),this.onEventFeedback(u.PlayerEvents.FULLSCREEN,{value:t})},c.prototype.lY=function(t){if(this.TY){var i=0<=t.mimeType.indexOf("video");if(void 0===this.mY){var n=this.player.getPlaybackVideoData();n&&n.bitrate&&this.OY(String(n.bitrate))}if(t.success){if(!t.isInit&&this.mY){var r=8*t.size/t.downloadTime;this.TY.accountCompleted(i,this.mY,t.size),this.TY.updateBandwidth(r)}}else this.mY&&this.TY.accountFailed(i,this.mY)}},c.prototype.unload=function(){this.logger().debug("bitmovin.player.EVENT.ON_SOURCE_UNLOAD"),this.getActiveSession()&&this.closeHiveSession("Source unload")},c.prototype.destroy=function(){this.logger().debug("bitmovin.player.EVENT.ON_DESTROY"),this.aF.reset(),this.destroyHivePlugin()},c.prototype.dY=function(){this.logger().debug("bitmovin.player.EVENT.ON_START_BUFFERING"),this.onStartBuffering()},c.prototype.EY=function(){this.logger().debug("bitmovin.player.EVENT.ON_STOP_BUFFERING"),this.onEndBuffering()},c.prototype.paused=function(){this.logger().debug("bitmovin.player.EVENT.ON_PAUSE"),this.TF(u.PlayerEvents.PAUSED)},c.prototype.pY=function(t){var i="object"==typeof t.targetQuality?t.targetQuality:"object"==typeof t.targetQualityId?t.targetQualityId:null,n="string"==typeof t.targetQualityId?t.targetQualityId:t.targetQuality,r=null;i&&(r=String(i.bitrate)),r||this.player.getAvailableVideoQualities().some(function(t){if(t.id===n)return r=String(t.bitrate),!0}),this.OY(r)},c.prototype.OY=function(t){isNaN(parseInt(t))||(this.logger().debug("newBitrate",t),this.mY&&t>this.mY&&this.TY?this.TY.bitrateSwitchUp():this.mY&&this.mY>t&&this.TY&&this.TY.bitrateSwitchDown(),this.mY=t)},c.prototype.getPlayerSource=function(){var t,i=this.getStreamProtocol();return(t="8"===this.aY?this.player.getSource():this.player.getConfig().source)?i===StreamProtocol.HLS&&t.hls?t.hls:i===StreamProtocol.DASH&&t.dash?t.dash:"":""},c.prototype.getCurrentTime=function(){return null!=this.player?Math.round(1e3*this.player.getCurrentTime()):0},c.prototype.getBufferLen=function(){return null!=this.player&&null!=this.player.getVideoBufferLength&&0<this.player.getVideoBufferLength()?Math.max(0,Math.round(1e3*this.player.getVideoBufferLength())):0},c.prototype.getWindowSize=function(){if(this.player){var t="function"==typeof this.player.getContainer?this.player.getContainer():this.player.getFigure();return{width:t.offsetWidth,height:t.offsetHeight}}},c.prototype.isFullscreen=function(){return"function"==typeof this.player.isFullscreen?this.player.isFullscreen():this.player.getViewMode()===c.fY.player.ViewMode.Fullscreen},c.prototype.isLive=function(){return this.player.isLive()},c.prototype.isActive=function(){return!0},c.prototype.getStreamProtocol=function(){if(this.player){var t=this.player.getStreamType();if("hls"===t)return StreamProtocol.HLS;if("dash"===t)return StreamProtocol.DASH}return null},c.prototype.getExtendedStats=function(){var t=this.TY;return this.TY=new u.HivePlayerExtendedStats,t},c.prototype.getPluginName=function(){return this.pluginName},c.prototype.getPlayerTech=function(){if(this.player)return this.player.getPlayerType()},c.prototype.getPlayerVersion=function(){return bitmovin.player&&bitmovin.player.version?bitmovin.player.version:"function"==typeof this.player.getVersion?this.player.getVersion():this.player.version?this.player.version:""},c);function c(t,i){var n,s=e.call(this,i)||this;if(s.pluginName="bitmovin",s.yY=null,s.player=t,s.player.yw)throw new Error("This player already has an attached Hive plugin instance.");(s.player.yw=s).aY=s.getPlayerVersion()[0],s.ready=s.ready.bind(s),s.play=s.play.bind(s),s.playing=s.playing.bind(s),s.error=s.error.bind(s),s.finished=s.finished.bind(s),s.cY=s.cY.bind(s),s.lY=s.lY.bind(s),s.vY=s.vY.bind(s),s.destroy=s.destroy.bind(s),s.dY=s.dY.bind(s),s.EY=s.EY.bind(s),s.paused=s.paused.bind(s),s.pY=s.pY.bind(s),s.unload=s.unload.bind(s),s.closeHiveSession=s.closeHiveSession.bind(s),s.destroyHivePlugin=s.destroyHivePlugin.bind(s),s.player.closeHiveSession=s.closeHiveSession,s.player.destroyHivePlugin=s.destroyHivePlugin,"8"===s.aY?s.aF.SY(t,"on","off"):s.aF.SY(t,"addEventHandler","removeEventHandler");var r=s.uY;return s.aF.eY(((n={})[r.destroy]={RY:s.destroy,IY:!0},n)),"8"===s.aY||c.bY||(s.player.originalSetup=s.player.setup,s.player._Y=s.player.load,s.player.load=function(i){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return s.getActiveSession()&&s.closeHiveSession("New source loaded"),s.hY(i).then(function(t){return s.logger().debug(s.loggerId+"Resolved sources",t),s.player._Y.apply(s.player,[t].concat(n))},function(t){s.oY(i,t)})},s.player.setup=function(i){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];s.getActiveSession()&&(s.logger().debug("Plugin contains active HiveSession. Calling player.closeHiveSession..."),s.player.closeHiveSession());var r=h({},i);return-1<s.options().hiveTechOrder.indexOf(u.TechName.HiveJS)&&(r.network=r.network||{},r.network.sendHttpRequest?s.logger().error(s.loggerId+"Player configuration already contains a network configuration for sendHttpRequest, cannot utilize HiveJS"):r.network.sendHttpRequest=s.sendHttpRequest()),s.hY(i.source).then(function(t){return r.source=t,s.player.originalSetup.apply(s.player,[r].concat(n))},function(t){s.oY(i.source,t)})}),s.logger().notice(s.loggerId+"registered plugin [name:"+s.getPluginName()+"][id: "+s.getPluginId()+"][version: "+s.getPluginVersion()+"]"),s}i.HiveBitmovin=f;"undefined"!=typeof bitmovin&&(bitmovin.initHiveSDN=function(t,i){var n=new f(t,i);return n.logger().warn("The use of bitmovin.initHiveSDN is deprecated. See Hive documentation for more details."),n})},function(t,i,n){var r="undefined"!=typeof global&&global||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function e(t,i){this.AY=t,this.NY=i}i.setTimeout=function(){return new e(s.call(setTimeout,r,arguments),clearTimeout)},i.setInterval=function(){return new e(s.call(setInterval,r,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(t){t&&t.close()},e.prototype.CY=e.prototype.kY=function(){},e.prototype.close=function(){this.NY.call(r,this.AY)},i.DY=function(t,i){clearTimeout(t.MY),t.jY=i},i.PY=function(t){clearTimeout(t.MY),t.jY=-1},i.HY=i.active=function(t){clearTimeout(t.MY);var i=t.jY;0<=i&&(t.MY=setTimeout(function(){t.LY&&t.LY()},i))},n(102),i.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof global&&global.setImmediate||this&&this.setImmediate,i.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof global&&global.clearImmediate||this&&this.clearImmediate},function(t,i,n){(function(d){!function(n,r){"use strict";if(!n.setImmediate){var s,e,i,h,o=1,u={},a=!1,f=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,s="[object process]"==={}.toString.call(n.process)?function(t){d.Ve(function(){l(t)})}:function(){if(n.postMessage&&!n.UY){var t=!0,i=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=i,t}}()?(h="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",v,!1):n.attachEvent("onmessage",v),function(t){n.postMessage(h+t,"*")}):n.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){l(t.data)},function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(e=f.documentElement,function(t){var i=f.createElement("script");i.onreadystatechange=function(){l(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}):function(t){setTimeout(l,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var i=new Array(arguments.length-1),n=0;n<i.length;n++)i[n]=arguments[n+1];var r={FY:t,GY:i};return u[o]=r,s(o),o++},t.clearImmediate=c}function c(t){delete u[t]}function l(t){if(a)setTimeout(l,0,t);else{var i=u[t];if(i){a=!0;try{!function(t){var i=t.FY,n=t.GY;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(r,n)}}(i)}finally{c(t),a=!1}}}}function v(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(h)&&l(+t.data.slice(h.length))}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)}).call(this,n(37))},function(t,i,n){var d,E,p=n(66),w=n(67),g=0,b=0;t.exports=function(t,i,n){var r=i&&n||0,s=i||[],e=(t=t||{}).xY||d,h=void 0!==t.BY?t.BY:E;if(null==e||null==h){var o=p();null==e&&(e=d=[1|o[0],o[1],o[2],o[3],o[4],o[5]]),null==h&&(h=E=16383&(o[6]<<8|o[7]))}var u=void 0!==t.VY?t.VY:(new Date).getTime(),a=void 0!==t.qY?t.qY:b+1,f=u-g+(a-b)/1e4;if(f<0&&void 0===t.BY&&(h=h+1&16383),(f<0||g<u)&&void 0===t.qY&&(a=0),1e4<=a)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=u,E=h;var c=(1e4*(268435455&(u+=122192928e5))+(b=a))%4294967296;s[r++]=c>>>24&255,s[r++]=c>>>16&255,s[r++]=c>>>8&255,s[r++]=255&c;var l=u/4294967296*1e4&268435455;s[r++]=l>>>8&255,s[r++]=255&l,s[r++]=l>>>24&15|16,s[r++]=l>>>16&255,s[r++]=h>>>8|128,s[r++]=255&h;for(var v=0;v<6;++v)s[r+v]=e[v];return i||w(s)}},function(t,i,n){var h=n(66),o=n(67);t.exports=function(t,i,n){var r=i&&n||0;"string"==typeof t&&(i="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.QY||h)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,i)for(var e=0;e<16;++e)i[r+e]=s[e];return i||o(s)}},function(t,i){if(!RegExp.escape){var n=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(t){return t.replace(n,"\\$&")}}},function(t,i,n){"use strict";var r=n(39),s=n(51);function e(){throw new Error("Can't construct. MapChanges is a mixin.")}t.exports=e;Object.prototype.hasOwnProperty;var h=new r,o=null;e.prototype.WY=function(){return h.has(this)||(o=o||n(52),h.set(this,o())),h.get(this)},e.prototype.YY=function(t){var i=this.WY();return t=t||"",i.has(t)||i.set(t,{Xf:new s,Jf:new s}),i.get(t)},e.prototype.KY=function(t,i,n){!this.ic&&this.tc&&this.tc();var r=this.YY(i);(n?r.Xf:r.Jf).push(t),Object.defineProperty(this,"bj",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.$Y(t,i,n),s=null)}},e.prototype.$Y=function(t,i,n){var r=this.YY(i),s=(n?r.Xf:r.Jf).findLast(t);if(!s)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(i));s.delete()},e.prototype.Tj=function(s,e,h){var t=this.WY(),o="Map"+(h?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=h?t.Xf:t.Jf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+o;try{n.forEach(function(t){if(t[r])t[r](e,s,this);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(t,e,s,this)}},this)}finally{t.isActive=!1}}},this)},e.prototype.XY=function(t,i){return this.KY(t,i,!0)},e.prototype.JY=function(t,i){return this.$Y(t,i,!0)},e.prototype.yj=function(t,i){return this.Tj(t,i,!0)}},function(t,i,n){"use strict";n(11);var r=n(52),s=n(51),e=n(12),h=n(41),c=n(72),o=n(13);Object.prototype.hasOwnProperty;function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);i=i||Object.Wh,n=n||Object.hash,r=r||Function.Yh,this.Kh=i,this.$h=n,this.Xh=r;var s=this;this.zY=new this.ZY(null,function(){return new s.tK}),this.length=0,this.hiveAddEach(t)}(t.exports=u).iK=u,Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),Object.hiveAddEach(u.prototype,o.prototype),u.prototype.ZY=r,u.prototype.tK=s,u.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.$h,this.Xh)},u.prototype.has=function(t){var i=this.$h(t);return this.zY.get(i).has(t)},u.prototype.get=function(t,i){if(i)throw new Error("FastSet#get does not support second argument: equals");var n=this.$h(t),r=this.zY;return r.has(n)?r.get(n).get(t):this.Xh(t)},u.prototype.delete=function(t,i){if(i)throw new Error("FastSet#delete does not support second argument: equals");var n=this.$h(t),r=this.zY;if(r.has(n)){var s=r.get(n);if(s.delete(t))return this.length--,0===s.length&&r.delete(n),!0}return!1},u.prototype.clear=function(){this.zY.clear(),this.length=0},u.prototype.hiveAdd=function(t){var i=this.$h(t),n=this.zY;return n.has(i)||n.set(i,new this.tK(null,this.Kh)),!n.get(i).has(t)&&(n.get(i).hiveAdd(t),this.length++,!0)},u.prototype.reduce=function(n,t){var r=arguments[2],i=this.zY,s=0;return i.reduce(function(t,i){return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},t,this)},u.prototype.xf=function(){if(0<this.length)return this.zY.xf().xf()},u.prototype.Bf=function(){return this.zY.values().Hf().Bf()},u.prototype.log=function(o,u,a,f){o=o||c.FF,u=u||this.Zh,a||(a=console.log,f=console),a=a.bind(f);var r=this.zY,s=r.keys();s.forEach(function(t,i){var n,e;e=i===s.length-1?(n=o.PF," "):(n=0===i?o.MF:o.HF,o.LF);var h=r.get(t);a.call(f,n+o.kF+o.MF+" "+t),h.forEach(function(t,i){var n,r,s;r=i===h.head.nj?(n=o.PF," "):(n=o.HF,o.LF),u(i,function(t){s?a.call(f,e+" "+r+"  "+t):(a.call(f,e+" "+n+o.kF+o.kF+t),s=!0)},function(t){a.call(f,e+" "+o.LF+"  "+t)})})})},u.prototype.Zh=function(t,i){var n=t.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(t){i(" "+t)}):i(" "+n)}},function(t,i,n){"use strict";t.exports=u;var o=n(38),r=n(12);function u(t){if(!(this instanceof u))return new u(t);if(Array.isArray(t)||"string"==typeof t)return u.Bf(t);if((t=o(t))instanceof u)return t;if(t.next)this.next=function(){return t.next()};else if(t.Bf){var i=t.Bf();this.next=function(){return i.next()}}else{if("[object Function]"!==o.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}u.prototype.forEach=r.prototype.forEach,u.prototype.map=r.prototype.map,u.prototype.filter=r.prototype.filter,u.prototype.every=r.prototype.every,u.prototype.some=r.prototype.some,u.prototype.kh=r.prototype.kh,u.prototype.all=r.prototype.all,u.prototype.min=r.prototype.min,u.prototype.max=r.prototype.max,u.prototype.jf=r.prototype.jf,u.prototype.Pf=r.prototype.Pf,u.prototype.Hf=r.prototype.Hf,u.prototype.Lf=r.prototype.Lf,u.prototype.enumerate=r.prototype.enumerate,u.prototype.Ff=r.prototype.Ff,u.prototype.group=r.prototype.group,u.prototype.reversed=r.prototype.reversed,u.prototype.toArray=r.prototype.toArray,u.prototype.Df=r.prototype.Df,u.prototype.iterator=r.prototype.iterator,u.prototype.lj=null,o.defineProperty(u.prototype,"_iterationObject",{get:function(){return this.lj||(this.lj={done:!1,value:void 0})}}),u.prototype.zh=function(t){var i=[];return i.hiveAddEach(t),i},u.prototype.nK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError;return new n.constructor(function(){if(!0!==n.vj.done){var t=i.call(r,n.next().value,s++,n);n.vj.value=t}return n.vj})},u.prototype.rK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError;return new n.constructor(function(){for(var t;;){if(!0===(t=n.next()).done)return t;if(i.call(r,t.value,s++,n))return t}})},u.prototype.reduce=function(t){var i,n=u(this),r=arguments[1],s=arguments[2],e=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError;if(!0===(i=n.next()).done){if(1<arguments.length)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(r=1<arguments.length?t.call(s,r,i.value,e,n):i.value,e++;;){if(!0===(i=n.next()).done)return r;r=t.call(s,r,i.value,e,n),e++}},u.prototype.concat=function(){return u.concat(Array.prototype.concat.apply(this,arguments))},u.prototype.sK=function(t){var i,n,r=u(this),s=arguments[1],e=!1,h=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError;for(;!0!==(n=r.next()).done;){if(!t.call(s,n.value,h,r)){e=!0,i=n.value;break}h++}return e?r.constructor([i]).concat(r):r.constructor([])},u.prototype.eK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError;return new n.constructor(function(){if(!0!==n.vj.done){var t=n.next().value;i.call(r,t,s++,n)?n.vj.value=t:(n.vj.done=!0,n.vj.value=void 0)}return n.vj})},u.prototype.hK=function(){return u.Uf(Array.prototype.concat.apply(this,arguments))},u.prototype.oK=function(t){return u.count(t).hK(this)},u.Bf=function(t){var i;return i=0,new u(function(){if("object"==typeof t)for(;!(i in t);){if(i>=t.length){this.vj.done=!0,this.vj.value=void 0;break}i+=1}else i>=t.length&&(this.vj.done=!0,this.vj.value=void 0);return this.vj.done||(this.vj.value=t[i],i+=1),this.vj})},u.uK=function(n,r){var s;return arguments.length<2&&(r=1/0),new u(function(){var t,i;return s&&(i=s()),s&&!0!==i.done||(i=0<r?(r--,t=u.Bf(n),(s=t.next.bind(t))()):(this.vj.done=!0,this.vj)),i})},u.concat=function(n){var r;return n=u(n),new u(function(){var t,i;return r&&(i=r()),i&&!0!==i.done?i:!1===(i=n.next()).done?(t=u(i.value),(r=t.next.bind(t))()):i})},u.Uf=function(r){return 0===(r=u(r).map(u)).length?new u([]):new u(function(){var i,n,t=r.map(function(t){return!0===(n=t.next()).done&&(i=!0),n.value});return i?(this.vj.done=!0,this.vj.value=void 0):this.vj.value=t,this.vj})},u.Lf=function(){return u.Uf(Array.prototype.slice.call(arguments))},u.chain=function(){return u.concat(Array.prototype.slice.call(arguments))},u.range=function(i,n,r){return arguments.length<3&&(r=1),arguments.length<2&&(n=i,i=0),i=i||0,r=r||1,new u(function(){n<=i&&(this.vj.done=!0,this.vj.value=void 0);var t=i;return i+=r,this.vj.value=t,this.vj})},u.count=function(t,i){return u.range(t,1/0,i)},u.repeat=function(t,i){return new u.range(i).nK(function(){return t})}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.destroy=function(){this.abort(),this.loader=null,this.xhr=null},s.prototype.abort=function(){var t=this.loader||this.xhr;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},s.prototype.load=function(t,i,n){this.context=t,this.config=i,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=i.retryDelay,this.aK()},s.prototype.aK=function(){this.xhr=null;var t=this.context,i=this.stats;i.tfirst=0,i.loaded=0,this.xhrSetup?this.xhr=this.xhrSetup(this.xhr,t):console.log(this.loggerId+"Hive XHR setup missing"),this.xhr.onreadystatechange=this.readystatechange.bind(this),this.xhr.onprogress=this.loadprogress.bind(this),this.config.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout)),this.xhr.send()},s.prototype.readystatechange=function(t){var i=t.currentTarget,n=i.readyState,r=this.stats,s=this.context,e=this.config;if(!r.aborted&&2<=n)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var h=i.status,o=i.getAllResponseHeaders()||"";o=o.replace(/[\r\n]{2,}Access-Control-Allow-Origin:\*/,"\naccess-control-allow-origin: *");var u=i.responseURL||i.url||"",a=i.statusText||(200===h?"OK":""),f=o.trim().split(/[\r\n]+/),c={};if(o&&f.forEach(function(t){var i=t.split(": "),n=i.shift(),r=i.join(": ");c[n]=r}),200<=h&&h<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,v=void 0;v="arraybuffer"===s.responseType?(l=i.response).byteLength:(l=i.responseText).length,r.loaded=r.total=v;var d={url:u,code:h,text:a,responseHeaders:o,fK:c,data:l};this.callbacks.onSuccess(d,r,s)}else void 0===e.retryDelay||void 0===e.cK||r.retry>=e.lK||400<=h&&h<499?(console.warn(h+" while loading "+s.url),d={url:u,code:h,text:a,responseHeaders:o,fK:c,data:"arraybuffer"===s.responseType?i.response:i.responseText},this.callbacks.onError(d,s)):(console.warn(h+" while loading "+s.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.aK.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,e.cK),r.retry++)}else e.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),e.timeout))},s.prototype.loadtimeout=function(){console.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context)},s.prototype.loadprogress=function(t){var i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null)},s);function s(t){this.loggerId="[HiveXhrLoader]",(this.vK=t)&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}i.FU=r},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.yF||(i.yF={}))[r.HiveJS=0]="HiveJS",r[r.HiveJava=1]="HiveJava",r[r.StatsJS=2]="StatsJS",r[r.HiveJsProxy=3]="HiveJsProxy";var s=(e.StatsJS="StatsJS",e.HiveJsProxy="HiveJsProxy",e.HiveJava="HiveJava",e.HiveJS="HiveJS",e);function e(){}i.TechName=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.lt=function(){return void 0===this.vt&&(this.vt=new s),this.vt},s.prototype.Et=function(t,i){this.dK.push(t),this.callbacks.push(i)},s.prototype.EK=function(n){for(var t=function(t){var i=!0;r.dK[t].forEach(function(t){null!=n[t]&&n[t]||(i=!1)}),i&&r.callbacks[t]()},r=this,i=0;i<this.dK.length;i++)t(i)},s);function s(){var i=this;if(this.dK=new Array,this.callbacks=new Array,s.vt)throw new Error("Error: Instantiation failed: Use KeyHandlerHiveComm.getInstance() instead of new.");var n={};document.addEventListener("keydown",function(t){n[t.keyCode]=!0,i.EK(n)},!0),document.addEventListener("keyup",function(t){n={}},!0)}i.pt=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(44),s=n(29),e=n(15),h=n(1),o=(u.prototype.pK=function(){var t=this;this.YP.options().silent&&(HiveConfig&&(HiveConfig.ConnInfo.detectPrivateIP=!0),void 0===this.wK&&(this.url="//"+r.zv.Ok+":"+this.gK+"/feedback",this.YP.logger().info("starting periodic alive ping to hive tester ["+this.url+"]"),this.wK=setInterval(function(){t.bK()},s.et.Ib)))},u.prototype.bK=function(){var i=this,t=this.YP.getActiveSession(),n=void 0;t&&(n="S["+t.id+"]");var r=this.YP.getCurrentTime();r>this.yK?(this.YP.logger().info("sending hive tester ping ["+r+" > "+this.yK+"]"),e.bc(this.url).then(function(t){},function(t){h.ErrorMonitor.lt().logError("error sending hive tester ping",n,{error:t}),clearInterval(i.wK)})):this.YP.logger().warn("not sending hive tester ping ["+r+" <= "+this.yK+"]"),this.yK=r},u);function u(t){this.gK=s.et.Xv?9989:9988,this.yK=-1,this.YP=t,this.pK()}i.IF=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(42),s=n(114),e=n(45),h=n(0),o=(u.prototype.apply=function(t){t.bind(new r.uk(h.Framework.ht.o,s.TK,r.ak.Ek)),t.bind(new r.uk(h.Framework.ht.m,e.Pk))},u);function u(){}i.SF=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(71),s=n(4),e=(h.prototype.U=function(){return!1},h.prototype.mK=function(t,i,n){},h.prototype.X=function(){return null},h.prototype.time=function(){return+new Date},h.prototype.setTimeout=function(t,i,n){var r=this;void 0===n&&(n=!1);var s=this.OK.setTimeout(function(){r.SK.delete(s),t()},i);return this.SK.set(s,n),s},h.prototype.clearTimeout=function(t){return this.SK.delete(t),this.OK.clearTimeout(t),!0},h.prototype.setInterval=function(t,i){var n=this.OK.setInterval(function(){t()},i);return this.RK.hiveAdd(n),n},h.prototype.clearInterval=function(t){return this.RK.delete(t),this.OK.clearInterval(t),!0},h.prototype.tt=function(n){var r=this;void 0===n&&(n=!1),this.SK.forEach(function(t,i){!n&&t||r.clearInterval(i)}),this.RK.forEach(function(t){return r.clearInterval(t)})},h);function h(){this.SK=new s,this.RK=new r,"undefined"!=typeof global?this.OK=global:this.OK=window}i.TK=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(42),s=n(0),e=n(45),h=n(18),o=n(8),u=n(24),a=n(73),f=n(74),c=n(75),l=n(76),v=n(77),d=n(7),E=d.ut.Ja,p=d.ut.sf;if(E)var w=n(78).gx;else var g=n(80).iB;var b=(y.prototype.apply=function(t){p?(t.bind(new r.uk(o.pf.lf,h.Ul,r.ak.Ek)),t.bind(new r.uk(o.pf.R,f.VG,r.ak.Ek))):(t.bind(new r.uk(o.pf.lf,h.Ll,r.ak.Ek)),t.bind(new r.uk(o.pf.R,f.BG,r.ak.Ek))),t.bind(new r.uk(o.pf.uf,c.$G,r.ak.Ek)),t.bind(new r.uk(o.pf.u,l.hx,r.ak.Ek)),t.bind(new r.uk(s.Framework.ht.m,e.Pk,r.ak.Ek)),E?t.bind(new r.uk(o.pf.af,w,r.ak.Ek)):t.bind(new r.uk(o.pf.af,g,r.ak.Ek)),t.bind(new r.uk(o.pf.ff,v.ax,r.ak.Ek)),t.bind(new r.uk(o.pf.vf,a.NF,r.ak.mk)),t.bind(new r.uk(o.pf.hf,a.Rl,r.ak.mk)),t.bind(new r.uk(o.pf.df,u.NE,r.ak.mk)),t.bind(new r.uk(o.pf.Ef,u.Rl,r.ak.mk))},y);function y(){}i.RF=b},function(t,i,n){var d=n(28),E=window.hive;void 0===E&&(E=window.hive={}),void 0===E.snapshots&&(E.snapshots={}),E.snapshots.Traffic=function(t){this.reqN=null,this.respFallbackN=null,this.respFallbackErrN=null,this.respP2pN=null,this.reqOtherN=null,this.respFallbackOtherN=null,this.respFallbackOthertErrN=null,this.srcReqN=null,this.srcRespN=null,this.srcRespErrN=null,this.srcReqQt=null,this.srcRespQt=null,this.srcOverQt=null,this.srcOtherReqN=null,this.srcOtherRespN=null,this.srcOtherRespErrN=null,this.srcOtherReqQt=null,this.srcOtherRespQt=null,this.srcOtherOverQt=null,this.p2pSubReqN=null,this.p2pSubRespN=null,this.p2pSubRespPartN=null,this.p2pSubRespErrN=null,this.p2pSubRespExpN=null,this.p2pSubReqQt=null,this.p2pSubRespQt=null,this.p2pDirectQt=null,this.p2pRelayQt=null,this.p2pNatQt=null,this.p2pUdpbQt=null,this.fallAgentRespN=null,this.fallAgentPredHitN=null,this.fallAgentFailedRespN=null,this.fallAgentPredMissN=null,this.fallAgentPredPartialHitN=null,this.fallAgenTrafficSuccessQt=null,this.fallAgenTrafficFailureQt=null,this.p2pAgentPredHitN=null,this.p2pAgentPredMissN=null,this.p2pAgentPredPartialHitN=null,this.p2pAgenTrafficSuccessQt=null,this.p2pAgenTrafficFailureQt=null,this.respP2pOtherN=null,this.lCacheRespN=null,this.lCacheRespQt=null,this.p2pOutSiteLowPrio=null,t&&(void 0!==t.reqN&&null!==t.reqN&&(this.reqN=t.reqN),void 0!==t.respFallbackN&&null!==t.respFallbackN&&(this.respFallbackN=t.respFallbackN),void 0!==t.respFallbackErrN&&null!==t.respFallbackErrN&&(this.respFallbackErrN=t.respFallbackErrN),void 0!==t.respP2pN&&null!==t.respP2pN&&(this.respP2pN=t.respP2pN),void 0!==t.reqOtherN&&null!==t.reqOtherN&&(this.reqOtherN=t.reqOtherN),void 0!==t.respFallbackOtherN&&null!==t.respFallbackOtherN&&(this.respFallbackOtherN=t.respFallbackOtherN),void 0!==t.respFallbackOthertErrN&&null!==t.respFallbackOthertErrN&&(this.respFallbackOthertErrN=t.respFallbackOthertErrN),void 0!==t.srcReqN&&null!==t.srcReqN&&(this.srcReqN=t.srcReqN),void 0!==t.srcRespN&&null!==t.srcRespN&&(this.srcRespN=t.srcRespN),void 0!==t.srcRespErrN&&null!==t.srcRespErrN&&(this.srcRespErrN=t.srcRespErrN),void 0!==t.srcReqQt&&null!==t.srcReqQt&&(this.srcReqQt=t.srcReqQt),void 0!==t.srcRespQt&&null!==t.srcRespQt&&(this.srcRespQt=t.srcRespQt),void 0!==t.srcOverQt&&null!==t.srcOverQt&&(this.srcOverQt=t.srcOverQt),void 0!==t.srcOtherReqN&&null!==t.srcOtherReqN&&(this.srcOtherReqN=t.srcOtherReqN),void 0!==t.srcOtherRespN&&null!==t.srcOtherRespN&&(this.srcOtherRespN=t.srcOtherRespN),void 0!==t.srcOtherRespErrN&&null!==t.srcOtherRespErrN&&(this.srcOtherRespErrN=t.srcOtherRespErrN),void 0!==t.srcOtherReqQt&&null!==t.srcOtherReqQt&&(this.srcOtherReqQt=t.srcOtherReqQt),void 0!==t.srcOtherRespQt&&null!==t.srcOtherRespQt&&(this.srcOtherRespQt=t.srcOtherRespQt),void 0!==t.srcOtherOverQt&&null!==t.srcOtherOverQt&&(this.srcOtherOverQt=t.srcOtherOverQt),void 0!==t.p2pSubReqN&&null!==t.p2pSubReqN&&(this.p2pSubReqN=t.p2pSubReqN),void 0!==t.p2pSubRespN&&null!==t.p2pSubRespN&&(this.p2pSubRespN=t.p2pSubRespN),void 0!==t.p2pSubRespPartN&&null!==t.p2pSubRespPartN&&(this.p2pSubRespPartN=t.p2pSubRespPartN),void 0!==t.p2pSubRespErrN&&null!==t.p2pSubRespErrN&&(this.p2pSubRespErrN=t.p2pSubRespErrN),void 0!==t.p2pSubRespExpN&&null!==t.p2pSubRespExpN&&(this.p2pSubRespExpN=t.p2pSubRespExpN),void 0!==t.p2pSubReqQt&&null!==t.p2pSubReqQt&&(this.p2pSubReqQt=t.p2pSubReqQt),void 0!==t.p2pSubRespQt&&null!==t.p2pSubRespQt&&(this.p2pSubRespQt=t.p2pSubRespQt),void 0!==t.p2pDirectQt&&null!==t.p2pDirectQt&&(this.p2pDirectQt=t.p2pDirectQt),void 0!==t.p2pRelayQt&&null!==t.p2pRelayQt&&(this.p2pRelayQt=t.p2pRelayQt),void 0!==t.p2pNatQt&&null!==t.p2pNatQt&&(this.p2pNatQt=t.p2pNatQt),void 0!==t.p2pUdpbQt&&null!==t.p2pUdpbQt&&(this.p2pUdpbQt=t.p2pUdpbQt),void 0!==t.fallAgentRespN&&null!==t.fallAgentRespN&&(this.fallAgentRespN=t.fallAgentRespN),void 0!==t.fallAgentPredHitN&&null!==t.fallAgentPredHitN&&(this.fallAgentPredHitN=t.fallAgentPredHitN),void 0!==t.fallAgentFailedRespN&&null!==t.fallAgentFailedRespN&&(this.fallAgentFailedRespN=t.fallAgentFailedRespN),void 0!==t.fallAgentPredMissN&&null!==t.fallAgentPredMissN&&(this.fallAgentPredMissN=t.fallAgentPredMissN),void 0!==t.fallAgentPredPartialHitN&&null!==t.fallAgentPredPartialHitN&&(this.fallAgentPredPartialHitN=t.fallAgentPredPartialHitN),void 0!==t.fallAgenTrafficSuccessQt&&null!==t.fallAgenTrafficSuccessQt&&(this.fallAgenTrafficSuccessQt=t.fallAgenTrafficSuccessQt),void 0!==t.fallAgenTrafficFailureQt&&null!==t.fallAgenTrafficFailureQt&&(this.fallAgenTrafficFailureQt=t.fallAgenTrafficFailureQt),void 0!==t.p2pAgentPredHitN&&null!==t.p2pAgentPredHitN&&(this.p2pAgentPredHitN=t.p2pAgentPredHitN),void 0!==t.p2pAgentPredMissN&&null!==t.p2pAgentPredMissN&&(this.p2pAgentPredMissN=t.p2pAgentPredMissN),void 0!==t.p2pAgentPredPartialHitN&&null!==t.p2pAgentPredPartialHitN&&(this.p2pAgentPredPartialHitN=t.p2pAgentPredPartialHitN),void 0!==t.p2pAgenTrafficSuccessQt&&null!==t.p2pAgenTrafficSuccessQt&&(this.p2pAgenTrafficSuccessQt=t.p2pAgenTrafficSuccessQt),void 0!==t.p2pAgenTrafficFailureQt&&null!==t.p2pAgenTrafficFailureQt&&(this.p2pAgenTrafficFailureQt=t.p2pAgenTrafficFailureQt),void 0!==t.respP2pOtherN&&null!==t.respP2pOtherN&&(this.respP2pOtherN=t.respP2pOtherN),void 0!==t.lCacheRespN&&null!==t.lCacheRespN&&(this.lCacheRespN=t.lCacheRespN),void 0!==t.lCacheRespQt&&null!==t.lCacheRespQt&&(this.lCacheRespQt=t.lCacheRespQt),void 0!==t.p2pOutSiteLowPrio&&null!==t.p2pOutSiteLowPrio&&(this.p2pOutSiteLowPrio=t.p2pOutSiteLowPrio))},E.snapshots.Traffic.prototype={},E.snapshots.Traffic.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.reqN=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.DOUBLE?this.respFallbackN=t.pb().value:t.Bw(n);break;case 3:n==d.Type.I32?this.respFallbackErrN=t.Vw().value:t.Bw(n);break;case 4:n==d.Type.DOUBLE?this.respP2pN=t.pb().value:t.Bw(n);break;case 5:n==d.Type.I32?this.reqOtherN=t.Vw().value:t.Bw(n);break;case 6:n==d.Type.I32?this.respFallbackOtherN=t.Vw().value:t.Bw(n);break;case 7:n==d.Type.I32?this.respFallbackOthertErrN=t.Vw().value:t.Bw(n);break;case 8:n==d.Type.I32?this.srcReqN=t.Vw().value:t.Bw(n);break;case 9:n==d.Type.I32?this.srcRespN=t.Vw().value:t.Bw(n);break;case 10:n==d.Type.I32?this.srcRespErrN=t.Vw().value:t.Bw(n);break;case 11:n==d.Type.I64?this.srcReqQt=t.Eb().value:t.Bw(n);break;case 12:n==d.Type.I64?this.srcRespQt=t.Eb().value:t.Bw(n);break;case 13:n==d.Type.I64?this.srcOverQt=t.Eb().value:t.Bw(n);break;case 14:n==d.Type.I32?this.srcOtherReqN=t.Vw().value:t.Bw(n);break;case 15:n==d.Type.I32?this.srcOtherRespN=t.Vw().value:t.Bw(n);break;case 16:n==d.Type.I32?this.srcOtherRespErrN=t.Vw().value:t.Bw(n);break;case 17:n==d.Type.I64?this.srcOtherReqQt=t.Eb().value:t.Bw(n);break;case 18:n==d.Type.I64?this.srcOtherRespQt=t.Eb().value:t.Bw(n);break;case 19:n==d.Type.I64?this.srcOtherOverQt=t.Eb().value:t.Bw(n);break;case 20:n==d.Type.I32?this.p2pSubReqN=t.Vw().value:t.Bw(n);break;case 21:n==d.Type.I32?this.p2pSubRespN=t.Vw().value:t.Bw(n);break;case 22:n==d.Type.DOUBLE?this.p2pSubRespPartN=t.pb().value:t.Bw(n);break;case 23:n==d.Type.DOUBLE?this.p2pSubRespErrN=t.pb().value:t.Bw(n);break;case 24:n==d.Type.I32?this.p2pSubRespExpN=t.Vw().value:t.Bw(n);break;case 25:n==d.Type.I64?this.p2pSubReqQt=t.Eb().value:t.Bw(n);break;case 26:n==d.Type.I64?this.p2pSubRespQt=t.Eb().value:t.Bw(n);break;case 27:n==d.Type.I64?this.p2pDirectQt=t.Eb().value:t.Bw(n);break;case 28:n==d.Type.I64?this.p2pRelayQt=t.Eb().value:t.Bw(n);break;case 29:n==d.Type.I64?this.p2pNatQt=t.Eb().value:t.Bw(n);break;case 30:n==d.Type.I64?this.p2pUdpbQt=t.Eb().value:t.Bw(n);break;case 31:n==d.Type.I32?this.fallAgentRespN=t.Vw().value:t.Bw(n);break;case 32:n==d.Type.I32?this.fallAgentPredHitN=t.Vw().value:t.Bw(n);break;case 33:n==d.Type.I32?this.fallAgentFailedRespN=t.Vw().value:t.Bw(n);break;case 34:n==d.Type.I32?this.fallAgentPredMissN=t.Vw().value:t.Bw(n);break;case 35:n==d.Type.I32?this.fallAgentPredPartialHitN=t.Vw().value:t.Bw(n);break;case 36:n==d.Type.I64?this.fallAgenTrafficSuccessQt=t.Eb().value:t.Bw(n);break;case 37:n==d.Type.I64?this.fallAgenTrafficFailureQt=t.Eb().value:t.Bw(n);break;case 38:n==d.Type.I32?this.p2pAgentPredHitN=t.Vw().value:t.Bw(n);break;case 39:n==d.Type.I32?this.p2pAgentPredMissN=t.Vw().value:t.Bw(n);break;case 40:n==d.Type.I32?this.p2pAgentPredPartialHitN=t.Vw().value:t.Bw(n);break;case 41:n==d.Type.I64?this.p2pAgenTrafficSuccessQt=t.Eb().value:t.Bw(n);break;case 42:n==d.Type.I64?this.p2pAgenTrafficFailureQt=t.Eb().value:t.Bw(n);break;case 43:n==d.Type.I32?this.respP2pOtherN=t.Vw().value:t.Bw(n);break;case 44:n==d.Type.I32?this.lCacheRespN=t.Vw().value:t.Bw(n);break;case 45:n==d.Type.I64?this.lCacheRespQt=t.Eb().value:t.Bw(n);break;case 46:n==d.Type.I64?this.p2pOutSiteLowPrio=t.Eb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.Traffic.prototype.write=function(t){t.Ww("Traffic"),null!==this.reqN&&void 0!==this.reqN&&(t.Yw("reqN",d.Type.I32,1),t.Xw(this.reqN),t.$w()),null!==this.respFallbackN&&void 0!==this.respFallbackN&&(t.Yw("respFallbackN",d.Type.DOUBLE,2),t.Kg(this.respFallbackN),t.$w()),null!==this.respFallbackErrN&&void 0!==this.respFallbackErrN&&(t.Yw("respFallbackErrN",d.Type.I32,3),t.Xw(this.respFallbackErrN),t.$w()),null!==this.respP2pN&&void 0!==this.respP2pN&&(t.Yw("respP2pN",d.Type.DOUBLE,4),t.Kg(this.respP2pN),t.$w()),null!==this.reqOtherN&&void 0!==this.reqOtherN&&(t.Yw("reqOtherN",d.Type.I32,5),t.Xw(this.reqOtherN),t.$w()),null!==this.respFallbackOtherN&&void 0!==this.respFallbackOtherN&&(t.Yw("respFallbackOtherN",d.Type.I32,6),t.Xw(this.respFallbackOtherN),t.$w()),null!==this.respFallbackOthertErrN&&void 0!==this.respFallbackOthertErrN&&(t.Yw("respFallbackOthertErrN",d.Type.I32,7),t.Xw(this.respFallbackOthertErrN),t.$w()),null!==this.srcReqN&&void 0!==this.srcReqN&&(t.Yw("srcReqN",d.Type.I32,8),t.Xw(this.srcReqN),t.$w()),null!==this.srcRespN&&void 0!==this.srcRespN&&(t.Yw("srcRespN",d.Type.I32,9),t.Xw(this.srcRespN),t.$w()),null!==this.srcRespErrN&&void 0!==this.srcRespErrN&&(t.Yw("srcRespErrN",d.Type.I32,10),t.Xw(this.srcRespErrN),t.$w()),null!==this.srcReqQt&&void 0!==this.srcReqQt&&(t.Yw("srcReqQt",d.Type.I64,11),t.Yg(this.srcReqQt),t.$w()),null!==this.srcRespQt&&void 0!==this.srcRespQt&&(t.Yw("srcRespQt",d.Type.I64,12),t.Yg(this.srcRespQt),t.$w()),null!==this.srcOverQt&&void 0!==this.srcOverQt&&(t.Yw("srcOverQt",d.Type.I64,13),t.Yg(this.srcOverQt),t.$w()),null!==this.srcOtherReqN&&void 0!==this.srcOtherReqN&&(t.Yw("srcOtherReqN",d.Type.I32,14),t.Xw(this.srcOtherReqN),t.$w()),null!==this.srcOtherRespN&&void 0!==this.srcOtherRespN&&(t.Yw("srcOtherRespN",d.Type.I32,15),t.Xw(this.srcOtherRespN),t.$w()),null!==this.srcOtherRespErrN&&void 0!==this.srcOtherRespErrN&&(t.Yw("srcOtherRespErrN",d.Type.I32,16),t.Xw(this.srcOtherRespErrN),t.$w()),null!==this.srcOtherReqQt&&void 0!==this.srcOtherReqQt&&(t.Yw("srcOtherReqQt",d.Type.I64,17),t.Yg(this.srcOtherReqQt),t.$w()),null!==this.srcOtherRespQt&&void 0!==this.srcOtherRespQt&&(t.Yw("srcOtherRespQt",d.Type.I64,18),t.Yg(this.srcOtherRespQt),t.$w()),null!==this.srcOtherOverQt&&void 0!==this.srcOtherOverQt&&(t.Yw("srcOtherOverQt",d.Type.I64,19),t.Yg(this.srcOtherOverQt),t.$w()),null!==this.p2pSubReqN&&void 0!==this.p2pSubReqN&&(t.Yw("p2pSubReqN",d.Type.I32,20),t.Xw(this.p2pSubReqN),t.$w()),null!==this.p2pSubRespN&&void 0!==this.p2pSubRespN&&(t.Yw("p2pSubRespN",d.Type.I32,21),t.Xw(this.p2pSubRespN),t.$w()),null!==this.p2pSubRespPartN&&void 0!==this.p2pSubRespPartN&&(t.Yw("p2pSubRespPartN",d.Type.DOUBLE,22),t.Kg(this.p2pSubRespPartN),t.$w()),null!==this.p2pSubRespErrN&&void 0!==this.p2pSubRespErrN&&(t.Yw("p2pSubRespErrN",d.Type.DOUBLE,23),t.Kg(this.p2pSubRespErrN),t.$w()),null!==this.p2pSubRespExpN&&void 0!==this.p2pSubRespExpN&&(t.Yw("p2pSubRespExpN",d.Type.I32,24),t.Xw(this.p2pSubRespExpN),t.$w()),null!==this.p2pSubReqQt&&void 0!==this.p2pSubReqQt&&(t.Yw("p2pSubReqQt",d.Type.I64,25),t.Yg(this.p2pSubReqQt),t.$w()),null!==this.p2pSubRespQt&&void 0!==this.p2pSubRespQt&&(t.Yw("p2pSubRespQt",d.Type.I64,26),t.Yg(this.p2pSubRespQt),t.$w()),null!==this.p2pDirectQt&&void 0!==this.p2pDirectQt&&(t.Yw("p2pDirectQt",d.Type.I64,27),t.Yg(this.p2pDirectQt),t.$w()),null!==this.p2pRelayQt&&void 0!==this.p2pRelayQt&&(t.Yw("p2pRelayQt",d.Type.I64,28),t.Yg(this.p2pRelayQt),t.$w()),null!==this.p2pNatQt&&void 0!==this.p2pNatQt&&(t.Yw("p2pNatQt",d.Type.I64,29),t.Yg(this.p2pNatQt),t.$w()),null!==this.p2pUdpbQt&&void 0!==this.p2pUdpbQt&&(t.Yw("p2pUdpbQt",d.Type.I64,30),t.Yg(this.p2pUdpbQt),t.$w()),null!==this.fallAgentRespN&&void 0!==this.fallAgentRespN&&(t.Yw("fallAgentRespN",d.Type.I32,31),t.Xw(this.fallAgentRespN),t.$w()),null!==this.fallAgentPredHitN&&void 0!==this.fallAgentPredHitN&&(t.Yw("fallAgentPredHitN",d.Type.I32,32),t.Xw(this.fallAgentPredHitN),t.$w()),null!==this.fallAgentFailedRespN&&void 0!==this.fallAgentFailedRespN&&(t.Yw("fallAgentFailedRespN",d.Type.I32,33),t.Xw(this.fallAgentFailedRespN),t.$w()),null!==this.fallAgentPredMissN&&void 0!==this.fallAgentPredMissN&&(t.Yw("fallAgentPredMissN",d.Type.I32,34),t.Xw(this.fallAgentPredMissN),t.$w()),null!==this.fallAgentPredPartialHitN&&void 0!==this.fallAgentPredPartialHitN&&(t.Yw("fallAgentPredPartialHitN",d.Type.I32,35),t.Xw(this.fallAgentPredPartialHitN),t.$w()),null!==this.fallAgenTrafficSuccessQt&&void 0!==this.fallAgenTrafficSuccessQt&&(t.Yw("fallAgenTrafficSuccessQt",d.Type.I64,36),t.Yg(this.fallAgenTrafficSuccessQt),t.$w()),null!==this.fallAgenTrafficFailureQt&&void 0!==this.fallAgenTrafficFailureQt&&(t.Yw("fallAgenTrafficFailureQt",d.Type.I64,37),t.Yg(this.fallAgenTrafficFailureQt),t.$w()),null!==this.p2pAgentPredHitN&&void 0!==this.p2pAgentPredHitN&&(t.Yw("p2pAgentPredHitN",d.Type.I32,38),t.Xw(this.p2pAgentPredHitN),t.$w()),null!==this.p2pAgentPredMissN&&void 0!==this.p2pAgentPredMissN&&(t.Yw("p2pAgentPredMissN",d.Type.I32,39),t.Xw(this.p2pAgentPredMissN),t.$w()),null!==this.p2pAgentPredPartialHitN&&void 0!==this.p2pAgentPredPartialHitN&&(t.Yw("p2pAgentPredPartialHitN",d.Type.I32,40),t.Xw(this.p2pAgentPredPartialHitN),t.$w()),null!==this.p2pAgenTrafficSuccessQt&&void 0!==this.p2pAgenTrafficSuccessQt&&(t.Yw("p2pAgenTrafficSuccessQt",d.Type.I64,41),t.Yg(this.p2pAgenTrafficSuccessQt),t.$w()),null!==this.p2pAgenTrafficFailureQt&&void 0!==this.p2pAgenTrafficFailureQt&&(t.Yw("p2pAgenTrafficFailureQt",d.Type.I64,42),t.Yg(this.p2pAgenTrafficFailureQt),t.$w()),null!==this.respP2pOtherN&&void 0!==this.respP2pOtherN&&(t.Yw("respP2pOtherN",d.Type.I32,43),t.Xw(this.respP2pOtherN),t.$w()),null!==this.lCacheRespN&&void 0!==this.lCacheRespN&&(t.Yw("lCacheRespN",d.Type.I32,44),t.Xw(this.lCacheRespN),t.$w()),null!==this.lCacheRespQt&&void 0!==this.lCacheRespQt&&(t.Yw("lCacheRespQt",d.Type.I64,45),t.Yg(this.lCacheRespQt),t.$w()),null!==this.p2pOutSiteLowPrio&&void 0!==this.p2pOutSiteLowPrio&&(t.Yw("p2pOutSiteLowPrio",d.Type.I64,46),t.Yg(this.p2pOutSiteLowPrio),t.$w()),t.Jw(),t.zw()},E.snapshots.Metrics=function(t){this.upBW=null,this.downBW=null,this.memN=null,this.prtInN=null,this.prtOutN=null,this.initVideoBufQt=null,this.videoAvgBufQt=null,this.videoBufQt=null,this.videoBufN=null,this.initAudioBufQt=null,this.audioAvgBufQt=null,this.audioBufQt=null,this.audioBufN=null,this.bitrateUpN=null,this.bitrateDwnN=null,this.delay=null,this.delayEnforcement=null,this.lookupReqEstablished=null,this.lookupReqAccept=null,this.fallbackAvgTp=null,this.srcThroughput=null,this.diskReadTimeout=null,this.diskReadRate=null,this.diskStoreRate=null,this.diskRemoveRate=null,this.diskCacheSize=null,this.clientBufferMs=null,this.lookupTotal=null,this.lookupNotFound=null,this.lookupFailed=null,this.lookupLatency=null,this.trackerFailed=null,this.trackerLatency=null,this.snapshotFailed=null,this.snapshotLatency=null,this.uG=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.memN&&null!==t.memN&&(this.memN=t.memN),void 0!==t.prtInN&&null!==t.prtInN&&(this.prtInN=t.prtInN),void 0!==t.prtOutN&&null!==t.prtOutN&&(this.prtOutN=t.prtOutN),void 0!==t.initVideoBufQt&&null!==t.initVideoBufQt&&(this.initVideoBufQt=t.initVideoBufQt),void 0!==t.videoAvgBufQt&&null!==t.videoAvgBufQt&&(this.videoAvgBufQt=t.videoAvgBufQt),void 0!==t.videoBufQt&&null!==t.videoBufQt&&(this.videoBufQt=t.videoBufQt),void 0!==t.videoBufN&&null!==t.videoBufN&&(this.videoBufN=t.videoBufN),void 0!==t.initAudioBufQt&&null!==t.initAudioBufQt&&(this.initAudioBufQt=t.initAudioBufQt),void 0!==t.audioAvgBufQt&&null!==t.audioAvgBufQt&&(this.audioAvgBufQt=t.audioAvgBufQt),void 0!==t.audioBufQt&&null!==t.audioBufQt&&(this.audioBufQt=t.audioBufQt),void 0!==t.audioBufN&&null!==t.audioBufN&&(this.audioBufN=t.audioBufN),void 0!==t.bitrateUpN&&null!==t.bitrateUpN&&(this.bitrateUpN=t.bitrateUpN),void 0!==t.bitrateDwnN&&null!==t.bitrateDwnN&&(this.bitrateDwnN=t.bitrateDwnN),void 0!==t.delay&&null!==t.delay&&(this.delay=t.delay),void 0!==t.delayEnforcement&&null!==t.delayEnforcement&&(this.delayEnforcement=t.delayEnforcement),void 0!==t.lookupReqEstablished&&null!==t.lookupReqEstablished&&(this.lookupReqEstablished=t.lookupReqEstablished),void 0!==t.lookupReqAccept&&null!==t.lookupReqAccept&&(this.lookupReqAccept=t.lookupReqAccept),void 0!==t.fallbackAvgTp&&null!==t.fallbackAvgTp&&(this.fallbackAvgTp=t.fallbackAvgTp),void 0!==t.srcThroughput&&null!==t.srcThroughput&&(this.srcThroughput=t.srcThroughput),void 0!==t.diskReadTimeout&&null!==t.diskReadTimeout&&(this.diskReadTimeout=t.diskReadTimeout),void 0!==t.diskReadRate&&null!==t.diskReadRate&&(this.diskReadRate=t.diskReadRate),void 0!==t.diskStoreRate&&null!==t.diskStoreRate&&(this.diskStoreRate=t.diskStoreRate),void 0!==t.diskRemoveRate&&null!==t.diskRemoveRate&&(this.diskRemoveRate=t.diskRemoveRate),void 0!==t.diskCacheSize&&null!==t.diskCacheSize&&(this.diskCacheSize=t.diskCacheSize),void 0!==t.clientBufferMs&&null!==t.clientBufferMs&&(this.clientBufferMs=t.clientBufferMs),void 0!==t.lookupTotal&&null!==t.lookupTotal&&(this.lookupTotal=t.lookupTotal),void 0!==t.lookupNotFound&&null!==t.lookupNotFound&&(this.lookupNotFound=t.lookupNotFound),void 0!==t.lookupFailed&&null!==t.lookupFailed&&(this.lookupFailed=t.lookupFailed),void 0!==t.lookupLatency&&null!==t.lookupLatency&&(this.lookupLatency=t.lookupLatency),void 0!==t.trackerFailed&&null!==t.trackerFailed&&(this.trackerFailed=t.trackerFailed),void 0!==t.trackerLatency&&null!==t.trackerLatency&&(this.trackerLatency=t.trackerLatency),void 0!==t.snapshotFailed&&null!==t.snapshotFailed&&(this.snapshotFailed=t.snapshotFailed),void 0!==t.snapshotLatency&&null!==t.snapshotLatency&&(this.snapshotLatency=t.snapshotLatency),void 0!==t.uG&&null!==t.uG&&(this.uG=t.uG))},E.snapshots.Metrics.prototype={},E.snapshots.Metrics.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.upBW=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.I32?this.downBW=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.I32?this.memN=t.Vw().value:t.Bw(n);break;case 4:n==d.Type.I32?this.prtInN=t.Vw().value:t.Bw(n);break;case 5:n==d.Type.I32?this.prtOutN=t.Vw().value:t.Bw(n);break;case 6:n==d.Type.I64?this.initVideoBufQt=t.Eb().value:t.Bw(n);break;case 7:n==d.Type.DOUBLE?this.videoAvgBufQt=t.pb().value:t.Bw(n);break;case 8:n==d.Type.I64?this.videoBufQt=t.Eb().value:t.Bw(n);break;case 9:n==d.Type.I32?this.videoBufN=t.Vw().value:t.Bw(n);break;case 10:n==d.Type.I32?this.initAudioBufQt=t.Vw().value:t.Bw(n);break;case 11:n==d.Type.DOUBLE?this.audioAvgBufQt=t.pb().value:t.Bw(n);break;case 12:n==d.Type.I64?this.audioBufQt=t.Eb().value:t.Bw(n);break;case 13:n==d.Type.I32?this.audioBufN=t.Vw().value:t.Bw(n);break;case 14:n==d.Type.I32?this.bitrateUpN=t.Vw().value:t.Bw(n);break;case 15:n==d.Type.I32?this.bitrateDwnN=t.Vw().value:t.Bw(n);break;case 16:n==d.Type.I32?this.delay=t.Vw().value:t.Bw(n);break;case 17:n==d.Type.I32?this.delayEnforcement=t.Vw().value:t.Bw(n);break;case 18:n==d.Type.I32?this.lookupReqEstablished=t.Vw().value:t.Bw(n);break;case 19:n==d.Type.I32?this.lookupReqAccept=t.Vw().value:t.Bw(n);break;case 20:n==d.Type.DOUBLE?this.fallbackAvgTp=t.pb().value:t.Bw(n);break;case 21:n==d.Type.DOUBLE?this.srcThroughput=t.pb().value:t.Bw(n);break;case 22:n==d.Type.I32?this.diskReadTimeout=t.Vw().value:t.Bw(n);break;case 23:n==d.Type.DOUBLE?this.diskReadRate=t.pb().value:t.Bw(n);break;case 24:n==d.Type.DOUBLE?this.diskStoreRate=t.pb().value:t.Bw(n);break;case 25:n==d.Type.DOUBLE?this.diskRemoveRate=t.pb().value:t.Bw(n);break;case 26:n==d.Type.I64?this.diskCacheSize=t.Eb().value:t.Bw(n);break;case 27:n==d.Type.I32?this.clientBufferMs=t.Vw().value:t.Bw(n);break;case 28:n==d.Type.I32?this.lookupTotal=t.Vw().value:t.Bw(n);break;case 29:n==d.Type.I32?this.lookupNotFound=t.Vw().value:t.Bw(n);break;case 30:n==d.Type.I32?this.lookupFailed=t.Vw().value:t.Bw(n);break;case 31:n==d.Type.I32?this.lookupLatency=t.Vw().value:t.Bw(n);break;case 32:n==d.Type.I32?this.trackerFailed=t.Vw().value:t.Bw(n);break;case 33:n==d.Type.I32?this.trackerLatency=t.Vw().value:t.Bw(n);break;case 34:n==d.Type.I32?this.snapshotFailed=t.Vw().value:t.Bw(n);break;case 35:n==d.Type.I32?this.snapshotLatency=t.Vw().value:t.Bw(n);break;case 36:n==d.Type.I32?this.uG=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.Metrics.prototype.write=function(t){t.Ww("Metrics"),null!==this.upBW&&void 0!==this.upBW&&(t.Yw("upBW",d.Type.I32,1),t.Xw(this.upBW),t.$w()),null!==this.downBW&&void 0!==this.downBW&&(t.Yw("downBW",d.Type.I32,2),t.Xw(this.downBW),t.$w()),null!==this.memN&&void 0!==this.memN&&(t.Yw("memN",d.Type.I32,3),t.Xw(this.memN),t.$w()),null!==this.prtInN&&void 0!==this.prtInN&&(t.Yw("prtInN",d.Type.I32,4),t.Xw(this.prtInN),t.$w()),null!==this.prtOutN&&void 0!==this.prtOutN&&(t.Yw("prtOutN",d.Type.I32,5),t.Xw(this.prtOutN),t.$w()),null!==this.initVideoBufQt&&void 0!==this.initVideoBufQt&&(t.Yw("initVideoBufQt",d.Type.I64,6),t.Yg(this.initVideoBufQt),t.$w()),null!==this.videoAvgBufQt&&void 0!==this.videoAvgBufQt&&(t.Yw("videoAvgBufQt",d.Type.DOUBLE,7),t.Kg(this.videoAvgBufQt),t.$w()),null!==this.videoBufQt&&void 0!==this.videoBufQt&&(t.Yw("videoBufQt",d.Type.I64,8),t.Yg(this.videoBufQt),t.$w()),null!==this.videoBufN&&void 0!==this.videoBufN&&(t.Yw("videoBufN",d.Type.I32,9),t.Xw(this.videoBufN),t.$w()),null!==this.initAudioBufQt&&void 0!==this.initAudioBufQt&&(t.Yw("initAudioBufQt",d.Type.I32,10),t.Xw(this.initAudioBufQt),t.$w()),null!==this.audioAvgBufQt&&void 0!==this.audioAvgBufQt&&(t.Yw("audioAvgBufQt",d.Type.DOUBLE,11),t.Kg(this.audioAvgBufQt),t.$w()),null!==this.audioBufQt&&void 0!==this.audioBufQt&&(t.Yw("audioBufQt",d.Type.I64,12),t.Yg(this.audioBufQt),t.$w()),null!==this.audioBufN&&void 0!==this.audioBufN&&(t.Yw("audioBufN",d.Type.I32,13),t.Xw(this.audioBufN),t.$w()),null!==this.bitrateUpN&&void 0!==this.bitrateUpN&&(t.Yw("bitrateUpN",d.Type.I32,14),t.Xw(this.bitrateUpN),t.$w()),null!==this.bitrateDwnN&&void 0!==this.bitrateDwnN&&(t.Yw("bitrateDwnN",d.Type.I32,15),t.Xw(this.bitrateDwnN),t.$w()),null!==this.delay&&void 0!==this.delay&&(t.Yw("delay",d.Type.I32,16),t.Xw(this.delay),t.$w()),null!==this.delayEnforcement&&void 0!==this.delayEnforcement&&(t.Yw("delayEnforcement",d.Type.I32,17),t.Xw(this.delayEnforcement),t.$w()),null!==this.lookupReqEstablished&&void 0!==this.lookupReqEstablished&&(t.Yw("lookupReqEstablished",d.Type.I32,18),t.Xw(this.lookupReqEstablished),t.$w()),null!==this.lookupReqAccept&&void 0!==this.lookupReqAccept&&(t.Yw("lookupReqAccept",d.Type.I32,19),t.Xw(this.lookupReqAccept),t.$w()),null!==this.fallbackAvgTp&&void 0!==this.fallbackAvgTp&&(t.Yw("fallbackAvgTp",d.Type.DOUBLE,20),t.Kg(this.fallbackAvgTp),t.$w()),null!==this.srcThroughput&&void 0!==this.srcThroughput&&(t.Yw("srcThroughput",d.Type.DOUBLE,21),t.Kg(this.srcThroughput),t.$w()),null!==this.diskReadTimeout&&void 0!==this.diskReadTimeout&&(t.Yw("diskReadTimeout",d.Type.I32,22),t.Xw(this.diskReadTimeout),t.$w()),null!==this.diskReadRate&&void 0!==this.diskReadRate&&(t.Yw("diskReadRate",d.Type.DOUBLE,23),t.Kg(this.diskReadRate),t.$w()),null!==this.diskStoreRate&&void 0!==this.diskStoreRate&&(t.Yw("diskStoreRate",d.Type.DOUBLE,24),t.Kg(this.diskStoreRate),t.$w()),null!==this.diskRemoveRate&&void 0!==this.diskRemoveRate&&(t.Yw("diskRemoveRate",d.Type.DOUBLE,25),t.Kg(this.diskRemoveRate),t.$w()),null!==this.diskCacheSize&&void 0!==this.diskCacheSize&&(t.Yw("diskCacheSize",d.Type.I64,26),t.Yg(this.diskCacheSize),t.$w()),null!==this.clientBufferMs&&void 0!==this.clientBufferMs&&(t.Yw("clientBufferMs",d.Type.I32,27),t.Xw(this.clientBufferMs),t.$w()),null!==this.lookupTotal&&void 0!==this.lookupTotal&&(t.Yw("lookupTotal",d.Type.I32,28),t.Xw(this.lookupTotal),t.$w()),null!==this.lookupNotFound&&void 0!==this.lookupNotFound&&(t.Yw("lookupNotFound",d.Type.I32,29),t.Xw(this.lookupNotFound),t.$w()),null!==this.lookupFailed&&void 0!==this.lookupFailed&&(t.Yw("lookupFailed",d.Type.I32,30),t.Xw(this.lookupFailed),t.$w()),null!==this.lookupLatency&&void 0!==this.lookupLatency&&(t.Yw("lookupLatency",d.Type.I32,31),t.Xw(this.lookupLatency),t.$w()),null!==this.trackerFailed&&void 0!==this.trackerFailed&&(t.Yw("trackerFailed",d.Type.I32,32),t.Xw(this.trackerFailed),t.$w()),null!==this.trackerLatency&&void 0!==this.trackerLatency&&(t.Yw("trackerLatency",d.Type.I32,33),t.Xw(this.trackerLatency),t.$w()),null!==this.snapshotFailed&&void 0!==this.snapshotFailed&&(t.Yw("snapshotFailed",d.Type.I32,34),t.Xw(this.snapshotFailed),t.$w()),null!==this.snapshotLatency&&void 0!==this.snapshotLatency&&(t.Yw("snapshotLatency",d.Type.I32,35),t.Xw(this.snapshotLatency),t.$w()),null!==this.uG&&void 0!==this.uG&&(t.Yw("sourceLatency",d.Type.I32,36),t.Xw(this.uG),t.$w()),t.Jw(),t.zw()},E.snapshots.PartnerTraffic=function(t){this.p2pSuccReq=null,this.p2pFailReq=null,this.p2pPartReq=null,this.p2pSuccReceived=null,this.p2pSuccReceivedLow=null,this.p2pFailReceived=null,this.p2pSuccResp=null,this.p2pFailResp=null,this.p2pPartResp=null,this.p2pSuccSent=null,this.p2pSuccSentLow=null,this.p2pFailSent=null,t&&(void 0!==t.p2pSuccReq&&null!==t.p2pSuccReq&&(this.p2pSuccReq=t.p2pSuccReq),void 0!==t.p2pFailReq&&null!==t.p2pFailReq&&(this.p2pFailReq=t.p2pFailReq),void 0!==t.p2pPartReq&&null!==t.p2pPartReq&&(this.p2pPartReq=t.p2pPartReq),void 0!==t.p2pSuccReceived&&null!==t.p2pSuccReceived&&(this.p2pSuccReceived=t.p2pSuccReceived),void 0!==t.p2pSuccReceivedLow&&null!==t.p2pSuccReceivedLow&&(this.p2pSuccReceivedLow=t.p2pSuccReceivedLow),void 0!==t.p2pFailReceived&&null!==t.p2pFailReceived&&(this.p2pFailReceived=t.p2pFailReceived),void 0!==t.p2pSuccResp&&null!==t.p2pSuccResp&&(this.p2pSuccResp=t.p2pSuccResp),void 0!==t.p2pFailResp&&null!==t.p2pFailResp&&(this.p2pFailResp=t.p2pFailResp),void 0!==t.p2pPartResp&&null!==t.p2pPartResp&&(this.p2pPartResp=t.p2pPartResp),void 0!==t.p2pSuccSent&&null!==t.p2pSuccSent&&(this.p2pSuccSent=t.p2pSuccSent),void 0!==t.p2pSuccSentLow&&null!==t.p2pSuccSentLow&&(this.p2pSuccSentLow=t.p2pSuccSentLow),void 0!==t.p2pFailSent&&null!==t.p2pFailSent&&(this.p2pFailSent=t.p2pFailSent))},E.snapshots.PartnerTraffic.prototype={},E.snapshots.PartnerTraffic.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I64?this.p2pSuccReq=t.Eb().value:t.Bw(n);break;case 2:n==d.Type.I64?this.p2pFailReq=t.Eb().value:t.Bw(n);break;case 3:n==d.Type.I64?this.p2pPartReq=t.Eb().value:t.Bw(n);break;case 4:n==d.Type.I64?this.p2pSuccReceived=t.Eb().value:t.Bw(n);break;case 5:n==d.Type.I64?this.p2pSuccReceivedLow=t.Eb().value:t.Bw(n);break;case 10:n==d.Type.I64?this.p2pFailReceived=t.Eb().value:t.Bw(n);break;case 6:n==d.Type.I64?this.p2pSuccResp=t.Eb().value:t.Bw(n);break;case 11:n==d.Type.I64?this.p2pFailResp=t.Eb().value:t.Bw(n);break;case 7:n==d.Type.I64?this.p2pPartResp=t.Eb().value:t.Bw(n);break;case 8:n==d.Type.I64?this.p2pSuccSent=t.Eb().value:t.Bw(n);break;case 9:n==d.Type.I64?this.p2pSuccSentLow=t.Eb().value:t.Bw(n);break;case 12:n==d.Type.I64?this.p2pFailSent=t.Eb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.PartnerTraffic.prototype.write=function(t){t.Ww("PartnerTraffic"),null!==this.p2pSuccReq&&void 0!==this.p2pSuccReq&&(t.Yw("p2pSuccReq",d.Type.I64,1),t.Yg(this.p2pSuccReq),t.$w()),null!==this.p2pFailReq&&void 0!==this.p2pFailReq&&(t.Yw("p2pFailReq",d.Type.I64,2),t.Yg(this.p2pFailReq),t.$w()),null!==this.p2pPartReq&&void 0!==this.p2pPartReq&&(t.Yw("p2pPartReq",d.Type.I64,3),t.Yg(this.p2pPartReq),t.$w()),null!==this.p2pSuccReceived&&void 0!==this.p2pSuccReceived&&(t.Yw("p2pSuccReceived",d.Type.I64,4),t.Yg(this.p2pSuccReceived),t.$w()),null!==this.p2pSuccReceivedLow&&void 0!==this.p2pSuccReceivedLow&&(t.Yw("p2pSuccReceivedLow",d.Type.I64,5),t.Yg(this.p2pSuccReceivedLow),t.$w()),null!==this.p2pFailReceived&&void 0!==this.p2pFailReceived&&(t.Yw("p2pFailReceived",d.Type.I64,10),t.Yg(this.p2pFailReceived),t.$w()),null!==this.p2pSuccResp&&void 0!==this.p2pSuccResp&&(t.Yw("p2pSuccResp",d.Type.I64,6),t.Yg(this.p2pSuccResp),t.$w()),null!==this.p2pFailResp&&void 0!==this.p2pFailResp&&(t.Yw("p2pFailResp",d.Type.I64,11),t.Yg(this.p2pFailResp),t.$w()),null!==this.p2pPartResp&&void 0!==this.p2pPartResp&&(t.Yw("p2pPartResp",d.Type.I64,7),t.Yg(this.p2pPartResp),t.$w()),null!==this.p2pSuccSent&&void 0!==this.p2pSuccSent&&(t.Yw("p2pSuccSent",d.Type.I64,8),t.Yg(this.p2pSuccSent),t.$w()),null!==this.p2pSuccSentLow&&void 0!==this.p2pSuccSentLow&&(t.Yw("p2pSuccSentLow",d.Type.I64,9),t.Yg(this.p2pSuccSentLow),t.$w()),null!==this.p2pFailSent&&void 0!==this.p2pFailSent&&(t.Yw("p2pFailSent",d.Type.I64,12),t.Yg(this.p2pFailSent),t.$w()),t.Jw(),t.zw()},E.snapshots.PartnerMetrics=function(t){this.rateReceived=null,this.rateSent=null,this.handshakeDelay=null,t&&(void 0!==t.rateReceived&&null!==t.rateReceived&&(this.rateReceived=t.rateReceived),void 0!==t.rateSent&&null!==t.rateSent&&(this.rateSent=t.rateSent),void 0!==t.handshakeDelay&&null!==t.handshakeDelay&&(this.handshakeDelay=t.handshakeDelay))},E.snapshots.PartnerMetrics.prototype={},E.snapshots.PartnerMetrics.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.DOUBLE?this.rateReceived=t.pb().value:t.Bw(n);break;case 2:n==d.Type.DOUBLE?this.rateSent=t.pb().value:t.Bw(n);break;case 3:n==d.Type.I64?this.handshakeDelay=t.Eb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.PartnerMetrics.prototype.write=function(t){t.Ww("PartnerMetrics"),null!==this.rateReceived&&void 0!==this.rateReceived&&(t.Yw("rateReceived",d.Type.DOUBLE,1),t.Kg(this.rateReceived),t.$w()),null!==this.rateSent&&void 0!==this.rateSent&&(t.Yw("rateSent",d.Type.DOUBLE,2),t.Kg(this.rateSent),t.$w()),null!==this.handshakeDelay&&void 0!==this.handshakeDelay&&(t.Yw("handshakeDelay",d.Type.I64,3),t.Yg(this.handshakeDelay),t.$w()),t.Jw(),t.zw()},E.snapshots.ConnectivityInfo=function(t){this.upBW=null,this.downBW=null,this.externalAs=null,this.internalAs=null,this.publicIp=null,this.privateIp=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp))},E.snapshots.ConnectivityInfo.prototype={},E.snapshots.ConnectivityInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.upBW=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.I32?this.downBW=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.I32?this.externalAs=t.Vw().value:t.Bw(n);break;case 4:n==d.Type.I32?this.internalAs=t.Vw().value:t.Bw(n);break;case 5:n==d.Type.STRING?this.publicIp=t.xw().value:t.Bw(n);break;case 6:n==d.Type.STRING?this.privateIp=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.ConnectivityInfo.prototype.write=function(t){t.Ww("ConnectivityInfo"),null!==this.upBW&&void 0!==this.upBW&&(t.Yw("upBW",d.Type.I32,1),t.Xw(this.upBW),t.$w()),null!==this.downBW&&void 0!==this.downBW&&(t.Yw("downBW",d.Type.I32,2),t.Xw(this.downBW),t.$w()),null!==this.externalAs&&void 0!==this.externalAs&&(t.Yw("externalAs",d.Type.I32,3),t.Xw(this.externalAs),t.$w()),null!==this.internalAs&&void 0!==this.internalAs&&(t.Yw("internalAs",d.Type.I32,4),t.Xw(this.internalAs),t.$w()),null!==this.publicIp&&void 0!==this.publicIp&&(t.Yw("publicIp",d.Type.STRING,5),t.Kw(this.publicIp),t.$w()),null!==this.privateIp&&void 0!==this.privateIp&&(t.Yw("privateIp",d.Type.STRING,6),t.Kw(this.privateIp),t.$w()),t.Jw(),t.zw()},E.snapshots.Partner=function(t){this.connInfo=null,this.traffic=null,this.metrics=null,this.inPart=null,this.outPart=null,this.udp=null,t&&(void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.inPart&&null!==t.inPart&&(this.inPart=t.inPart),void 0!==t.outPart&&null!==t.outPart&&(this.outPart=t.outPart),void 0!==t.udp&&null!==t.udp&&(this.udp=t.udp))},E.snapshots.Partner.prototype={},E.snapshots.Partner.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.STRUCT?(this.connInfo=new E.snapshots.ConnectivityInfo,this.connInfo.read(t)):t.Bw(n);break;case 2:n==d.Type.STRUCT?(this.traffic=new E.snapshots.PartnerTraffic,this.traffic.read(t)):t.Bw(n);break;case 3:n==d.Type.STRUCT?(this.metrics=new E.snapshots.PartnerMetrics,this.metrics.read(t)):t.Bw(n);break;case 4:n==d.Type.BOOL?this.inPart=t.cb().value:t.Bw(n);break;case 5:n==d.Type.BOOL?this.outPart=t.cb().value:t.Bw(n);break;case 6:n==d.Type.BOOL?this.udp=t.cb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.Partner.prototype.write=function(t){t.Ww("Partner"),null!==this.connInfo&&void 0!==this.connInfo&&(t.Yw("connInfo",d.Type.STRUCT,1),this.connInfo.write(t),t.$w()),null!==this.traffic&&void 0!==this.traffic&&(t.Yw("traffic",d.Type.STRUCT,2),this.traffic.write(t),t.$w()),null!==this.metrics&&void 0!==this.metrics&&(t.Yw("metrics",d.Type.STRUCT,3),this.metrics.write(t),t.$w()),null!==this.inPart&&void 0!==this.inPart&&(t.Yw("inPart",d.Type.BOOL,4),t.qg(this.inPart),t.$w()),null!==this.outPart&&void 0!==this.outPart&&(t.Yw("outPart",d.Type.BOOL,5),t.qg(this.outPart),t.$w()),null!==this.udp&&void 0!==this.udp&&(t.Yw("udp",d.Type.BOOL,6),t.qg(this.udp),t.$w()),t.Jw(),t.zw()},E.snapshots.StreamInfo=function(t){this.url=null,this.streamType=null,this.streamProtocol=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.streamProtocol&&null!==t.streamProtocol&&(this.streamProtocol=t.streamProtocol))},E.snapshots.StreamInfo.prototype={},E.snapshots.StreamInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.STRING?this.url=t.xw().value:t.Bw(n);break;case 2:n==d.Type.I32?this.streamType=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.I32?this.streamProtocol=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.StreamInfo.prototype.write=function(t){t.Ww("StreamInfo"),null!==this.url&&void 0!==this.url&&(t.Yw("url",d.Type.STRING,1),t.Kw(this.url),t.$w()),null!==this.streamType&&void 0!==this.streamType&&(t.Yw("streamType",d.Type.I32,2),t.Xw(this.streamType),t.$w()),null!==this.streamProtocol&&void 0!==this.streamProtocol&&(t.Yw("streamProtocol",d.Type.I32,3),t.Xw(this.streamProtocol),t.$w()),t.Jw(),t.zw()},E.snapshots.ClientInfo=function(t){this.clientType=null,this.majorVersion=null,this.minorVersion=null,this.patchVersion=null,t&&(void 0!==t.clientType&&null!==t.clientType&&(this.clientType=t.clientType),void 0!==t.majorVersion&&null!==t.majorVersion&&(this.majorVersion=t.majorVersion),void 0!==t.minorVersion&&null!==t.minorVersion&&(this.minorVersion=t.minorVersion),void 0!==t.patchVersion&&null!==t.patchVersion&&(this.patchVersion=t.patchVersion))},E.snapshots.ClientInfo.prototype={},E.snapshots.ClientInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.clientType=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.BYTE?this.majorVersion=t.lb().value:t.Bw(n);break;case 3:n==d.Type.BYTE?this.minorVersion=t.lb().value:t.Bw(n);break;case 4:n==d.Type.I16?this.patchVersion=t.vb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.ClientInfo.prototype.write=function(t){t.Ww("ClientInfo"),null!==this.clientType&&void 0!==this.clientType&&(t.Yw("clientType",d.Type.I32,1),t.Xw(this.clientType),t.$w()),null!==this.majorVersion&&void 0!==this.majorVersion&&(t.Yw("majorVersion",d.Type.BYTE,2),t.Qg(this.majorVersion),t.$w()),null!==this.minorVersion&&void 0!==this.minorVersion&&(t.Yw("minorVersion",d.Type.BYTE,3),t.Qg(this.minorVersion),t.$w()),null!==this.patchVersion&&void 0!==this.patchVersion&&(t.Yw("patchVersion",d.Type.I16,4),t.Wg(this.patchVersion),t.$w()),t.Jw(),t.zw()},E.snapshots.AgentInfo=function(t){this.firstTierBitrates=null,this.secondTierBitrates=null,t&&(void 0!==t.firstTierBitrates&&null!==t.firstTierBitrates&&(this.firstTierBitrates=t.firstTierBitrates),void 0!==t.secondTierBitrates&&null!==t.secondTierBitrates&&(this.secondTierBitrates=t.secondTierBitrates))},E.snapshots.AgentInfo.prototype={},E.snapshots.AgentInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:if(n==d.Type.SET){var s,e;this.firstTierBitrates=[];(e=t.ab()).ob,s=e.size;for(var h=0;h<s;++h){var o;o=t.Vw().value,this.firstTierBitrates.push(o)}t.fb()}else t.Bw(n);break;case 2:if(n==d.Type.SET){var u,a;this.secondTierBitrates=[];(a=t.ab()).ob,u=a.size;for(var f=0;f<u;++f){var c;c=t.Vw().value,this.secondTierBitrates.push(c)}t.fb()}else t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.AgentInfo.prototype.write=function(t){if(t.Ww("AgentInfo"),null!==this.firstTierBitrates&&void 0!==this.firstTierBitrates){for(var i in t.Yw("firstTierBitrates",d.Type.SET,1),t.Bg(d.Type.I32,this.firstTierBitrates.length),this.firstTierBitrates)this.firstTierBitrates.hasOwnProperty(i)&&(i=this.firstTierBitrates[i],t.Xw(i));t.Vg(),t.$w()}if(null!==this.secondTierBitrates&&void 0!==this.secondTierBitrates){for(var n in t.Yw("secondTierBitrates",d.Type.SET,2),t.Bg(d.Type.I32,this.secondTierBitrates.length),this.secondTierBitrates)this.secondTierBitrates.hasOwnProperty(n)&&(n=this.secondTierBitrates[n],t.Xw(n));t.Vg(),t.$w()}t.Jw(),t.zw()},E.snapshots.TrafficKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid))},E.snapshots.TrafficKey.prototype={},E.snapshots.TrafficKey.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.bitrate=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.I32?this.AS=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.STRING?this.partnerGuid=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.TrafficKey.prototype.write=function(t){t.Ww("TrafficKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.Yw("bitrate",d.Type.I32,1),t.Xw(this.bitrate),t.$w()),null!==this.AS&&void 0!==this.AS&&(t.Yw("AS",d.Type.I32,2),t.Xw(this.AS),t.$w()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.Yw("partnerGuid",d.Type.STRING,3),t.Kw(this.partnerGuid),t.$w()),t.Jw(),t.zw()},E.snapshots.PartnerKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid))},E.snapshots.PartnerKey.prototype={},E.snapshots.PartnerKey.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I32?this.bitrate=t.Vw().value:t.Bw(n);break;case 2:n==d.Type.I32?this.AS=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.STRING?this.partnerGuid=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.PartnerKey.prototype.write=function(t){t.Ww("PartnerKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.Yw("bitrate",d.Type.I32,1),t.Xw(this.bitrate),t.$w()),null!==this.AS&&void 0!==this.AS&&(t.Yw("AS",d.Type.I32,2),t.Xw(this.AS),t.$w()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.Yw("partnerGuid",d.Type.STRING,3),t.Kw(this.partnerGuid),t.$w()),t.Jw(),t.zw()},E.snapshots.Player=function(t){this.bufferingN=null,this.bufferingMs=null,this.initBufferingN=null,this.initBufferingMs=null,this.seekBufferingN=null,this.seekBufferingMs=null,this.playerBufferMs=null,t&&(void 0!==t.bufferingN&&null!==t.bufferingN&&(this.bufferingN=t.bufferingN),void 0!==t.bufferingMs&&null!==t.bufferingMs&&(this.bufferingMs=t.bufferingMs),void 0!==t.initBufferingN&&null!==t.initBufferingN&&(this.initBufferingN=t.initBufferingN),void 0!==t.initBufferingMs&&null!==t.initBufferingMs&&(this.initBufferingMs=t.initBufferingMs),void 0!==t.seekBufferingN&&null!==t.seekBufferingN&&(this.seekBufferingN=t.seekBufferingN),void 0!==t.seekBufferingMs&&null!==t.seekBufferingMs&&(this.seekBufferingMs=t.seekBufferingMs),void 0!==t.playerBufferMs&&null!==t.playerBufferMs&&(this.playerBufferMs=t.playerBufferMs))},E.snapshots.Player.prototype={},E.snapshots.Player.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I16?this.bufferingN=t.vb().value:t.Bw(n);break;case 2:n==d.Type.I32?this.bufferingMs=t.Vw().value:t.Bw(n);break;case 3:n==d.Type.I16?this.initBufferingN=t.vb().value:t.Bw(n);break;case 4:n==d.Type.I32?this.initBufferingMs=t.Vw().value:t.Bw(n);break;case 5:n==d.Type.I16?this.seekBufferingN=t.vb().value:t.Bw(n);break;case 6:n==d.Type.I32?this.seekBufferingMs=t.Vw().value:t.Bw(n);break;case 36:n==d.Type.I32?this.playerBufferMs=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.Player.prototype.write=function(t){t.Ww("Player"),null!==this.bufferingN&&void 0!==this.bufferingN&&(t.Yw("bufferingN",d.Type.I16,1),t.Wg(this.bufferingN),t.$w()),null!==this.bufferingMs&&void 0!==this.bufferingMs&&(t.Yw("bufferingMs",d.Type.I32,2),t.Xw(this.bufferingMs),t.$w()),null!==this.initBufferingN&&void 0!==this.initBufferingN&&(t.Yw("initBufferingN",d.Type.I16,3),t.Wg(this.initBufferingN),t.$w()),null!==this.initBufferingMs&&void 0!==this.initBufferingMs&&(t.Yw("initBufferingMs",d.Type.I32,4),t.Xw(this.initBufferingMs),t.$w()),null!==this.seekBufferingN&&void 0!==this.seekBufferingN&&(t.Yw("seekBufferingN",d.Type.I16,5),t.Wg(this.seekBufferingN),t.$w()),null!==this.seekBufferingMs&&void 0!==this.seekBufferingMs&&(t.Yw("seekBufferingMs",d.Type.I32,6),t.Xw(this.seekBufferingMs),t.$w()),null!==this.playerBufferMs&&void 0!==this.playerBufferMs&&(t.Yw("playerBufferMs",d.Type.I32,36),t.Xw(this.playerBufferMs),t.$w()),t.Jw(),t.zw()},E.snapshots.jG=function(t){this.mF=null,this.count=null,t&&(void 0!==t.mF&&null!==t.mF&&(this.mF=t.mF),void 0!==t.count&&null!==t.count&&(this.count=t.count))},E.snapshots.jG.prototype={},E.snapshots.jG.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I16?this.mF=t.vb().value:t.Bw(n);break;case 2:n==d.Type.I32?this.count=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.jG.prototype.write=function(t){t.Ww("ResponseInfo"),null!==this.mF&&void 0!==this.mF&&(t.Yw("statusCode",d.Type.I16,1),t.Wg(this.mF),t.$w()),null!==this.count&&void 0!==this.count&&(t.Yw("count",d.Type.I32,2),t.Xw(this.count),t.$w()),t.Jw(),t.zw()},E.snapshots.PG=function(t){this.source=null,t&&void 0!==t.source&&null!==t.source&&(this.source=d.Rb(t.source,[E.snapshots.jG]))},E.snapshots.PG.prototype={},E.snapshots.PG.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:if(n==d.Type.LIST){var s,e;this.source=[];(e=t.hb()).ob,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new E.snapshots.jG).read(t),this.source.push(o)}t.ub()}else t.Bw(n);break;case 0:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.PG.prototype.write=function(t){if(t.Ww("ServiceResponseInfo"),null!==this.source&&void 0!==this.source){for(var i in t.Yw("source",d.Type.LIST,1),t.Gg(d.Type.STRUCT,this.source.length),this.source)this.source.hasOwnProperty(i)&&(i=this.source[i]).write(t);t.xg(),t.$w()}t.Jw(),t.zw()},E.snapshots.MetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.rG=null,this.testInfo=null,this.IK=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.rG&&null!==t.rG&&(this.rG=t.rG),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.IK&&null!==t.IK&&(this.IK=t.IK))},E.snapshots.MetricSnapshot.prototype={},E.snapshots.MetricSnapshot.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I64?this.timestamp=t.Eb().value:t.Bw(n);break;case 2:n==d.Type.STRING?this.guid=t.xw().value:t.Bw(n);break;case 3:n==d.Type.STRUCT?(this.eventId=new EventId,this.eventId.read(t)):t.Bw(n);break;case 4:n==d.Type.STRUCT?(this.streamInfo=new E.snapshots.StreamInfo,this.streamInfo.read(t)):t.Bw(n);break;case 5:n==d.Type.STRUCT?(this.metrics=new E.snapshots.Metrics,this.metrics.read(t)):t.Bw(n);break;case 6:if(n==d.Type.MAP){var s,e;this.traffic={};(e=t.nb()).rb,e.sb,s=e.size;for(var h=0;h<s;++h){0<h&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var o=null,u=null;(o=new E.snapshots.TrafficKey).read(t),(u=new E.snapshots.Traffic).read(t),this.traffic[o]=u}t.eb()}else t.Bw(n);break;case 7:n==d.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo,this.snapshotInfo.read(t)):t.Bw(n);break;case 8:n==d.Type.STRUCT?(this.agentInfo=new E.snapshots.AgentInfo,this.agentInfo.read(t)):t.Bw(n);break;case 9:n==d.Type.STRUCT?(this.connInfo=new E.snapshots.ConnectivityInfo,this.connInfo.read(t)):t.Bw(n);break;case 10:if(n==d.Type.MAP){var a,f;this.partners={};(f=t.nb()).rb,f.sb,a=f.size;for(var c=0;c<a;++c){0<c&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var l=null,v=null;(l=new E.snapshots.PartnerKey).read(t),(v=new E.snapshots.Partner).read(t),this.partners[l]=v}t.eb()}else t.Bw(n);break;case 11:n==d.Type.STRUCT?(this.player=new E.snapshots.Player,this.player.read(t)):t.Bw(n);break;case 12:n==d.Type.STRUCT?(this.client=new E.snapshots.ClientInfo,this.client.read(t)):t.Bw(n);break;case 13:n==d.Type.STRING?this.sessionId=t.xw().value:t.Bw(n);break;case 14:n==d.Type.STRUCT?(this.rG=new E.snapshots.PG,this.rG.read(t)):t.Bw(n);break;case 15:n==d.Type.STRUCT?(this.testInfo=new TestInfo,this.testInfo.read(t)):t.Bw(n);break;case 16:n==d.Type.I64?this.IK=t.Eb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.MetricSnapshot.prototype.write=function(t){if(t.Ww("MetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",d.Type.I64,1),t.Yg(this.timestamp),t.$w()),null!==this.guid&&void 0!==this.guid&&(t.Yw("guid",d.Type.STRING,2),t.Kw(this.guid),t.$w()),null!==this.eventId&&void 0!==this.eventId&&(t.Yw("eventId",d.Type.STRUCT,3),this.eventId.write(t),t.$w()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.Yw("streamInfo",d.Type.STRUCT,4),this.streamInfo.write(t),t.$w()),null!==this.metrics&&void 0!==this.metrics&&(t.Yw("metrics",d.Type.STRUCT,5),this.metrics.write(t),t.$w()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.Yw("traffic",d.Type.MAP,6),t.Ug(d.Type.STRUCT,d.Type.STRUCT,d.Ow(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];n.key.write(t),n.value.write(t)}t.Fg(),t.$w()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.Yw("snapshotInfo",d.Type.STRUCT,7),this.snapshotInfo.write(t),t.$w()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.Yw("agentInfo",d.Type.STRUCT,8),this.agentInfo.write(t),t.$w()),null!==this.connInfo&&void 0!==this.connInfo&&(t.Yw("connInfo",d.Type.STRUCT,9),this.connInfo.write(t),t.$w()),null!==this.partners&&void 0!==this.partners){for(var r in t.Yw("partners",d.Type.MAP,10),t.Ug(d.Type.STRUCT,d.Type.STRUCT,d.Ow(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];s.key.write(t),s.value.write(t)}t.Fg(),t.$w()}null!==this.player&&void 0!==this.player&&(t.Yw("player",d.Type.STRUCT,11),this.player.write(t),t.$w()),null!==this.client&&void 0!==this.client&&(t.Yw("client",d.Type.STRUCT,12),this.client.write(t),t.$w()),null!==this.sessionId&&void 0!==this.sessionId&&(t.Yw("sessionId",d.Type.STRING,13),t.Kw(this.sessionId),t.$w()),null!==this.rG&&void 0!==this.rG&&(t.Yw("responseInfo",d.Type.STRUCT,14),this.rG.write(t),t.$w()),null!==this.testInfo&&void 0!==this.testInfo&&(t.Yw("testInfo",d.Type.STRUCT,15),this.testInfo.write(t),t.$w()),null!==this.IK&&void 0!==this.IK&&(t.Yw("clientId",d.Type.I64,16),t.Yg(this.IK),t.$w()),t.Jw(),t.zw()},E.snapshots.JsonMetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.rG=null,this.testInfo=null,this.IK=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.rG&&null!==t.rG&&(this.rG=t.rG),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.IK&&null!==t.IK&&(this.IK=t.IK))},E.snapshots.JsonMetricSnapshot.prototype={},E.snapshots.JsonMetricSnapshot.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==d.Type.STOP)break;switch(r){case 1:n==d.Type.I64?this.timestamp=t.Eb().value:t.Bw(n);break;case 2:n==d.Type.STRING?this.guid=t.xw().value:t.Bw(n);break;case 3:n==d.Type.STRUCT?(this.eventId=new EventId,this.eventId.read(t)):t.Bw(n);break;case 4:n==d.Type.STRUCT?(this.streamInfo=new E.snapshots.StreamInfo,this.streamInfo.read(t)):t.Bw(n);break;case 5:n==d.Type.STRUCT?(this.metrics=new E.snapshots.Metrics,this.metrics.read(t)):t.Bw(n);break;case 6:if(n==d.Type.MAP){var s,e;this.traffic={};(e=t.nb()).rb,e.sb,s=e.size;for(var h=0;h<s;++h){0<h&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var o,u=null;o=t.xw().value,(u=new E.snapshots.Traffic).read(t),this.traffic[o]=u}t.eb()}else t.Bw(n);break;case 7:n==d.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo,this.snapshotInfo.read(t)):t.Bw(n);break;case 8:n==d.Type.STRUCT?(this.agentInfo=new E.snapshots.AgentInfo,this.agentInfo.read(t)):t.Bw(n);break;case 9:n==d.Type.STRUCT?(this.connInfo=new E.snapshots.ConnectivityInfo,this.connInfo.read(t)):t.Bw(n);break;case 10:if(n==d.Type.MAP){var a,f;this.partners={};(f=t.nb()).rb,f.sb,a=f.size;for(var c=0;c<a;++c){0<c&&t.Xg.length>t.ig[t.ig.length-1]+1&&t.Xg.pop();var l,v=null;l=t.xw().value,(v=new E.snapshots.Partner).read(t),this.partners[l]=v}t.eb()}else t.Bw(n);break;case 11:n==d.Type.STRUCT?(this.player=new E.snapshots.Player,this.player.read(t)):t.Bw(n);break;case 12:n==d.Type.STRUCT?(this.client=new E.snapshots.ClientInfo,this.client.read(t)):t.Bw(n);break;case 13:n==d.Type.STRING?this.sessionId=t.xw().value:t.Bw(n);break;case 14:n==d.Type.STRUCT?(this.rG=new E.snapshots.PG,this.rG.read(t)):t.Bw(n);break;case 15:n==d.Type.STRUCT?(this.testInfo=new TestInfo,this.testInfo.read(t)):t.Bw(n);break;case 16:n==d.Type.I64?this.IK=t.Eb().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},E.snapshots.JsonMetricSnapshot.prototype.write=function(t){if(t.Ww("JsonMetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",d.Type.I64,1),t.Yg(this.timestamp),t.$w()),null!==this.guid&&void 0!==this.guid&&(t.Yw("guid",d.Type.STRING,2),t.Kw(this.guid),t.$w()),null!==this.eventId&&void 0!==this.eventId&&(t.Yw("eventId",d.Type.STRUCT,3),this.eventId.write(t),t.$w()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.Yw("streamInfo",d.Type.STRUCT,4),this.streamInfo.write(t),t.$w()),null!==this.metrics&&void 0!==this.metrics&&(t.Yw("metrics",d.Type.STRUCT,5),this.metrics.write(t),t.$w()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.Yw("traffic",d.Type.MAP,6),t.Ug(d.Type.STRING,d.Type.STRUCT,d.Ow(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];t.Kw(i),n.write(t)}t.Fg(),t.$w()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.Yw("snapshotInfo",d.Type.STRUCT,7),this.snapshotInfo.write(t),t.$w()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.Yw("agentInfo",d.Type.STRUCT,8),this.agentInfo.write(t),t.$w()),null!==this.connInfo&&void 0!==this.connInfo&&(t.Yw("connInfo",d.Type.STRUCT,9),this.connInfo.write(t),t.$w()),null!==this.partners&&void 0!==this.partners){for(var r in t.Yw("partners",d.Type.MAP,10),t.Ug(d.Type.STRING,d.Type.STRUCT,d.Ow(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];t.Kw(r),s.write(t)}t.Fg(),t.$w()}null!==this.player&&void 0!==this.player&&(t.Yw("player",d.Type.STRUCT,11),this.player.write(t),t.$w()),null!==this.client&&void 0!==this.client&&(t.Yw("client",d.Type.STRUCT,12),this.client.write(t),t.$w()),null!==this.sessionId&&void 0!==this.sessionId&&(t.Yw("sessionId",d.Type.STRING,13),t.Kw(this.sessionId),t.$w()),null!==this.rG&&void 0!==this.rG&&(t.Yw("responseInfo",d.Type.STRUCT,14),this.rG.write(t),t.$w()),null!==this.testInfo&&void 0!==this.testInfo&&(t.Yw("testInfo",d.Type.STRUCT,15),this.testInfo.write(t),t.$w()),null!==this.IK&&void 0!==this.IK&&(t.Yw("clientId",d.Type.I64,16),t.Yg(this.IK),t.$w()),t.Jw(),t.zw()}},function(t,i,n){var u=n(28),r=(window.StreamType={1:"LIVE",LIVE:1,2:"VOD",VOD:2},window.StreamProtocol={1:"DASH",DASH:1,2:"HDS",HDS:2,3:"HLS",HLS:3,4:"SS",SS:4},window.ClientType={1:"JAVA",_K:1,2:"STATS_ONLY",SG:2,3:"JS_DIRECT",mG:3,4:"JS_PROXY",OG:4},window.EventId=function(t){this.partnerId=null,this.customerId=null,this.contentId=null,this.tags=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.tags&&null!==t.tags&&(this.tags=t.tags))});r.prototype={},r.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.partnerId=t.xw().value:t.Bw(n);break;case 2:n==u.Type.STRING?this.customerId=t.xw().value:t.Bw(n);break;case 3:n==u.Type.STRING?this.contentId=t.xw().value:t.Bw(n);break;case 4:if(n==u.Type.LIST){var s,e;this.tags=[];(e=t.hb()).ob,s=e.size;for(var h=0;h<s;++h){var o;o=t.xw().value,this.tags.push(o)}t.ub()}else t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},r.prototype.write=function(t){if(t.Ww("EventId"),null!==this.partnerId&&void 0!==this.partnerId&&(t.Yw("partnerId",u.Type.STRING,1),t.Kw(this.partnerId),t.$w()),null!==this.customerId&&void 0!==this.customerId&&(t.Yw("customerId",u.Type.STRING,2),t.Kw(this.customerId),t.$w()),null!==this.contentId&&void 0!==this.contentId&&(t.Yw("contentId",u.Type.STRING,3),t.Kw(this.contentId),t.$w()),null!==this.tags&&void 0!==this.tags){for(var i in t.Yw("tags",u.Type.LIST,4),t.Gg(u.Type.STRING,this.tags.length),this.tags)this.tags.hasOwnProperty(i)&&(i=this.tags[i],t.Kw(i));t.xg(),t.$w()}t.Jw(),t.zw()};var s=window.SnapshotInfo=function(t){this.timestamp=null,this.apiServer=null,this.clientIp=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.apiServer&&null!==t.apiServer&&(this.apiServer=t.apiServer),void 0!==t.clientIp&&null!==t.clientIp&&(this.clientIp=t.clientIp))};s.prototype={},s.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.I64?this.timestamp=t.Eb().value:t.Bw(n);break;case 2:n==u.Type.STRING?this.apiServer=t.xw().value:t.Bw(n);break;case 3:n==u.Type.STRING?this.clientIp=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},s.prototype.write=function(t){t.Ww("SnapshotInfo"),null!==this.timestamp&&void 0!==this.timestamp&&(t.Yw("timestamp",u.Type.I64,1),t.Yg(this.timestamp),t.$w()),null!==this.apiServer&&void 0!==this.apiServer&&(t.Yw("apiServer",u.Type.STRING,2),t.Kw(this.apiServer),t.$w()),null!==this.clientIp&&void 0!==this.clientIp&&(t.Yw("clientIp",u.Type.STRING,3),t.Kw(this.clientIp),t.$w()),t.Jw(),t.zw()};var e=window.TestInfo=function(t){this.testId=null,t&&void 0!==t.testId&&null!==t.testId&&(this.testId=t.testId)};e.prototype={},e.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.testId=t.xw().value:t.Bw(n);break;case 0:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},e.prototype.write=function(t){t.Ww("TestInfo"),null!==this.testId&&void 0!==this.testId&&(t.Yw("testId",u.Type.STRING,1),t.Kw(this.testId),t.$w()),t.Jw(),t.zw()};var h=window.InetAddress=function(t){this.address=null,this.port=null,t&&(void 0!==t.address&&null!==t.address&&(this.address=t.address),void 0!==t.port&&null!==t.port&&(this.port=t.port))};h.prototype={},h.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.address=t.wb().value:t.Bw(n);break;case 2:n==u.Type.I32?this.port=t.Vw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},h.prototype.write=function(t){t.Ww("InetAddress"),null!==this.address&&void 0!==this.address&&(t.Yw("address",u.Type.STRING,1),t.$g(this.address),t.$w()),null!==this.port&&void 0!==this.port&&(t.Yw("port",u.Type.I32,2),t.Xw(this.port),t.$w()),t.Jw(),t.zw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(17),e=(h.prototype.AK=function(){return Date.now()>=this.NK},h);function h(t,i){this.msg=t,this.NK=Date.now()+i,this.CK=r.defer()}var o=(u.prototype.Eh=function(t){var i=t.service+"_"+t.msgId,n=this.oW[i];null!=n?n(t):s.logger().error(s.loggerId+"Could not find a dispatcher for ",t,i,this.oW)},u.prototype.on=function(t,i,n){this.oW[t+"_"+i]=n},u.prototype.onerror=function(t){this.kK.push(t)},u.prototype.onconnect=function(t){this.DK.push(t)},u.prototype.MK=function(){var n=this;if(window.WebSocket){var t=new WebSocket(this.jK);return t.binaryType="arraybuffer",t.onopen=function(t){n.PK(),s.logger().debug(s.loggerId+"HiveServicesConnection established to "+n.jK),n.HK=(new n.LK).getTime(),n.UK(),n.DK.forEach(function(t){return t(n)}),n.FK(),n.GK()},t.onclose=function(t){n.close(n.xK),n.connect()},t.onmessage=function(t){n.Eh(s.hl.el(t.data))},t.onerror=function(i){n.close(!0),n.kK.forEach(function(t){return t(i.toString())})},t}this.kK.forEach(function(t){return t("WebSocket not defined")})},u.prototype.isOpen=function(){return null!=this.Yb&&this.Yb.readyState==this.Yb.OPEN},u.prototype.connect=function(t){var i=this;t&&(this.xK=!0),this.xK&&1!=this.isOpen()&&(0<this.BK||(-1<this.HK&&(new this.LK).getTime()-this.HK>this.ep?(this.VK=s.et.rl,this.HK=-1):this.VK=Math.min(2*this.VK,this.ep),this.BK=window.setTimeout(function(){i.BK=-1,s.logger().debug(s.loggerId+"Connection attempt to "+i.jK+" [t:"+i.VK+" hb:"+i.qK+"]"),i.Yb=i.MK(),i.VK=Math.max(i.VK,s.et.rl)},this.VK)))},u.prototype.PK=function(){-1<this.BK&&(clearTimeout(this.BK),this.BK=-1)},u.prototype.close=function(t){this.xK=null!=t&&t,s.logger().debug(s.loggerId+"Closing connection [reconnect:"+this.xK+"]"),this.PK(),null!=this.Yb&&(this.Yb.close(),this.Yb=null)},u.prototype.UK=function(){for(;0<this.QK.length;){var i=this.QK.pop();try{i.AK()?i.CK.reject(new Error("Message expired")):(this.FK(),this.Yb.send(i.msg.sl()))}catch(t){if(t.code===DOMException.INVALID_STATE_ERR){this.QK.push(i);break}s.logger().error(s.loggerId+"Failed to send the message, dropped: ",t.code,t.name),i.CK.reject(t)}}this.GK()},u.prototype.FK=function(){this.WK&&(clearTimeout(this.WK),this.WK=null)},u.prototype.GK=function(){var t=this;this.qK&&!this.WK&&(this.WK=window.setInterval(function(){t.send(new s.hl(HiveStreamingServices.YK,0,""))},this.KK))},u.prototype.send=function(t,i){if(void 0===i&&(i=this.op),this.QK.length>=this.hp)throw new Error("HiveServices connection cannot queue more messages");var n=new e(t,i);return this.QK.push(n),this.Yb&&this.UK(),n.CK.promise},u.prototype.$K=function(t){this.qK=t,this.qK&&this.GK()},u.prototype.isConnected=function(){return null!=this.Yb},u);function u(t,i,n,r,s,e,h){void 0===i&&(i=3e4),void 0===n&&(n=100),void 0===r&&(r=3e4),void 0===s&&(s=15e3),void 0===e&&(e=Date),void 0===h&&(h=!1),this.VK=1,this.BK=-1,this.HK=-1,this.oW={},this.kK=[],this.DK=[],this.qK=!1,this.xK=!0,this.jK=t,this.QK=Array(),this.ep=i,this.hp=n,this.op=r,this.KK=s,this.LK=e,this.qK=h||/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge./i.test(navigator.userAgent)}i.xG=o},function(t,i){window.HiveStreamingServices={1:"REMOTE_EXECUTOR",XK:1,2:"PEER_FORWARDER",JK:2,3:"PEER_INDEX",zK:3,4:"PEER_BROADCAST",ZK:4,5:"PEER_FILTER",t$:5,6:"PEER_LOGGING",i$:6,7:"HIVEJS_TRACKER",n$:7,8:"PEER_SYSTEM",r$:8,9:"HIVEJS_SNAPSHOTS",GE:9,10:"HIVEJS_TICKETS",GG:10,11:"HIVEJS_KEEPALIVE",YK:11,12:"HIVEJS_FORWARDING",s$:12,13:"INTERNAL_TICKET",e$:13,14:"LOCALITY_SERVICE",h$:14}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.Dl=function(){return this.p2pId},s.prototype.Ml=function(){return this.reportingId?this.reportingId:this.p2pId},s);function s(t,i){this.p2pId=t,this.reportingId=i}i.tx=r},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(79),o=(e=h.Ax,s(u,e),u.prototype.getCidr=function(){return this._x?this._x:null},u);function u(){return null!==e&&e.apply(this,arguments)||this}i.vx=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(55),o=n(3),r=n(0),u=n(25),s=(e.prototype.XG=function(){var i=o.defer(),n=this.indexedDB.open("PrivateIPDB");return n.onupgradeneeded=function(){n.result.createObjectStore("PrivateIPStore",{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},e.prototype.Qx=function(){var r=this;if(this.o$)return this.o$;var s=setTimeout(function(){r.logger.warn("Private list retrieval timeout"),e.reject({message:"Private list timeout"})},4e3),e=o.defer();return u.DE.rf&&this.indexedDB?this.XG().then(function(i){var n=i.transaction("PrivateIPStore","readwrite").objectStore("PrivateIPStore").get("iplist");n.onsuccess=function(){clearTimeout(s);var t=[];h.LP(n.result)||h.LP(n.result.value)||(t=n.result.value.split("|")),e.resolve(t),i.close()},n.onerror=function(t){clearTimeout(s),r.logger.warn("I got an error on indexed db "+t.message),e.reject({message:"Error on indexedDB "+t.message})}}).fail(function(t){clearTimeout(s),r.logger.warn("DB is not open with error"+t.message),e.reject({message:"DB is not open with error "+t.message})}):(clearTimeout(s),e.reject({message:"DB is not ready or enabled"})),this.o$=e.promise,this.o$},e.prototype.Zx=function(n){var r=this;if(u.DE.rf&&this.indexedDB){var s=n.join("|");this.XG().then(function(t){var i=t.transaction("PrivateIPStore","readwrite");i.objectStore("PrivateIPStore").put({id:"iplist",value:s}),i.oncomplete=function(){r.logger.debug("Storing site matched ips ["+n.join(",")+"]"),t.close()}}).fail(function(t){r.logger.warn("DB is not open with error "+t.message)})}},e);function e(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.logger=r.Framework.resolve(r.Framework.ht.m).log()}i.tB=s},function(t,i){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.hC&&"function"==typeof t.fill&&"function"==typeof t.qA}},function(t,i){"function"==typeof Object.create?t.exports=function(t,i){t.u$=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,i){t.u$=i;function n(){}n.prototype=i.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(21),o=(e=h.HiveTechOptions,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.gH=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.oG=function(){var t=new hive.snapshots.StreamInfo;return t.streamType=this.isLive?StreamType.LIVE:StreamType.VOD,t.streamProtocol=this.protocol,t.url=this.iL,t},s);function s(t,i,n){this.isLive=t,this.protocol=i,this.iL=n}i.hH=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(4),r=(d.prototype.SY=function(t,i,n){if(!this.a$.has(t)){if(!t[i])throw new Error(d.loggerId+"- method "+i+" is undefined in event target.");if(!t[n])throw new Error(d.loggerId+"- method "+n+" is undefined in event target.");this.a$.set(t,{f$:d.c$++,l$:i,v$:n,events:{}})}return this},d.prototype.eY=function(t,i){if(!i){var n=this.a$.keys(),r=n.length;if(1!==r)throw new Error(d.loggerId+"Incorrect use of non-targeted registerEvents; "+r+" registered");i=t,t=n[0]}var s=this.a$.get(t);if(!s)throw new Error(d.loggerId+"- target not registered");for(var e=s.l$,h=s.f$,o=[],u=0,a=Object.keys(i);u<a.length;u++){var f=a[u],c=i[f],l=void 0;l="function"==typeof c?c:c.RY,s.events[f]||(t[e](f,l),s.events[f]=c,o.push(f))}return this.plugin&&this.plugin.logger().debug(d.loggerId+"Registering events ["+o.join(", ")+"] on target #"+h),0<o.length},d.prototype.uF=function(l){var v=this;void 0===l&&(l=!1),this.a$.forEach(function(t,i){for(var n=t.v$,r=t.events,s=t.f$,e=[],h=0,o=Object.keys(r);h<o.length;h++){var u=o[h],a=r[u],f=void 0,c=void 0;"function"==typeof a?f=a:(f=a.RY,c=a.IY),!l&&c||(i[n](u,f),e.push(u),delete r[u])}l&&v.a$.delete(i),v.plugin&&v.plugin.logger().debug(d.loggerId+"Unregistering events ["+e.join(", ")+"] on target #"+s+" [destroy: "+l+"]")})},d.prototype.reset=function(){var r=this;this.a$.forEach(function(t,i){var n=t.f$;r.a$.delete(i),r.plugin&&r.plugin.logger().debug(d.loggerId+"Reset on target #"+n)})},d.loggerId="[HiveEventsBinder] ",d.c$=0,d);function d(t,i,n,r){this.plugin=t,this.a$=new s,i&&this.SY(i,n,r)}i.default=r},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(54),u=n(0),a=n(129),f=n(82),c=n(18),l=n(56),v=n(200),d=n(27),E=n(22),p=n(15),w=n(81),g=n(1),b=n(45),y=n(33),T=(e=l.StatsJS,s(m,e),m.prototype.getName=function(){return m.WP},m.prototype.getVersion=function(){return this.YP.getPluginVersion()},m.prototype.KP=function(){return!0},m.prototype.$P=function(){return f.aA.Api?navigator&&navigator.userAgent&&this.d$(navigator.userAgent)?h.resolve(!0):h.reject(new d.HiveTechError(d.aw.fw,"WebRTC DataChannels not supported by browser")):h.reject(new d.HiveTechError(d.aw.fw,"Not included in the page"))},m.prototype.initSession=function(s,e){var h=this;return this.$P().then(function(){var t=e.ticket;h.sH();var i=t.$k();0===i.indexOf("//")&&(i=location.protocol+i);var n=h.XP(s,t,i,e),r=h.YP.getPluginId();return w.OF.nB(n,r),w.OF.registerComm(h.YP,r),E.HiveRequestFactory.registerTech(r,h.getName()),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(h.YP.loggerLevel()>b.Nk.info,r),n})},m.prototype.isActive=function(t,i,n){void 0===n&&(n=!1);var r=i.manifest.toLowerCase(),s=t.toLowerCase(),e=r.indexOf(".ism/manifest");if(-1<e&&(!n||t===i.manifest)){var h=r.substring(0,e);if(-1<s.indexOf(h))return-1<s.indexOf(".ism/manifest(format=mpd-time-csf)")?this.ad?(i.ticket.SourceURL=t,!0):this.E$(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.E$(i,"Protocol not supported by HiveJS tech, downgrading to StatsJS")}else if(s===r)return!!this.ad||this.E$(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},m.prototype.pd=function(t,i){window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),e.prototype.pd.call(this,t,i);var n=f.aA.Api();i?(E.HiveRequestFactory.clearPlugin(this.YP.getPluginId()),w.OF.eB(t,this.YP.getPluginId()),n&&(n.gl(this.YP.getPluginId(),c.ul.STOP),n.p$())):n&&n.gl(this.YP.getPluginId(),c.ul.IDLE)},m.prototype.E$=function(t,i){return t.tech=this.BU,E.HiveRequestFactory.registerTech(this.YP.getPluginId(),l.StatsJS.WP),this.ad&&this.ad.resolve(),this.ad=void 0,this.YP.logger().warn("[HiveJS] "+i),this.onError(new d.HiveTechError(d.aw.lw,i)),window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),!0},m.prototype.hB=function(t){this.ad=t},m.prototype.fH=function(){E.HiveRequestFactory.od(m.WP,y.HiveRequest,w.OF)},m.prototype.onActiveSession=function(r){var s=this;u.Framework.D().apply(new a.w$(!0));var e=f.aA.Api();if(e.gl(this.YP.getPluginId(),c.ul.STOP),this.g$()&&e.b$(!0),e.start(r.yd,!1,this.YP.$U()).then(function(t){if(s.sH(),s.eH=r.yd,s.eH.Tl(s.options_.renderStatsCallback),s.eH.El(f.aA.Pl(),f.aA.getVersion()),s.eH.bl.init(s.eH.pl,r.ticket.sessionId),s.YP.options().testId&&s.eH.pl.uH(s.YP.options().testId),r.authenticationToken){var i=e.y$(s.YP.getPluginId());i&&i.T$.$.TL(r.authenticationToken)}s.ad&&e.request(s.ad,s.YP.getPluginId()),s.eH.wl.fd(r.ticket.sessionId,s.YP.getPlayerSource(),200);var n=s.YP.flushTechEvents();n&&0<n.length&&s.eH.wl.dE(n),s.YP.updatePlayerInfo(s.eH)}),null!=this.options().onActiveSession)try{this.options().onActiveSession(r.toHiveSession())}catch(t){g.ErrorMonitor.lt().logError("exception in user-defined onActiveSession callback","[HiveJS]",t)}},m.prototype.gl=function(t,i){},m.prototype.XP=function(t,i,n,r){var s=new E.HiveSessionInternal(t,i,n,r);return s.lH=!0,s.id=s.ticket.sessionId,s},m.prototype.nH=function(){},m.prototype.g$=function(){var t=new o.gE;return t.bE(navigator.userAgent),"Android"==t.yE().name},m.prototype.d$=function(t){try{var i=new o.gE(t).Bj();return"Mobile Safari"!==i.name&&("Safari"===i.name?12<=parseInt(i.Sj,10):"function"==typeof RTCPeerConnection.prototype.createDataChannel)}catch(t){return!1}},m.WP="HiveJS",m);function m(t,i,n){var r=e.call(this,t,i)||this;return r.options_=new v.m$,null!=i[m.WP]&&p.updateOptions(i[m.WP],r.options_),r.BU=n,r}i.HiveJS=T},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(42),s=n(0),e=n(45),h=n(8),o=n(18),u=n(74),a=n(75),f=n(76),c=n(73),l=n(24),v=n(16),d=n(130),E=n(132),p=n(133),w=n(89),g=n(152),b=n(153),y=n(154),T=n(155),m=n(156),O=n(95),S=n(171),R=n(172),I=n(173),_=n(49),A=n(20),N=n(174),C=n(178),k=n(179),D=n(180),M=n(181),j=n(183),P=n(184),H=n(185),L=n(186),U=n(77),F=n(187),G=n(188),x=n(189),B=n(7),V=n(190),q=n(191),Q=n(192),W=n(193),Y=B.ut.Ya,K=B.ut.Ka,$=B.ut.$a,X=B.ut.Ja,J=n(195),z=n(196),Z=n(93),tt=n(198),it=n(78),nt=n(80),rt=B.ut.sf,st=(et.prototype.apply=function(t){this.O$?X&&t.bind(new r.uk(h.pf.af,it.gx,r.ak.Ek)):(rt?(t.bind(new r.uk(h.pf.lf,o.Ul,r.ak.Ek)),t.bind(new r.uk(h.pf.R,u.VG,r.ak.Ek))):(t.bind(new r.uk(h.pf.lf,o.Ll,r.ak.Ek)),t.bind(new r.uk(h.pf.R,u.BG,r.ak.Ek))),t.bind(new r.uk(h.pf.uf,a.$G,r.ak.Ek)),t.bind(new r.uk(h.pf.u,f.hx,r.ak.Ek)),t.bind(new r.uk(s.Framework.ht.m,e.Pk,r.ak.Ek)),t.bind(new r.uk(h.pf.hf,c.Rl,r.ak.mk)),t.bind(new r.uk(h.pf.df,l.NE,r.ak.mk)),t.bind(new r.uk(h.pf.Ef,l.Rl,r.ak.mk)),X?t.bind(new r.uk(h.pf.af,it.gx,r.ak.Ek)):t.bind(new r.uk(h.pf.af,nt.iB,r.ak.Ek))),t.bind(new r.uk(v.nl.il,W.S$,r.ak.mk)),t.bind(new r.uk(v.nl.Sc,V.R$,r.ak.mk)),t.bind(new r.uk(h.pf.ff,U.ax,r.ak.Ek)),t.bind(new r.uk(v.nl.$c,H.I$,r.ak.Ek)),t.bind(new r.uk(v.nl.Gc,d.ia,r.ak.Ek)),t.bind(new r.uk(v.nl.Hc,E._$,r.ak.mk)),t.bind(new r.uk(v.nl.xc,p.A$,r.ak.mk)),t.bind(new r.uk(v.nl.kc,g.Cache,r.ak.mk)),t.bind(new r.uk(v.nl.Dc,w.Eq,r.ak.mk)),Y&&t.bind(new r.uk(v.nl.Mc,tt.N$,r.ak.mk)),t.bind(new r.uk(v.nl.Uc,b.C$,r.ak.mk)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new r.uk(s.Framework.ht.T,HiveOriginalXMLHttpRequest)):t.bind(new r.uk(s.Framework.ht.T,XMLHttpRequest)),t.bind(new r.uk(v.nl.Kc,P.k$,r.ak.Ek)),t.bind(new r.uk(v.nl.Qc,y.D$,r.ak.mk)),t.bind(new r.uk(s.Framework.ht.v,N.M$,r.ak.Ek)),t.bind(new r.uk(v.nl.O,C.j$,r.ak.Ek)),t.bind(new r.uk(v.nl.Pc,L.P$,r.ak.mk)),t.bind(new r.uk(v.nl.jc,T.H$,r.ak.mk)),t.bind(new r.uk(v.nl.Rc,m.zu,r.ak.mk)),t.bind(new r.uk(v.nl.Ic,O.BW,r.ak.mk)),t.bind(new r.uk(v.nl._c,q.L$,r.ak.mk)),t.bind(new r.uk(v.nl.Ac,G.U$,r.ak.mk)),t.bind(new r.uk(v.nl.Nc,x.F$,r.ak.mk)),t.bind(new r.uk(v.nl.Cc,x.G$,r.ak.mk)),t.bind(new r.uk(v.nl.Zc,F.qu,r.ak.mk)),t.bind(new r.uk(v.nl.Fc,S.x$,r.ak.mk)),t.bind(new r.uk(v.nl.Lc,R.B$,r.ak.mk)),t.bind(new r.uk(v.nl.Wc,I.V$,r.ak.mk)),t.bind(new r.uk(v.nl.qc,M.q$,r.ak.mk)),t.bind(new r.uk(v.nl.Bc,_.tj,r.ak.mk)),t.bind(new r.uk(v.nl.Vc,j.Q$,r.ak.mk)),t.bind(new r.uk(s.Framework.ht.p,A.$v,r.ak.mk)),t.bind(new r.uk(v.nl.Yc,k.$u,r.ak.mk)),t.bind(new r.uk(v.nl.tl,Q.W$,r.ak.mk)),K&&(t.bind(new r.uk(v.nl.Jc,z.Y$,r.ak.mk)),t.bind(new r.uk(v.nl.Xc,J.K$,r.ak.mk))),$&&t.bind(new r.uk(v.nl.$a,Z.pQ,r.ak.mk)),t.bind(new r.uk(v.nl.zc,D.$$,r.ak.mk))},et);function et(t){this.O$=!1,t&&(this.O$=t)}i.w$=st},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(3),r=n(32),o=n(0),s=n(19),e=n(16),u=n(5),a=n(18),f=n(4),c=n(131),l=n(48),v=n(8),d=n(47),E=n(7),p=n(1),w=n(2),g=E.ut.Ka,b=E.ut.$a,y=E.ut.Xa,T=(m.prototype.init=function(t,i,n,r){try{y?this.X$(!1):n?this.X$(!1):this.X$(!0),this.PD.setReportingGuid(this.yd.identity.Ml()),this.PD.J$(n),this.fg.init(u.ea.Cache.Jo,u.ea.Cache.zo);var s=this.T$.GD(t,i,r);this.PD.setContextId(this.T$.$.getContextId());var e=new c.z$(s);this.yd.oH=e,this.yd.pl.oH=e,this.Z$.start(this.T$,this.Tq),(g||o.Framework.U()&&l.TD.gD)&&this.iX.tX(this.Tq);var h=[this.nX,this.Tq,this.HD,this.Z$,this.yd.pl,this.yd.wl,this.IQ];(g||o.Framework.U()&&l.TD.gD)&&h.push(this.iX),(b||o.Framework.U()&&l.TD.bD)&&h.push(this.rX),this.yv.start(this.swarmId,h),this.yd.pl.DG(this.HD),this.yd.pl.zF(this.PD),this.PD.sX(t)}catch(t){throw p.ErrorMonitor.lt().logError("Error initializing swarm object",this.loggerId,w.le.de,t),new Error(t)}},m.prototype.X$=function(t){t&&"undefined"!=typeof navigator&&navigator.hardwareConcurrency?(this.PD.eX(navigator.hardwareConcurrency),this.PD.hX(navigator.hardwareConcurrency)):(this.PD.eX(1),this.PD.hX(1)),this.logger.debug(this.loggerId+"My score "+this.PD.vQ())},m.prototype.oX=function(t){return r.Av.tO(t).toString(r.Av.Dm.Mm)},m.prototype.request=function(t){this.uX(),this.MD.request(t)},m.prototype.aX=function(){this.state!==a.ul.STOP?(this.Tq.stop(),this.HD.stop(),this.LD.fX(),this.LD.cX(),this.Z$.lX(),this.iX&&this.iX.vX(),this.yd.gl(a.ul.IDLE),this.fg.vq(),this.UD.dX(),this.MD.EX(),this.sU.pX(),o.Framework.clearTimeout(this.requestTimeout)):this.logger.debug("Ignoring changing state from Stop to Idle")},m.prototype.gl=function(t,i){try{if(this.state!=t){switch(this.logger.info("Switching state "+a.ul[this.state]+" -> "+a.ul[t]),t){case a.ul.STOP:this.aX(),this.yv.stop(i);break;case a.ul.IDLE:this.aX();break;case a.ul.al:this.Tq.start(),this.HD.start(this.T$.$),this.LD.wX(),this.Z$.gX(),this.iX&&this.iX.bX(),this.yd.gl(a.ul.al),this.sU.yX()}this.state=t}}catch(t){p.ErrorMonitor.lt().logError("Error changing peer status",this.loggerId,w.le.Ee,t)}},m.prototype.uX=function(){var t=this;try{o.Framework.clearTimeout(this.requestTimeout),this.gl(a.ul.al),this.requestTimeout=o.Framework.setTimeout(function(){t.gl(a.ul.IDLE)},u.ea.ia.Mu)}catch(t){p.ErrorMonitor.lt().logError("Error requesting timeout",this.loggerId,w.le.ee,t)}},m);function m(t){this.state=a.ul.al,this.requestTimeout=-1;try{this.logger=o.Framework.resolve(o.Framework.ht.m).log(t.ticket.sessionId),this.loggerId="[SWARM] ",this.yv=o.Framework.resolve(o.Framework.ht.v),this.sessionId=t.ticket.sessionId,this.yd=t,this.MD=o.Framework.resolve(e.nl.Hc),this.fg=o.Framework.resolve(e.nl.kc),this.Tq=o.Framework.resolve(e.nl.Rc),this.TX=o.Framework.resolve(e.nl.Uc),this.DD=o.Framework.resolve(e.nl.jc),this.HD=o.Framework.resolve(e.nl.Ic),this.uploadScore=o.Framework.resolve(e.nl.Wc),this.mX=o.Framework.resolve(e.nl.Lc),this.Z$=o.Framework.resolve(e.nl.Qc),this.jD=o.Framework.resolve(e.nl.Fc),this.T$=o.Framework.resolve(e.nl.xc),this.GL=o.Framework.resolve(e.nl.Yc),this.PD=o.Framework.resolve(e.nl.zc),this.eU=o.Framework.resolve(e.nl.Bc),this.LD=o.Framework.resolve(e.nl.Vc),this.UD=o.Framework.resolve(e.nl.Pc),this.IQ=o.Framework.resolve(e.nl.Zc),this.sU=o.Framework.resolve(e.nl.Sc),this.OX=o.Framework.resolve(e.nl.tl),this.nX=o.Framework.resolve(e.nl.il),(g||o.Framework.U()&&l.TD.gD)&&(this.SX=o.Framework.resolve(e.nl.Xc),this.iX=o.Framework.resolve(e.nl.Jc)),(b||o.Framework.U()&&l.TD.bD)&&(this.rX=o.Framework.resolve(e.nl.$a)),this.swarmId=this.oX(t.ticket.OE()),this.sU.init(this),this.TX.init(this),this.UD.init(this),this.IQ.init(this),this.HD.init(this),this.mX.init(this),this.Z$.init(this),this.jD.init(this),this.T$.init(this),this.MD.init(this),this.Tq.init(this),this.eU.init(this),this.LD.init(this),this.GL.init(this),this.OX.init(this),this.nX.init(this),(b||o.Framework.U()&&l.TD.bD)&&this.rX.init(this),(g||o.Framework.U()&&l.TD.gD)&&this.iX.init(this)}catch(t){throw p.ErrorMonitor.lt().logError("Error constructing swarm object",this.loggerId,w.le.ve,t),new Error(t)}}i.RX=T;var O=(S.prototype.start=function(t,i,n){this.logger=o.Framework.resolve(o.Framework.ht.m).log(t.ticket.sessionId);var r=t.ticket;this.renderStats.init(this,t);var s=r.pluginId;if(this.IX.has(s))this.logger.warn("SESSION ALREADY ACTIVE "+s);else{d.hD.Zd(t.Sl.client,r.Xk(),t.identity.Ml());var e=new T(t);e.init(r,i,this._X,n),this.SE.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();i&&e.PD.Sx(i)}).done(),t.pl.kG(this.SE),this.logger.info("PEER CONTEXT STARTED"),this.IX.set(s,e),this.AX.set(e.swarmId,s)}return 1!=this.IX.length&&!this.NX||o.Framework.U()||(this.CX.init(),this.NX=!1),h.resolve(r.SourceURL)},S.prototype.p$=function(){this.NX=!0},S.prototype.vv=function(t){if(this.AX.has(t)){var i=this.AX.get(t);return this.IX.get(i)}return null},S.prototype.y$=function(t){return this.IX.get(t)},S.prototype.kX=function(t){return this.IX.has(t)?this.IX.get(t).MD:null},S.prototype.request=function(t,i){this.y$(i).request(t)},S.prototype.gl=function(t,i){var n=this.y$(t);n&&(n.gl(i,n.swarmId),i===a.ul.STOP&&this.IX.delete(t))},S.prototype.abort=function(t,i){var n=this.kX(i);n&&n.abort(t)},S.prototype.b$=function(t){this._X=t},S.prototype.DX=function(t,i){this.SE.wx(t)},S);function S(){this.Kv=new s.Counter,this.IX=new f,this.AX=new f,this.MX=!1,this.NX=!1,this.CX=o.Framework.resolve(e.nl.Kc),this.renderStats=o.Framework.resolve(e.nl.$c),this.SE=o.Framework.resolve(v.pf.af),this._X=!1}i.ia=O},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.oG=function(){var t=new hive.snapshots.StreamInfo;return t.streamType=this.xD.isLive()?StreamType.LIVE:StreamType.VOD,t.streamProtocol=this.xD.getStreamProtocol(),t.url=this.xD.FH(),t},s);function s(t){this.xD=t}i.z$=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(3),a=n(26),f=n(6),e=n(5),h=n(0),c=n(9),o=n(16),u=n(19),l=n(1),v=n(2),d=(E.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.ht.m).log(t.sessionId),this.DD=t.DD,this.fg=t.fg,this.HD=t.HD,this.pl=t.yd.pl,this.sessionId=t.yd.ticket.sessionId,this.TX=t.TX,this.jD=t.jD,this.jX=t.T$,this.PD=t.PD,this.UD=t.UD,this.sU=t.sU,this.PX=t.LD,this.pl.WF(this.HX)},E.prototype.request=function(t){try{var i=t.url;this.logger.info("HIVE REQ "+i),t.Np=h.Framework.time();var n=this.jX.LX(t),r=n.YH(t.url);this.sU.UX(r),this.bM(t,r,n,a.fp.cp)}catch(t){l.ErrorMonitor.lt().logError("Error on player request",this.loggerId,v.he.oe,t)}},E.prototype.bM=function(n,t,i,r){var s=this;if(t.Gp()){if(t.Dp()!=c.wf.bf)return this.FX(n,t,i,r);var e=i.lL(t,r);if(e.YL)return this.logger.debug("DO NOT CONTINUE WITH THE REQUEST "+t.jp()+". ALREADY REQUESTED  "+e.xL+" PENDING REQUEST "+e.WL),null;if(e.WL&&r==a.fp.cp){var h=this.GX(n,t,i,r);return 0<h.length?(h.forEach(function(t){var i=s.xX.get(t);s.xX.set(n.id,i),s.xX.delete(t)}),null):(this.logger.info("PREFETCH UPGRADE FAILED. THIS SHOULD NOT HAPPEN. CHECK FOR MULTIPLE PLAYER REQUESTS FOR THE SAME FRAGMENT"),this.FX(n,t,i,r))}return this.FX(n,t,i,r)}var o=f.La.Ha.next(),u=new a.tw(n,o,r,t,i);return this.xX.set(n.id,u),u.type=a.fp.lp,this.BX(u),u},E.prototype.FX=function(t,i,n,r){var s=this,e=f.La.Ha.next(),h=new a.tw(t,e,r,i,n);if(this.xX.set(t.id,h),i.Dp()==c.wf.bf&&(n.$L(h),r!==a.fp.vp&&r!==a.fp.pp)){var o=i.bitrate,u=this.PD.VX();0!=o&&(this.PD.qX(o),this.PX.nQ(this.PD.VM()||this.PD.AM()),o!=u&&(this.QX=!0,this.WX=0),this.QX&&this.WX++,this.WX==this.YX&&(this.HD.DW(),this.QX=!1,this.WX=0))}return this.KX(i.jp()).then(function(t){s.sU.$X(h,t),s.XX(h,t),n.XL(h.jp(),h.Pp()),n.tU(i.bitrate)}).catch(function(){s.JX(i,h),h.Dp()==c.wf.bf&&(n.zL(h),h.type==a.fp.cp&&s.HX.add(0))}),h},E.prototype.GX=function(t,i,n,r){return n.KL(t,i,r)},E.prototype.KX=function(t){return this.fg.get(t)},E.prototype.JX=function(t,i){this.DD.contains(t.jp())?(this.logger.debug("OBJ IDX CONTAINS "+i.jp()),i.kp()==a.fp.vp&&(i.type=a.fp.pp),this.wp(i)):i.kp()!=a.fp.pp?this.BX(i):(l.ErrorMonitor.lt().logError("P2P PREFETCH FAILED BECAUSE OBJECT INDEX DOES NOT CONTAIN REQUEST ENTITY",this.loggerId,{pA:i.jp()}),i.Zp.XL(i.jp(),i.Pp()))},E.prototype.EX=function(){var i=this;this.xX.forEach(function(t){return i.abort(t.zp)})},E.prototype.abort=function(t){if(this.xX.has(t.id)){var i=this.xX.get(t.id);try{var n=i.Pp();this.logger.debug("REQUEST "+n+" ABORTED "),this.jD.ah(n)?this.jD.zX(n):this.TX.ah(n)&&this.TX.zX(n),this.xX.delete(t.id)}catch(t){l.ErrorMonitor.lt().logError("Error occurred while aborting the request",this.loggerId,v.he.ue,t)}}},E.prototype.wp=function(t){t.type==a.fp.cp&&(t.type=a.fp.Ep),t.type==a.fp.pp&&(t.Kp=!0),this.jD.request(t)},E.prototype.ZX=function(t){if(0!=t.Jp&&(t.Vp.yp=t.Jp,this.logger.info("ALREADY DOWNLOADED "+t.Vp.yp+" BYTES"),t.Vp.Tp=t.Jp),!e.ea.N.uu&&t.Jp&&(t.Vp.yp=0),this.sU.tJ(t),t.type!=a.fp.pp)t.type=a.fp.dp,this.BX(t);else if(t.Dp()==c.wf.bf){t.Zp.JL(t.jp()),t.Zp.XL(t.jp(),t.Pp());var i=t.Mp;i.bitrate&&t.Zp.tU(i.bitrate)}},E.prototype.iJ=function(t){var i=this;this.logger.info("SUCCESS FROM P2P FOR "+t.Lp()+" [REQ "+t.Hp+"] ["+a.fp[t.type]+"] AFTER "+t.qp()+" [bw:"+t.Qp().pa()+"]"),this.nJ(t),this.rJ(t,this.jL(t.type)),this.UD.sJ(t);var n=this.TX.eJ().va();this.sU.hJ(t,n),this.oJ(t).then(function(){t.Zp.fL(t),i.uJ()}).finally(function(){i.jL(t.type)&&i.aJ(t),i.xX.delete(t.zp.id)})},E.prototype.fJ=function(t){if(t.type!=a.fp.pp)t.type=a.fp.cp,this.BX(t);else if(t.Dp()==c.wf.bf){t.Zp.JL(t.jp()),t.Zp.XL(t.jp(),t.Pp());var i=t.Mp;i.bitrate&&t.Zp.tU(i.bitrate)}},E.prototype.BX=function(t){this.sU.cJ(t),this.TX.request(t)},E.prototype.lJ=function(t){this.uJ();var i=this.TX.eJ().va();this.sU.vJ(t,i),t.Dp()==c.wf.bf&&(t.Zp.JL(t.jp()),t.Zp.XL(t.jp(),t.Pp())),this.dJ(t)},E.prototype.EJ=function(t){var i=this;this.nJ(t),this.rJ(t,this.jL(t.type)),t.type==a.fp.dp&&this.logger.debug("CDN COMPENSATION TIME "+(t.Vp.Ap-t.zp.Np)+" / "+(t.Vp.Ap-t.Vp.Rp)+" P2P TIME "+(t.Vp._p-t.Vp.Ip)),-1==[c.wf.yf,c.wf.Tf].indexOf(t.Dp())&&this.UD.sJ(t);var n=this.TX.eJ().va();this.sU.pJ(t,n),this.oJ(t).then(function(){t.Dp()==c.wf.yf&&t.Zp.nL(t),-1==[c.wf.yf,c.wf.Tf].indexOf(t.Dp())&&t.Zp.fL(t),i.uJ()}).catch(function(t){i.logger.error(t)}).finally(function(){i.jL(t.type)&&i.aJ(t),i.xX.delete(t.zp.id)})},E.prototype.nJ=function(t){t.type==a.fp.pp&&(t.Vp.p2pAgenTrafficSuccessQt=t.Vp.yp),t.type==a.fp.vp&&(t.Vp.Sp=t.Vp.Op,t.Yp&&(t.Vp.srcOtherRespQt=t.Vp.Op)),t.Vp.bp=t.Vp.Op+t.Vp.yp,t.zp.total=t.Vp.bp},E.prototype.rJ=function(t,i){if(this.wJ(t),t.zp.total=t.size,i){var n=f.La.createEvent(ProgressEvent,"progress",{lengthComputable:!0,total:t.Vp.bp,loaded:t.Vp.bp,currentTarget:t.zp});t.zp.dispatchEvent(n),t.Mp.dA()||(t.zp.response=t.sL,t.zp.responseText=t.sL)}},E.prototype.aJ=function(t){var i=t.zp,n=h.Framework.U()?i.total:t.Xp?t.Xp.byteLength:0;this.logger.info("RESPOND TO THE PLAYER "+t.jp()+" SIZE "+n),i.status=200,i.statusText="OK",i.readyState=4,"string"==typeof i.response&&"arraybuffer"===i.responseType&&(i.response=f.La.Ma(i.response)),"text"!=i.responseType&&""!=i.responseType&&delete i.responseText,t.Mp.dA()&&(i.response=h.Framework.U()?null:f.La.ya(t.Xp));var r=f.La.createEvent(Event,"readystatechange",{currentTarget:i}),s=f.La.createEvent(ProgressEvent,"load",{bubbles:!1,cancelable:!1,lengthComputable:!1,total:n,currentTarget:i,loaded:n}),e=f.La.createEvent(ProgressEvent,"loadend",{bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:n,total:0,currentTarget:i});i.dispatchEvent(r),i.dispatchEvent(s),i.dispatchEvent(e)},E.prototype.dJ=function(t){this.xX.delete(t.zp.id);var i=t.zp,n={bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:i.total,total:0,currentTarget:i};t.xhr.status&&0<t.xhr.status?(i.status=t.xhr.status,i.$p=t.$p):i.status=404,i.readyState=4,i.dispatchEvent(f.La.createEvent(Event,"readystatechange",n)),i.dispatchEvent(f.La.createEvent(ProgressEvent,"load",n)),i.dispatchEvent(f.La.createEvent(ProgressEvent,"loadend",n))},E.prototype.oJ=function(t){var i=this;return t.Mp.Gp()?this.fg.put(t).then(function(){return i.HD.gJ(t.Mp,t.Vp.bp,t.lB)}).catch(function(t){s.resolve(!0)}):s.resolve(!0)},E.prototype.XX=function(t,i){var n=this;t.Xp=i.data,t.$p=i.headers,t.uq=i.uq,t.Vp=i.Vp,t.size=i.length;var r=t.Zp.VH().wB(i.length);this.logger.info("SCHEDULE DELIVERY OF "+t.jp()+" IN "+r+" SIZE "+(h.Framework.U()?i.length:t.Xp.byteLength)+" BYTES"),h.Framework.setTimeout(function(){n.bJ(t)},r)},E.prototype.bJ=function(t){this.logger.debug("DELIVERY OF "+t.jp()),this.rJ(t,!0),this.xX.delete(t.zp.id);var i=t.zp.Np-t.Vp.Ap;this.logger.info("FRAGMENT PREFETCHED "+i+" MSECS BEFORE PLAYER REQUEST"),0<i&&t.Dp()==c.wf.bf&&this.HX.add(i);var n=0;n=0<t.Vp.Ip?t.zp.Np-t.Vp.Ip:t.zp.Np-t.Vp._p,this.logger.info("FRAGMENT REQUESTED "+n+" MSECS BEFORE PLAYER REQUEST"),this.aJ(t)},E.prototype.jL=function(t){return t!=a.fp.pp&&t!=a.fp.vp},E.prototype.wJ=function(t){if(t.type!==a.fp.dp)t.$p=t.zp.$p=t.$p;else{var i="\nContent-Range: bytes=0-"+(t.size-1)+"/"+t.size+"\n";i+="Content-Length: "+t.size+"\n",t.$p=t.zp.$p=i}null==t.$p?t.$p="access-control-allow-origin: *":-1==t.$p.toLowerCase().indexOf("access-control-allow-origin")&&(t.$p=t.$p.trim()+"\naccess-control-allow-origin: *\n")},E.prototype.uJ=function(){h.Framework.U()||this.renderStats.render()},E);function E(){this.xX=new r,this.QX=!1,this.WX=0,this.loggerId="[HiveCache] ",this.YX=5,this.renderStats=h.Framework.resolve(o.nl.$c),this.HX=new u.Vl}i._$=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(57),h=n(88),r=n(0),s=(o.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.ht.m).log(t.sessionId),this.yq=t,this.HD=t.HD},o.prototype.GD=function(t,i,n){var r=null,s=t.Qk();return h.HLS.bH(s)?this.$=r=new h.CL(t,i,this.yq):e.DASH.bH(s)?this.$=r=new e.CL(t,this.yq,n):this.logger.warn("COULD NOT FIND A CONTEXT FOR "+s),null!=r&&this.yJ(this.$),r},o.prototype.yJ=function(i){var n=this;null!=this.HD?this.HD.stop().then(function(t){n.HD.start(i)}):this.HD.start(i)},o.prototype.LX=function(t){if(null==this.$)this.logger.warn("FIRST REQUEST, COULD NOT FIND RIGHT CONTEXT "+t.url);else if(!this.$.tL(t))return this.logger.warn("REQUEST DOES NOT BELONG TO THE CURRENT CONTEXT "+t.url),null;return this.$},o);function o(){this.HD=null,this.yv=r.Framework.resolve(r.Framework.ht.v)}i.A$=s},function(t,i,n){"use strict";t.exports=u;n(11);var r=n(12),s=n(41),e=n(13),h=n(40),o=n(72);function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);this.Kh=i||Object.Wh,this.Mf=n||Object.compare,this.Xh=r||Function.Yh,this.root=null,this.length=0,this.hiveAddEach(t)}function a(t){this.value=t,this.left=null,this.right=null,this.length=1}function f(t,i,n){if(this.set=t,this.nj=null,this.end=n,i){var r=this.set.TJ(i);r&&(this.set.mJ(r.value),this.nj=r.OJ())}}u.SJ=u,Object.hiveAddEach(u.prototype,r.prototype),Object.hiveAddEach(u.prototype,s.prototype),Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),u.prototype.hU=!0,u.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.Mf,this.Xh)},u.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.mJ(t),this.Kh(t,this.root.value))},u.prototype.get=function(t,i){if(i)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.mJ(t),this.Kh(t,this.root.value))?this.root.value:this.Xh(t)},u.prototype.hiveAdd=function(t){var i=new this.Node(t);if(!this.root)return this.$C&&this.tk([t],[],0),this.root=i,this.length++,this.$C&&this.JC([t],[],0),!0;if(this.mJ(t),this.Kh(t,this.root.value))return!1;var n=this.Mf(t,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+t+" and "+this.root.value);return this.$C&&this.tk([t],[],this.root.index),n<0?(i.right=this.root,i.left=this.root.left,this.root.left=null):(i.left=this.root,i.right=this.root.right,this.root.right=null),this.root.RJ(),i.RJ(),this.root=i,this.length++,this.$C&&this.JC([t],[],this.root.index),!0},u.prototype.delete=function(t,i){if(i)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.mJ(t),this.Kh(t,this.root.value))){var n=this.root.index;if(this.$C&&this.tk([],[t],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.mJ(t),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.RJ(),this.$C&&this.JC([],[t],n),!0}return!1},u.prototype.indexOf=function(t,i){if(i)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.mJ(t),this.Kh(t,this.root.value))?this.root.index:-1},u.prototype.find=function(t,i,n){if(i)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.mJ(t),this.Kh(t,this.root.value)))return this.root},u.prototype.IJ=function(t){if(this.root){for(t=t||this.root;t.right;)t=t.right;return t}},u.prototype._J=function(t){if(this.root){for(t=t||this.root;t.left;)t=t.left;return t}},u.prototype.AJ=function(t){if(this.root)return this.mJ(t),0<this.Mf(this.root.value,t)?this.root.OJ():this.root},u.prototype.NJ=function(t){if(this.root)return this.mJ(t),0<=this.Mf(this.root.value,t)?this.root.OJ():this.root},u.prototype.TJ=function(t){if(this.root)return this.mJ(t),0<=this.Mf(this.root.value,t)?this.root:this.root.CJ()},u.prototype.kJ=function(t){if(this.root)return this.mJ(t),this.Mf(this.root.value,t)<=0?this.root.CJ():this.root},u.prototype.pop=function(){if(this.root){var t=this.IJ();return this.delete(t.value),t.value}},u.prototype.shift=function(){if(this.root){var t=this._J();return this.delete(t.value),t.value}},u.prototype.push=function(){this.hiveAddEach(arguments)},u.prototype.unshift=function(){this.hiveAddEach(arguments)},u.prototype.slice=function(t,i){t=t||0,i=i||this.length,t<0&&(t+=this.length),i<0&&(i+=this.length);var n=[];if(this.root)for(this.DJ(t);this.root.index<i&&(n.push(this.root.value),this.root.right);)this.mJ(this.root.CJ().value);return n},u.prototype.splice=function(t,i){return this.cj(t,i,Array.prototype.slice.call(arguments,2))},u.prototype.cj=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=[];if(this.root){this.DJ(t);for(var s=0;s<i;s++){r.push(this.root.value);var e=this.root.CJ();if(this.delete(this.root.value),!e)break;this.mJ(e.value)}}return this.hiveAddEach(n),r},u.prototype.mJ=function(t){var i,n,r,s,e,h;if(this.root){for(i=n=r=new this.Node,h=new this.Node,e=this.root;;){var o=this.Mf(t,e.value);if(o<0){if(!e.left)break;if(this.Mf(t,e.left.value)<0&&(s=e.left,e.left=s.right,e.RJ(),s.right=e,s.RJ(),!(e=s).left))break;(s=new a).right=e,s.left=h.left,h.left=s,r.left=e,r.RJ(),e=(r=e).left}else{if(!(0<o))break;if(!e.right)break;if(0<this.Mf(t,e.right.value)&&(s=e.right,e.right=s.left,e.RJ(),s.left=e,s.RJ(),!(e=s).right))break;(s=new a).left=e,s.right=h.right,h.right=s,n.right=e,n.RJ(),e=(n=e).right}}for(n.right=e.left,n.RJ(),r.left=e.right,r.RJ(),e.left=i.right,e.right=i.left;h.left;)h.left.right.RJ(),h.left=h.left.left;for(;h.right;)h.right.left.RJ(),h.right=h.right.right;e.RJ(),this.root=e}},u.prototype.DJ=function(t){if(this.root){for(var i=this.root,n=this.root.index;n!==t;)if(t<n&&i.left)n-=1+((i=i.left).right?i.right.length:0);else{if(!(n<t&&i.right))break;n+=1+((i=i.right).left?i.left.length:0)}return this.mJ(i.value),this.root.index===t}return!1},u.prototype.reduce=function(t,i,n){return this.root&&(i=this.root.reduce(t,i,0,n,this)),i},u.prototype.reduceRight=function(t,i,n){return this.root&&(i=this.root.reduceRight(t,i,this.length-1,n,this)),i},u.prototype.min=function(t){var i=this._J(t);if(i)return i.value},u.prototype.max=function(t){var i=this.IJ(t);if(i)return i.value},u.prototype.xf=function(){return this.min()},u.prototype.clear=function(){var t;this.$C&&(t=this.toArray(),this.tk([],t,0)),this.root=null,this.length=0,this.$C&&this.JC([],t,0)},u.prototype.Bf=function(t,i){return new this.Iterator(this,t,i)},u.prototype.Iterator=f,u.prototype.summary=function(){return this.root?this.root.summary():"()"},u.prototype.log=function(t,i,n,r){t=t||o.UF,i=i||this.Zh,n||(n=console.log,r=console),n=n.bind(r),this.root&&this.root.log(t,i,n,n)},u.prototype.Zh=function(t,i,n){i(" "+t.value)},u.MJ=o,(u.prototype.Node=a).prototype.reduce=function(t,i,n,r,s,e){if(e=e||0,this.left){var h=this.left.length;i=this.left.reduce(t,i,n,r,s,e+1),n+=h}return i=t.call(r,i,this.value,n,s,this,e),n+=1,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1)),i},a.prototype.reduceRight=function(t,i,n,r,s,e){return e=e||0,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1),n-=this.right.length),i=t.call(r,i,this.value,this.value,s,this,e),n-=1,this.left&&(i=this.left.reduce(t,i,n,r,s,e+1)),i},a.prototype.RJ=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},a.prototype.jJ=function(){var t=1;if(t+=this.left?this.left.jJ():0,t+=this.right?this.right.jJ():0,this.length!==t)throw new Error("Integrity check failed: "+this.summary());return t},a.prototype.CJ=function(){var t=this;if(t.right){for(t=t.right;t.left;)t=t.left;return t}},a.prototype.OJ=function(){var t=this;if(t.left){for(t=t.left;t.right;)t=t.right;return t}},a.prototype.summary=function(){var t=this.value||"-";return t+=" <"+this.length,this.left||this.right?"("+t+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+t+")"},a.prototype.log=function(i,t,n,r){var s,e,h,o,u=this;s=this.left&&this.right?i.rk:this.left?i.DF:this.right?i.MF:i.kF,this.left&&this.left.log(i,t,function(t){e?r(i.LF+" "+t):(e=!0,r(i.jF+i.kF+t))},function(t){r("  "+t)}),t(this,function(t){h?n((u.right?i.LF:" ")+t):(h=!0,n(s+t))},function(t){r((u.left?i.LF:" ")+t)}),this.right&&this.right.log(i,t,function(t){o?n("  "+t):(o=!0,n(i.PF+i.kF+t))},function(t){n(i.LF+" "+t)})},f.prototype.lj=null,Object.defineProperty(f.prototype,"vj",{get:function(){return this.lj||(this.lj={done:!1,value:null})}}),f.prototype.next=function(){var t;return(t=this.nj?this.set.kJ(this.nj.value):this.set._J())?void 0!==this.end&&0<=this.set.Mf(t.value,this.end)?(this.vj.done=!0,this.vj.value=void 0):(this.nj=t,this.vj.value=t.value):(this.vj.done=!0,this.vj.value=void 0),this.vj}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.xL=!1,this.WL=!1,this.YL=!1}i.UL=r},function(t,i,n){"use strict";t.exports=h;n(11);var r=n(12),s=n(13),e=n(40);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);Array.isArray(t)?t=(this.bS=t).splice(0,t.length):this.bS=[],this.Kh=i||Object.Wh,this.Mf=n||Object.compare,this.Xh=r||Function.Yh,this.length=0,this.hiveAddEach(t)}function o(t,i,n){for(var r=0,s=t.length-1;r<=s;){var e=r+s>>1,h=n(i,t[e]);if(0<h)r=1+e;else{if(!(h<0))return e;s=e-1}}return-(r+1)}function u(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;0<s&&r(i,t[s-1]);)s--;return r(i,t[s])?s:-1}function a(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;s<t.length-1&&r(i,t[s+1]);)s++;return r(i,t[s])?s:-1}h.PJ=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.hU=!0,h.prototype.zh=function(t){return new this.constructor(t,this.Kh,this.Mf,this.Xh)},h.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");var n=o(this.bS,t,this.Mf);return 0<=n&&this.Kh(this.bS[n],t)},h.prototype.get=function(t,i){if(i)throw new Error("SortedArray#get does not support second argument: equals");var n=u(this.bS,t,this.Mf,this.Kh);return-1!==n?this.bS[n]:this.Xh(t)},h.prototype.hiveAdd=function(t){var i=function(t,i,n){var r=o(t,i,n);if(r<0)return-r-1;for(var s=t.length-1;r<s&&0===n(i,t[r+1]);)r++;return r}(this.bS,t,this.Mf);return this.$C&&this.tk([t],[],i),this.bS.splice(i,0,t),this.length++,this.$C&&this.JC([t],[],i),!0},h.prototype.delete=function(t,i){if(i)throw new Error("SortedArray#delete does not support second argument: equals");var n=u(this.bS,t,this.Mf,this.Kh);return-1!==n&&(this.$C&&this.tk([],[t],n),this.bS.splice(n,1),this.length--,this.$C&&this.JC([],[t],n),!0)},h.prototype.hk=function(t,i){if(i){var n=this.bS.hk(t,i);return this.length-=n,n}var r=u(this.bS,t,this.Mf,this.Kh);if(-1===r)return 0;for(var s=r;this.Kh(t,this.bS[s]);)s++;var e=this.slice(r,s);return this.$C&&this.tk([],e,r),this.bS.splice(r,e.length),this.length-=e.length,this.$C&&this.JC([],e,r),e.length},h.prototype.indexOf=function(t){return u(this.bS,t,this.Mf,this.Kh)},h.prototype.lastIndexOf=function(t){return a(this.bS,t,this.Mf,this.Kh)},h.prototype.find=function(t,i,n){if(i)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return u(this.bS,t,this.Mf,this.Kh)},h.prototype.findLast=function(t,i,n){if(i)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return a(this.bS,t,this.Mf,this.Kh)},h.prototype.push=function(){this.hiveAddEach(arguments)},h.prototype.unshift=function(){this.hiveAddEach(arguments)},h.prototype.pop=function(){var t=this.bS.pop();return this.length=this.bS.length,t},h.prototype.shift=function(){var t=this.bS.shift();return this.length=this.bS.length,t},h.prototype.slice=function(){return this.bS.slice.apply(this.bS,arguments)},h.prototype.splice=function(t,i){return this.cj(t,i,Array.prototype.slice.call(arguments,2))},h.prototype.cj=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=this.slice(t,t+i);return this.$C&&this.tk(n,r,t),this.bS.splice(t,i),this.length-=r.length,this.$C&&this.JC([],r,t),this.hiveAddEach(n),r},h.prototype.reduce=function(r,t){var s=arguments[2];return this.bS.reduce(function(t,i,n){return r.call(s,t,i,n,this)},t,this)},h.prototype.reduceRight=function(){var r=arguments[2];return this.bS.reduceRight(function(t,i,n){return callback.call(r,t,i,n,this)},basis,this)},h.prototype.min=function(){if(this.length)return this.bS[0]},h.prototype.max=function(){if(this.length)return this.bS[this.length-1]},h.prototype.xf=function(){return this.bS.xf()},h.prototype.clear=function(){var t;this.$C&&(t=this.bS.slice(),this.tk([],t,0)),this.length=0,this.bS.clear(),this.$C&&this.JC([],t,0)},h.prototype.Wh=function(t,i){return this.bS.Wh(t,i)},h.prototype.compare=function(t,i){return this.bS.compare(t,i)},h.prototype.Bf=function(t,i){return new this.Iterator(this.bS,t,i)},h.prototype.toJSON=function(){return this.toArray()},h.prototype.Iterator=Array.prototype.Iterator},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(84),o=(e=h.SB,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.IL=o},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(85),o=n(3),u=(e=h.pV,s(a,e),a.prototype.NB=function(t,i){if(DOMParser){var n=(new DOMParser).parseFromString(i,"text/xml").getElementsByTagName("Location"),r="";if(n&&0<n.length&&0<n[0].childNodes.length){var s=n[0].childNodes[0];r=this.RB(s.data)}else r=this.RB(t);this.manifest=this.dV.parse(i,r)}},a.prototype.fL=function(t){return o.resolve(!1)},a);function a(){return null!==e&&e.apply(this,arguments)||this}i._L=u},function(t,i,n){var o=n(140),u=n(86);t.exports.EV=function(){var s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,e=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})([0-9]{2}))?/,i=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,h=[{type:"duration",test:function(t){for(var i=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],n=i.length,r=0;r<n;r++)if(t.nodeName===i[r])return s.test(t.value);return!1},TV:function(t){var i=s.exec(t),n=31536e3*parseFloat(i[2]||0)+2592e3*parseFloat(i[4]||0)+86400*parseFloat(i[6]||0)+3600*parseFloat(i[8]||0)+60*parseFloat(i[10]||0)+parseFloat(i[12]||0);return void 0!==i[1]&&(n=-n),n}},{type:"datetime",test:function(t){return e.test(t.value)},TV:function(t){var i,n=e.exec(t);if(i=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var r=60*parseInt(n[9],10)+parseInt(n[10],10);i+=("+"===n[8]?-1:1)*r*60*1e3}return new Date(i)}},{type:"numeric",test:function(t){return i.test(t.value)},TV:function(t){return parseFloat(t)}}];return{parse:function(i,t){var n,r=new u(h,"",!0),s=new o(function(){var t=[];return t.push(function(){var t,i,n,r;return r=[{name:"profiles",mm:!1},{name:"width",mm:!1},{name:"height",mm:!1},{name:"sar",mm:!1},{name:"frameRate",mm:!1},{name:"audioSamplingRate",mm:!1},{name:"mimeType",mm:!1},{name:"segmentProfiles",mm:!1},{name:"codecs",mm:!1},{name:"maximumSAPPeriod",mm:!1},{name:"startsWithSap",mm:!1},{name:"maxPlayoutRate",mm:!1},{name:"codingDependency",mm:!1},{name:"scanType",mm:!1},{name:"FramePacking",mm:!0},{name:"AudioChannelConfiguration",mm:!0},{name:"ContentProtection",mm:!0}],(t={}).name="AdaptationSet",t.HJ=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,(i={}).name="Representation",i.HJ=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),(n={name:"SubRepresentation",HJ:!1,isArray:!0}).parent=i,n.children=[],n.properties=r,i.children.push(n),t}()),t.push(function(){var t,i,n,r;return r=[{name:"SegmentBase",mm:!0},{name:"SegmentTemplate",mm:!0},{name:"SegmentList",mm:!0}],(t={}).name="Period",t.HJ=!1,t.isArray=!0,t.parent=null,t.children=[],t.properties=r,(i={}).name="AdaptationSet",i.HJ=!1,i.isArray=!0,i.parent=t,i.children=[],i.properties=r,t.children.push(i),(n={name:"Representation",HJ:!1,isArray:!0}).parent=i,n.children=[],n.properties=r,i.children.push(n),t}()),t.push(function(){var t,i,n,r,s;return s=[{name:"BaseURL",mm:!0,LJ:function(t,i){return 0===i.indexOf("http://")?i:t+i}}],(t={}).name="mpd",t.HJ=!0,t.isArray=!0,t.parent=null,t.children=[],t.properties=s,(i={}).name="Period",i.HJ=!1,i.isArray=!0,i.parent=null,i.children=[],i.properties=s,t.children.push(i),(n={}).name="AdaptationSet",n.HJ=!1,n.isArray=!0,n.parent=i,n.children=[],n.properties=s,i.children.push(n),(r={name:"Representation",HJ:!1,isArray:!0}).parent=n,r.children=[],r.properties=s,n.children.push(r),t}()),t}());new Date;try{n=r.eV(i),new Date,n.hasOwnProperty("BaseURL")?(n.BaseURL=n.BaseURL_asArray[0],0!==n.BaseURL.toString().indexOf("http")&&(n.BaseURL=t+n.BaseURL)):n.BaseURL=t,n.hasOwnProperty("Location")&&(n.Location=n.Location_asArray[0]),s.RC(n),new Date}catch(t){return console.log("parsing the manifest failed","parse",i),null}return n}}}},function(t,n,r){t.exports=function(u){var a;for(a=[],i=0,len=u.length;i<len;i+=1)u[i].HJ?a.push("root"):a.push(u[i].name);function f(t,i){var n;if(null!==t&&null!==i)for(n in t)t.hasOwnProperty(n)&&(i.hasOwnProperty(n)||(i[n]=t[n]))}function c(t,i,n){var r,s,e,h,o;if(null!==t&&0!==t.length)for(r=0,s=t.length;r<s;r+=1)e=t[r],i.hasOwnProperty(e.name)&&(n.hasOwnProperty(e.name)?e.mm&&(h=i[e.name],o=n[e.name],"object"==typeof h&&"object"==typeof o?f(h,o):null!=e.LJ?n[e.name]=e.LJ(h,o):n[e.name]=h+o):n[e.name]=i[e.name])}var l=function(t,i){var n,r,s,e,h,o,u,a=t;if(null!==a.children&&0!==a.children.length)for(n=0,r=a.children.length;n<r;n+=1)if(o=a.children[n],i.hasOwnProperty(o.name))if(o.isArray)for(s=0,e=(h=i[o.name+"_asArray"]).length;s<e;s+=1)u=h[s],c(a.properties,i,u),l(o,u);else u=i[o.name],c(a.properties,i,u),l(o,u)},v=function(t){var i,n,r,s,e,h,o;if(null===t)return t;if("object"!=typeof t)return t;for(i=0,n=a.length;i<n;i+=1)"root"===a[i]&&(e=u[i],l(e,h=t));for(s in t)if(t.hasOwnProperty(s)){if(-1!==(r=a.indexOf(s)))if((e=u[r]).isArray)for(i=0,n=(o=t[s+"_asArray"]).length;i<n;i+=1)h=o[i],l(e,h);else h=t[s],l(e,h);v(t[s])}return t};return{RC:v}}},function(t,i,n){
/*! codem-isoboxer v0.2.2 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
if(void 0===r)var r={};r.nV=function(t){return new s(t).parse()},r.La={},r.La.UJ=function(t,i){var n=i||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(t);var r=[],s=0;if("utf-8"===n)for(;s<t.byteLength;){var e=t.getUint8(s++);e<128||(e<224?e=(31&e)<<6:(e<240?e=(15&e)<<12:(e=(7&e)<<18,e|=(63&t.getUint8(s++))<<12),e|=(63&t.getUint8(s++))<<6),e|=63&t.getUint8(s++)),r.push(String.fromCharCode(e))}else for(;s<t.byteLength;)r.push(String.fromCharCode(t.getUint8(s++)));return r.join("")},i.nV=r.nV,i.La=r.La,r.FJ=function(t){this.offset=void 0===t?0:t};var s=function(t){this.GJ=new DataView(t),this.xJ=new r.FJ,this.BJ=[]};s.prototype.fetch=function(t){var i=this.VJ(t,!0);return i.length?i[0]:null},s.prototype.VJ=function(t,i){var n=[];return s.qJ.call(this,t,n,i),n},s.prototype.parse=function(){for(this.xJ.offset=0,this.BJ=[];this.xJ.offset<this.GJ.byteLength;){var t=e.parse(this);if(void 0===t.type)break;this.BJ.push(t)}return this},s.qJ=function(t,i,n){for(var r in this.type&&this.type==t&&i.push(this),this.BJ){if(i.length&&n)return;s.qJ.call(this.BJ[r],t,i,n)}};var e=function(){this.xJ=new r.FJ};e.parse=function(t){var i=new e;return i.QJ=t.xJ.offset,i.WJ=t.WJ?t.WJ:t,i.GJ=t.GJ,i.YJ=t,i.KJ(),t.xJ.offset=i.GJ.byteOffset+i.GJ.byteLength,i},e.prototype.$J=function(t){var i=null;switch(t){case 8:i=this.GJ.getInt8(this.xJ.offset-this.GJ.byteOffset);break;case 16:i=this.GJ.getInt16(this.xJ.offset-this.GJ.byteOffset);break;case 32:i=this.GJ.getInt32(this.xJ.offset-this.GJ.byteOffset);break;case 64:var n=this.GJ.getInt32(this.xJ.offset-this.GJ.byteOffset),r=this.GJ.getInt32(this.xJ.offset-this.GJ.byteOffset+4);i=n*Math.pow(2,32)+r}return this.xJ.offset+=t>>3,i},e.prototype.XJ=function(t){var i=null;switch(t){case 8:i=this.GJ.getUint8(this.xJ.offset-this.GJ.byteOffset);break;case 16:i=this.GJ.getUint16(this.xJ.offset-this.GJ.byteOffset);break;case 24:i=((n=this.GJ.getUint16(this.xJ.offset-this.GJ.byteOffset))<<8)+(r=this.GJ.getUint8(this.xJ.offset-this.GJ.byteOffset+2));break;case 32:i=this.GJ.getUint32(this.xJ.offset-this.GJ.byteOffset);break;case 64:var n=this.GJ.getUint32(this.xJ.offset-this.GJ.byteOffset),r=this.GJ.getUint32(this.xJ.offset-this.GJ.byteOffset+4);i=n*Math.pow(2,32)+r}return this.xJ.offset+=t>>3,i},e.prototype.JJ=function(t){for(var i="",n=0;n<t;n++){var r=this.XJ(8);i+=String.fromCharCode(r)}return i},e.prototype.zJ=function(){for(var t="";;){var i=this.XJ(8);if(0==i)break;t+=String.fromCharCode(i)}return t},e.prototype.ZJ=function(t){return this.XJ(t/2)+this.XJ(t/2)/Math.pow(2,t/2)},e.prototype.KJ=function(){if(this.xJ.offset=this.QJ,this.QJ+8>this.GJ.buffer.byteLength)this.WJ.tz=!0;else{switch(this.size=this.XJ(32),this.type=this.JJ(4),1==this.size&&(this.iz=this.XJ(64)),"uuid"==this.type&&(this.nz=this.JJ(16)),this.size){case 0:this.GJ=new DataView(this.GJ.buffer,this.QJ,this.GJ.byteLength-this.xJ.offset);break;case 1:this.QJ+this.size>this.GJ.buffer.byteLength?(this.tz=!0,this.WJ.tz=!0):this.GJ=new DataView(this.GJ.buffer,this.QJ,this.iz);break;default:this.QJ+this.size>this.GJ.buffer.byteLength?(this.tz=!0,this.WJ.tz=!0):this.GJ=new DataView(this.GJ.buffer,this.QJ,this.size)}!this.tz&&this.rz[this.type]&&this.rz[this.type].call(this)}},e.prototype.sz=function(){this.version=this.XJ(8),this.flags=this.XJ(24)},e.prototype.rz={},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(t){e.prototype.rz[t]=function(){for(this.BJ=[];this.xJ.offset-this.GJ.byteOffset<this.GJ.byteLength;)this.BJ.push(e.parse(this))}}),e.prototype.rz.ez=function(){this.sz(),this.hz=this.XJ(32),this.entries=[];for(var t=1;t<=this.hz;t++){var i={};1==this.version?(i.oz=this.XJ(64),i.uz=this.$J(64)):(i.oz=this.XJ(32),i.uz=this.$J(32)),i.az=this.$J(16),i.fz=this.$J(16),this.entries.push(i)}},e.prototype.rz.cz=function(){this.sz(),this.lz=this.zJ(),this.value=this.zJ(),this.timescale=this.XJ(32),this.vz=this.XJ(32),this.dz=this.XJ(32),this.id=this.XJ(32),this.Ez=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ))},e.prototype.rz.pz=e.prototype.rz.Bw=function(){this.data=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ))},e.prototype.rz.wz=e.prototype.rz.gz=function(){for(this.bz=this.JJ(4),this.yz=this.XJ(32),this.Tz=[];this.xJ.offset-this.GJ.byteOffset<this.GJ.byteLength;)this.Tz.push(this.JJ(4))},e.prototype.rz.mz=function(){this.sz(),this.Oz=this.XJ(32),this.Sz=this.JJ(4),this.wy=[this.XJ(32),this.XJ(32),this.XJ(32)],this.name=this.zJ()},e.prototype.rz.Rz=function(){this.data=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ))},e.prototype.rz.Iz=function(){this.sz(),1==this.version?(this._z=this.XJ(64),this.Az=this.XJ(64),this.timescale=this.XJ(32),this.duration=this.XJ(64)):(this._z=this.XJ(32),this.Az=this.XJ(32),this.timescale=this.XJ(32),this.duration=this.XJ(32));var t=this.XJ(16);this.pad=t>>15,this.language=String.fromCharCode(96+(t>>10&31),96+(t>>5&31),96+(31&t)),this.Oz=this.XJ(16)},e.prototype.rz.Nz=function(){this.sz(),this.Cz=this.XJ(32)},e.prototype.rz.kz=function(){this.sz(),1==this.version?(this._z=this.XJ(64),this.Az=this.XJ(64),this.timescale=this.XJ(32),this.duration=this.XJ(64)):(this._z=this.XJ(32),this.Az=this.XJ(32),this.timescale=this.XJ(32),this.duration=this.XJ(32)),this.rate=this.ZJ(32),this.volume=this.ZJ(16),this.Dz=this.XJ(16),this.Mz=[this.XJ(32),this.XJ(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.ZJ(32));this.Oz=[];for(t=0;t<6;t++)this.Oz.push(this.XJ(32));this.jz=this.XJ(32)},e.prototype.rz.Pz=function(){var t=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ));this.Hz=r.La.UJ(t)},e.prototype.rz.Lz=function(){this.sz(),this.Uz=this.XJ(32),this.timescale=this.XJ(32),0==this.version?(this.Fz=this.XJ(32),this.Gz=this.XJ(32)):(this.Fz=this.XJ(64),this.Gz=this.XJ(64)),this.wy=this.XJ(16),this.xz=this.XJ(16),this.Bz=[];for(var t=0;t<this.xz;t++){var i={},n=this.XJ(32);i.Vz=n>>31&1,i.qz=2147483647&n,i.Qz=this.XJ(32);var r=this.XJ(32);i.Wz=r>>31&1,i.Yz=r>>28&7,i.Kz=268435455&r,this.Bz.push(i)}},e.prototype.rz.$z=function(){this.sz(),this.Xz=this.XJ(32),this.Jz=[];for(var t=0;t<this.Xz;t++){var i={};i.zz=this.XJ(32),i.Zz=[];for(var n=0;n<i.zz;n++){var r={};r.level=this.XJ(8),r.tZ=this.XJ(24),i.Zz.push(r)}this.Jz.push(i)}},e.prototype.rz.iZ=function(){this.sz(),1==this.version?this.nZ=this.XJ(64):this.nZ=this.XJ(32)},e.prototype.rz.tfhd=function(){this.sz(),this.rZ=this.XJ(32),1&this.flags&&(this.sZ=this.XJ(64)),2&this.flags&&(this.eZ=this.XJ(32)),8&this.flags&&(this.default_sample_duration=this.XJ(32)),16&this.flags&&(this.hZ=this.XJ(32)),32&this.flags&&(this.oZ=this.XJ(32))},e.prototype.rz.uZ=function(){this.sz(),1==this.version?(this._z=this.XJ(64),this.Az=this.XJ(64),this.rZ=this.XJ(32),this.Dz=this.XJ(32),this.duration=this.XJ(64)):(this._z=this.XJ(32),this.Az=this.XJ(32),this.rZ=this.XJ(32),this.Dz=this.XJ(32),this.duration=this.XJ(32)),this.Mz=[this.XJ(32),this.XJ(32)],this.aZ=this.XJ(16),this.fZ=this.XJ(16),this.volume=this.ZJ(16),this.cZ=this.XJ(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.ZJ(32));this.width=this.XJ(32),this.height=this.XJ(32)},e.prototype.rz.trun=function(){this.sz(),this.lZ=this.XJ(32),1&this.flags&&(this.vZ=this.$J(32)),4&this.flags&&(this.dZ=this.XJ(32)),this.rV=[];for(var t=0;t<this.lZ;t++){var i={};256&this.flags&&(i.sample_duration=this.XJ(32)),512&this.flags&&(i.EZ=this.XJ(32)),1024&this.flags&&(i.pZ=this.XJ(32)),2048&this.flags&&(0==this.version?i.wZ=this.XJ(32):i.wZ=this.$J(32)),this.rV.push(i)}},e.prototype.rz.gZ=function(){var t=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ));this.bZ=r.La.UJ(t)},e.prototype.rz.yZ=function(){var t=new DataView(this.GJ.buffer,this.xJ.offset,this.GJ.byteLength-(this.xJ.offset-this.QJ));this.config=r.La.UJ(t)},e.prototype.rz.TZ=function(){}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.kB=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(3),r=n(0),h=n(1),o=n(2),u=function(t,i){this.name=t,this.iv=i},s=(a.prototype.init=function(){var i=this;try{this.mZ();var n=e.defer();this.OZ().then(function(){return n.resolve(!0)}).fail(function(t){h.ErrorMonitor.lt().logError("Error initializing key",i.loggerId,o.Fn.xn,t),n.resolve(!1)}),this.SZ=n.promise}catch(t){h.ErrorMonitor.lt().logError("Error initializing AES Manager",this.loggerId,o.Fn.Gn,t)}},a.prototype.EL=function(){return this.SZ?this.SZ:e.resolve(!1)},a.prototype.OZ=function(){var i=this;if(this.RZ)return this.RZ;var n=e.defer();return this.IZ().then(function(t){window.crypto.subtle.importKey("raw",t,i._Z,!1,["decrypt"]).then(function(t){n.resolve(t)},function(t){n.reject("error importing key: "+t.toString())})}).fail(function(t){return n.reject(t)}),this.RZ=n.promise,this.RZ},a.prototype.mZ=function(){for(var t=2,i=this.AZ.length,n=[];t<i;t+=2)n.push(parseInt(this.AZ.substr(t,2),16));this.iv=new Uint8Array(n)},a.prototype.decrypt=function(i){var n=this,r=e.defer(),s=new u(this._Z,this.iv);return this.RZ.then(function(t){window.crypto.subtle.decrypt(s,t,i).then(function(t){r.resolve(t)})}).catch(function(t){h.ErrorMonitor.lt().logError("Error decrypting arraybuffer",n.loggerId,o.Fn.Vn,t),n.failed=!0,n.SZ=e.resolve(!1),r.reject(t)}),r.promise},a.prototype.IZ=function(){var i=this,n=e.defer(),r=new XMLHttpRequest;return r.responseType="arraybuffer",r.open("GET",this.NZ),this.CZ&&r.setRequestHeader("Authorization",this.CZ),r.onload=function(){if(200===r.status){var t=new Uint8Array(r.response);n.resolve(t)}else h.ErrorMonitor.lt().logError("Error downloading key",i.loggerId,o.Fn.qn,r.status),n.reject("error downloading key - status: "+r.status)},r.onerror=function(){h.ErrorMonitor.lt().logError("Error downloading key",i.logger,o.Fn.Qn),n.reject("error downloading key")},r.send(),n.promise},a.prototype.zB=function(){return this.failed},a);function a(t,i,n){this.loggerId="[DASH AES Manager] ",this._Z="AES-CBC",this.failed=!1,this.logger=r.Framework&&r.Framework.resolve(r.Framework.ht.m)?r.Framework.resolve(r.Framework.ht.m).log():console,this.NZ=t,this.AZ=i,this.logger.debug(this.loggerId+"Starting Dash AES Manager"),n&&(this.CZ=n)}i.ZB=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=(e.prototype.init=function(){},e.prototype.EL=function(){return r.resolve(!1)},e.prototype.decrypt=function(t){return r.reject("unsupported")},e.prototype.zB=function(){return!1},e);function e(){}i.tV=s},function(i,n,r){var s;!function(){"use strict";var d={kZ:/[^s]/,DZ:/[^t]/,MZ:/[^T]/,jZ:/[^v]/,number:/[diefg]/,PZ:/[bcdiefguxX]/,json:/[j]/,HZ:/[^j]/,text:/^[^\x25]+/,LZ:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,UZ:/^\.([a-z_][a-z_\d]*)/i,FZ:/^\[(\d+)\]/,sign:/^[+-]/};function E(t){return function(t,i){var n,r,s,e,h,o,u,a,f,c=1,l=t.length,v="";for(r=0;r<l;r++)if("string"==typeof t[r])v+=t[r];else if("object"==typeof t[r]){if((e=t[r]).keys)for(n=i[c],s=0;s<e.keys.length;s++){if(null==n)throw new Error(E('[sprintf] Cannot access property "%s" of undefined value "%s"',e.keys[s],e.keys[s-1]));n=n[e.keys[s]]}else n=e.GZ?i[e.GZ]:i[c++];if(d.MZ.test(e.type)&&d.jZ.test(e.type)&&n instanceof Function&&(n=n()),d.PZ.test(e.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(E("[sprintf] expecting number but found %T",n));switch(d.number.test(e.type)&&(a=0<=n),e.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,e.width?parseInt(e.width):0);break;case"e":n=e.precision?parseFloat(n).toExponential(e.precision):parseFloat(n).toExponential();break;case"f":n=e.precision?parseFloat(n).toFixed(e.precision):parseFloat(n);break;case"g":n=e.precision?String(Number(n.toPrecision(e.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=e.precision?n.substring(0,e.precision):n;break;case"t":n=String(!!n),n=e.precision?n.substring(0,e.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=e.precision?n.substring(0,e.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=e.precision?n.substring(0,e.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}d.json.test(e.type)?v+=n:(!d.number.test(e.type)||a&&!e.sign?f="":(f=a?"+":"-",n=n.toString().replace(d.sign,"")),o=e.xZ?"0"===e.xZ?"0":e.xZ.charAt(1):" ",u=e.width-(f+n).length,h=e.width&&0<u?o.repeat(u):"",v+=e.align?f+n+h:"0"===o?f+h+n:h+f+n)}return v}(function(t){if(u[t])return u[t];var i,n=t,r=[],s=0;for(;n;){if(null!==(i=d.text.exec(n)))r.push(i[0]);else if(null!==(i=d.LZ.exec(n)))r.push("%");else{if(null===(i=d.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){s|=1;var e=[],h=i[2],o=[];if(null===(o=d.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(e.push(o[1]);""!==(h=h.substring(o[0].length));)if(null!==(o=d.UZ.exec(h)))e.push(o[1]);else{if(null===(o=d.FZ.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");e.push(o[1])}i[2]=e}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:i[0],GZ:i[1],keys:i[2],sign:i[3],xZ:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}n=n.substring(i[0].length)}return u[t]=r}(t),arguments)}function t(t,i){return E.apply(null,[t].concat(i||[]))}var u=Object.create(null);n.vV=E,n.BZ=t,"undefined"!=typeof window&&(window.vV=E,window.BZ=t,void 0===(s=function(){return{vV:E,BZ:t}}.call(n,r,n,i))||(i.exports=s))}()},function(t,i,n){var r,s,e;s=[i],void 0===(e="function"==typeof(r=function(t){"use strict";var i,n;Object.defineProperty(t,"s",{value:!0});var r={YEAR:31536e3,MONTH:2628e3,DAY:86400,HOUR:3600,MINUTE:60,SECOND:1},u="years",a="months",f="days",c="hours",l="minutes",v="seconds",d=((i={}).VZ=0,i.qZ=0,i.QZ=0,i),E=((n={}).WZ=0,n.YZ=0,n.KZ=0,n),s=function(t){return/^-?P((([0-9]+Y([0-9]+M)?([0-9]+D)?|([0-9]+M)([0-9]+D)?|([0-9]+D))(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))?)|(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S))))$/.test(t)},p=function(t){return"string"==typeof t&&0<t.length},w=function(t){return"-"===t[0]},g=function(t){return t.slice(1)},o=function(t,i){var n=b(i);return function(t,i){return r[t.toUpperCase()]*i}(t,n)},b=function(t){var i=parseFloat(t);return isNaN(i)?0:i},e=function(t){var i=w(t),n=i?g(t):t,r=n.split("T"),s=g(r[0]),e=r[1],h=0;return p(s)&&(h+=function(t){var i=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("year",n)+o("month",r)+o("day",s)}(s)),p(e)&&(h+=function(t){var i=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("hour",n)+o("minute",r)+o("second",s)}(e)),i?-h:h},h=t.$Z=function(t){var i,n=w(t),r=n?g(t):t,s=r.split("T"),e=g(s[0]),h=s[1],o=((i={}).XZ=n,i);return o=p(e)?Object.assign(o,function(t){var i,n=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[u]=b(r),i[a]=b(s),i[f]=b(e),i}(e)):Object.assign(o,d),o=p(h)?Object.assign(o,function(t){var i,n=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[c]=b(r),i[l]=b(s),i[v]=b(e),i}(h)):Object.assign(o,E)};t.default=function(t,i){return function(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if("string"==typeof t)return s(t)?i?h(t):e(t):null;throw new TypeError("expected input to be a string")}(t,i)}})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,u=n(85),a=n(61),h=n(57),f=n(3),o=(e=u.pV,s(c,e),c.prototype.NB=function(t,i){this.manifest=this.dV.parse(i,this.RB(t))},c.prototype.fL=function(i){var n=this,r=f.defer(),o=this.WH(i.Lp());if(!o||o.next)return r.resolve(!1),r.promise;var s=f.defer();if(this.dL)h.DASH.kH?this.dL.EL().then(function(t){t?n.dL.decrypt(i.Xp).then(function(t){s.resolve(n.iV(t))}).fail(function(t){return s.reject(!0)}):s.reject(!1)}):s.reject(!1);else try{var t=this.iV(i.Xp);s.resolve(t)}catch(t){this.logger.warn("error extracting duration",t),s.reject(!0)}return s.promise.then(function(e){if(!isNaN(e)){var h=o.id+e;n.logger.debug("found next fragment: "+o.id+" -> "+h+" duration: "+e),n.IB.forEach(function(t){if(t.type===o.type){var i=t.HB.replace(u.pV.JB,o.id+""),n=t.HB.replace(u.pV.JB,h+""),r=t.XH.get(i);if(!t.XH.has(n)&&r){r.duration=e;var s=new a.wU(h,t.bandwidth,e,n,n);s.type=r.type,r.next=s,t.XH.set(n,s),t.qB.set(h,s)}}})}r.resolve(!1)}).fail(function(t){n.logger.debug("could not extract duration from "+i.Lp()+" [reevaluate: "+t+"]"),r.resolve(t)}),r.promise},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.AL=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var l=n(1),e=n(149),r=n(4),h=n(150),v=n(61),s=n(0),d=n(6),a=n(88),E=n(2),o=(u.prototype.parse=function(i,n){try{var t=new e.JZ;if(t.push(n),t.manifest.playlists)this.zZ(i,t.manifest);else{var r=this.ZZ(i,t.manifest);if(r&&r.t0&&(this.live=!r.t0.i0),this.live){var s=this.n0(t.manifest,n);return this.logger.debug("HLS manifest trimmed "+s.r0+" segments ("+s.r0+"s) - new segments:["+r.s0.map(function(t){return t.id+":"+t.duration})+"]"),s.e0}}return n}catch(t){return l.ErrorMonitor.lt().logError("Error parsing metadata",this.loggerId,E.Sr.rr,{detailedError:t,url:i}),n}},u.prototype.RL=function(t,i){return this.XV.has(i)?this.XV.get(i).qB.get(t):null},u.prototype.xH=function(){return this.$V.values().map(function(t){return t.bitrate})},u.prototype.isLive=function(){return this.live},u.prototype.WH=function(t){return null==this.XH?null:this.XH.get(t)},u.prototype.JH=function(i){try{var t=this.XH.get(i);if(t){var n=t.bitrate;return this.XV.get(n).qB.get(t.id+1)}return null}catch(t){return l.ErrorMonitor.lt().logError("Error getting the next segment info",this.loggerId,E.Sr.hr,{detailedError:t,url:i}),null}},u.prototype.YV=function(t){return this.$V.has(t)},u.prototype.KV=function(){return this.h0},u.prototype.zZ=function(s,t){var e=this;this.h0=s,this.o0=t,this.$V=new r,this.XH=new r,this.XV=new r,this.o0.playlists.forEach(function(t){var i=d.La.Aa(s,t.uri),n=t.attributes.BANDWIDTH,r=new h.u0(n,t.uri,i);e.$V.set(i,r),e.XV.set(n,r)})},u.prototype.ZZ=function(e,t){var h=this;try{var o=this.$V.get(e);if(!o)return void l.ErrorMonitor.lt().logError("Playlist url does not match any playlist in the master file",this.loggerId,E.Sr.Rr,{url:e});var u=null!=t.mediaSequence?t.mediaSequence:0,a=[],i=u-1,f=o.qB.get(i),c=[];return t.JV.forEach(function(t){var i=d.La.Aa(e,t.uri),n=Math.round(1e3*t.duration),r=o.bitrate;Number.isInteger(r)||(l.ErrorMonitor.lt().logError("Segment Bitrate is a Float",{bitrate:r}),r=Math.round(r));var s=new v.wU(u,r,n,t.uri,i);h.XH.has(i)||c.push(s),h.XH.set(i,s),o.qB.set(u,s),a.push(s),f&&(f.next=s),f=s,u++}),(this.a0=o).update(t.mediaSequence,t.discontinuitySequence,t.i0,t.f0,a),{t0:o,s0:c}}catch(t){return l.ErrorMonitor.lt().logError("Error updating the playlist",this.loggerId,E.Sr.Ar,t),null}},u.prototype.n0=function(t,i){try{for(var n=i.split("\n"),r=Math.max(1,a.HLS.BV),s=null,e=0,h=0,o=t.JV.length-1;r-1<o&&(s=t.JV[o],!(e>=a.HLS.xV));o--)h++,e+=s.duration;var u="";if(s){for(o=0;o<n.length&&(u=u+n[o]+"\n",n[o].trim()!==s.uri);o++);this.logger.debug("HLS trimmed "+h+" segments for total duration: "+e)}else u=n.join("\n")+"\n",this.logger.debug("HLS trimming disabled (minFragments = "+r+", segments.length = "+t.JV.length+")");return{e0:u,r0:h,c0:e}}catch(t){throw l.ErrorMonitor.lt().logError("Error trimming the playlist",this.loggerId,E.Sr.Nr,t),new Error(t)}},u);function u(){this.loggerId="[HLS METADATA] ",this.$V=new r,this.a0=null,this.logger=(s.Framework.resolve(s.Framework.ht.m)||console).log()}i.iq=o},function(t,i,n){var r=function(){var e={OS:{}};e.OS.create=Object.create||function(t){function i(){}return i.prototype=t,new i},e.OS.l0=function(t,i,n){for(var r in t)hasOwnProp.call(t,r)&&i.call(n||this,r,t[r])},e.OS.mm=function(t,i){if(!i)return t;for(var n in i)hasOwnProp.call(i,n)&&(t[n]=i[n]);return t},e.OS.v0=function(t,i){var n,r,s;for(n in t=e.OS.hC(t),i)hasOwnProp.call(i,n)&&(r=t[n],s=i[n],e.OS.d0(r)&&e.OS.d0(s)?t[n]=e.OS.v0(r,s):t[n]=i[n]);return t},e.OS.hC=function(t){return e.OS.mm({},t)},e.OS.d0=function(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object},e.OS.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.mergeOptions=function(t,i){var n,r,s;for(n in t=e.OS.hC(t),i)i.hasOwnProperty(n)&&(r=t[n],s=i[n],e.OS.d0(r)&&e.OS.d0(s)?t[n]=e.util.mergeOptions(r,s):t[n]=i[n]);return t},(t=function(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,s;if(i=e[t])for(s=Array.prototype.slice.call(arguments,1),r=i.length,n=0;n<r;++n)i[n].apply(this,s)},this.p0=function(){e={}}}}).prototype.E0=function(i){this.on("data",function(t){i.push(t)})},e.w0=t;function h(t){for(var i,n=t.split(a),r=n.length,s={};r--;)""!==n[r]&&((i=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),s[i[0]]=i[1]);return s}var i,o,u,a=new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'),t=e.w0;return(i=function(){var n="";i.prototype.init.call(this),this.push=function(t){var i;for(i=(n+=t).indexOf("\n");-1<i;i=n.indexOf("\n"))this.trigger("data",n.substring(0,i)),n=n.substring(i+1)}}).prototype=new t,(o=function(){o.prototype.init.call(this)}).prototype=new t,o.prototype.push=function(t){var i,n;if(0!==(t=t.replace(/^\s+|\s+$/g,"")).length)if("#"===t[0])if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),i=/^#EXTM3U/.exec(t))this.trigger("data",{type:"tag",g0:"m3u"});else{if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return n={type:"tag",g0:"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),void this.trigger("data",n);if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",g0:"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",g0:"totalduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return n={type:"tag",g0:"version"},i[1]&&(n.version=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",g0:"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",g0:"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return n={type:"tag",g0:"playlist-type"},i[1]&&(n.b0=i[1]),void this.trigger("data",n);if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return n={type:"tag",g0:"byterange"},i[1]&&(n.length=parseInt(i[1],10)),i[2]&&(n.offset=parseInt(i[2],10)),void this.trigger("data",n);if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return n={type:"tag",g0:"allow-cache"},i[1]&&(n.EM=!/NO/.test(i[1])),void this.trigger("data",n);if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t))return n={type:"tag",g0:"stream-inf"},i[1]&&(n.attributes=h(i[1]),n.attributes.y0&&(r=n.attributes.y0.split("x"),s={},r[0]&&(s.width=parseInt(r[0],10)),r[1]&&(s.height=parseInt(r[1],10)),n.attributes.y0=s),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["T0"]&&(n.attributes["T0"]=parseInt(n.attributes["T0"],10))),void this.trigger("data",n);var r,s;if(i=/^#EXT-X-ENDLIST/.exec(t))this.trigger("data",{type:"tag",g0:"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(t))this.trigger("data",{type:"tag",g0:"discontinuity"});else{if(i=/^#EXT-X-KEY:?(.*)$/.exec(t))return n={type:"tag",g0:"key"},i[1]&&(n.attributes=h(i[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2)&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n);this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}else this.trigger("data",{type:"comment",text:t.slice(1)});else this.trigger("data",{type:"uri",uri:t})},(u=function(){var t,n=this,r=[],s={};u.prototype.init.call(this),this.m0=new i,this.O0=new o,this.m0.E0(this.O0),this.manifest={S0:!0},this.O0.on("data",function(i){({tag:function(){({"allow-cache":function(){this.manifest.S0=i.EM,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.S0=!0)},byterange:function(){var t={};"length"in i&&((s.byterange=t).length=i.length,"offset"in i||(this.trigger("info",{message:"defaulting offset to zero"}),i.offset=0)),"offset"in i&&((s.byterange=t).offset=i.offset)},endlist:function(){this.manifest.i0=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<=i.duration&&(s.duration=i.duration),this.manifest.JV=r},key:function(){i.attributes?"NONE"!==i.attributes.R0?i.attributes.Ab?(i.attributes.R0||this.trigger("warn",{message:"defaulting key method to AES-128"}),t={method:i.attributes.R0||"AES-128",uri:i.attributes.Ab},void 0!==i.attributes.IV&&(t.iv=i.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):t=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(i.number)?this.manifest.mediaSequence=i.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number})},"discontinuity-sequence":function(){isFinite(i.number)?this.manifest.discontinuitySequence=i.number:this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number})},"playlist-type":function(){/VOD|EVENT/.test(i.b0)?this.manifest.b0=i.b0:this.trigger("warn",{message:"ignoring unknown playlist type: "+i.t0})},"stream-inf":function(){this.manifest.playlists=r,i.attributes?(s.attributes||(s.attributes={}),s.attributes=e.mergeOptions(s.attributes,i.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){s.discontinuity=!0},targetduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration}):this.manifest.f0=i.duration},totalduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+i.duration}):this.manifest.I0=i.duration}}[i.g0]||function(){}).call(n)},uri:function(){s.uri=i.uri,r.push(s),!this.manifest.f0||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.f0),t&&(s.key=t),s={}},_0:function(){}})[i.type].call(n)})}).prototype=new t,u.prototype.push=function(t){this.m0.push(t)},u.prototype.end=function(){this.m0.push("\n")},e.A0=i,e.N0=o,e.JZ=u,e}();t.exports=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=(e.prototype.update=function(t,i,n,r,s){this.mediaSequence=t,this.discontinuitySequence=i,this.i0=n,this.f0=r,this.JV=s,this.updated=!0},e);function e(t,i,n){this.qB=new r,this.bitrate=t,this.uri=i,this.zH=n}i.u0=s},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(84),o=(e=h.SB,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.tq=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(16),s=n(0),e=n(5),h=n(3),o=n(7),u=n(2),a=n(1),f=(c.prototype.init=function(t,i){try{this.C0.init(t,i),o.ut.Ya&&e.ea.Cache.Zo&&this.k0.init(t,i)}catch(t){a.ErrorMonitor.lt().logError("Error initializing cache",this.loggerId,u.li.vi,t)}},c.prototype.put=function(t){var i=this,n=h.defer();try{!t.Zp.isLive()&&o.ut.Ya&&e.ea.Cache.Zo?this.k0.put(t).then(function(){n.resolve(!0)}).catch(function(t){t&&a.ErrorMonitor.lt().logError("Error adding new fragment in cache",i.loggerId,u.li.di,t),n.reject(!1)}):this.C0.put(t).then(function(){n.resolve(!0)}).catch(function(t){t&&a.ErrorMonitor.lt().logError("Error adding new fragment in cache",i.loggerId,u.li.di,t),n.reject(!1)})}catch(t){a.ErrorMonitor.lt().logError("Error adding new fragment in cache",this.loggerId,u.li.di,t),n.reject(!1)}return n.promise},c.prototype.get=function(i){var n=this,r=h.defer();try{this.contains(i).then(function(t){t?n.C0.get(i).then(function(t){r.resolve(t)}).catch(function(t){t&&a.ErrorMonitor.lt().logError("Error getting the fragment from cache",n.loggerId,u.li.Ei,t),o.ut.Ya&&e.ea.Cache.Zo?n.k0.get(i).then(function(t){r.resolve(t)}).catch(function(){r.reject(!1)}):r.reject(!1)}):r.reject(!1)}).catch(function(t){t&&a.ErrorMonitor.lt().logError("Error getting the fragment from cache",n.loggerId,u.li.Ei,t),r.reject(!1)})}catch(t){a.ErrorMonitor.lt().logError("Error getting the fragment from cache",this.loggerId,u.li.Ei,t),r.reject(!1)}return r.promise},c.prototype.contains=function(i){var n=this,r=h.defer(),s=!1;try{this.C0.contains(i).then(function(t){!s&&o.ut.Ya&&e.ea.Cache.Zo?n.k0.contains(i).then(function(t){s=t}):s=t}).fail(function(t){n.logger.error(t)}).finally(function(){r.resolve(s)})}catch(t){a.ErrorMonitor.lt().logError("Error checking if cache contains the fragment",this.loggerId,u.li.pi,t),r.resolve(!1)}return r.promise},c.prototype.OM=function(t){try{return!t&&o.ut.Ya&&e.ea.Cache.Zo?this.k0.OM(t):this.C0.OM(t)}catch(t){return a.ErrorMonitor.lt().logError("Error getting the keys from cache",this.loggerId,u.li.wi,t),[]}},c.prototype.cq=function(t){var i=this,n=h.defer(),r=[];try{!t&&o.ut.Ya&&e.ea.Cache.Zo?this.k0.cq(t).then(function(t){r=t}).fail(function(t){i.logger.error(t)}).finally(function(){n.resolve(r)}):this.C0.cq(t).then(function(t){r=t}).fail(function(t){i.logger.error(t)}).finally(function(){n.resolve(r)})}catch(t){a.ErrorMonitor.lt().logError("Error getting the elements from cache ",this.loggerId,u.li.gi,t),n.resolve(r)}return n.promise},c.prototype.vq=function(){this.C0.vq()},c);function c(){this.loggerId="[CACHE] ",this.logger=s.Framework.resolve(s.Framework.ht.m).log(),this.C0=s.Framework.resolve(r.nl.Dc),o.ut.Ya&&e.ea.Cache.Zo&&(this.k0=s.Framework.resolve(r.nl.Mc))}i.Cache=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(26),u=n(6),a=n(5),f=n(0),c=n(9),l=n(1),v=n(2),e=n(19),h=(o.prototype.init=function(t){this.logger=f.Framework.resolve(f.Framework.ht.m).log(t.sessionId),this.D0=t.MD,this.PD=t.PD,this.PD&&(this.oa=this.PD.M0()),this.pl=t.yd.pl,this.pl.XF(this.JF)},o.prototype.request=function(n){var r=this,s=f.Framework.resolve(f.Framework.ht.T),e=!1,h=n.Pp(),o=n.zp,t=n.Lp();n.xhr=s,n.Vp._p=f.Framework.time(),this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+n.Mp.toString()+"-"+n.Vp.yp+" ["+c.wf[n.Dp()]+"] TO FALLBACK "),n.Mp.dA()&&(s.responseType="arraybuffer"),this.j0(n.type)&&o.range&&n.Dp()!=c.wf.yf&&s.setRequestHeader("Range","bytes="+o.range),a.ea.N.uu&&this.P0(n.type)&&0!=n.Vp.yp&&(this.logger.info("SET RANGE bytes="+n.Vp.yp+"-"),s.setRequestHeader("Range","bytes="+n.Vp.yp+"-")),o.uB.forEach(function(t){"range"!==t.key.toLowerCase()&&s.setRequestHeader(t.key,t.value)}),o.async&&0<o.timeout&&(s.timeout=o.timeout),o.mimeType&&s.overrideMimeType(o.mimeType),o.withCredentials&&(s.withCredentials=o.withCredentials),s.onloadstart=function(t){var i=u.La.createEvent(Event,"loadstart",t,o);o.dispatchEvent(i)},s.onabort=function(t){if(!e){var i=u.La.createEvent(Event,"abort",t,o);o.dispatchEvent(i)}},s.ontimeout=function(t){if(!e){r.error(n,h,10);var i=u.La.createEvent(ProgressEvent,"timeout",t,o);o.dispatchEvent(i),l.ErrorMonitor.lt().logError("Error on fallback request because of timeout",r.loggerId,v.se.ee)}},s.onreadystatechange=function(t){if(o&&(s.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(o.$p=s.getAllResponseHeaders(),o.status=s.status,o.statusText=s.statusText),s.readyState<XMLHttpRequest.DONE||s.readyState===XMLHttpRequest.DONE&&0===s.status)){o.readyState=s.readyState;var i=u.La.createEvent(Event,"readystatechange",t,o);o.dispatchEvent(i)}},s.onprogress=function(t){if(!r.P0(n.type)){var i=u.La.createEvent(ProgressEvent,"progress",t,o);o.dispatchEvent(i),s.total=t.total}n.Vp.Op=t.total,n.size=t.total},s.onload=function(t){if(e=!0,o.status=s.status,t&&0!=t.total&&(n.Vp.Op=t.total),n.$p=s.getAllResponseHeaders(),s.status<200||299<s.status)return r.logger.debug("FRL SERVER RETURNED ERROR CODE "+s.status),void r.error(n,h);n.Mp.dA()?r.j0(n.type)?n.Xp=s.response:r.P0(n.type)&&(a.ea.N.uu?n.Xp=f.Framework.U()?null:u.La.appendBuffer(n.Xp,s.response):n.Xp=s.response):n.sL=s.responseText,n.loaded(),r.H0.delete(h),n.Vp.Ap=f.Framework.time(),r.L0(n),r.U0(n),r.D0.EJ(n),s=null},s.onerror=function(){e||r.error(n,h)},this.H0.set(h,n),s.open("GET",t,o.async,o.username,o.password),s.send()},o.prototype.error=function(t,i,n){this.pl&&-1==a.ea.Yu.Io.indexOf(t.xhr.status)&&(n&&0<n?this.pl.MG(n):t.xhr.status&&0<t.xhr.status?this.pl.MG(t.xhr.status):this.pl.MG(404));var r="COULD NOT DOWNLOAD "+t.Lp()+" status: "+t.xhr.status;t.type==s.fp.vp?this.logger.debug(r):this.logger.warn(r),this.F0(t),this.H0.delete(i),this.D0.lJ(t)},o.prototype.ah=function(t){return this.H0.has(t)},o.prototype.j0=function(t){return t==s.fp.vp||t==s.fp.lp||t==s.fp.cp},o.prototype.P0=function(t){return t==s.fp.dp},o.prototype.zX=function(t){var i=this.H0.get(t);this.H0.delete(t),i&&i.xhr&&i.xhr.abort()},o.prototype.U0=function(t){t.Mp.Dp()==c.wf.bf&&this.JF.add(t.Bp()),this.logger.info("SUCCESS FROM FALLBACK FOR "+t.Lp()+" ["+s.fp[t.type]+"]["+t.Vp.Op+"] AFTER "+t.Bp()+" [curr:"+t.Qp().pa()+" avg:"+this.oa.pa()+"]")},o.prototype.F0=function(t){},o.prototype.eJ=function(){return this.oa},o.prototype.L0=function(t){t.Dp()===c.wf.bf&&this.oa.ca(t.Qp())},o);function o(){this.loggerId="[FallbackRequester] ",this.H0=new r,this.oa=new u.ga,this.JF=new e.Vl}i.C$=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(3);n(60);var u=n(0),e=n(5),r=n(16),a=n(49),f=n(58),o=n(10),s=n(92),c=hive.services.protocol.oU.CustomerKey,l=n(8),v=n(14),d=n(7),E=n(1),p=n(2),w=n(19),g=d.ut.$a,b=(y.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.ht.m).log(t.sessionId),this.sessionId=t.sessionId,this.TX=t.TX,this.PD=t.PD,this.eU=t.eU,this.PX=t.LD,this.CX.G0(t.sessionId,this),this.x0=s.gq.bq,this.pl=t.yd.pl,this.pl.KF(this.B0)},y.prototype.start=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.context=t,this.streamId=t.$.getContextId(),this.ticket=t.$.YM(),this.jd=i},y.prototype.V0=function(t){this.q0=t},y.prototype.gX=function(){var t=this;this.lX(),this.Q0=u.Framework.setInterval(function(){t.W0()},e.ea.Wu.So),this.W0()},y.prototype.lX=function(){this.Q0&&u.Framework.clearInterval(this.Q0)},y.prototype.Y0=function(){var i=this,n=h.defer(),r=new hive.services.protocol.oU.TrackerRequest,s=this.context.$,t=s.isLive()?StreamType.LIVE:StreamType.VOD;r.sessionId=this.sessionId;var e=new c;return this.q0?(e.partnerId=this.q0.partnerId,e.customerId=this.q0.customerId):v.HiveConfig.ClientInfo.vc&&v.HiveConfig.ClientInfo.dc?(e.partnerId=v.HiveConfig.ClientInfo.vc,e.customerId=v.HiveConfig.ClientInfo.dc):(e.partnerId=this.ticket.pE(),e.customerId=this.ticket.wE()),r.customerKey=e,r.streamType=t,r.contentId=this.PD.getContextId(),this.SE.getConnectivityInfo().then(function(t){i.K0=t.getNetworkChanged().getPrivateIp(),i.PD.Sx(i.K0)}).fail(function(t){E.ErrorMonitor.lt().logError("Error getting connectivity info",i.loggerId,p.Lr.Fr)}).finally(function(){try{var t=new hive.snapshots.ConnectivityInfo;t.publicIp=i.TG,t.privateIp=i.K0,r.info=i.$0(t,s),r.query=i.X0(s,r.info),n.resolve(r)}catch(t){E.ErrorMonitor.lt().logError("Error collecting the data for the tracker request",i.loggerId,p.Lr.Gr,t),n.reject("ERROR")}}).done(),n.promise},y.prototype.J0=function(){var t=new Array;return this.x0==s.gq.bq?t.push(hive.services.protocol.oU.uU.Global):this.x0==s.gq.AS?t.push(hive.services.protocol.oU.uU.fU):this.x0==s.gq.ID?t.push(hive.services.protocol.oU.uU.aU):this.logger.warn("Wrong locality mode"),t},y.prototype.X0=function(t,i){var r=this,s=new hive.services.protocol.oU.TrackerQuery;try{return s.random=e.ea.Zu.Ou,i.externalAs&&!this.yG&&(this.yG=i.externalAs),i.internalAs&&!this.z0&&(this.z0=i.internalAs),s.rankings=this.J0(),s.asns=[],0<this.yG&&this.Z0(s.asns,hive.services.protocol.oU.cU.External,this.yG,e.ea.Zu.Su),0<this.z0&&(this.Z0(s.asns,hive.services.protocol.oU.cU.lU,this.z0,e.ea.Zu.Ru),s.watchers=[],t.xH().forEach(function(t){var i=r.t1(hive.services.protocol.oU.cU.lU,r.z0,t,-1);s.watchers.push({key:i,value:1})}),s.streamers=[],this.PD.TW().forEach(function(t,i){var n=r.t1(hive.services.protocol.oU.cU.lU,r.z0,i,t.type==a.SD.ID?hive.services.protocol.oU.Sf._f:-1);s.streamers.push({key:n,value:e.ea.Zu.Iu})})),s}catch(t){throw E.ErrorMonitor.lt().logError("Error preparing tracker query",this.loggerId,p.Lr.xr,t),new Error(t)}},y.prototype.t1=function(t,i,n,r){var s=new hive.services.protocol.oU.TrackerBitrateQuery,e=new hive.services.protocol.oU.TrackerAsQuery;return e.asType=t,e.asn=i,s.bitrate=n,s.asn=e,-1!=r&&s.streamState,s},y.prototype.Z0=function(t,i,n,r){var s=new hive.services.protocol.oU.TrackerAsQuery;s.asType=i,s.asn=n,t.push({key:s,value:r})},y.prototype.$0=function(t,i){var r=new hive.services.protocol.oU.TrackerPeerInfo;try{if(u.Framework.U()?r.guid=this.tE:r.guid=btoa(this.tE),r.timestamp=u.Framework.time(),r.nat=void 0,this.PD.HM()&&(r.externalAs=this.PD.HM()),this.PD.PM()&&(r.internalAs=this.PD.PM()),null!=t){r.publicIpString=t.publicIp;var n=new InetAddress;n.address=t.publicIp,r.publicIp=n,r.privateIpString=t.privateIp;var s=new InetAddress;s.address=t.privateIp,r.privateIp=s}var e=Math.round(this.PD.M0().va()/8);if(r.bandwidth=isNaN(e)?null:e,!this.PD.AM()&&this.PD.GM()&&g?r.rankValue=1:r.rankValue=this.PD.i1(),this.context.$ instanceof f.UH){r.streams=new Array;var h=i.WD();null!=h&&(r.watchingBitrate=h.bitrate);var o=i.kL();this.PD.TW().forEach(function(t,i){if(t.fA){var n=new hive.services.protocol.oU.TrackerPeerStreamInfo;switch(n.bitrate=i,t.type){case a.SD.Rf:n.state=hive.services.protocol.oU.Sf.If;break;case a.SD.RD:n.state=hive.services.protocol.oU.Sf.Af;break;case a.SD.ID:n.state=hive.services.protocol.oU.Sf._f}n.delta=o.fM(t.fA.cA(),i),r.streams.push(n)}})}return r}catch(t){throw E.ErrorMonitor.lt().logError("Error preparing tracker info",this.loggerId,p.Lr.Vr,t),new Error(t)}},y.prototype.W0=function(){var n=this;this.n1=u.Framework.time(),this.logger.debug(this.loggerId+" PREPARE REQUEST"),this.Y0().then(function(t){var i=n.loggerId+"SENDING TRACKER REQUEST [ privateIp:"+t.info.privateIpString+" rank:"+t.info.rankValue+"]";switch(n.s1){case 0:default:n.logger.debug(i);break;case 1:n.logger.debug(i+" "+JSON.stringify(t));break;case 2:n.logger.debug(i,t);break;case 3:n.logger.debug(i+" "+JSON.stringify(t),t)}n.CX.e1(t)},function(t){E.ErrorMonitor.lt().logError("Error preparing the tracker request",n.loggerId,p.Lr.Ur)}).catch(function(t){E.ErrorMonitor.lt().logError("Error sending tracker request",n.loggerId,p.Lr.qr,t)})},y.prototype.h1=function(t){this.x0=t},y.prototype.o1=function(){var t=Math.max(0,u.Framework.time()-this.n1);0<t&&t<e.ea.Zu.TIMEOUT&&this.B0.add(t)},y.prototype.rJ=function(t){var i=this;try{switch(this.o1(),this.s1){case 1:this.logger.debug(this.loggerId+this.context.$.YM()+" Tracker Response: "+JSON.stringify(t));break;case 2:this.logger.debug(this.loggerId+this.context.$.YM()+" Tracker Response: ",t);break;case 3:this.logger.debug(this.loggerId+this.context.$.YM()+" Tracker Response: "+JSON.stringify(t),t)}this.yG=t.peerInfo.externalAs,this.z0=t.peerInfo.internalAs,this.TG=t.peerInfo.publicIpString,this.K0=t.peerInfo.privateIpString,this.PD.bx(this.TG),this.PD.u1(this.z0),this.PD.a1(this.yG),this.SE.px(this.TG,this.K0,this.z0),this.logger.debug(this.loggerId+"Reporting from tracker public IP:"+this.TG+" private IP: "+this.K0+" ExtAs:"+this.yG+" inAs:"+this.z0),!this.PD.AM()&&this.PD.GM()&&g?this.PX.nQ(!1):this.PX.f1(t.rankings,t.infos);var n=this.c1(t);this.jd.forEach(function(t){return t.Dq(n,i.l1)}),this.l1=!1}catch(t){E.ErrorMonitor.lt().logError("Error handling the response",this.loggerId,p.Lr.Qr,t)}},y.prototype.c1=function(t){for(var i=[],n=0,r=t.infos;n<r.length;n++){var s=r[n],e=new o.Nf(o.mf.Of,s);i.push(e)}return i},y.prototype.dQ=function(t){},y.prototype.AE=function(t){this.tE=t,this.logger.info(this.loggerId+"CONNECTED "+this.tE),this.PX.v1(),this.gX()},y.prototype.HQ=function(){},y);function y(){this.s1=isNaN(v.HiveConfig.DebugLogs.TrackerLogs)?0:v.HiveConfig.DebugLogs.TrackerLogs,this.loggerId="[TRACKER] ",this.yG=0,this.z0=0,this.d1=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{0,4}){5})/,this.l1=!0,this.yv=u.Framework.resolve(u.Framework.ht.v),this.SE=u.Framework.resolve(l.pf.af),this.CX=u.Framework.resolve(r.nl.Kc),this.B0=new w.Vl}i.D$=b},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),e=n(6),h=n(1),o=n(2),u=function(t,i){this.id=t,this.size=i};i.Element=u;var a=(f.prototype.put=function(t,i){try{var n=t.fragmentId,r=t.size;t.bitrate,this.E1.has(n)||(this.E1.set(n,new u(n,r)),this.w1.set(n,new Array)),this.w1.get(n).push(i)}catch(t){throw h.ErrorMonitor.lt().logError("Error adding new have in object index",this.loggerId,o.ae.fe,t),new Error(t)}},f.prototype.contains=function(t){return this.w1.has(t)},f.prototype.jM=function(t){return this.w1.get(t)},f.prototype.MM=function(t){return this.E1.get(t)},f.prototype._W=function(n){var r=this;try{this.w1.forEach(function(t,i){e.La.Ta(t,n,!1),0===t.length&&(r.w1.delete(i),r.E1.delete(i))})}catch(t){h.ErrorMonitor.lt().logError("Error removing haves send from a specific peer",this.loggerId,o.ae.ce,t)}},f.prototype.dq=function(){var n=this;this.w1.forEach(function(t,i){n.logger.debug("OBJIDX FR "+i+" PS "+t.map(function(t){return t.oW.Kl.otherGuid}).reduce(function(t,i){return t+","+i}))})},f);function f(){this.loggerId="[ObjectIndex] ",this.E1=new r,this.w1=new r,this.logger=s.Framework.resolve(s.Framework.ht.m).log()}i.H$=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(5),e=n(0),h=n(6),o=n(10),u=n(157),a=n(48),f=n(93),c=n(7),l=n(1),v=n(2),d=c.ut.$a,E=(p.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.ht.m).log(t.sessionId),this.HD=t.HD,this.PD=t.PD,this.OX=t.OX,this.g1=t.sU,(d||e.Framework.U()&&a.TD.bD)&&(this.rX=t.rX),this.start()},p.prototype.start=function(){this.b1=!0},p.prototype.stop=function(){this.b1=!1},p.prototype.Dq=function(t,i){var n=this;try{if(this.b1){var r=[];t.forEach(function(i){var t=null;i.guid!=n.tE&&(i.type==o.mf.Of?t=n.T1(i):d||e.Framework.U()&&a.TD.bD?(t=n.m1(i),n.rX.mq(i).then(function(){n.HD.LQ(n.gW.get(i.guid))}).fail(function(t){t&&t!=f.wQ.Pq&&(n.gW.delete(i.guid),l.ErrorMonitor.lt().logError("Error electing lan leader",n.loggerId,v.mi.Si))})):t=n.m1(i)),t&&r.push(t.peerInfo.guid)}),this.O1(),this.ZP(),i&&this.HD.QQ(i),0<r.length&&this.logger.debug("DISCOVERED NEW "+r.length+"/"+t.length+": ["+r.join(", ")+"]")}}catch(t){l.ErrorMonitor.lt().logError("Error discovering peers",this.loggerId,v.mi.Oi,t)}},p.prototype.ZP=function(){var t=this.S1.length+this.gW.length;this.g1.R1(t)},p.prototype.O1=function(){try{this.S1.length>s.ea.zu.Tu&&this.I1(this.S1,s.ea.zu.Tu),this.gW.length>=s.ea.zu.mu&&this._1(this.gW)}catch(t){l.ErrorMonitor.lt().logError("Error clearing membership views",this.loggerId,v.mi.Ri,t)}},p.prototype.I1=function(t,i){for(var n=t.values().sort(function(t,i){return t.peerInfo.timestamp-i.peerInfo.timestamp});t.length>i;){var r=n.splice(0,1)[0];this.HD.UQ(r)||t.delete(r.peerInfo.guid)}},p.prototype._1=function(t){var i=t.keys()[e.Framework.random()*t.length];t.delete(i)},p.prototype.m1=function(t){var i=null;try{if(this.S1.has(t.guid)?(i=this.S1.get(t.guid),this.S1.delete(t.guid),this.gW.set(t.guid,i)):this.gW.has(t.guid)&&(i=this.gW.get(t.guid)),!i)return i=new u.A1(t),this.gW.set(t.guid,i),i;i.V0(t)}catch(t){return l.ErrorMonitor.lt().logError("Error adding peer to lan view",this.loggerId,v.mi.Ii,t),null}},p.prototype.T1=function(t){var i=null;try{if(this.gW.has(t.guid))this.m1(t);else{if(!this.S1.has(t.guid))return i=new u.A1(t),this.S1.set(t.guid,i),this.OX.N1(i),i;(i=this.S1.get(t.guid)).V0(t),this.OX.N1(i)}}catch(t){return l.ErrorMonitor.lt().logError("Error adding peer to random view",this.loggerId,v.mi._i,t),null}},p.prototype.WQ=function(t,i){var n=[];try{return this.b1&&(n=d||e.Framework.U()&&a.TD.bD?h.La.Sa(this.S1.values()):(n=this.S1.values(),this.gW.forEach(function(t,i){n.push(t)}),h.La.Sa(n))),t?n:i?n.slice(0,i):n.slice(0,2*s.ea.Bu.io)}catch(t){return l.ErrorMonitor.lt().logError("Error sampling membership",this.loggerId,v.mi.Ai,t),[]}},p.prototype.vW=function(t){return this.S1.has(t)?this.S1.get(t):this.gW.has(t)?this.gW.get(t):null},p.prototype.AE=function(t){this.logger.info("MEMBERSHIP SERVER CONNECTED"),this.tE=t,this.PD.setId(this.tE)},p.prototype.HQ=function(){},p.prototype.dQ=function(t){this.logger.debug("Peer "+t+" disconnected"),this.S1.delete(t),this.gW.delete(t),this.ZP()},p);function p(){this.loggerId="[Membership] ",this.tE=null,this.S1=new r,this.gW=new r}i.zu=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(10),s=n(158),e=(h.prototype.sW=function(){return this.peerInfo.type===r.mf.k},h.prototype.C1=function(t){this.D1=new s.M1([t])},h.prototype.j1=function(){return this.D1},h.prototype.P1=function(){return this.OX},h.prototype.H1=function(t){isNaN(t)||(this.OX=t)},h.prototype.V0=function(t){this.peerInfo.type==r.mf.Of&&t.type==r.mf.k?this.peerInfo.type=r.mf.k:this.peerInfo.type==r.mf.Of&&t.type==r.mf.Of||this.peerInfo.type==r.mf.k&&t.type==r.mf.k?this.L1(this.peerInfo,t):this.peerInfo.type==r.mf.k&&t.type==r.mf.Of&&(this.L1(this.peerInfo,t),this.peerInfo.type=r.mf.k)},h.prototype.PW=function(t){this.peerInfo.watchingBitrate=t},h.prototype.L1=function(t,i){t.internalAs=this.U1(t.internalAs,i.internalAs),t.externalAs=this.U1(t.externalAs,i.externalAs),t.nat=this.U1(t.nat,i.nat),t.bandwidth=this.U1(t.bandwidth,i.bandwidth),t.watchingBitrate=this.U1(t.watchingBitrate,i.watchingBitrate),t.privateIpString=this.U1(t.privateIpString,i.privateIpString),t.publicIpString=this.U1(t.publicIpString,i.publicIpString),t.rankValue=this.U1(t.rankValue,i.rankValue),t.timestamp=this.U1(t.timestamp,i.timestamp),i.isLeader&&(t.isLeader=this.U1(t.isLeader,i.isLeader)),i.streams&&(t.streams=i.streams)},h.prototype.U1=function(t,i){return t?i&&t!=i&&(t=i):i&&(t=i),t},h);function h(t){this.OX=0,this.peerInfo=t}i.A1=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(c.prototype.F1=function(){return this.G1||this.B1(),this.G1},c.prototype.B1=function(){for(var t=[],i=0;i<this.columns;i++){for(var n=[],r=0;r<this.rows;r++)n.push(this.matrix[r][i]);t.push(n)}this.G1=new c(t)},c.prototype.V1=function(t){for(var i=t.q1(),n=[],r=0;r<this.rows;r++){for(var s=[],e=0;e<this.columns;e++){var h=this.matrix[r][e]/i[r][e];s.push(h||0)}n.push(s)}return new c(n)},c.prototype.multiply=function(t){for(var i=t.q1(),n=t.Q1(),r=t.W1(),s=[],e=0;e<this.rows;e++){for(var h=this.matrix[e],o=[],u=0;u<r;u++){for(var a=0,f=0;f<n;f++)a+=h[f]*i[f][u];o.push(a)}s.push(o)}return new c(s)},c.prototype.Y1=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]*t);i.push(r)}return new c(i)},c.prototype.K1=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]+t);i.push(r)}return new c(i)},c.prototype.X1=function(){for(var t=[],i=0;i<this.rows;i++){for(var n=[],r=0;r<this.columns;r++)n.push(Math.exp(this.matrix[i][r]));t.push(n)}return new c(t)},c.prototype.J1=function(t){for(var i=[],n=0;n<this.rows;n++){var r=this.matrix[n];i.push([t]);for(var s=0;s<r.length;s++)i[n].push(r[s])}return new c(i)},c.prototype.q1=function(){return this.matrix},c.prototype.Q1=function(){return this.rows},c.prototype.W1=function(){return this.columns},c);function c(t){this.matrix=[],this.rows=0,this.columns=0,this.matrix=t,this.rows=this.matrix.length,this.columns=this.matrix[0].length}i.M1=r},function(s,e,l){(function(i){var t,n,r;
/**
 * @license ProtoBuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/ProtoBuf.js for details
 */n=[l(36)],void 0===(r="function"==typeof(t=function(T,t){"use strict";var s={};return s.z1=T,s._A=T._A||null,s.VERSION="4.1.3",s.Z1={},s.Z1.t2=0,s.Z1.i2=1,s.Z1.n2=2,s.Z1.s2=3,s.Z1.e2=4,s.Z1.h2=5,s.o2=[s.Z1.t2,s.Z1.i2,s.Z1.h2],s.u2={int32:{name:"int32",a2:s.Z1.t2,defaultValue:0},uint32:{name:"uint32",a2:s.Z1.t2,defaultValue:0},sint32:{name:"sint32",a2:s.Z1.t2,defaultValue:0},int64:{name:"int64",a2:s.Z1.t2,defaultValue:s._A?s._A.ZERO:void 0},uint64:{name:"uint64",a2:s.Z1.t2,defaultValue:s._A?s._A.f2:void 0},sint64:{name:"sint64",a2:s.Z1.t2,defaultValue:s._A?s._A.ZERO:void 0},bool:{name:"bool",a2:s.Z1.t2,defaultValue:!1},double:{name:"double",a2:s.Z1.i2,defaultValue:0},string:{name:"string",a2:s.Z1.n2,defaultValue:""},bytes:{name:"bytes",a2:s.Z1.n2,defaultValue:null},fixed32:{name:"fixed32",a2:s.Z1.h2,defaultValue:0},sfixed32:{name:"sfixed32",a2:s.Z1.h2,defaultValue:0},fixed64:{name:"fixed64",a2:s.Z1.i2,defaultValue:s._A?s._A.f2:void 0},sfixed64:{name:"sfixed64",a2:s.Z1.i2,defaultValue:s._A?s._A.ZERO:void 0},float:{name:"float",a2:s.Z1.h2,defaultValue:0},enum:{name:"enum",a2:s.Z1.t2,defaultValue:0},message:{name:"message",a2:s.Z1.n2,defaultValue:null},group:{name:"group",a2:s.Z1.s2,defaultValue:null}},s.c2=[s.u2.int32,s.u2.sint32,s.u2.sfixed32,s.u2.uint32,s.u2.fixed32,s.u2.int64,s.u2.sint64,s.u2.sfixed64,s.u2.uint64,s.u2.fixed64,s.u2.bool,s.u2.string,s.u2.bytes],s.l2=1,s.v2=536870911,s.d2=!1,s.E2=!0,s.w2=!0,s.RR=function(){var s={};return s.g2=!("object"!=typeof i||i+""!="[object process]"||i._C),s.b2=function(){for(var t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=null,n=0;n<t.length;n++){try{i=t[n]()}catch(t){continue}break}if(!i)throw Error("XMLHttpRequest is not supported");return i},s.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),s.g2){var i=l(23);if(n)i.T2(t,function(t,i){n(t?null:""+i)});else try{return i.m2(t)}catch(t){return null}}else{var r=s.b2();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},s.O2=function(t){return t.replace(/_([a-zA-Z])/g,function(t,i){return i.toUpperCase()})},s}(),s.Lang={S2:/[\s\{\}=;:\[\],'"\(\)<>]/g,R2:/^(?:required|optional|repeated|map)$/,iP:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,$j:/^[a-zA-Z_][a-zA-Z_0-9]*$/,I2:/^[a-zA-Z][a-zA-Z_0-9]*$/,_2:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,A2:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,N2:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,C2:/^(?:[1-9][0-9]*|0)$/,D2:/^0[xX][0-9a-fA-F]+$/,M2:/^0[0-7]+$/,j2:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,P2:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,H2:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,L2:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,U2:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,F2:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},s.G2=function(r,h){function i(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this.B2=null}var t={},n=i.prototype;function s(t){this.V2=new i(t),this.q2=!1}n.JJ=function(){var t='"'===this.B2?h.U2:h.F2;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this.B2),this.B2=null,i[1]},n.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this.B2)return this.JJ();var t,i,n;do{for(t=!1;h.L2.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;i=n,n=this.source.charAt(this.index)}while("*"!==i||"/"!==n);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var r=this.index;if(h.S2.lastIndex=0,!h.S2.test(this.source.charAt(r++)))for(;r<this.source.length&&!h.S2.test(this.source.charAt(r));)++r;var s=this.source.substring(this.index,this.index=r);return'"'!==s&&"'"!==s||(this.B2=s),s},n.aj=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},n.Bw=function(t){var i=this.next();if(i!==t)throw Error("illegal '"+i+"', '"+t+"' expected")},n.Q2=function(t){return this.aj()===t&&(this.next(),!0)},n.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},t.W2=i;var e=s.prototype;function o(t,i){var n=-1,r=1;if("-"==t.charAt(0)&&(r=-1,t=t.substring(1)),h.C2.test(t))n=parseInt(t);else if(h.D2.test(t))n=parseInt(t.substring(2),16);else{if(!h.M2.test(t))throw Error("illegal id value: "+(r<0?"-":"")+t);n=parseInt(t.substring(1),8)}if(n=r*n|0,!i&&n<0)throw Error("illegal id value: "+(r<0?"-":"")+t);return n}function u(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),h.C2.test(t))return i*parseInt(t,10);if(h.D2.test(t))return i*parseInt(t.substring(2),16);if(h.M2.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(h.j2.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function a(t,i,n){void 0===t[i]?t[i]=n:(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(n))}return e.parse=function(){var t,i={name:"[ROOT]",package:null,messages:[],Y2:[],imports:[],options:{},services:[]},n=!0;try{for(;t=this.V2.next();)switch(t){case"package":if(!n||null!==i.package)throw Error("unexpected 'package'");if(t=this.V2.next(),!h._2.test(t))throw Error("illegal package name: "+t);this.V2.Bw(";"),i.package=t;break;case"import":if(!n)throw Error("unexpected 'import'");"public"===(t=this.V2.aj())&&this.V2.next(),t=this.JJ(),this.V2.Bw(";"),i.imports.push(t);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.V2.Bw("="),"proto3"===(i.K2=this.JJ())&&(this.q2=!0),this.V2.Bw(";");break;case"message":this.X2(i,null),n=!1;break;case"enum":this.J2(i),n=!1;break;case"option":this.z2(i);break;case"service":this.Z2(i);break;case"extend":this.t3(i);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.V2.line+": "+t.message,t}return delete i.name,i},s.parse=function(t){return new s(t).parse()},e.JJ=function(){var t,i,n="";do{if("'"!==(i=this.V2.next())&&'"'!==i)throw Error("illegal string delimiter: "+i);n+=this.V2.next(),this.V2.Bw(i),t=this.V2.aj()}while('"'===t||'"'===t);return n},e.i3=function(t){var i=this.V2.aj();if('"'===i||"'"===i)return this.JJ();if(this.V2.next(),h.N2.test(i))return u(i);if(h.BOOL.test(i))return"true"===i.toLowerCase();if(t&&h._2.test(i))return i;throw Error("illegal value: "+i)},e.z2=function(t,i){var n=this.V2.next(),r=!1;if("("===n&&(r=!0,n=this.V2.next()),!h._2.test(n))throw Error("illegal option name: "+n);var s=n;r&&(this.V2.Bw(")"),s="("+s+")",n=this.V2.aj(),h.A2.test(n)&&(s+=n,this.V2.next())),this.V2.Bw("="),this.n3(t,s),i||this.V2.Bw(";")},e.n3=function(t,i){var n=this.V2.aj();if("{"!==n)a(t.options,i,this.i3(!0));else for(this.V2.Bw("{");"}"!==(n=this.V2.next());){if(!h.$j.test(n))throw Error("illegal option name: "+i+"."+n);this.V2.Q2(":")?a(t.options,i+"."+n,this.i3(!0)):this.n3(t,i+"."+n)}},e.Z2=function(t){var i=this.V2.next();if(!h.$j.test(i))throw Error("illegal service name at line "+this.V2.line+": "+i);var n={name:i,r3:{},options:{}};for(this.V2.Bw("{");"}"!==(i=this.V2.next());)if("option"===i)this.z2(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this.s3(n)}this.V2.Q2(";"),t.services.push(n)},e.s3=function(t){var i=this.V2.next();if(!h.$j.test(i))throw Error("illegal rpc service method name: "+i);var n=i,r={request:null,response:null,e3:!1,h3:!1,options:{}};if(this.V2.Bw("("),"stream"===(i=this.V2.next()).toLowerCase()&&(r.e3=!0,i=this.V2.next()),!h._2.test(i))throw Error("illegal rpc service request type: "+i);if(r.request=i,this.V2.Bw(")"),"returns"!==(i=this.V2.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.V2.Bw("("),"stream"===(i=this.V2.next()).toLowerCase()&&(r.h3=!0,i=this.V2.next()),r.response=i,this.V2.Bw(")"),"{"===(i=this.V2.aj())){for(this.V2.next();"}"!==(i=this.V2.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this.z2(r)}this.V2.Q2(";")}else this.V2.Bw(";");void 0===t.r3&&(t.r3={}),t.r3[n]=r},e.X2=function(t,i){var n=!!i,r=this.V2.next(),s={name:"",fields:[],Y2:[],messages:[],options:{},o3:{}};if(!h.$j.test(r))throw Error("illegal "+(n?"group":"message")+" name: "+r);for(s.name=r,n&&(this.V2.Bw("="),i.id=o(this.V2.next()),s.u3=!0),"["===(r=this.V2.aj())&&i&&this.a3(i),this.V2.Bw("{");"}"!==(r=this.V2.next());)if(h.R2.test(r))this.f3(s,r);else if("oneof"===r)this.c3(s);else if("enum"===r)this.J2(s);else if("message"===r)this.X2(s);else if("option"===r)this.z2(s);else if("extensions"===r)this.l3(s);else if("extend"===r)this.t3(s);else{if(!h._2.test(r))throw Error("illegal message token: "+r);if(!this.q2)throw Error("illegal field rule: "+r);this.f3(s,"optional",r)}return this.V2.Q2(";"),t.messages.push(s),s},e.f3=function(t,i,n){if(!h.R2.test(i))throw Error("illegal message field rule: "+i);var r,s={rule:i,type:"",name:"",options:{},id:0};if("map"===i){if(n)throw Error("illegal type: "+n);if(this.V2.Bw("<"),r=this.V2.next(),!h.iP.test(r)&&!h._2.test(r))throw Error("illegal message field type: "+r);if(s.keytype=r,this.V2.Bw(","),r=this.V2.next(),!h.iP.test(r)&&!h._2.test(r))throw Error("illegal message field: "+r);if(s.type=r,this.V2.Bw(">"),r=this.V2.next(),!h.$j.test(r))throw Error("illegal message field name: "+r);s.name=r,this.V2.Bw("="),s.id=o(this.V2.next()),"["===(r=this.V2.aj())&&this.a3(s),this.V2.Bw(";")}else if("group"===(n=void 0!==n?n:this.V2.next())){var e=this.X2(t,s);if(!/^[A-Z]/.test(e.name))throw Error("illegal group name: "+e.name);s.type=e.name,s.name=e.name.toLowerCase(),this.V2.Q2(";")}else{if(!h.iP.test(n)&&!h._2.test(n))throw Error("illegal message field type: "+n);if(s.type=n,r=this.V2.next(),!h.$j.test(r))throw Error("illegal message field name: "+r);s.name=r,this.V2.Bw("="),s.id=o(this.V2.next()),"["===(r=this.V2.aj())&&this.a3(s),this.V2.Bw(";")}return t.fields.push(s),s},e.c3=function(t){var i=this.V2.next();if(!h.$j.test(i))throw Error("illegal oneof name: "+i);var n,r=i,s=[];for(this.V2.Bw("{");"}"!==(i=this.V2.next());)(n=this.f3(t,"optional",i)).v3=r,s.push(n.id);this.V2.Q2(";"),t.o3[r]=s},e.a3=function(t){this.V2.Bw("[");for(var i=!0;"]"!==this.V2.aj();)i||this.V2.Bw(","),this.z2(t,!0),i=!1;this.V2.next()},e.J2=function(t){var i={name:"",values:[],options:{}},n=this.V2.next();if(!h.$j.test(n))throw Error("illegal name: "+n);for(i.name=n,this.V2.Bw("{");"}"!==(n=this.V2.next());)if("option"===n)this.z2(i);else{if(!h.$j.test(n))throw Error("illegal name: "+n);this.V2.Bw("=");var r={name:n,id:o(this.V2.next(),!0)};"["===(n=this.V2.aj())&&this.a3({options:{}}),this.V2.Bw(";"),i.values.push(r)}this.V2.Q2(";"),t.Y2.push(i)},e.l3=function(t){var i=this.V2.next(),n=[];"min"===i?n.push(r.l2):"max"===i?n.push(r.v2):n.push(u(i)),this.V2.Bw("to"),"min"===(i=this.V2.next())?n.push(r.l2):"max"===i?n.push(r.v2):n.push(u(i)),this.V2.Bw(";"),t.extensions=n},e.t3=function(t){var i=this.V2.next();if(!h._2.test(i))throw Error("illegal extend reference: "+i);var n={kY:i,fields:[]};for(this.V2.Bw("{");"}"!==(i=this.V2.next());)if(h.R2.test(i))this.f3(n,i);else{if(!h._2.test(i))throw Error("illegal extend token: "+i);if(!this.q2)throw Error("illegal field rule: "+i);this.f3(n,"optional",i)}return this.V2.Q2(";"),t.messages.push(n),n},e.toString=function(){return"Parser at line "+this.V2.line},t.JZ=s,t}(s,s.Lang),s.Reflect=function(E){function f(t,i,n){this.d3=t,this.parent=i,this.name=n,this.className}var h={},t=f.prototype;function o(t,i,n,r,s){f.call(this,t,i,n),this.className="Namespace",this.children=[],this.options=r||{},this.K2=s||"proto2"}t.E3=function(){for(var t=this.name,i=this;null!=(i=i.parent);)t=i.name+"."+t;return t},t.toString=function(t){return(t?this.className+" ":"")+this.E3()},t.Wv=function(){throw Error(this.toString(!0)+" cannot be built directly")},h.w3=f;var i=o.prototype=Object.create(f.prototype);function c(t,i,n,r){if(this.type=t,this.g3=i,this.b3=n,this.K2=r,n&&E.c2.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)}i.y3=function(t){if(null==(t=t||null))return this.children.slice();for(var i=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof t&&i.push(this.children[n]);return i},i.T3=function(t){var i;if(i=this.m3(t.name))if(i instanceof l.O3&&i.name!==i.S3&&null===this.m3(i.S3))i.name=i.S3;else{if(!(t instanceof l.O3&&t.name!==t.S3&&null===this.m3(t.S3)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.S3}this.children.push(t)},i.m3=function(t){for(var i="number"==typeof t?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][i]===t)return this.children[n];return null},i.resolve=function(t,i){var n,r="string"==typeof t?t.split("."):t,s=this,e=0;if(""===r[e]){for(;null!==s.parent;)s=s.parent;e++}do{do{if(!(s instanceof h.R3)){s=null;break}if(!(n=s.m3(r[e]))||!(n instanceof h.w3)||i&&!(n instanceof h.R3)){s=null;break}s=n,e++}while(e<r.length);if(null!=s)break;if(null!==this.parent)return this.parent.resolve(t,i)}while(null!=s);return s},i.I3=function(t){for(var i=[],n=t;i.unshift(n.name),null!==(n=n.parent););for(var r=1;r<=i.length;r++){var s=i.slice(i.length-r);if(t===this.resolve(s,t instanceof h.R3))return s.join(".")}return t.E3()},i.Wv=function(){for(var t,i={},n=this.children,r=0,s=n.length;r<s;++r)(t=n[r])instanceof o&&(i[t.name]=t.Wv());return Object.defineProperty&&Object.defineProperty(i,"_3",{value:this.A3()}),i},i.A3=function(){for(var t={},i=Object.keys(this.options),n=0,r=i.length;n<r;++n){var s=i[n],e=this.options[i[n]];t[s]=e}return t},i.N3=function(t){return void 0===t?this.options:void 0!==this.options[t]?this.options[t]:null},h.R3=o;var n=c.prototype;function e(t,i){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.MN&&t.low==t.low&&t.high==t.high)return new E._A(t.low,t.high,void 0===i?t.MN:i);if("string"==typeof t)return E._A.rO(t,i||!1,10);if("number"==typeof t)return E._A.nO(t,i||!1);throw Error("not convertible to Long")}c.C3=function(t){if("string"==typeof t&&(t=E.u2[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==E.u2.bytes?new T(0):t.defaultValue},n.D3=function(i){var n=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);switch(this.type){case E.u2.int32:case E.u2.sint32:case E.u2.sfixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),4294967295<i?0|i:i;case E.u2.uint32:case E.u2.fixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case E.u2.int64:case E.u2.sint64:case E.u2.sfixed64:if(E._A)try{return e(i,!1)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.u2.uint64:case E.u2.fixed64:if(E._A)try{return e(i,!0)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.u2.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case E.u2.float:case E.u2.double:return"number"!=typeof i&&n(typeof i,"not a number"),i;case E.u2.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case E.u2.bytes:return T.kA(i)?i:T.wrap(i,"base64");case E.u2.enum:var t=this.g3.y3(E.Reflect.j3.M3);for(s=0;s<t.length;s++){if(t[s].name==i)return t[s].id;if(t[s].id==i)return t[s].id}if("proto3"===this.K2)return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),(4294967295<i||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case E.u2.group:case E.u2.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.g3.P3)return i;if(i instanceof E.H3.hl){var r={};for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);i=r}return new this.g3.P3(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},n.L3=function(t,i){if(null===i)return 0;var n;switch(this.type){case E.u2.int32:return i<0?T.NN(i):T.yN(i);case E.u2.uint32:return T.yN(i);case E.u2.sint32:return T.yN(T.TN(i));case E.u2.fixed32:case E.u2.sfixed32:case E.u2.float:return 4;case E.u2.int64:case E.u2.uint64:return T.NN(i);case E.u2.sint64:return T.NN(T.DN(i));case E.u2.fixed64:case E.u2.sfixed64:return 8;case E.u2.bool:return 1;case E.u2.enum:return T.yN(i);case E.u2.double:return 8;case E.u2.string:return n=T.JN(i),T.yN(n)+n;case E.u2.bytes:if(i.vC()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.vC()+" bytes remaining");return T.yN(i.vC())+i.vC();case E.u2.message:return n=this.g3.U3(i),T.yN(n)+n;case E.u2.group:return(n=this.g3.U3(i))+T.yN(t<<3|E.Z1.e2)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")},n.F3=function(t,i,n){if(null===i)return n;switch(this.type){case E.u2.int32:i<0?n.UN(i):n.ON(i);break;case E.u2.uint32:n.ON(i);break;case E.u2.sint32:n.SN(i);break;case E.u2.fixed32:n.iN(i);break;case E.u2.sfixed32:n.ZA(i);break;case E.u2.int64:case E.u2.uint64:n.UN(i);break;case E.u2.sint64:n.FN(i);break;case E.u2.fixed64:n.aN(i);break;case E.u2.sfixed64:n.eN(i);break;case E.u2.bool:"string"==typeof i?n.ON("false"===i.toLowerCase()?0:!!i):n.ON(i?1:0);break;case E.u2.enum:n.ON(i);break;case E.u2.float:n.vN(i);break;case E.u2.double:n.wN(i);break;case E.u2.string:n.nC(i);break;case E.u2.bytes:if(i.vC()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.vC()+" bytes remaining");var r=i.offset;n.ON(i.vC()),n.append(i),i.offset=r;break;case E.u2.message:var s=(new T).uC();this.g3.encode(i,s),n.ON(s.offset),n.append(s.Dv());break;case E.u2.group:this.g3.encode(i,n),n.ON(t<<3|E.Z1.e2);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")}return n},n.decode=function(t,i,n){if(i!=this.type.a2)throw Error("Unexpected wire type for element");var r,s;switch(this.type){case E.u2.int32:return 0|t.RN();case E.u2.uint32:return t.RN()>>>0;case E.u2.sint32:return 0|t._N();case E.u2.fixed32:return t.rN()>>>0;case E.u2.sfixed32:return 0|t.tN();case E.u2.int64:return t.GN();case E.u2.uint64:return t.GN().PN();case E.u2.sint64:return t.xN();case E.u2.fixed64:return t.cN();case E.u2.sfixed64:return t.oN();case E.u2.bool:return!!t.RN();case E.u2.enum:return t.RN();case E.u2.float:return t.pN();case E.u2.double:return t.pb();case E.u2.string:return t.rC();case E.u2.bytes:if(s=t.RN(),t.vC()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+t.vC());return(r=t.clone()).mA=r.offset+s,t.offset+=s,r;case E.u2.message:return s=t.RN(),this.g3.decode(t,s);case E.u2.group:return this.g3.decode(t,-1,n)}throw Error("[INTERNAL] Illegal decode type")},n.G3=function(t){if(!this.b3)throw Error("valueFromString() called on non-map-key element");switch(this.type){case E.u2.int32:case E.u2.sint32:case E.u2.sfixed32:case E.u2.uint32:case E.u2.fixed32:return this.D3(parseInt(t));case E.u2.int64:case E.u2.sint64:case E.u2.sfixed64:case E.u2.uint64:case E.u2.fixed64:return this.D3(t);case E.u2.bool:return"true"===t;case E.u2.string:return this.D3(t);case E.u2.bytes:return T.jA(t)}},n.x3=function(t){if(!this.b3)throw Error("valueToString() called on non-map-key element");return this.type===E.u2.bytes?t.toString("binary"):t.toString()},h.Element=c;var l=function(t,i,n,r,s,e){o.call(this,t,i,n,r,e),this.className="Message",this.extensions=[E.l2,E.v2],this.P3=null,this.u3=!!s,this.B3=null,this.V3=null,this.q3=null},r=l.prototype=Object.create(o.prototype);function p(t,i){var n=i.RN(),r=7&n,s=n>>>3;switch(r){case E.Z1.t2:for(;128==(128&(n=i.VA())););break;case E.Z1.i2:i.offset+=8;break;case E.Z1.n2:n=i.RN(),i.offset+=n;break;case E.Z1.s2:p(s,i);break;case E.Z1.e2:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case E.Z1.h2:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+r)}return!0}function u(t,i,n,r,s,e,h,o,u,a){f.call(this,t,i,e),this.className="Message.Field",this.required="required"===n,this.repeated="repeated"===n,this.map="map"===n,this.Q3=r||null,this.type=s,this.g3=null,this.id=h,this.options=o||{},this.defaultValue=null,this.v3=u||null,this.K2=a||"proto2",this.S3=this.name,this.W3=null,this.Y3=null,!this.d3.options.d2||this instanceof l.K3||(this.name=E.RR.O2(this.name))}r.Wv=function(t){if(this.P3&&!t)return this.P3;var i=function(c,h){var o=h.y3(c.Reflect.hl.O3),u=h.y3(c.Reflect.hl.X3),a=function(t,i){c.H3.hl.call(this);for(var n=0,r=u.length;n<r;++n)this[u[n].name]=null;for(n=0,r=o.length;n<r;++n){var s=o[n];this[s.name]=s.repeated?[]:s.map?new c.Map(s):null,!s.required&&"proto3"!==h.K2||null===s.defaultValue||(this[s.name]=s.defaultValue)}var e;if(0<arguments.length)if(1!==arguments.length||null===t||"object"!=typeof t||!("function"!=typeof t.encode||t instanceof a)||Array.isArray(t)||t instanceof c.Map||T.kA(t)||t instanceof ArrayBuffer||c._A&&t instanceof c._A)for(n=0,r=arguments.length;n<r;++n)void 0!==(e=arguments[n])&&this.J3(o[n].name,e);else this.J3(t)},e=a.prototype=Object.create(c.H3.hl.prototype);e.add=function(t,i,n){var r=h.q3[t];if(!n){if(!r)throw Error(this+"#"+t+" is undefined");if(!(r instanceof c.Reflect.hl.O3))throw Error(this+"#"+t+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+t+" is not a repeated field");i=r.D3(i,!0)}return null===this[t]&&(this[t]=[]),this[t].push(i),this},e.z3=e.add,e.set=function(t,i,n){if(t&&"object"==typeof t){for(var r in n=i,t)t.hasOwnProperty(r)&&void 0!==(i=t[r])&&this.J3(r,i,n);return this}var s=h.q3[t];if(n)this[t]=i;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof c.Reflect.hl.O3))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=i=s.D3(i)}if(s&&s.v3){var e=this[s.v3.name];null!==i?(null!==e&&e!==s.name&&(this[e]=null),this[s.v3.name]=s.name):e===t&&(this[s.v3.name]=null)}return this},e.J3=e.set,e.get=function(t,i){if(i)return this[t];var n=h.q3[t];if(!(n&&n instanceof c.Reflect.hl.O3))throw Error(this+"#"+t+" is not a field: undefined");if(!(n instanceof c.Reflect.hl.O3))throw Error(this+"#"+t+" is not a field: "+n.toString(!0));return this[n.name]},e.Z3=e.get;for(var t=0;t<o.length;t++){var i=o[t];i instanceof c.Reflect.hl.K3||h.d3.options.E2&&function(n){var t=n.S3.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});function i(t,i){return this[n.name]=i?t:n.D3(t),this}function r(){return this[n.name]}t=t.substring(0,1).toUpperCase()+t.substring(1);var s=n.S3.replace(/([A-Z])/g,function(t){return"_"+t});null===h.m3("set"+t)&&(e["set"+t]=i),null===h.m3("set_"+s)&&(e["set_"+s]=i),null===h.m3("get"+t)&&(e["get"+t]=r),null===h.m3("get_"+s)&&(e["get_"+s]=r)}(i)}function l(t,n,r,s){if(null===t||"object"!=typeof t){if(s&&s instanceof c.Reflect.j3){var i=c.Reflect.j3.getName(s.object,t);if(null!==i)return i}return t}if(T.kA(t))return n?t.pC():t.dC();if(c._A.t4(t))return r?t.toString():c._A.i4(t);var e;if(Array.isArray(t))return e=[],t.forEach(function(t,i){e[i]=l(t,n,r,s)}),e;if(e={},t instanceof c.Map){for(var h=t.entries(),o=h.next();!o.done;o=h.next())e[t.n4.x3(o.value[0])]=l(o.value[1],n,r,t.r4.g3);return e}var u=t.s4,a=void 0;for(var f in t)t.hasOwnProperty(f)&&(u&&(a=u.m3(f))?e[f]=l(t[f],n,r,a.g3):e[f]=l(t[f],n,r));return e}return e.encode=function(i,t){"boolean"==typeof i&&(t=i,i=void 0);var n=!1;i||(i=new T,n=!0);var r=i.OA;try{return h.encode(this,i.uC(),t),(n?i.Dv():i).uC(r)}catch(t){throw i.uC(r),t}},a.encode=function(t,i,n){return new a(t).encode(i,n)},e.U3=function(){return h.U3(this)},e.e4=function(t){var i=!1;t||(t=new T,i=!0);var n=(new T).uC();return h.encode(this,n).Dv(),t.ON(n.vC()),t.append(n),i?t.Dv():t},e.h4=function(){try{return this.encode().Ma()}catch(t){throw t.o4&&(t.o4=t.o4.Ma()),t}},e.Ma=e.h4,e.u4=function(){try{return this.encode().dC()}catch(t){throw t.o4&&(t.o4=t.o4.dC()),t}},e.dC=e.u4,e.a4=function(){try{return this.encode().pC()}catch(t){throw t.o4&&(t.o4=t.o4.pC()),t}},e.pC=e.a4,e.f4=function(){try{return this.encode().wC()}catch(t){throw t.o4&&(t.o4=t.o4.wC()),t}},e.wC=e.f4,e.c4=function(t,i){return l(this,!!t,!!i,this.s4)},e.l4=function(){return JSON.stringify(l(this,!0,!0,this.s4))},a.decode=function(i,t){"string"==typeof i&&(i=T.wrap(i,t||"base64"));var n=(i=T.kA(i)?i:T.wrap(i)).OA;try{var r=h.decode(i.uC());return i.uC(n),r}catch(t){throw i.uC(n),t}},a.v4=function(i,t){if("string"==typeof i&&(i=T.wrap(i,t||"base64")),(i=T.kA(i)?i:T.wrap(i)).vC()<1)return null;var n=i.offset,r=i.RN();if(i.vC()<r)return i.offset=n,null;try{var s=h.decode(i.slice(i.offset,i.offset+r).uC());return i.offset+=r,s}catch(t){throw i.offset+=r,t}},a.d4=function(t){return a.decode(t,"base64")},a.E4=function(t){return a.decode(t,"hex")},a.w4=function(t){return new a(JSON.parse(t))},e.toString=function(){return h.toString()},Object.defineProperty&&(Object.defineProperty(a,"_3",{value:h.A3()}),Object.defineProperty(e,"_3",{value:a._3}),Object.defineProperty(a,"s4",{value:h}),Object.defineProperty(e,"s4",{value:h})),a}(E,this);this.B3=[],this.V3={},this.q3={};for(var n,r=0,s=this.children.length;r<s;r++)if((n=this.children[r])instanceof v||n instanceof l||n instanceof g){if(i.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");i[n.name]=n.Wv()}else if(n instanceof l.O3)n.Wv(),this.B3.push(n),this.V3[n.id]=n,this.q3[n.name]=n;else if(!(n instanceof l.X3||n instanceof w))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[r].toString(!0));return this.P3=i},r.encode=function(t,i,n){for(var r,s,e=null,h=0,o=this.B3.length;h<o;++h)s=t[(r=this.B3[h]).name],r.required&&null===s?null===e&&(e=r):r.encode(n?s:r.D3(s),i,t);if(null===e)return i;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+e);throw u.o4=i,u},r.U3=function(t){for(var i,n,r=0,s=0,e=this.B3.length;s<e;++s){if(n=t[(i=this.B3[s]).name],i.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+i);r+=i.U3(n,t)}return r},r.decode=function(t,i,n){i="number"==typeof i?i:-1;for(var r,s,e,h,o=t.offset,u=new this.P3;t.offset<o+i||-1===i&&0<t.vC();){if(e=(r=t.RN())>>>3,(s=7&r)===E.Z1.e2){if(e!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+e+" ("+(n?n+" expected":"not a group")+")");break}if(h=this.V3[e]){if(h.repeated&&!h.options.g4)u[h.name].push(h.decode(s,t));else if(h.map){var a=h.decode(s,t);u[h.name].set(a[0],a[1])}else if(u[h.name]=h.decode(s,t),h.v3){var f=u[h.v3.name];null!==f&&f!==h.name&&(u[f]=null),u[h.v3.name]=h.name}}else switch(s){case E.Z1.t2:t.RN();break;case E.Z1.h2:t.offset+=4;break;case E.Z1.i2:t.offset+=8;break;case E.Z1.n2:var c=t.RN();t.offset+=c;break;case E.Z1.s2:for(;p(e,t););break;default:throw Error("Illegal wire type for unknown field "+e+" in "+this.toString(!0)+"#decode: "+s)}}for(var l=0,v=this.B3.length;l<v;++l)if(null===u[(h=this.B3[l]).name])if("proto3"===this.K2)u[h.name]=h.defaultValue;else{if(h.required){var d=Error("Missing at least one required field for "+this.toString(!0)+": "+h.name);throw d.b4=u,d}E.w2&&null!==h.defaultValue&&(u[h.name]=h.defaultValue)}return u},h.hl=l;var s=u.prototype=Object.create(f.prototype);function a(t,i,n,r,s,e,h){u.call(this,t,i,n,null,r,s,e,h),this.y4}s.Wv=function(){this.W3=new c(this.type,this.g3,!1,this.K2),this.map&&(this.Y3=new c(this.Q3,void 0,!0,this.K2)),"proto3"!==this.K2||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.D3(this.options.default)):this.defaultValue=c.C3(this.type)},s.D3=function(t,i){i=i||!1;var n,r=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);if(null===t)return this.required&&r(typeof t,"required"),"proto3"===this.K2&&this.type!==E.u2.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(!this.repeated||i)return this.map&&!i?t instanceof E.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new E.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.W3.D3(t));Array.isArray(t)||(t=[t]);var s=[];for(n=0;n<t.length;n++)s.push(this.W3.D3(t[n]));return s},s.T4=function(t,i){if("proto3"!==this.K2)return null!==t;if(this.v3&&i[this.v3.name]===this.name)return!0;switch(this.type){case E.u2.int32:case E.u2.sint32:case E.u2.sfixed32:case E.u2.uint32:case E.u2.fixed32:return 0!==t;case E.u2.int64:case E.u2.sint64:case E.u2.sfixed64:case E.u2.uint64:case E.u2.fixed64:return 0!==t.low||0!==t.high;case E.u2.bool:return t;case E.u2.float:case E.u2.double:return 0!==t;case E.u2.string:return 0<t.length;case E.u2.bytes:return 0<t.vC();case E.u2.enum:return 0!==t;case E.u2.message:return null!==t;default:return!0}},s.encode=function(i,s,t){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return s;try{var n;if(this.repeated)if(this.options.g4&&0<=E.o2.indexOf(this.type.a2)){s.ON(this.id<<3|E.Z1.n2),s.oC(s.offset+=1);var r=s.offset;for(n=0;n<i.length;n++)this.W3.F3(this.id,i[n],s);var e=s.offset-r,h=T.yN(e);if(1<h){var o=s.slice(r,s.offset);r+=h-1,s.offset=r,s.append(o)}s.ON(e,r-h)}else for(n=0;n<i.length;n++)s.ON(this.id<<3|this.type.a2),this.W3.F3(this.id,i[n],s);else this.map?i.forEach(function(t,i,n){var r=T.yN(8|this.Q3.a2)+this.Y3.L3(1,i)+T.yN(16|this.type.a2)+this.W3.L3(2,t);s.ON(this.id<<3|E.Z1.n2),s.ON(r),s.ON(8|this.Q3.a2),this.Y3.F3(1,i,s),s.ON(16|this.type.a2),this.W3.F3(2,t,s)},this):this.T4(i,t)&&(s.ON(this.id<<3|this.type.a2),this.W3.F3(this.id,i,s))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.U3=function(i,t){if(i=this.D3(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var s=0;try{var n,r;if(this.repeated)if(this.options.g4&&0<=E.o2.indexOf(this.type.a2)){for(s+=T.yN(this.id<<3|E.Z1.n2),n=r=0;n<i.length;n++)r+=this.W3.L3(this.id,i[n]);s+=T.yN(r),s+=r}else for(n=0;n<i.length;n++)s+=T.yN(this.id<<3|this.type.a2),s+=this.W3.L3(this.id,i[n]);else this.map?i.forEach(function(t,i,n){var r=T.yN(8|this.Q3.a2)+this.Y3.L3(1,i)+T.yN(16|this.type.a2)+this.W3.L3(2,t);s+=T.yN(this.id<<3|E.Z1.n2),s+=T.yN(r),s+=r},this):this.T4(i,t)&&(s+=T.yN(this.id<<3|this.type.a2),s+=this.W3.L3(this.id,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.decode=function(t,i,n){var r,s;if(!(!this.map&&t==this.type.a2||!n&&this.repeated&&this.options.g4&&t==E.Z1.n2||this.map&&t==E.Z1.n2))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.a2+" expected)");if(t==E.Z1.n2&&this.repeated&&this.options.g4&&0<=E.o2.indexOf(this.type.a2)&&!n){s=i.RN(),s=i.offset+s;for(var e=[];i.offset<s;)e.push(this.decode(this.type.a2,i,!0));return e}if(this.map){var h=c.C3(this.Q3);if(r=c.C3(this.type),s=i.RN(),i.vC()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.vC());var o=i.clone();for(o.mA=o.offset+s,i.offset+=s;0<o.vC();){var u=o.RN();t=7&u;var a=u>>>3;if(1==a)h=this.Y3.decode(o,t,a);else{if(2!=a)throw Error("Unexpected tag in map field key/value submessage");r=this.W3.decode(o,t,a)}}return[h,r]}return this.W3.decode(i,t,this.id)},h.hl.O3=u,a.prototype=Object.create(u.prototype),h.hl.K3=a,h.hl.X3=function(t,i,n){f.call(this,t,i,n),this.fields=[]};var v=function(t,i,n,r,s){o.call(this,t,i,n,r,s),this.className="Enum",this.object=null};function d(t,i,n,r){f.call(this,t,i,n),this.className="Enum.Value",this.id=r}v.getName=function(t,i){for(var n,r=Object.keys(t),s=0;s<r.length;++s)if(t[n=r[s]]===i)return n;return null},(v.prototype=Object.create(o.prototype)).Wv=function(t){if(this.object&&!t)return this.object;for(var i=new E.H3.j3,n=this.y3(v.M3),r=0,s=n.length;r<s;++r)i[n[r].name]=n[r].id;return Object.defineProperty&&Object.defineProperty(i,"_3",{value:this.A3(),enumerable:!1}),this.object=i},h.j3=v,d.prototype=Object.create(f.prototype),h.j3.M3=d;var w=function(t,i,n,r){f.call(this,t,i,n),this.m4=r};w.prototype=Object.create(f.prototype),h.O4=w;var g=function(t,i,n,r){o.call(this,t,i,n,r),this.className="Service",this.P3=null};function b(t,i,n,r){f.call(this,t,i,n),this.className="Service.Method",this.options=r||{}}function y(t,i,n,r,s,e,h,o){b.call(this,t,i,n,o),this.className="Service.RPCMethod",this.S4=r,this.R4=s,this.I4=e,this._4=h,this.A4=null,this.N4=null}return(g.prototype=Object.create(o.prototype)).Wv=function(t){return this.P3&&!t?this.P3:this.P3=function(i,s){for(var e=function(t){i.H3.C4.call(this),this.D4=t||function(t,i,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},t=e.prototype=Object.create(i.H3.C4.prototype),n=s.y3(i.Reflect.C4.M4),r=0;r<n.length;r++)!function(r){t[r.name]=function(t,n){try{try{t=r.A4.P3.decode(T.wrap(t))}catch(t){if(!(t instanceof TypeError))throw t}if(null===t||"object"!=typeof t)throw Error("Illegal arguments");t instanceof r.A4.P3||(t=new r.A4.P3(t)),this.D4(r.E3(),t,function(t,i){if(t)n(t);else{try{i=r.N4.P3.decode(i)}catch(t){}i&&i instanceof r.N4.P3?n(null,i):n(Error("Illegal response type received in service method "+s.name+"#"+r.name))}})}catch(t){setTimeout(n.bind(this,t),0)}},e[r.name]=function(t,i,n){new e(t)[r.name](i,n)},Object.defineProperty&&(Object.defineProperty(e[r.name],"_3",{value:r.A3()}),Object.defineProperty(t[r.name],"_3",{value:e[r.name]._3}))}(n[r]);return Object.defineProperty&&(Object.defineProperty(e,"_3",{value:s.A3()}),Object.defineProperty(t,"_3",{value:e._3}),Object.defineProperty(e,"s4",{value:s}),Object.defineProperty(t,"s4",{value:s})),e}(E,this)},h.C4=g,(b.prototype=Object.create(f.prototype)).A3=i.A3,h.C4.j4=b,y.prototype=Object.create(b.prototype),h.C4.M4=y,h}(s),s.H3=function(c,i,h){function o(t){this.P4=new h.R3(this,null,""),this.H4=this.P4,this.L4=!1,this.result=null,this.files={},this.U4=null,this.options=t||{}}var t=o.prototype;return o.F4=function(t){return"string"==typeof t.name&&void 0===t.values&&void 0===t.r3},o.G4=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&void 0!==t.id},o.x4=function(t){return"string"==typeof t.name&&!(void 0===t.values||!Array.isArray(t.values)||0===t.values.length)},o.B4=function(t){return!("string"!=typeof t.name||"object"!=typeof t.r3||!t.r3)},o.V4=function(t){return"string"==typeof t.kY},t.reset=function(){return this.H4=this.P4,this},t.define=function(t){if("string"!=typeof t||!i._2.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var i=this.H4.m3(t);null===i&&this.H4.T3(i=new h.R3(this,this.H4,t)),this.H4=i},this),this},t.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];0<i.length;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;0<t.length;){var n=t.shift();if(o.F4(n)){var s=new h.hl(this,this.H4,n.name,n.options,n.u3,n.K2),r={};n.o3&&Object.keys(n.o3).forEach(function(t){s.T3(r[t]=new h.hl.X3(this,s,t))},this),n.fields&&n.fields.forEach(function(t){if(null!==s.m3(0|t.id))throw Error("duplicate or invalid field id in "+s.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+s.name+"#"+t.name);var i=null;if("string"==typeof t.v3&&!(i=r[t.v3]))throw Error("illegal oneof in "+s.name+"#"+t.name+": "+t.v3);t=new h.hl.O3(this,s,t.rule,t.keytype,t.type,t.name,t.id,t.options,i,n.K2),i&&i.fields.push(t),s.T3(t)},this);var e=[];if(n.Y2&&n.Y2.forEach(function(t){e.push(t)}),n.messages&&n.messages.forEach(function(t){e.push(t)}),n.services&&n.services.forEach(function(t){e.push(t)}),n.extensions&&(s.extensions=n.extensions,s.extensions[0]<c.l2&&(s.extensions[0]=c.l2),s.extensions[1]>c.v2&&(s.extensions[1]=c.v2)),this.H4.T3(s),0<e.length){i.push(t),t=e,e=null,this.H4=s,s=null;continue}e=null}else if(o.x4(n))s=new h.j3(this,this.H4,n.name,n.options,n.K2),n.values.forEach(function(t){s.T3(new h.j3.M3(this,s,t.name,t.id))},this),this.H4.T3(s);else if(o.B4(n))s=new h.C4(this,this.H4,n.name,n.options),Object.keys(n.r3).forEach(function(t){var i=n.r3[t];s.T3(new h.C4.M4(this,s,t,i.request,i.response,!!i.e3,!!i.h3,i.options))},this),this.H4.T3(s);else{if(!o.V4(n))throw Error("not a valid definition: "+JSON.stringify(n));if(s=this.H4.resolve(n.kY,!0))n.fields.forEach(function(t){if(null!==s.m3(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(t.id<s.extensions[0]||t.id>s.extensions[1])throw Error("illegal extended field id in "+s.name+": "+t.id+" ("+s.extensions.join(" to ")+" expected)");var i=t.name;this.options.d2&&(i=c.RR.O2(i));var n=new h.hl.K3(this,s,t.rule,t.type,this.H4.E3()+"."+i,t.id,t.options),r=new h.O4(this,this.H4,t.name,n);n.y4=r,this.H4.T3(r),s.T3(n)},this);else if(!/\.?google\.protobuf\./.test(n.kY))throw Error("extended message "+n.kY+" is not defined")}s=n=null}t=null,this.H4=this.H4.parent}return this.L4=!1,this.result=null,this},t.import=function(i,t){var n="/";if("string"==typeof t){if(c.RR.g2&&(t=l(94).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"==typeof t){var r=t.root;c.RR.g2&&(r=l(94).resolve(r)),(0<=r.indexOf("\\")||0<=t.q4.indexOf("\\"))&&(n="\\");var s=r+n+t.q4;if(!0===this.files[s])return this.reset();this.files[s]=!0}if(i.imports&&0<i.imports.length){var e,h=!1;"object"==typeof t?(this.U4=t.root,h=!0,e=this.U4,t=t.q4,(0<=e.indexOf("\\")||0<=t.indexOf("\\"))&&(n="\\")):"string"==typeof t?this.U4?e=this.U4:0<=t.indexOf("/")?""===(e=t.replace(/\/[^\/]*$/,""))&&(e="/"):0<=t.indexOf("\\")?(e=t.replace(/\\[^\\]*$/,""),n="\\"):e=".":e=null;for(var o=0;o<i.imports.length;o++)if("string"==typeof i.imports[o]){if(!e)throw Error("cannot determine import root");var u=i.imports[o];if("google/protobuf/descriptor.proto"===u)continue;if(u=e+n+u,!0===this.files[u])continue;/\.proto$/i.test(u)&&!c.G2&&(u=u.replace(/\.proto$/,".json"));var a=c.RR.fetch(u);if(null===a)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(a+""),u):this.import(c.G2.JZ.parse(a),u)}else t?/\.(\w+)$/.test(t)?this.import(i.imports[o],t.replace(/^(.+)\.(\w+)$/,function(t,i,n){return i+"_import"+o+"."+n})):this.import(i.imports[o],t+"_import"+o):this.import(i.imports[o]);h&&(this.U4=null)}i.package&&this.define(i.package),i.K2&&function i(n){n.messages&&n.messages.forEach(function(t){t.K2=n.K2,i(t)}),n.Y2&&n.Y2.forEach(function(t){t.K2=n.K2})}(i);var f=this.H4;return i.options&&Object.keys(i.options).forEach(function(t){f.options[t]=i.options[t]}),i.messages&&(this.create(i.messages),this.H4=f),i.Y2&&(this.create(i.Y2),this.H4=f),i.services&&(this.create(i.services),this.H4=f),i.Q4&&this.create(i.Q4),this.reset()},t.W4=function(){var t;if(null==this.H4||"object"==typeof this.H4.type)return this;if(this.H4 instanceof h.R3)this.H4.children.forEach(function(t){this.H4=t,this.W4()},this);else if(this.H4 instanceof h.hl.O3){if(i.iP.test(this.H4.type))this.H4.type=c.u2[this.H4.type];else{if(!i._2.test(this.H4.type))throw Error("illegal type reference in "+this.H4.toString(!0)+": "+this.H4.type);if(!(t=(this.H4 instanceof h.hl.K3?this.H4.y4.parent:this.H4.parent).resolve(this.H4.type,!0)))throw Error("unresolvable type reference in "+this.H4.toString(!0)+": "+this.H4.type);if((this.H4.g3=t)instanceof h.j3){if(this.H4.type=c.u2.enum,"proto3"===this.H4.K2&&"proto3"!==t.K2)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof h.hl))throw Error("illegal type reference in "+this.H4.toString(!0)+": "+this.H4.type);this.H4.type=t.u3?c.u2.group:c.u2.message}}if(this.H4.map){if(!i.iP.test(this.H4.Q3))throw Error("illegal key type for map field in "+this.H4.toString(!0)+": "+this.H4.Q3);this.H4.Q3=c.u2[this.H4.Q3]}}else if(this.H4 instanceof c.Reflect.C4.j4){if(!(this.H4 instanceof c.Reflect.C4.M4))throw Error("illegal service type in "+this.H4.toString(!0));if(!((t=this.H4.parent.resolve(this.H4.S4,!0))&&t instanceof c.Reflect.hl))throw Error("Illegal type reference in "+this.H4.toString(!0)+": "+this.H4.S4);if(this.H4.A4=t,!((t=this.H4.parent.resolve(this.H4.R4,!0))&&t instanceof c.Reflect.hl))throw Error("Illegal type reference in "+this.H4.toString(!0)+": "+this.H4.R4);this.H4.N4=t}else if(!(this.H4 instanceof c.Reflect.hl.X3||this.H4 instanceof c.Reflect.O4||this.H4 instanceof c.Reflect.j3.M3))throw Error("illegal object in namespace: "+typeof this.H4+": "+this.H4);return this.reset()},t.Wv=function(t){if(this.reset(),this.L4||(this.W4(),this.L4=!0,this.result=null),null===this.result&&(this.result=this.P4.Wv()),!t)return this.result;for(var i="string"==typeof t?t.split("."):t,n=this.result,r=0;r<i.length;r++){if(!n[i[r]]){n=null;break}n=n[i[r]]}return n},t.Y4=function(t,i){return t?this.P4.resolve(t,i):this.P4},t.toString=function(){return"Builder"},o.hl=function(){},o.j3=function(){},o.C4=function(){},o}(s,s.Lang,s.Reflect),s.Map=function(t,h){function i(t,i){if(!t.map)throw Error("field is not a map");if(this.m4=t,this.n4=new h.Element(t.Q3,null,!0,t.K2),this.r4=new h.Element(t.type,t.g3,!1,t.K2),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var n=Object.keys(i),r=0;r<n.length;r++){var s=this.n4.G3(n[r]),e=this.r4.D3(i[n[r]]);this.map[this.n4.x3(s)]={key:s,value:e}}}var n=i.prototype;function s(t){var i=0;return{next:function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}}}return n.clear=function(){this.map={}},n.delete=function(t){var i=this.n4.x3(this.n4.D3(t)),n=i in this.map;return delete this.map[i],n},n.entries=function(){for(var t,i=[],n=Object.keys(this.map),r=0;r<n.length;r++)i.push([(t=this.map[n[r]]).key,t.value]);return s(i)},n.keys=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].key);return s(t)},n.values=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].value);return s(t)},n.forEach=function(t,i){for(var n,r=Object.keys(this.map),s=0;s<r.length;s++)t.call(i,(n=this.map[r[s]]).value,n.key,this)},n.set=function(t,i){var n=this.n4.D3(t),r=this.r4.D3(i);return this.map[this.n4.x3(n)]={key:n,value:r},this},n.get=function(t){var i=this.n4.x3(this.n4.D3(t));if(i in this.map)return this.map[i].value},n.has=function(t){return this.n4.x3(this.n4.D3(t))in this.map},i}(0,s.Reflect),s.K4=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.q4&&"string"==typeof i.root)&&(n=i,i=void 0),s.Yv(s.G2.JZ.parse(t),i,n)},s.X4=s.K4,s.J4=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.RR.fetch("string"==typeof i?i:i.root+"/"+i.q4,function(t){if(null!==t)try{n(null,s.K4(t,r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.RR.fetch("object"==typeof i?i.root+"/"+i.q4:i);return null===t?null:s.K4(t,r,i)},s.z4=s.J4,s.Z4=function(t){return void 0===(t=t||{}).d2&&(t.d2=s.d2),void 0===t.E2&&(t.E2=s.E2),new s.H3(t)},s.Yv=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.q4&&"string"==typeof i.root)&&(n=i,i=null),i&&"object"==typeof i||(i=s.Z4()),"string"==typeof t&&(t=JSON.parse(t)),i.import(t,n),i.W4(),i},s.t5=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.RR.fetch("string"==typeof i?i:i.root+"/"+i.q4,function(t){if(null!==t)try{n(null,s.Yv(JSON.parse(t),r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.RR.fetch("object"==typeof i?i.root+"/"+i.q4:i);return null===t?null:s.Yv(JSON.parse(t),r,i)},s})?t.apply(e,n):t)||(s.exports=r)}).call(this,l(37))},function(t,i,n){var r,s,e;
/**
 * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/Long.js for details
 */s=[],void 0===(e="function"==typeof(r=function(){"use strict";function v(t,i,n){this.low=0|t,this.high=0|i,this.MN=!!n}Object.defineProperty(v.prototype,"i5",{value:!0,enumerable:!1,configurable:!1}),v.t4=function(t){return!0===(t&&t.i5)};var s={},e={};v.cO=function(t,i){var n,r;return i?0<=(t>>>=0)&&t<256&&(r=e[t])?r:(n=new v(t,(0|t)<0?-1:0,!0),0<=t&&t<256&&(e[t]=n),n):-128<=(t|=0)&&t<128&&(r=s[t])?r:(n=new v(t,t<0?-1:0,!1),-128<=t&&t<128&&(s[t]=n),n)},v.nO=function(t,i){return i=!!i,isNaN(t)||!isFinite(t)?v.ZERO:!i&&t<=-h?v.MIN_VALUE:!i&&h<=t+1?v.MAX_VALUE:i&&r<=t?v.n5:t<0?v.nO(-t,i).LO():new v(t%n|0,t/n|0,i)},v.HI=function(t,i,n){return new v(t,i,n)},v.rO=function(t,i,n){if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v.ZERO;if("number"==typeof i&&(n=i,i=!1),(n=n||10)<2||36<n)throw Error("radix out of range: "+n);var r;if(0<(r=t.indexOf("-")))throw Error('number format error: interior "-" character: '+t);if(0===r)return v.rO(t.substring(1),i,n).LO();for(var s=v.nO(Math.pow(n,8)),e=v.ZERO,h=0;h<t.length;h+=8){var o=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+o),n);if(o<8){var a=v.nO(Math.pow(n,o));e=e.multiply(a).add(v.nO(u))}else e=(e=e.multiply(s)).add(v.nO(u))}return e.MN=i,e},v.i4=function(t){return t instanceof v?t:"number"==typeof t?v.nO(t):"string"==typeof t?v.rO(t):new v(t.low,t.high,t.MN)};var n=4294967296,r=n*n,h=r/2,d=v.cO(1<<24);return v.ZERO=v.cO(0),v.f2=v.cO(0,!0),v.ONE=v.cO(1),v.r5=v.cO(1,!0),v.s5=v.cO(-1),v.MAX_VALUE=v.HI(-1,2147483647,!1),v.n5=v.HI(-1,-1,!0),v.MIN_VALUE=v.HI(0,-2147483648,!1),v.prototype.CN=function(){return this.MN?this.low>>>0:this.low},v.prototype.e5=function(){return this.MN?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},v.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix out of range: "+t);if(this.h5())return"0";var i;if(this.XZ()){if(this.Wh(v.MIN_VALUE)){var n=v.nO(t),r=this.o5(n);return i=r.multiply(n).u5(this),r.toString(t)+i.CN().toString(t)}return"-"+this.LO().toString(t)}var s=v.nO(Math.pow(t,6),this.MN);i=this;for(var e="";;){var h=i.o5(s),o=(i.u5(h.multiply(s)).CN()>>>0).toString(t);if((i=h).h5())return o+e;for(;o.length<6;)o="0"+o;e=""+o+e}},v.prototype.a5=function(){return this.high},v.prototype.f5=function(){return this.high>>>0},v.prototype.c5=function(){return this.low},v.prototype.l5=function(){return this.low>>>0},v.prototype.v5=function(){if(this.XZ())return this.Wh(v.MIN_VALUE)?64:this.LO().v5();for(var t=0!=this.high?this.high:this.low,i=31;0<i&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},v.prototype.h5=function(){return 0===this.high&&0===this.low},v.prototype.XZ=function(){return!this.MN&&this.high<0},v.prototype.d5=function(){return this.MN||0<=this.high},v.prototype.E5=function(){return 1==(1&this.low)},v.prototype.HO=function(){return 0==(1&this.low)},v.p5=v.prototype.Wh=function(t){return v.t4(t)||(t=v.i4(t)),(this.MN===t.MN||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},v.w5=v.prototype.g5=function(t){return!this.Wh(t)},v.prototype.b5=v.prototype.y5=function(t){return this.compare(t)<0},v.prototype.T5=v.prototype.m5=function(t){return this.compare(t)<=0},v.prototype.O5=v.prototype.S5=function(t){return 0<this.compare(t)},v.prototype.R5=v.prototype.I5=function(t){return 0<=this.compare(t)},v.prototype.compare=function(t){if(v.t4(t)||(t=v.i4(t)),this.Wh(t))return 0;var i=this.XZ(),n=t.XZ();return i&&!n?-1:!i&&n?1:this.MN?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.u5(t).XZ()?-1:1},v.prototype._5=v.prototype.LO=function(){return!this.MN&&this.Wh(v.MIN_VALUE)?v.MIN_VALUE:this.not().add(v.ONE)},v.prototype.add=function(t){v.t4(t)||(t=v.i4(t));var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=0,a=0,f=0,c=0;return f+=(c+=s+(65535&t.low))>>>16,a+=(f+=r+o)>>>16,u+=(a+=n+h)>>>16,u+=i+e,v.HI((f&=65535)<<16|(c&=65535),(u&=65535)<<16|(a&=65535),this.MN)},v.prototype.sub=v.prototype.u5=function(t){return v.t4(t)||(t=v.i4(t)),this.add(t.LO())},v.prototype.A5=v.prototype.multiply=function(t){if(this.h5())return v.ZERO;if(v.t4(t)||(t=v.i4(t)),t.h5())return v.ZERO;if(this.Wh(v.MIN_VALUE))return t.E5()?v.MIN_VALUE:v.ZERO;if(t.Wh(v.MIN_VALUE))return this.E5()?v.MIN_VALUE:v.ZERO;if(this.XZ())return t.XZ()?this.LO().multiply(t.LO()):this.LO().multiply(t).LO();if(t.XZ())return this.multiply(t.LO()).LO();if(this.y5(d)&&t.y5(d))return v.nO(this.e5()*t.e5(),this.MN);var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=65535&t.low,a=0,f=0,c=0,l=0;return c+=(l+=s*u)>>>16,f+=(c+=r*u)>>>16,c&=65535,f+=(c+=s*o)>>>16,a+=(f+=n*u)>>>16,f&=65535,a+=(f+=r*o)>>>16,f&=65535,a+=(f+=s*h)>>>16,a+=i*u+n*o+r*h+s*e,v.HI((c&=65535)<<16|(l&=65535),(a&=65535)<<16|(f&=65535),this.MN)},v.prototype.N5=v.prototype.o5=function(t){if(v.t4(t)||(t=v.i4(t)),t.h5())throw new Error("division by zero");if(this.h5())return this.MN?v.f2:v.ZERO;var i,n,r;if(this.Wh(v.MIN_VALUE))return t.Wh(v.ONE)||t.Wh(v.s5)?v.MIN_VALUE:t.Wh(v.MIN_VALUE)?v.ONE:(i=this.HN(1).o5(t).shiftLeft(1)).Wh(v.ZERO)?t.XZ()?v.ONE:v.s5:(n=this.u5(t.multiply(i)),r=i.add(n.o5(t)));if(t.Wh(v.MIN_VALUE))return this.MN?v.f2:v.ZERO;if(this.XZ())return t.XZ()?this.LO().o5(t.LO()):this.LO().o5(t).LO();if(t.XZ())return this.o5(t.LO()).LO();for(r=v.ZERO,n=this;n.I5(t);){i=Math.max(1,Math.floor(n.e5()/t.e5()));for(var s=Math.ceil(Math.log(i)/Math.LN2),e=s<=48?1:Math.pow(2,s-48),h=v.nO(i),o=h.multiply(t);o.XZ()||o.S5(n);)o=(h=v.nO(i-=e,this.MN)).multiply(t);h.h5()&&(h=v.ONE),r=r.add(h),n=n.u5(o)}return r},v.prototype.mO=v.prototype.LZ=function(t){return v.t4(t)||(t=v.i4(t)),this.u5(this.o5(t).multiply(t))},v.prototype.not=function(){return v.HI(~this.low,~this.high,this.MN)},v.prototype.and=function(t){return v.t4(t)||(t=v.i4(t)),v.HI(this.low&t.low,this.high&t.high,this.MN)},v.prototype.or=function(t){return v.t4(t)||(t=v.i4(t)),v.HI(this.low|t.low,this.high|t.high,this.MN)},v.prototype.xor=function(t){return v.t4(t)||(t=v.i4(t)),v.HI(this.low^t.low,this.high^t.high,this.MN)},v.prototype.C5=v.prototype.shiftLeft=function(t){return v.t4(t)&&(t=t.CN()),0==(t&=63)?this:t<32?v.HI(this.low<<t,this.high<<t|this.low>>>32-t,this.MN):v.HI(0,this.low<<t-32,this.MN)},v.prototype.k5=v.prototype.HN=function(t){return v.t4(t)&&(t=t.CN()),0==(t&=63)?this:t<32?v.HI(this.low>>>t|this.high<<32-t,this.high>>t,this.MN):v.HI(this.high>>t-32,0<=this.high?0:-1,this.MN)},v.prototype.D5=v.prototype.kN=function(t){if(v.t4(t)&&(t=t.CN()),0==(t&=63))return this;var i=this.high;if(t<32){var n=this.low;return v.HI(n>>>t|i<<32-t,i>>>t,this.MN)}return v.HI(32===t?i:i>>>t-32,0,this.MN)},v.prototype.jN=function(){return this.MN?new v(this.low,this.high,!1):this},v.prototype.PN=function(){return this.MN?this:new v(this.low,this.high,!0)},v})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),y=n(20),e=n(48),h=n(162),o=n(166),u=n(7),T=n(1),m=n(2),O=u.ut.Za,a=u.ut.$a,f=(c.prototype.Tv=function(){return this.sender.Tv()||this.receiver.Tv()},c.prototype.close=function(){var i=this,n=r.defer();return this.sender.M5().then(function(t){return i.receiver.close(t).then(function(t){return i.hW(t).then(function(t){return i.Kl.close(t).then(function(t){n.resolve(t)})})})}).catch(function(t){T.ErrorMonitor.lt().logError("Error closing connection to peer",i.loggerId,m.ri.Jt,{detailedError:t,otherGuid:i.otherGuid}),n.reject("Close partnership failed")}),n.promise},c.prototype.hW=function(t){this.logger.debug("SEND CLOSE TO "+this.otherGuid);var i=new y.$v.Qv.Close;return i.setType(t),this.Sv(y.ev.Close,i),r(this.swarmId)},c.prototype.Eh=function(t){try{switch(O&&this.logger.debug("DISPATCH "+t.Gv),t.Gv){case y.ev.Chunk:var i=y.$v.Qv.Chunk.decode(t.Vv);this.receiver.j5(i);break;case y.ev.Ack:var n=y.$v.Qv.Ack.decode(t.Vv);this.sender.P5(n.transferId);break;case y.ev.Cancel:var r=y.$v.Qv.Cancel.decode(t.Vv);this.sender.H5(r.transferId);break;case y.ev.hv:O&&this.logger.debug("RECEIVED OUT PART,DECODING ");var s=y.$v.Qv.OutPartnershipRequest.decode(t.Vv);O&&this.logger.debug("RECEIVED OUT PART FROM "+s.guid),this.HD.aW(s,this.Kl);break;case y.ev.ov:O&&this.logger.debug("RECEIVED OUT PART RESP ");var e=y.$v.Qv.OutPartnershipResponse.decode(t.Vv);O&&this.logger.debug("RECEIVED OUT PART RESP FROM "+e.accept),this.HD.kW(e,this.Kl);break;case y.ev.Have:var h=y.$v.Qv.Have.decode(t.Vv);O&&this.logger.debug("RECEIVED HAVE FOR "+h.fragmentId+" FROM "+this.otherGuid),this.HD.L5(this.otherGuid,h);break;case y.ev.Close:var o=y.$v.Qv.Close.decode(t.Vv);O&&this.logger.debug("RECEIVED CLOSE FROM "+this.otherGuid),this.HD.AW(this.otherGuid,o);break;case y.ev.Request:var u=y.$v.Qv.Request.decode(t.Vv);O&&this.logger.debug("RECEIVED REQUEST FOR "+u.fragmentId+" FROM "+this.otherGuid),this.mX.lL(this.otherGuid,u,this);break;case y.ev.DoNotHave:var a=y.$v.Qv.DoNotHave.decode(t.Vv);O&&this.logger.debug("DoNotHave "+a.transferId),this.F5.U5(a);break;case y.ev.uv:var f=y.$v.Qv.UDPHandshakeMessage.decode(t.Vv);O&&this.logger.debug("UDP HANDSHAKE MESSAGE RECEIVED FROM "+f.uuid),this.rX.Bq(f,this.Kl);break;case y.ev.UDPHandshakeResponse:var c=y.$v.Qv.UDPHandshakeResponse.decode(t.Vv);O&&this.logger.debug("UDP HANDSHAKE MESSAGE RESPONSE RECEIVED FROM "+this.otherGuid),this.rX.xq(c,this.Kl);break;case y.ev.UDPSwitchLeadershipRequest:var l=y.$v.Qv.UDPSwitchLeadershipRequest.decode(t.Vv);O&&this.logger.debug("SWITCH LEADERSHIP REQUEST RECEIVED FROM "+this.otherGuid),this.rX.eQ(l);break;case y.ev.av:var v=y.$v.Qv.UDPSwitchLeadershipAck.decode(t.Vv);O&&this.logger.debug("UDP SWITCH ACKNOWLEDGMENT RESPONSE FROM "+this.otherGuid),this.rX.cQ(v,this.otherGuid);break;case y.ev.Bitrate:var d=y.$v.Qv.Bitrate.decode(t.Vv);O&&this.logger.debug("BITRATE INFO "+d.bitrate+" FROM "+d.guid),this.HD.jW(d);break;case y.ev.Haves:var E=y.$v.Qv.Haves.decode(t.Vv);O&&this.logger.debug("RECEIVED BATCH HAVES FOR FROM "+this.otherGuid),this.HD.G5(this.otherGuid,E);break;case y.ev.fv:var p=y.$v.Qv.PeerInfoMessage.decode(t.Vv);O&&this.logger.debug("RECEIVED PEER INFO FROM "+this.otherGuid),this.HD.LW(p);break;case y.ev.Ping:var w=y.$v.Qv.Ping.decode(t.Vv);O&&this.logger.debug("RECEIVED PING FROM "+this.otherGuid),this.HD.x5(w);break;case y.ev.Pong:var g=y.$v.Qv.Pong.decode(t.Vv);O&&this.logger.debug("RECEIVED PONG FROM "+this.otherGuid),this.HD.B5(g);break;case y.ev.cv:var b=y.$v.Qv.NoPartners.decode(t.Vv);O&&this.logger.debug("RECEIVED NON PARTNER MESSAGE FROM "+this.otherGuid),this.F5.V5(this.otherGuid,b);break;default:this.logger.warn("UNKNOWN MESSAGE TYPE "+t.Gv)}}catch(t){T.ErrorMonitor.lt().logError("Error dispatching message",this.loggerId,t,m.ri.si,t)}},c.prototype.Sv=function(t,i){return this.Kl.Sv(t,this.swarmId,i)},c.prototype.Pv=function(){this.sender.Pv()},c);function c(t,i,n,r){this.loggerId="[P2PDispatcher] ",this.logger=s.Framework.resolve(s.Framework.ht.m).log(t.sessionId),this.Ev=i,this.otherGuid=n,this.swarmId=t.swarmId,this.Kl=r,this.receiver=new h.q5(i,n,t),this.sender=new o.Q5(i,n,t,this),this.F5=t.jD,this.HD=t.HD,this.mX=t.mX,(a||s.Framework.U()&&e.TD.bD)&&(this.rX=t.rX)}i.dv=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(34),e=n(20),u=n(0),a=n(6),f=n(5),h=n(95),c=n(1),l=n(2),o=(v.prototype.setReportingGuid=function(t){this.W5=t},v.prototype.Tv=function(){return!(0===this.Y5.keys().length&&null===this.K5)},v.prototype.X5=function(t){var i=new e.$v.Qv.Request;try{i.fragmentId=t.jp(),i.transferId=t.ZM,this.sv&&this.logger.debug("INITIATING TR-"+t.ZM+" TIMEOUT: "+t.J5+" FRAGMENT: "+t.jp()+" FROM: "+this.otherGuid),this.Y5.set(t.ZM,t),this.z5.set(t.ZM,u.Framework.time())}catch(t){c.ErrorMonitor.lt().logError("Error constructing fragment request message",this.loggerId,l.ss.es,{detailedError:t,otherGuid:this.otherGuid}),i=null}try{i&&t.lB.oW.Sv(e.ev.Request,i)}catch(t){c.ErrorMonitor.lt().logError("Error sending fragment request",this.loggerId,l.ss.hs,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.j5=function(t){try{var i=t.transferId,n=t.data.dC(),r=t.chunkSize,s=t.totalSize,e=t.headers;if(this.sv&&this.logger.debug("RCV Chunk "+n.byteLength),!this.Y5.has(i))return;null==this.K5?(this.sv&&this.logger.debug("INITIATED TR-"+i+",SIZE="+s),this.K5=this.Y5.get(i),this.K5.ZM=i,f.ea.Ju.vu&&this.Z5(i,this.K5.lB),null!=e?this.K5.$p=e:this.logger.warn("HEADERS NULL IN FIRST CHUNK"),this.F5.l1(this.otherGuid,this.K5,r,s),this.K5.Jp=r,u.Framework.U()||(this.K5.Xp=n)):(f.ea.Ju.vu&&this.Z5(i,this.K5.lB),this.K5.Jp+=r,u.Framework.U()||(this.K5.Xp=a.La.appendBuffer(this.K5.Xp,n)));var h=u.Framework.U()?this.K5.Jp:this.K5.Xp.byteLength;if(this.sv&&this.logger.debug("RECEIVED "+h+"/"+s+" TRID "+i),h==s){this.sv&&this.logger.debug("RCV ALL DATA "+h+" TR-"+this.K5.Hp),this.K5.Vp.yp=h,u.Framework.clearTimeout(this.K5.Gq),this.Y5.delete(i);var o=u.Framework.time()-this.z5.get(i);this.logger.debug("RCV ALL DATA FROM "+this.otherGuid+" AFTER "+o+" mseconds"),this.z5.delete(i),this.F5.iM(i,this.K5),this.K5=null}}catch(t){c.ErrorMonitor.lt().logError("Error receiving chunk",this.loggerId,l.ss.us,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.Z5=function(t,i){try{this.sv&&this.logger.debug("SEND ACK "+t+" TO "+this.otherGuid);var n=new e.$v.Qv.Ack;n.transferId=t,i.oW.Sv(e.ev.Ack,n)}catch(t){c.ErrorMonitor.lt().logError("Error sending ack",this.loggerId,l.ss.fs,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.close=function(t){var i=this,n=r.defer();return null!=this.K5&&this.t6(this.K5.ZM),this.Y5.keys().slice().forEach(function(t){i.t6(t)}),n.resolve(h.mQ.bq),n.promise},v.prototype.t6=function(t){try{if(this.Y5.has(t)){var i=this.Y5.get(t);i.Vp.yp=i.Jp,this.logger.debug("SEND CANCEL FOR "+t+" TO "+this.otherGuid),this.z5.delete(t);var n=new e.$v.Qv.Cancel;n.transferId=t,i.lB.oW.Sv(e.ev.Cancel,n),null!==this.K5&&this.K5.Pp()===i.Pp()&&(this.K5=null),this.Y5.delete(t)}else c.ErrorMonitor.lt().logError("Error cleaning up a not pending transfer",this.loggerId,l.ss.cs)}catch(t){c.ErrorMonitor.lt().logError("Error sending stop transfer",this.loggerId,l.ss.ls,{detailedError:t,otherGuid:this.otherGuid})}},v);function v(t,i,n){this.loggerId="[FragmentRequester] ",this.Y5=new s,this.z5=new s,this.K5=null,this.sv=e.sv,this.Ev=t,this.otherGuid=i,this.F5=n.jD,this.PD=n.PD,this.yv=u.Framework.resolve(u.Framework.ht.v),this.logger=u.Framework.resolve(u.Framework.ht.m).log(n.sessionId)}i.q5=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var o=n(4),u=n(0),a=n(5),f=n(16),c=n(2),l=n(1),r=(s.prototype.wW=function(t){this.reportingGuid=t,this.oW&&(this.oW.receiver.setReportingGuid(this.reportingGuid),this.oW.sender.setReportingGuid(this.reportingGuid))},s.prototype.i6=function(t,i,n){var r=Math.max(1,i);for(n&&(this.n6+=r,this.r6+=t);this.s6.length>a.ea.Xu.iu;)this.s6.pop();var s=t/r;this.s6.unshift(s)},s.prototype.e6=function(t){this.Y5.has(t)?this.logger.warn(this.guid+" DUPLICATE {} PENDING REQUESTS "+t):this.Y5.set(t,u.Framework.time())},s.prototype.h6=function(t,i,n,r,s,e){try{if(this.Y5.has(t)){var h=this.Y5.get(t),o=u.Framework.time()-h;this.Y5.delete(t),r&&s&&this.i6(i,o,!0),this._U.success(i),this.HL.o6(this.reportingGuid,i,n,s,e)}else l.ErrorMonitor.lt().logError("Error completing a non-existing request",this.loggerId,c.Fs.xs,{otherGuid:this.guid,W5:this.reportingGuid})}catch(t){l.ErrorMonitor.lt().logError("Error handling request completed",this.loggerId,c.Fs.Gs,{detailedError:t,otherGuid:this.guid,W5:this.reportingGuid})}},s.prototype.u6=function(t,i,n,r,s,e){try{if(this.Y5.has(t)){var h=this.Y5.get(t);this.Y5.delete(t),a.ea.Xu.nu?this.i6(i,h,!0):this.i6(0,h,!0),this._U.a6(i,r),this.HL.f6(this.reportingGuid,i,n,r,s,e)}else l.ErrorMonitor.lt().logError("Error partially failed a non-existing request",this.loggerId,c.Fs.Vs,{otherGuid:this.guid,W5:this.reportingGuid})}catch(t){l.ErrorMonitor.lt().logError("Error handling request partially failed ",this.loggerId,c.Fs.Bs,{detailedError:t,otherGuid:this.guid})}},s.prototype.zM=function(t,i,n){try{if(this.Y5.has(t)){var r=this.Y5.get(t);this.Y5.delete(t),this.i6(0,r,!0),this._U.failed(),this.HL.c6(this.reportingGuid,n,i)}else l.ErrorMonitor.lt().logError("Error failed a non-existing request",this.loggerId,c.Fs.Qs,{otherGuid:this.guid,W5:this.reportingGuid})}catch(t){l.ErrorMonitor.lt().logError("Error handling request failed ",this.loggerId,c.Fs.qs,{detailedError:t,otherGuid:this.guid})}},s.prototype.l6=function(t,i){this.HL.v6(t,i,!0)},s.prototype.d6=function(t,i){this.HL.E6(t,i,!0)},s.prototype.p6=function(t,i,n){this.HL.w6(t,i,n,!0)},s.prototype.QM=function(){var t=this.s6.reduce(function(t,i){return t+i},0);return 0<this.s6.length?t/this.s6.length:0},s.prototype.g6=function(t){this.b6=t},s.prototype.y6=function(){return this.b6},s.prototype.sW=function(){return this.LM.sW()},s.prototype.T6=function(){return this.handshakeDelay},s.prototype.m6=function(t){var i=Math.max(0,this.$W-t);0<i&&i<a.ea.Vu.lo&&(this.handshakeDelay=i)},s);function s(t,i,n,r,s,e,h){this.loggerId="[Partner] ",this.r6=0,this.n6=0,this.b6=0,this.s6=new Array,this.O6=new Array,this.Y5=new o,this.handshakeDelay=-1,this.logger=r,this.oW=n,this.guid=t,this.LM=e,this.S6=s,this.HL=i,this._U=u.Framework.resolve(f.nl.Wc),this.NU=u.Framework.resolve(f.nl.Wc),this.$W=u.Framework.time(),h&&this.m6(h)}i.Partner=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(36),r=n(4),h=n(0),u=n(10),l=n(20),o=n(5),v=n(1),s=n(165),d=n(2),a=(f.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.ht.m).log(t.sessionId),this.PD=t.PD,this.fg=t.fg,this.uploadScore=t.uploadScore,this.DD=t.DD,this.iW=t.sU},f.prototype.BQ=function(t){return this.fW(t.peerInfo.guid)},f.prototype.fW=function(t){return this.lG.has(t)||this.cG.has(t)},f.prototype.FW=function(t){return this.cG.has(t)?this.cG.get(t):this.lG.get(t)},f.prototype.UQ=function(t){return this.RW(t.peerInfo.guid)},f.prototype.RW=function(t){return this.vG.has(t)||this.qQ.has(t)},f.prototype.IW=function(t){return this.vG.has(t)?this.vG.get(t):this.qQ.get(t)},f.prototype.bW=function(o){var u=this;try{var t=this.PD.R6();if(this.I6&&!t)if(this.fW(o)){var a=this.FW(o),f=this.uploadScore._6(!1),c=[];this.fg.cq(this.context.isLive()).then(function(t){u.logger.debug(u.ML+"SEND ALL HAVES TO "+o+","+t.length);for(var i=0;i<t.length;i++){var n=0;n=u.context.isLive()?t[i].size():t[i].totalSize;var r=t[i].Mp,s=new l.$v.Qv.Have;s.setFragmentId(r.jp()),s.setSize(n),s.setUploadScore(f);var e=r;s.setId(e.cA()),s.setBitrate(e.bitrate),s.setDuration(e.duration),s.setType(e.Dp()),c.push(s)}if(0<c.length){var h=new l.$v.Qv.Haves;h.setHave(c),a.oW.Sv(l.ev.Haves,h)}})}else v.ErrorMonitor.lt().logError("Error sending all haves to peer who is not out partner",this.ML,d.Ni.Hi,{otherGuid:o})}catch(t){v.ErrorMonitor.lt().logError("Error sending all haves",this.ML,d.Ni.Ci,{detailedError:t,otherGuid:o})}},f.prototype.gJ=function(i,n,r){var s=this,t=this.PD.R6();if(this.I6&&!t){var e=this.cG.values();this.lG.forEach(function(t,i){e.push(t)});var h=this.uploadScore._6(!1);e.forEach(function(t){(!r||r&&t.guid!=r.guid)&&s.A6(t.oW,i,n,h)})}},f.prototype.A6=function(i,t,n,r){this.N6&&this.logger.debug(this.ML+"SEND HAVE TO "+i.otherGuid+" FOR "+t.jp());try{var s=new l.$v.Qv.Have;s.setFragmentId(t.jp()),s.setSize(n),s.setUploadScore(r);var e=t;s.setId(e.cA()),s.setBitrate(e.bitrate),s.setDuration(e.duration),s.setType(e.Dp()),i.Sv(l.ev.Have,s)}catch(t){v.ErrorMonitor.lt().logError("Error sending have ",this.ML,d.Ni.ki,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.L5=function(i,t){try{if(this.RW(i)){this.C6&&this.logger.debug(this.ML+"HAVE RECEIVED FROM "+i+": "+t.fragmentId);var n=this.IW(i);n.g6(t.getUploadScore()),this.DD.put(t,n),this.context.nU(t)}else v.ErrorMonitor.lt().logError("Error receiving have from unknown peer",this.ML,d.Ni.Di,{otherGuid:i})}catch(t){v.ErrorMonitor.lt().logError("Error handling received have",this.ML,d.Ni.ji,{detailedError:t,otherGuid:i})}},f.prototype.G5=function(i,t){var n=this;try{if(this.RW(i)){this.C6&&this.logger.debug(this.ML+"BATCH HAVES RECEIVED FROM "+i);var r=this.IW(i);t.getHave().forEach(function(t){r.g6(t.getUploadScore()),n.DD.put(t,r)}),this.context.nU(t.getHave()[0])}else v.ErrorMonitor.lt().logError("Error receiving haves from unknown peer",this.ML,d.Ni.Mi,{otherGuid:i})}catch(t){v.ErrorMonitor.lt().logError("Error handling received haves",this.ML,d.Ni.Pi,{detailedError:t,otherGuid:i})}},f.prototype.rW=function(i){try{var t=new l.$v.Qv.Ping;t.id=this.PD.getId(),t.startTs=h.Framework.time(),this.logger.debug(this.ML+"REQUEST PING TO PEER GUID "+i.otherGuid),i.Sv(l.ev.Ping,t)}catch(t){v.ErrorMonitor.lt().logError("Error requesting ping",this.ML,d.Ni.Ui,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.x5=function(i){try{var t=i.id;if(!this.fW(t))return void v.ErrorMonitor.lt().logError("Error receiving ping from an unknown peer",this.ML,d.Ni.Gi,{otherGuid:t});var n=-1;i.startTs&&(n=i.startTs),this.k6(this.FW(t).oW,n)}catch(t){v.ErrorMonitor.lt().logError("Error handling received ping",this.ML,d.Ni.Fi,{detailedError:t,otherGuid:i.id})}},f.prototype.D6=function(){try{for(var t="",i=0;i<o.ea.Ju.au;i++)t+=String.fromCharCode(33+93*Math.random());var n=new ArrayBuffer(t.length),r=new Uint8Array(n),s=t.length;for(i=0;i<s;i++)r[i]=t.charCodeAt(i);this.M6=e.wrap(r)}catch(t){v.ErrorMonitor.lt().logError("Error creating random buffer for ping pong",this.logger,d.Ni.Li,t)}},f.prototype.k6=function(i,t){try{var n=new l.$v.Qv.Pong;n.id=this.PD.getId(),n.startTs=t,this.M6||this.D6(),n.data=this.M6,n.dataSize=o.ea.Ju.au,this.logger.debug(this.ML+"SEND PONG TO PEER GUID "+i.otherGuid),i.Sv(l.ev.Pong,n)}catch(t){v.ErrorMonitor.lt().logError("Error sending pong",this.ML,d.Ni.xi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.B5=function(i){try{var t=i.id;if(!this.RW(t))return void v.ErrorMonitor.lt().logError("Error receiving a pong from an unknown peer",this.ML,d.Ni.Bi,{otherGuid:t});var n=h.Framework.time();if(i.startTs&&0<i.startTs){var r=n-i.startTs,s=this.IW(t);i.dataSize==i.data.Ma().byteLength?s.i6(i.dataSize,r,!0):v.ErrorMonitor.lt().logError("Error receing pong with wrong data size",this.ML,d.Ni.Vi,{otherGuid:t})}else v.ErrorMonitor.lt().logError("Error receiving pong with wrong timestamp",this.ML,d.Ni.qi,{otherGuid:t})}catch(t){v.ErrorMonitor.lt().logError("Error receiving pong",this.ML,d.Ni.Qi,{detailedError:t,otherGuid:i.id})}},f.prototype.EG=function(){try{var t=new r;return this.j6(this.vG,t),this.j6(this.qQ,t),t}catch(t){return v.ErrorMonitor.lt().logError("Error getting partner snapshots",this.ML,d.Ni.Wi,t),new r}},f.prototype.j6=function(t,h){var o=this;t.forEach(function(t,i){var n=new hive.snapshots.Partner;n.inPart=!0,n.outPart=o.fW(i),n.connInfo=new hive.snapshots.ConnectivityInfo;var r=void 0;t.LM.peerInfo.publicIpString&&(r=t.LM.peerInfo.publicIpString);var s=void 0;t.LM.peerInfo.privateIpString&&(s=t.LM.peerInfo.privateIpString),n.connInfo.publicIp=r,n.connInfo.privateIp=s,n.connInfo.externalAs=t.LM.peerInfo.externalAs,n.connInfo.internalAs=t.LM.peerInfo.internalAs;var e=o.P6();e.rateReceived=t.QM(),n.metrics=e,-1!=t.T6()&&(n.metrics.handshakeDelay=t.T6()),n.udp=t.LM.peerInfo.type==u.mf.k,h.set(t.reportingGuid,n)})},f.prototype.fG=function(){return new s.H6(this.vG.length,this.qQ.length,this.lG.length,this.cG.length)},f.prototype.P6=function(){var t=new hive.snapshots.PartnerMetrics;return t.rateReceived=0,t.rateSent=0,t.handshakeDelay=0,t},f);function f(){this.ML="[PARTNERSHIP] ",this.qQ=new r,this.vG=new r,this.cG=new r,this.lG=new r,this.N6=!1,this.C6=!1,this.I6=!0,this.active=!1,this.D6(),this.KQ=[]}i.RQ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.vG=t,this.dG=i,this.lG=n,this.cG=r}i.H6=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(34),e=n(36),h=n(20),o=n(0),u=n(167),a=n(5),f=n(1),c=n(2),l=(v.prototype.setReportingGuid=function(t){this.W5=t},v.prototype.L6=function(t,i,n,r,s){var e=this;this.sv&&this.logger.info("SEND FRAGMENT "+t+" TO "+this.otherGuid);try{var h=new u.U6;h.transferId=i,h.fragmentId=t,h.F6=s,h.headers=r,h.G6=n,h.x6=Math.ceil(h.G6/a.ea.Ju.au),h.B6=0,this.V6.push(h),this.sv&&this.V6.forEach(function(t){e.logger.debug(e.otherGuid+" PENDING OUT "+t)})}catch(t){f.ErrorMonitor.lt().logError("Error constructing chunk response",this.loggerId,c.ds.Es,{detailedError:t,otherGuid:this.otherGuid})}null===this.response?this.q6():this.sv&&this.logger.debug(this.otherGuid+" OUT MSG NOT NULL")},v.prototype.P5=function(t){this.sv&&this.logger.debug("ONGOING "+t+" GOT ACK"),null!==this.response&&this.response.transferId.toString()===t.toString()?this.Q6(!1):f.ErrorMonitor.lt().logError("Error receiving ack for unknown transfer",this.loggerId,c.ds.gs)},v.prototype.Pv=function(){null!=this.response&&this.Q6(!1)},v.prototype.H5=function(i){null!=this.response&&this.response.transferId===i?(this.logger.debug("GOT CANCEL FOR ONGOING TR-"+i),this.logger.debug("TRANSPORT CANCEL STATS "+this.Ev+","+this.otherGuid+","+i),this.W6.delete(i),0!=this.response.B6?this.mX.Y6(this.otherGuid,this.W5,this.response.B6,this.response.G6):this.mX.K6(this.otherGuid,this.W5,this.response.G6),this.response=null,this.q6()):this.V6=this.V6.filter(function(t){return t.transferId!==i})},v.prototype.q6=function(){try{if(null===this.response&&0!==this.V6.length){var t=this.V6.shift();this.response=t,this.sv&&this.logger.debug("DATA TO SEND LENGTH "+this.response.G6+" IN "+this.response.x6+" CHUNKS WITH TR-"+this.response.transferId),this.Q6(!0)}}catch(t){f.ErrorMonitor.lt().logError("Error start sending chunks",this.loggerId,c.ds.ps,t),this.Ov()}},v.prototype.Q6=function(t){t&&(this.W6.set(this.response.transferId,o.Framework.time()),this.X6=this.response.x6);try{if(null!=this.response)if(0===this.response.x6)this.logger.debug("FINISHED SENDING TRANSFER "+this.response.transferId+" WITH "+this.response.B6+" BYTES"),this.W6.delete(this.response.transferId),this.mX.J6(this.otherGuid,this.W5,this.response.G6),this.response=null,this.z6(),this.q6();else{this.sv&&this.logger.debug("A CHUNK");var i=Math.min(this.response.B6+a.ea.Ju.au,this.response.G6),n=i-this.response.B6,r=new h.$v.Qv.Chunk;if(r.transferId=this.response.transferId,r.totalSize=this.response.G6,r.chunkSize=n,t&&null!=this.response.headers&&(r.headers=this.response.headers),o.Framework.U()||null==this.response.F6)r.data=e.wrap(new ArrayBuffer(0));else if(r.data=this.UD.Z6(this.response.fragmentId,this.X6-this.response.x6),null==r.data){var s=this.response.F6.slice(this.response.B6,i);r.data=e.wrap(s)}this.response.B6=this.response.B6+n,this.oW.Sv(h.ev.Chunk,r),this.sv&&this.logger.debug("SND ["+this.response.B6+"-"+(this.response.B6+n)+"/"+this.response.G6+"] TO "+this.otherGuid+" OF TR-"+this.response.transferId),this.response.x6--}else this.logger.debug("NO MESSAGE TO SEND")}catch(t){f.ErrorMonitor.lt().logError("Error sending chunk",this.loggerId,c.ds.ws,{detailedError:t,otherGuid:this.otherGuid}),this.Ov()}},v.prototype.Tv=function(){return!(0===this.V6.length&&null===this.response)},v.prototype.M5=function(){var t=r.defer();return this.V6.length=0,this.Tv()?this.close=t:t.resolve("CLOSE"),t.promise},v.prototype.z6=function(){this.close&&this.close.resolve("CLOSED")},v.prototype.Ov=function(){this.response=null},v);function v(t,i,n,r){this.loggerId="[FragmentSender] ",this.sv=h.sv,this.response=null,this.V6=new Array,this.W6=new s,this.X6=0,this.close=null,this.Ev=t,this.otherGuid=i,this.mX=n.mX,this.oW=r,this.UD=n.UD,this.logger=o.Framework.resolve(o.Framework.ht.m).log(n.sessionId),this.yv=o.Framework.resolve(o.Framework.ht.v)}i.Q5=l},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.headers=null}i.U6=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.xv=r},function(t){t.exports=JSON.parse('{"package":"HiveMsgs","messages":[{"name":"Chunk","fields":[{"rule":"required","type":"int32","name":"transferId","id":1},{"rule":"required","type":"int32","name":"totalSize","id":2},{"rule":"required","type":"int32","name":"chunkSize","id":3},{"rule":"required","type":"bytes","name":"data","id":4},{"rule":"optional","type":"string","name":"headers","id":5}]},{"name":"Haves","fields":[{"rule":"repeated","type":"Have","name":"have","id":1}]},{"name":"Have","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"size","id":2},{"rule":"required","type":"int32","name":"type","id":3},{"rule":"required","type":"int32","name":"id","id":4},{"rule":"required","type":"int32","name":"bitrate","id":5},{"rule":"required","type":"int32","name":"duration","id":6},{"rule":"required","type":"float","name":"uploadScore","id":7}]},{"name":"Ping","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"uint64","name":"startTs","id":2}]},{"name":"Pong","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"bytes","name":"data","id":2},{"rule":"required","type":"int32","name":"dataSize","id":3},{"rule":"required","type":"uint64","name":"startTs","id":4}]},{"name":"Request","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"transferId","id":2}]},{"name":"DoNotHave","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"NoPartners","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Cancel","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Ack","fields":[{"rule":"optional","type":"int32","name":"transferId","id":1}]},{"name":"Close","fields":[{"rule":"required","type":"int32","name":"type","id":1}]},{"name":"StreamCharacteristics","fields":[{"rule":"required","type":"int32","name":"streamState","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2},{"rule":"required","type":"int32","name":"delta","id":3}]},{"name":"OutPartnershipRequest","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"string","name":"contextId","id":2},{"rule":"required","type":"string","name":"p2pProtocolVersion","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"optional","type":"string","name":"publicIpString","id":6},{"rule":"optional","type":"string","name":"privateIpString","id":7},{"rule":"required","type":"string","name":"reportingGuid","id":8},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":9}]},{"name":"OutPartnershipResponse","fields":[{"rule":"required","type":"int32","name":"accept","id":1},{"rule":"optional","type":"int32","name":"internalAs","id":2},{"rule":"optional","type":"int32","name":"externalAs","id":3},{"rule":"optional","type":"string","name":"publicIpString","id":4},{"rule":"optional","type":"string","name":"privateIpString","id":5},{"rule":"optional","type":"string","name":"reportingGuid","id":6},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":7}]},{"name":"PeerInfoMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"optional","type":"string","name":"publicIpString","id":2},{"rule":"optional","type":"string","name":"privateIpString","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":6}]},{"name":"UDPHandshakeMessage","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"string","name":"streamId","id":2},{"rule":"required","type":"float","name":"udpScore","id":3},{"rule":"required","type":"bool","name":"isLeader","id":4}]},{"name":"UDPHandshakeResponse","fields":[{"rule":"required","type":"string","name":"accept","id":1}]},{"name":"UDPSwitchLeadershipRequest","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"float","name":"udpScore","id":2}]},{"name":"UDPSwitchLeadershipAck","fields":[{"rule":"required","type":"bool","name":"ok","id":1}]},{"name":"Bitrate","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2}]}]}')},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(5),s=(e.TO=function(t,i){var n=0;return 0!=(n=t.udpScore>i.udpScore?1:t.udpScore<i.udpScore?-1:0)?-n:r.ea.UDPBroadcast.gu?i.uuid.localeCompare(t.uuid):t.uuid.localeCompare(i.uuid)},e);function e(t,i,n,r,s){this.udpScore=0,this.Iq=!1,this.streamId="",this.uuid=t,this.udpScore=i,n&&(this.address=n),r&&(this.Iq=r),s&&(this.streamId=s)}i.Sq=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(19),h=n(0),e=n(16),o=n(9),u=n(10),a=n(1),f=n(2),c=(l.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.ht.m).log(t.sessionId),this.DD=t.DD,this.HD=t.HD,this.MD=t.MD,this.PD=t.PD,this.HL=t.sU,this.n8.t8(t.PD)},l.prototype.request=function(t){this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+t.Mp.toString()+"-"+t.Vp.yp+" ["+o.wf[t.Dp()]+"] TO P2P"),this.Y5.set(t.Pp(),t);var i=this.Kv.next();t.ZM=i,this.r8.set(i,t.Pp()),this.Y0(t)},l.prototype.Y0=function(t){var i=t.jp(),n=t.Pp(),r=this.s8(i);t.size=this.DD.MM(i).size;var s=this.n8.e8(r,t.type);null!=s?(this.logger.info("SELECT "+s.oW.otherGuid+" (LAN LEADER "+s.LM.peerInfo.isLeader+" iAS "+s.LM.peerInfo.internalAs+" eAS "+s.LM.peerInfo.externalAs+" privateIp "+s.LM.peerInfo.privateIpString+" ) out of "+r.length+" type "+u.mf[s.LM.peerInfo.type]+" size:"+t.size+" FOR TRANSFER"+t.ZM+" REQUEST ID "+n),t.lB=s,t.uq=s.LM.peerInfo,t.lB.e6(t.ZM),t.Vp.wp=!0,t.Vp.Ip=h.Framework.time(),this.JM(t)?(this.HL.h8(t),s.oW.receiver.X5(t)):this.o8(t)):(a.ErrorMonitor.lt().logError("Error sending p2p request because we cannot find a partner",this.loggerId,f.bs.ys),this.zM(t.ZM,"NO PARTNERS FOUND FOR REQUEST"))},l.prototype.s8=function(t){var i=this,n=[];try{this.DD.jM(t).forEach(function(t){i.HD.RW(t.guid)?n.push(t):i.logger.warn("I HAVE A HAVE FROM A NON IN-PARTNER "+t.guid)})}catch(t){a.ErrorMonitor.lt().logError("Error filtering in partners",this.loggerId,f.bs.Ts,t)}finally{return n}},l.prototype.o8=function(t){var i=t.ZM;if(this.logger.info("REQUEST "+t.ZM+" TO "+t.lB.guid+" ABORTED BECAUSE OF SLOW P2P CONNECTION"),this.r8.has(i)){var n=this.r8.get(i);this.r8.delete(i);var r=this.Y5.get(n);this.Y5.delete(n),this.MD.fJ(r)}},l.prototype.JM=function(t){var i=this,n=!1;try{var r=0;null==t.size?(r=this.DD.MM(t.jp()).size,t.size=r,this.logger.warn("request size not set - this should not happen")):r=t.size;var s=r-t.Jp,e=t.Zp.VH().aB(t,s);return 0<(t.J5=e)&&(n=!0,null==t.Gq&&(t.Gq=h.Framework.setTimeout(function(){i.u8(t)},e))),n}catch(t){return a.ErrorMonitor.lt().logError("Error setting request timeout",this.loggerId,f.bs.ms,t),!1}},l.prototype.u8=function(t){this.HL.a8(t),this.zM(t.ZM,"TIMED-OUT")},l.prototype.zM=function(t,i){this.logger.info(i+" "+t);var n=this.f8(t,!0);this.logger.warn("REQUEST "+t+" FOR "+n.Pp()+" FAILED BECAUSE "+i),n&&this.MD.ZX(n)},l.prototype.f8=function(t,i){try{if(this.r8.has(t)){var n=this.r8.get(t);this.r8.delete(t);var r=this.Y5.get(n);if(this.Y5.delete(n),h.Framework.clearTimeout(r.Gq),i&&this.HD.RW(r.lB.oW.otherGuid)){r.lB.oW.receiver.t6(t);var s=r.Dp()==o.wf.bf;0!=r.Jp?r.lB.u6(r.ZM,r.Jp,r.Vp.p2pAgenTrafficSuccessQt,r.size,s,r.type):r.lB.zM(r.ZM,s,r.size)}return r}return a.ErrorMonitor.lt().logError("Error cancelling request on non existing session",this.loggerId,f.bs.Ss),null}catch(t){return a.ErrorMonitor.lt().logError("Error removing request",this.loggerId,f.bs.Os,t),null}},l.prototype.zX=function(t){if(this.Y5.has(t)){var i=this.Y5.get(t).ZM;this.f8(i,!0)}},l.prototype.l1=function(t,i,n,r){this.logger.debug("FRL DOWNLOADING "+i.Pp()+" FROM "+t+" P2P")},l.prototype.iM=function(t,i){if(this.logger.debug("FRL PROMISED FRAGMENT "+i.Pp()+" RETURNED FROM P2P SIZE "+i.Vp.yp),i=this.f8(t,!1)){i.Vp.Ap=h.Framework.time();var n=i.Dp()==o.wf.bf;i.lB.h6(i.ZM,i.size,i.Vp.p2pAgenTrafficSuccessQt,!0,n,i.type),this.MD.iJ(i)}else this.logger.warn("TRIED TO REMOVE A NON EXISTING REQUEST "+t+" (THIS SHOULD NOT HAPPEN. AT LEAST NOT TOO OFTEN)")},l.prototype.U5=function(t){var i=t.getTransferId();if(this.r8.has(i)){a.ErrorMonitor.lt().logError("Error receiving a do not have for my request",this.loggerId,f.bs.Rs),this.logger.debug("DO NOT HAVE RECEIVED FOR "+i);var n=this.f8(i,!1);if(n){var r=n.Dp()==o.wf.bf;n.lB.zM(n.ZM,r,n.size),this.MD.ZX(n)}}else this.logger.warn("UNKNOWN DO NOT HAVE "+i)},l.prototype.V5=function(t,i){var n=i.transferId;if(this.r8.has(n)){a.ErrorMonitor.lt().logError("Error rejected request by a non partner",this.loggerId,f.bs.Is),this.HD.eW(t);var r=this.f8(n,!1);r&&this.MD.ZX(r)}},l.prototype.ah=function(t){return this.Y5.has(t)},l);function l(){this.loggerId="[P2PRequester] ",this.Kv=new s.Counter,this.Y5=new r,this.r8=new r,this.n8=h.Framework.resolve(e.nl.qc)}i.x$=c},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(20),e=n(1),h=n(2),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.ht.m).log(t.sessionId),this.yq=t,this.DD=t.DD,this.fg=t.fg,this.HD=t.HD,this.uploadScore=t.uploadScore,this.PD=t.PD,this.HL=t.sU},u.prototype.lL=function(t,i,n){try{if(this.HD.fW(t)){var r=this.HD.FW(t);this.c8(t,i,r)}else this.l8(t,i,n)}catch(t){e.ErrorMonitor.lt().logError("Error on responding to p2p request",this.loggerId,h._s.As,t)}},u.prototype.J6=function(t,i,n){try{if(this.uploadScore.success(n),this.HD.fW(t)){var r=this.HD.FW(t);r.NU.success(n),r.l6(n,i)}}catch(t){e.ErrorMonitor.lt().logError("Error on request satisfied",this.loggerId,h._s.Ns,t)}},u.prototype.Y6=function(t,i,n,r){try{if(this.uploadScore.a6(n,r),this.HD.fW(t)){var s=this.HD.FW(t);s.NU.a6(n,r),s.p6(n,r,i)}}catch(t){e.ErrorMonitor.lt().logError("Error on request partially satisfied",this.loggerId,h._s.Cs,t)}},u.prototype.K6=function(t,i,n){try{if(this.uploadScore.failed(),this.HD.fW(t)){var r=this.HD.FW(t);r.NU.failed(),r.d6(n,i)}}catch(t){e.ErrorMonitor.lt().logError("Error on request not satisfied",this.loggerId,h._s.ks,t)}},u.prototype.c8=function(i,n,r){var s=this;this.fg.get(n.fragmentId).then(function(t){t?(s.logger.debug("SENDING TO "+i+","+n.fragmentId+","+n.transferId+","+t.length+" DL "+t.length),r.oW.sender.L6(n.fragmentId,n.transferId,t.length,t.headers,t.data)):(s.logger.debug("RECEIVED REQUEST FOR "+n.fragmentId+" FROM "+i+" CAN'T BE SERVED"),s.v8(n.transferId,r))})},u.prototype.v8=function(t,i){try{this.logger.info("SEND DO NOT HAVE "+t+" TO "+i.oW.Ev);var n=new s.$v.Qv.DoNotHave;n.setTransferId(t),i.oW.Sv(s.ev.DoNotHave,n)}catch(t){e.ErrorMonitor.lt().logError("Error on sending do not have",this.loggerId,h._s.Ds,t)}},u.prototype.l8=function(t,i,n){try{this.logger.warn("GOT REQUEST FROM NON-PARTNER "+t+" FOR "+i.fragmentId);var r=new s.$v.Qv.NoPartners;r.setTransferId(i.transferId),n.Sv(s.ev.cv,r)}catch(t){e.ErrorMonitor.lt().logError("Error on send no partners",this.loggerId,h._s.Ms,t)}},u);function u(){this.loggerId="[P2PResponder] "}i.B$=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(34),o=n(0),s=n(5);(r=e=i.d8||(i.d8={}))[r.S=0]="S",r[r.E8=1]="F",r[r.p8=2]="PF";var u=function(t){this.ts=t},a=function(){this.w8=0,this.g8=0,this.b8=0,this.y8=0,this.T8=0,this.m8=0};i.O8=a;var f=(c.prototype.success=function(t){this.event(e.S,t,t)},c.prototype.failed=function(){this.event(e.E8,0,0)},c.prototype.a6=function(t,i){this.event(e.p8,t,i)},c.prototype.event=function(t,i,n){var r=new u(o.Framework.time());r.t=t,r.S8=i,r.R8=i/n,r.I8=(n-i)/n,this._8.set(r.ts,r),this.A8()},c.prototype.A8=function(){var i=this,n=o.Framework.time()-2*s.ea.Xu.ru;if(0<n){var r=[];this._8.forEach(function(t,i){i<n&&r.push(i)}),r.forEach(function(t){i._8.delete(t)})}},c.prototype.IU=function(t){var i=0,n=this.N8(t,s.ea.Xu.ru);return null!=n&&(i=0==n.g8+n.b8+n.y8?0:(n.g8-s.ea.Xu.su*(n.y8+n.b8))/(n.g8+s.ea.Xu.su*(n.y8+n.b8))),i},c.prototype._6=function(t){var i=0,n=this.N8(t,s.ea.Xu.ru);if(null!=n){var r=n.g8+n.b8+n.y8;i=0==r?0:(n.b8+n.y8*s.ea.Xu.hu)/r}return i},c.prototype.C8=function(t){var i=this.N8(!1,t);return null!=i?i.w8:0},c.prototype.N8=function(t,i){if(0==this._8.keys().length)return null;var n=new a,r=o.Framework.time()-i;r<0&&(r=0);var s=new h;return this._8.forEach(function(t,i){r<=i&&s.set(i,t)}),s.forEach(function(t,i){switch(n.w8+=t.S8,t.t){case e.S:n.g8++;break;case e.E8:n.b8++;break;default:n.y8++,n.T8+=t.R8,n.m8+=t.I8}}),n},c.hu=.2,c.eu=.2,c);function c(){this._8=new h}i.V$=f},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),o=n(3),u=n(0),a=n(175),f=n(177),c=n(96),l=n(2),v=n(1),d=(e=f.k8,s(E,e),E.prototype.start=function(t,i){void 0===i&&(i=[]);var n=u.Framework.resolve(u.Framework.ht.m).log(t),r=null;return 0==this.jd.keys().length?(n.debug("TRIGGERING CONNECT "),r=this.D8(),this.M8(t,i)):(n.debug("ALREADY CONNECTED "),r=this.vl.Al(),this.M8(t,i),this.j8.isConnected()&&this.P8(this.tE,t)),r},E.prototype.D8=function(){var n=this,r=u.Framework.et.h;return"localhost"===r&&(r="127.0.0.1:"+location.port),this.logger.debug("CONNECTING.."),this.vl.Al().then(function(t){var i=t.Dl();return n.logger.debug("MY IDENTITY ",i),n.tE=i,n.j8.start(r,i),t})},E.prototype.H8=function(){return o.resolve(new h)},E.prototype.connect=function(i){var n=this,r=o.defer();return this.L8.has(i)?(this.logger.debug("Already connected to "+i+", ignoring"),r.resolve(this.L8.get(i))):this.channelManager.U8(this.tE,i).then(function(t){return n.connected(i,t)}).then(function(t){return r.resolve(t)}).fail(function(t){v.ErrorMonitor.lt().logError("Error establishing connection",n.loggerId,l.kt.Pt,{otherGuid:i}),r.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")}),r.promise},E.prototype.send=function(t,i,n){var r=this.channelManager.send(t,i);return r||(v.ErrorMonitor.lt().logError("Error sending message without channel established",this.loggerId,l.kt.Ht,{otherGuid:t}),this.F8(t)),r},E.prototype.G8=function(t,i,n){this.x8&&this.logger.debug("REC BUF "+n.byteLength+" "+n),this.L8.has(t)?(this.x8&&this.logger.debug("PROC MSG FROM "+t),this.L8.get(t).Hv(n)):v.ErrorMonitor.lt().logError("Error receiving msg without having a connection established",this.loggerId,l.kt.Ht,{otherGuid:t})},E.prototype.connected=function(t,i){if(this.L8.has(t))this.logger.debug("RECONNECTED TO "+t+", RESETTING STATE"),this.L8.get(t).reset();else{this.logger.info("CONNECTED TO "+t);var n=i.Nq;n.init(this.tE,t),this.L8.set(t,n)}return o.resolve(this.L8.get(t))},E.prototype.B8=function(t,i){this.logger.debug("FAILED CONN TO "+i),t.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")},E.prototype.V8=function(t,i){this.logger.info(t+" connected to me"),this.connected(t,i)},E.prototype.F8=function(t){this.L8.has(t)?(this.logger.info("Connection closed to "+t),this.L8.delete(t),this.q8(t)):this.logger.warn("TRYING TO REMOVE A PEER THAT IS NOT THERE: "+t)},E.prototype.Q8=function(){var s=this;c.YW.VW&&u.Framework.setInterval(function(){var r=u.Framework.time();s.L8.forEach(function(t,i){var n=r-t.qv();n>c.YW.QW&&(s.logger.debug("closing stale connection to "+i+" [unused for: "+n+"ms]"),s.disconnect(i))})},c.YW.qW)},E.prototype.stop=function(t){u.Framework.resolve(u.Framework.ht.m).log(t).debug("STOPPING CONNECTIONS AND REMOVING LISTENERS"),this.W8(t)},E.prototype.Y8=function(){},E.prototype.disconnect=function(t){this.L8.has(t)&&this.channelManager.disconnect(t)},E.Nu="availableSendRate",E.Cu="remoteAddress",E.ku="localAddress",E);function E(){var t=e.call(this)||this;return t.loggerId="[HiveNetworkManager] ",t.x8=!1,t.L8=new h,t.Kv=1,t.vl=u.Framework.resolve(u.Framework.ht.u),t.j8=u.Framework.resolve(u.Framework.ht.O),t.channelManager=new a.K8(t.logger,t.j8,t),t.j8.init(t,t.logger,t.channelManager),t.Q8(),t}i.M$=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(3),r=n(0),s=n(176),h=n(96),o=n(2),u=n(1),a=(f.prototype.U8=function(t,i){var n=null;if(i in this.X8){var r=e.defer();r.reject("OTHER ALREADY TRYING TO CONNECT"),n=r.promise}else{this.J8.x8&&this.logger.info("Initiating connection to "+i);var s=this.z8(t,i);n=this.Z8(s,i).connect(i)}return n},f.prototype.t9=function(t){t.i9 in this.X8&&(delete this.n9[t.label],delete this.X8[t.i9]),t.open&&(this.J8.F8(t.i9),t.open=!1)},f.prototype.send=function(t,i){this.J8.x8&&this.logger.debug("DATA "+i.byteLength+" "+i);var n=this.X8[t];return n&&n.channel?(n.send(i),!0):(u.ErrorMonitor.lt().logError("Error sending message wihtout channel established",this.loggerId,o.Zt.ti,{otherGuid:t}),!1)},f.prototype.trigger=function(t,i){var n=i.channel;if(n&&n.label&&this.n9[n.label]){var r=this.n9[n.label];(s=r[t]).call(r,i)}else{var s,e="handle_"+t;(s=this[e])?s.call(this,i):u.ErrorMonitor.lt().logError("Error received a message for a non existing function",this.loggerId,o.Zt.ii,{r9:e})}},f.prototype.handle_offer=function(t){if(this.J8.x8&&this.logger.info("received an offer from "+t.peer.guid+" on channel "+t.channel.label),this.X8[t.peer.guid]&&t.peer<this.J8.tE)this.j8.s9(this.J8.tE,t.peer.guid,t.channel.label);else{var i=this.Z8(t.channel.label,t.peer.guid),n=this.e9(i);i.offer(t,n)}},f.prototype.e9=function(t){var i=this;return r.Framework.setTimeout(function(){u.ErrorMonitor.lt().logError("Error incoming connection timedout",i.loggerId,o.Zt.ni,{otherGuid:t.i9}),t.close()},h.YW.WW)},f.prototype.Z8=function(t,i){var n=new s.h9(this,this.J8,t,this.o9,this.u9,i);return this.n9[t]=n,this.X8[i]=n},f.prototype.handle_offer_rejected=function(t){this.J8.x8&&this.logger.debug("remote peer rejected ",t);var i=this.X8[t.a9];i&&i.close(),delete this.X8[t.a9],delete this.n9[t.channel]},f.prototype.z8=function(t,i){return t.substring(0,Math.max(8,t.length))+":"+i.substring(0,Math.max(8,i.length))+":"+this.Kv++},f.prototype.disconnect=function(t){var i=this.X8[t];i&&i.close()},f);function f(t,i,n){this.logger=t,this.j8=i,this.J8=n,this.loggerId="[ChannelManager] ",this.u9={iceServers:[{urls:"stun:stun.hivestreaming.com:3478"}]},this.Kv=1,this.o9=null,this.n9={},this.X8={}}i.K8=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(5),o=n(2),e=n(3),u=n(0),a=n(1),r=(h.prototype.f9=function(){var t=this;if(this.channel&&"open"!=this.channel.readyState){if(this.x8&&this.logger.debug(this.loggerId+"Check connection "+this.i9),this.c9<=0)return this.logger.debug(this.loggerId+"Closing channel since it couldnt be established to "+this.i9),void this.close();this.c9-=1,this.l9=u.Framework.setTimeout(function(){return t.f9()},this.timeout)}},h.prototype.close=function(){try{this.x8&&this.logger.debug(this.loggerId+"Closing connection to "+this.i9),this.v9(!0),this.channelManager.t9(this),this.Ex&&"closed"!==this.Ex.signalingState&&(this.Ex.close(),this.Ex=null,this.channel&&(this.channel.close(),this.channel=null))}catch(t){a.ErrorMonitor.lt().logError("Error closing the connection",this.loggerId,o.Ut.Jt,{detailedError:t,otherGuid:this.i9})}},h.prototype.connect=function(t){var i=this;this.x8&&this.logger.debug(this.loggerId+"Connecting to "+t),this.i9=t,this.channel=this.Ex.createDataChannel(this.label);var n=this.d9(!0,-1);return this.l9=u.Framework.setTimeout(function(){return i.f9()},this.timeout),n},h.prototype.E9=function(t){var i=this,n=e.defer();return this.Ex.setRemoteDescription(t).then(function(){n.resolve("OK")}).catch(function(t){a.ErrorMonitor.lt().logError("Error setting remote description",i.loggerId,o.Ut.xt,{detailedError:t,otherGuid:i.i9}),n.reject(t)}),n.promise},h.prototype.p9=function(t){var i=this,n=e.defer();return"closed"!==this.Ex.signalingState?this.Ex.setLocalDescription(t).then(function(){n.resolve(i.Ex.localDescription)}).catch(function(t){a.ErrorMonitor.lt().logError("Error setting local description",i.loggerId,o.Ut.Bt,{detailedError:t,otherGuid:i.i9}),n.reject(t)}):(a.ErrorMonitor.lt().logError("Signaling state is closed",this.loggerId,o.Ut.xt),n.reject("Signaling state is closed")),n.promise},h.prototype.createOffer=function(){var i=this,n=e.defer();return this.Ex.createOffer().then(function(t){n.resolve(new RTCSessionDescription(t))}).catch(function(t){a.ErrorMonitor.lt().logError("Error creating offer",i.loggerId,o.Ut.Ft,{detailedError:t,otherGuid:i.i9}),i.close()}),n.promise},h.prototype.createAnswer=function(){var i=this,n=e.defer();return this.Ex.createAnswer().then(function(t){n.resolve(new RTCSessionDescription(t))}).catch(function(t){a.ErrorMonitor.lt().logError("Error creating answer",i.loggerId,o.Ut.Gt,{detailedError:t,otherGuid:i.i9}),n.reject(t)}),n.promise},h.prototype.offer=function(i,n){var r=this;this.x8&&(this.logger.debug(this.loggerId+"Received an offer from "+this.i9),this.logger.debug(this.loggerId+"Offer:",i)),this.Ex.ondatachannel=function(t){r.channel=t.channel,r.d9(!1,n)};var t=new RTCSessionDescription(i.channel.offer);this.i9=i.peer.guid,this.E9(t).then(function(t){if("closed"!==r.Ex.signalingState)return r.update_ice_candidates(i),r.createAnswer()}).then(function(t){return r.p9(t)}).then(function(t){r.logger.debug(r.loggerId+"Sending back an answer [candidates: "+r.w9.length+"]");var i=r.w9;r.w9=new Array,r.channelManager.j8.answer(r,t,i,r.i9),r.g9=!0}).catch(function(t){a.ErrorMonitor.lt().logError("Error responding to offer",r.loggerId,o.Ut.$t,{detailedError:t,otherGuid:r.i9}),r.close()})},h.prototype.answer=function(t){var i=this;this.x8&&this.logger.debug(this.loggerId+"Answer: ",t);var n=new RTCSessionDescription(t.answer);this.E9(n).then(function(){"closed"!==i.Ex.signalingState&&i.update_ice_candidates(t)}).catch(function(t){a.ErrorMonitor.lt().logError("Error setting remote descriptor for the answer received",i.logger,o.Ut.Kt,{detailedError:t,otherGuid:i.i9}),i.close()})},h.prototype.update_ice_candidates=function(t){var n=this;t.channel.ice_candidates.forEach(function(t){n.x8&&n.logger.debug(n.loggerId+"got ICE cand: ",t);var i=new RTCIceCandidate(t);n.Ex.addIceCandidate(i).then(function(){}).catch(function(t){a.ErrorMonitor.lt().logError("Error updating ice candidates",n.loggerId,o.Ut.Yt,{detailedError:t,otherGuid:n.i9})})})},h.prototype.d9=function(i,n){var r=this,s=e.defer();return this.channel.onopen=function(t){return r.b9(s,i,n)},this.channel.onclose=function(t){r.close(),s.reject(r)},this.channel.onmessage=function(t){return r.Nq.Hv(t.data)},this.channel.onerror=function(t){a.ErrorMonitor.lt().logError("Error setting up channel",r.loggerId,o.Ut.qt,{detailedError:t,otherGuid:r.i9}),r.close()},s.promise},h.prototype.b9=function(t,i,n){var r=this;this.open=!0,this.channel.bufferedAmountLowThreshold=Math.min(this.Ex.sctp.maxMessageSize,s.ea.Ju.au),this.channel.addEventListener("bufferedamountlow",function(){r.Nq.Pv()}),t.resolve(this),i||(this.J8.V8(this.i9,this),n&&u.Framework.clearTimeout(n))},h.prototype.y9=function(){var t=this;this.g9&&-1==this.T9&&(this.T9=u.Framework.setTimeout(function(){t.m9(),t.v9(!1)},s.ea.na.ju))},h.prototype.m9=function(){var i=this,t=this.w9;if(this.w9=new Array,t&&0<t.length){var n=t.length;this.channelManager.j8.O9(this.J8.tE,this,t,this.i9).then(function(t){i.x8&&i.logger.debug(i.loggerId+"sent "+n+" more candidates")}).catch(function(t){a.ErrorMonitor.lt().logError("Error sending candidates",i.loggerId,o.Ut.qt,{detailedError:t,otherGuid:i.i9})})}},h.prototype.v9=function(t){t&&-1!=this.T9&&u.Framework.clearTimeout(this.T9),this.T9=-1},h.prototype.send=function(t){var i=this;null!==this.S9&&(u.Framework.clearTimeout(this.S9),this.S9=null);try{this.channel.send(t),this.channel.bufferedAmount<=s.ea.Ju.au&&(this.S9=u.Framework.setTimeout(function(){return i.Nq.Pv()},0))}catch(t){a.ErrorMonitor.lt().logError("Error setting sending ",this.loggerId,o.Ut.zt,{detailedError:t,otherGuid:this.i9}),this.close()}},h);function h(t,i,n,r,s,e){var h=this;this.channelManager=t,this.J8=i,this.label=n,this.o9=r,this.u9=s,this.i9=e,this.x8=!1,this.loggerId="[Channel] ",this.T9=-1,this.Ex=null,this.channel=null,this.S9=null,this.l9=null,this.c9=5,this.timeout=5e3,this.open=!1,this.g9=!1,this.w9=new Array,this.R9=function(){return!!this.channel&&"connecting"===this.channel.readyState},this.logger=u.Framework.resolve(u.Framework.ht.m).log(),this.Nq=u.Framework.resolve(u.Framework.ht.p),this.Nq.init(this.J8.tE,e),this.Ex=new RTCPeerConnection(this.u9),this.Ex.onicecandidate=function(t){t&&t.candidate&&(h.w9.push(t.candidate),h.y9())},this.Ex.onnegotiationneeded=function(){h.createOffer().then(function(t){return h.p9(t)}).then(function(t){h.x8&&h.logger.debug(h.loggerId+"Sending offer to "+h.i9+" [candidates: "+h.w9.length+"]");var i=h.w9;h.w9=new Array;var n=h.channelManager.j8.offer(h.J8.tE,h.i9,h,i,t);return h.g9=!0,n}).catch(function(t){a.ErrorMonitor.lt().logError("Error negotiating with peer",h.loggerId,o.Ut.Vt,{detailedError:t,otherGuid:h.i9}),h.close()})},this.Ex.oniceconnectionstatechange=function(t){h.Ex&&"disconnected"===h.Ex.iceConnectionState&&h.close(),h.Ex&&"failed"===h.Ex.iceConnectionState&&(a.ErrorMonitor.lt().logError("Error establishing ICE connection",h.loggerId,o.Ut.Vt,{otherGuid:h.i9}),h.close())},this.Ex.onsignalingstatechange=function(t){"closed"===t.signalingState&&h.close()}}i.h9=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),e=n(2),h=n(1),o=(u.prototype.M8=function(t,i){void 0===i&&(i=[]),this.logger.info("SET LISTENERS FOR "+t+","+i.length),this.jd.set(t,i)},u.prototype.W8=function(t){this.jd.delete(t)},u.prototype.I9=function(){0<this.jd.length&&this.jd.forEach(function(t,i){t.forEach(function(t){t.HQ&&t.HQ()})})},u.prototype.P8=function(n,t){var r=this;0<this.jd.length&&(t?this.jd.get(t).forEach(function(t){try{t.AE&&t.AE(n)}catch(t){h.ErrorMonitor.lt().logError("Error firing server connect when we have swarm",r.ML,e.kt.Mt,t)}}):this.jd.forEach(function(t,i){t.forEach(function(t){try{t.AE&&t.AE(n)}catch(t){h.ErrorMonitor.lt().logError("Error firing server connect when we do not have swarm",r.ML,e.kt.jt,t)}})}))},u.prototype.q8=function(n){0<this.jd.length&&this.jd.forEach(function(t,i){t.forEach(function(t){t.dQ&&t.dQ(n)})})},u);function u(){this.ML="[Base Network Manager] ",this.jd=new r,this.logger=s.Framework.resolve(s.Framework.ht.m).log()}i.k8=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(3),o=n(0),u=n(17),r=(s.prototype.init=function(t,i,n){this.J8=t,this.logger=i,this.channelManager=n},s.prototype.isConnected=function(){return this.client.UE().isConnected()},s.prototype.start=function(t,i){var n=this;this.logger.debug("MY ID "+i),this.tE=i,this.client&&this.client.UE()?this.client.UE().on(HiveStreamingServices.s$,1,function(t){n._9(t.msg)}):this.logger.error("error getting active services connection"),this.J8.P8(this.tE)},s.prototype._9=function(t){var i=JSON.parse(t);this.J8.x8&&this.logger.debug("RCV MSG FROM SRV ",i),this.channelManager.trigger(i.msgName,i.msg)},s.prototype.A9=function(t,i,n){var r=this.wrap(i,t,n);if(this.client&&this.client.UE()){var s=JSON.stringify(r);this.J8.x8&&this.logger.debug(" FORWARDING REQUEST : "+s);var e=new u.hl(HiveStreamingServices.s$,0,s);return this.client.UE().send(e)}return h.reject()},s.prototype.wrap=function(t,i,n){return{msgId:this.Kv++,destination:n,msg:t,msgName:i}},s.prototype.O9=function(t,i,n,r){var s={channel:{label:i.label,ice_candidates:n}};return this.A9("update_ice_candidates",s,r)},s.prototype.offer=function(t,i,n,r,s){var e={peer:{guid:t,first_seen:o.Framework.time()},channel:{label:n.label,ice_candidates:r,offer:s}};return this.A9("offer",e,n.i9)},s.prototype.s9=function(t,i,n){this.J8.x8&&this.logger.debug("Discovery service rejects offer from peer "+i+" on channel "+n);var r={a9:t,channel:n};return this.A9("answer",r,i)},s.prototype.answer=function(t,i,n,r){var s={answer:i,N9:this.J8.tE,channel:{label:t.label,ice_candidates:n}};return this.A9("answer",s,r)},s);function s(){this.Kv=1,this.client=o.Framework.resolve(o.Framework.ht.R)}i.j$=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(5),e=n(0),h=(o.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.ht.m).log(t.sessionId),this.MD=t.MD,this.C9()},o.prototype.C9=function(){var t=this;e.Framework.setInterval(function(){t.k9()},s.ea.$u.$o)},o.prototype.k9=function(){var i=this;this.Y5.values().filter(function(t){return e.Framework.time()-t.Vp.Rp>s.ea.$u.Xo}).forEach(function(t){i.MD.abort(t.zp),i.XL(t.jp(),t.Pp())})},o.prototype.$L=function(t){this.D9(t.jp(),t.Pp()),this.Y5.set(t.Pp(),t)},o.prototype.XL=function(t,i){this.Y5.delete(i),this.M9(t,i)},o.prototype.ZL=function(t){this.j9(t)},o.prototype.JL=function(t){this.xL.delete(t)},o.prototype.j9=function(t){if(this.xL.set(t.jp(),t.kp()),this.P9.push(t.jp()),this.xL.length>s.ea.$u.Ko){var i=this.P9[0];this.xL.delete(i),this.P9.splice(0,1)}},o.prototype.FL=function(t){return this.xL.has(t)},o.prototype.BL=function(t){return this.xL.get(t)},o.prototype.D9=function(t,i){if(this.H9.has(t))this.H9.get(t).push(i);else{var n=[];n.push(i),this.H9.set(t,n)}},o.prototype.M9=function(t,i){if(this.H9.has(t)){var n=this.H9.get(t),r=n.indexOf(i);-1==r?this.logger.warn("I CANNOT FIND THE REQUEST ID "+i):n.splice(r,1),0==n.length&&this.H9.delete(t)}else this.logger.warn("TRIED TO REMOVE AN OBJECT THAT DOES NOT EXIST")},o.prototype.QL=function(t){var i=[];if(this.L9(t))for(var n=this.H9.get(t),r=0;r<n.length;r++)this.Y5.has(n[r])&&i.push(this.Y5.get(n[r]));return i},o.prototype.L9=function(t){return this.H9.has(t)},o.prototype.iU=function(){return 0!=this.Y5.length},o.prototype.qL=function(t){return this.H9.has(t)},o);function o(){this.xL=new r,this.P9=[],this.Y5=new r,this.H9=new r}i.$u=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(5),e=n(6),h=n(32),o=(u.prototype.setId=function(t){this.U9=t},u.prototype.getId=function(){return this.U9},u.prototype.eX=function(t){this.udpScore=t},u.prototype.vQ=function(){return this.udpScore},u.prototype.hX=function(t){this.F9=t},u.prototype.i1=function(){return this.F9},u.prototype.setContextId=function(t){var i=h.Av.tO(t+"_"+s.ea.Vu.eo).toString(h.Av.Dm.Mm);this.contextId=i},u.prototype.getContextId=function(){return this.contextId},u.prototype.tQ=function(t){this.G9=t},u.prototype.AM=function(){return this.G9},u.prototype.EQ=function(t){this.x9=t},u.prototype.GM=function(){return this.x9},u.prototype.SW=function(t){this.B9=t},u.prototype.xM=function(){return this.B9},u.prototype.OW=function(t){this.V9=t},u.prototype.BM=function(){return this.V9},u.prototype.u1=function(t){this.q9=t},u.prototype.PM=function(){return this.q9},u.prototype.a1=function(t){this.Q9=t},u.prototype.HM=function(){return this.Q9},u.prototype.Zq=function(t){this.W9=t},u.prototype.KM=function(){return this.W9},u.prototype.Y9=function(t){this.K9=t},u.prototype.VM=function(){return this.K9},u.prototype.qX=function(t){this.watchingBitrate=t},u.prototype.VX=function(){return this.watchingBitrate},u.prototype.sQ=function(t){this.rQ=t},u.prototype.WM=function(){return this.rQ},u.prototype.Sx=function(t){this.privateIp=t},u.prototype.getPrivateIp=function(){return this.privateIp},u.prototype.bx=function(t){this.publicIp=t},u.prototype.getPublicIp=function(){return this.publicIp},u.prototype.setReportingGuid=function(t){this.reportingGuid=t},u.prototype.getReportingGuid=function(){return this.reportingGuid},u.prototype.setDelta=function(t){this.delta=t},u.prototype.getDelta=function(){return this.delta},u.prototype.tM=function(t,i){this.X9.set(t,i)},u.prototype.JD=function(t){this.X9.delete(t)},u.prototype.TW=function(){return this.X9},u.prototype.eG=function(){return this.VM()?this.X9.keys():[]},u.prototype.hG=function(){return this.VM()?[]:this.X9.keys()},u.prototype.sX=function(t){this.ticket=t},u.prototype.YM=function(){return this.ticket},u.prototype.J$=function(t){this._X=t},u.prototype.R6=function(){return this._X},u.prototype.M0=function(){return this.srcThroughput},u);function u(){this.udpScore=0,this.F9=0,this.watchingBitrate=-1,this.G9=!1,this.K9=!1,this.x9=!1,this.B9=!1,this.V9=!1,this.X9=new r,this.srcThroughput=new e.ga}i.$$=o},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var a,f=n(10),e=n(182),c=n(2),l=n(1),v=n(5),h=(a=e.J9,s(o,a),o.prototype.e8=function(t,i){var r=[],s=[],e=[],h=[];try{var o=this.PD.PM(),u=this.PD.HM();return t.forEach(function(t){t.LM.peerInfo.type==f.mf.k&&r.push(t);var i=t.LM.peerInfo.internalAs;if(0!=o&&o===i&&s.push(t),v.ea.Ju.du){var n=t.LM.peerInfo.externalAs;0!=u&&u===n&&e.push(t)}t.LM.peerInfo.type==f.mf.Of&&h.push(t)}),0<r.length?a.prototype.e8.call(this,r,i):0<s.length?a.prototype.e8.call(this,s,i):0<e.length?a.prototype.e8.call(this,e,i):a.prototype.e8.call(this,h,i)}catch(t){return l.ErrorMonitor.lt().logError("Error choosing partner for p2p",this.loggerId,c.ns.rs,t),null}},o);function o(){return null!==a&&a.apply(this,arguments)||this}i.q$=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(5),e=n(1),h=n(2),o=(u.prototype.t8=function(t){this.PD=t},u.prototype.e8=function(t,i){var n=this.z9(t);return n?n[0]:null},u.prototype.Z9=function(t,i){return s.ea.Ju.cu*(t.QM()/i)+s.ea.Ju.lu*(1-t.y6())},u.prototype.z9=function(t){var n=this;try{var r=.1;r+=t.map(function(t){return t.QM()}).reduce(function(t,i){return t+i});var i=t.sort(function(t,i){return n.Z9(i,r)-n.Z9(t,r)}),s=[];return i.forEach(function(t){s.push(t.guid+":"+n.Z9(t,r))}),this.logger.debug("SC ["+s.join(", ")+"]"),i}catch(t){return e.ErrorMonitor.lt().logError("Error sorting the partners",this.loggerId,h.zr.Zr,t),null}},u);function u(){this.loggerId="[PickerTRSingle] ",this.logger=r.Framework.resolve(r.Framework.ht.m).log()}i.J9=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v=n(49),d=n(4),E=n(59),p=n(6),w=n(5),a=n(0),r=n(48),s=n(92),e=n(7).ut.$a,h=(o.prototype.init=function(t){this.logger=a.Framework.resolve(a.Framework.ht.m).log(t.sessionId),this.PD=t.PD,this.Z$=t.Z$,this.Tq=t.Tq,this.eU=t.eU},o.prototype.GD=function(t){this.xD=t},o.prototype.v1=function(){this.t7=!0,this.wX()},o.prototype.iQ=function(){if(w.ea.Ku.Po)this.i7();else{var t=!this.PD.GM()||this.PD.AM()||!e;this.logger.debug("REQUEST REMOTE ELECTION "+t),t?this.i7():this.n7()}},o.prototype.i7=function(){var t=this.PD.PM(),i=t&&0!=t?s.gq.ID:s.gq.AS;this.Z$.h1(i)},o.prototype.n7=function(){this.Z$.h1(s.gq.bq)},o.prototype.wX=function(){var t=this;this.fX(),this.r7=a.Framework.setInterval(function(){t.iQ()},w.ea.Ku.Lo),this.eU.FD(),this.iQ()},o.prototype.fX=function(){this.r7&&a.Framework.clearInterval(this.r7)},o.prototype.cX=function(){this.eU.yM(),this.xD.oL()},o.prototype.nQ=function(t){var i=new d;if(t){this.s7().forEach(function(t){i.set(t,v.SD.RD)});var n=!1,r=v.SD.RD;this.PD.VM()&&(r=v.SD.ID,n=!0),this.eU.QD(i,r,n)}else this.eU.QD(i,v.SD.Rf,!1)},o.prototype.f1=function(t,i){var n=this,r=this.e7(i),s=this.eU.qD().isLive();if(t&&0<t.length){var e=new E;e.hiveAddEach(t);var h=w.ea.Ku.No||e.some(function(t){var i=p.La._a(hive.services.protocol.oU.uU,t.key.rankType);return n.logger.info("GOT RANKING "+i+",CRV "+t.cumulatedRankValue+",RV "+t.ranking+",GS "+t.groupSize),n.h7(t)});w.ea.Ku.Co&&(h=this.o7(h));var o=null!=r&&0!=r.length;if(this.logger.debug("Tracker reports ["+r.keys().join(", ")+"]  bitrates"),this.logger.debug("ISLive "+s+" DoElect "+h),w.ea.Ku.Ao&&s){var u=this.s7();if(o&&h){this.PD.Y9(!0),this.logger.info("BECOMING SITE LEADER");var a=new d;u.forEach(function(t){a.set(t,v.SD.RD)}),r.forEach(function(t,i){n.Tq.gW.has(t)||a.set(i,v.SD.ID)}),this.eU.QD(a,v.SD.ID,!1)}else{this.PD.Y9(!1);var f=v.SD.Rf,c=new d;this.PD.GM()&&this.PD.AM()&&(f=v.SD.RD,u.forEach(function(t){c.set(t,v.SD.RD)})),this.eU.QD(c,f,!1)}}}else if(s){w.ea.Ku.No?this.PD.Y9(!0):this.PD.Y9(!1);var l=new d;f=v.SD.Rf,this.PD.GM()&&this.PD.AM()&&(this.s7().forEach(function(t){l.set(t,v.SD.RD)}),f=v.SD.RD),w.ea.Ku.No&&(f=v.SD.ID),this.eU.QD(l,f,!1)}},o.prototype.o7=function(t){return t?!(this.u7=!1):this.PD.VM()?this.u7?this.u7=!1:this.u7=!0:void 0},o.prototype.HW=function(){var t=this.s7(),i=new d;t.forEach(function(t){i.set(t,v.SD.RD)});var n=!1,r=v.SD.RD;this.PD.VM()&&(r=v.SD.ID,n=!0),this.eU.QD(i,r,n)},o.prototype.s7=function(){var n=new E;return this.Tq.gW.forEach(function(t,i){t.peerInfo.watchingBitrate&&!n.has(t.peerInfo.watchingBitrate)&&n.hiveAdd(t.peerInfo.watchingBitrate)}),n.toArray()},o.prototype.e7=function(t){var i=new d,n=this.PD.PM();return t.forEach(function(t){null!=t.watchingBitrate&&(0<n?n===t.internalAs&&i.set(t.watchingBitrate,t.guid):i.set(t.watchingBitrate,t.guid))}),i},o.prototype.h7=function(t){if(t.groupSize<2)return!1;var i=Math.max(w.ea.Ku.Mo,Math.round(t.groupSize*w.ea.Ku.Do));return e||a.Framework.U()&&r.TD.bD?t.ranking<i&&(this.PD.AM()||!this.PD.GM()):t.ranking<i},o.prototype.wM=function(t,i,n,r){var s=1,e=this.xD.CM(n,i),h=w.ea.Ku.Fo*a.Framework.random();if(t==v.SD.RD){var o=this.xD.SL()-h;s=Math.max(1,e-o)}else if(t==v.SD.ID){var u=w.ea.Ku.Go-h;s=Math.max(1,e-u)+r}return s=Math.round(s)},o);function o(){this.t7=!1,this.u7=!1}i.Q$=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(4),e=n(17),h=n(1),o=n(2);n(60);var u=n(19),a=(f.prototype.G0=function(t,i){try{return this.logger.debug("TRACKER CLIENT REGISTERED "+t),this.a7.has(t)||this.a7.set(t,i),this.a7.get(t)}catch(t){h.ErrorMonitor.lt().logError("Error adding new tracker client",this.loggerId,o.Wr.Yr,t)}},f.prototype.wv=function(t){this.a7.delete(t)},f.prototype.gv=function(t){return this.a7.get(t)},f.prototype.e1=function(t){var i=this;if(this.client&&this.client.UE()){try{var n=this.f7.sl(t,"TRACKER_REQ",0)}catch(t){h.ErrorMonitor.lt().logError("Error serializing the new request",this.loggerId,o.Wr.Kr,t)}if(n){var r=new e.hl(HiveStreamingServices.n$,1,n),s=this.client.UE().send(r);s.then(function(){return i.logger.info("TRACKER REQUEST SENT")}),s.fail(function(t){h.ErrorMonitor.lt().logError("Error sending tracker request",i.loggerId,o.Wr.qr)})}}else h.ErrorMonitor.lt().logError("Error sending tracker request because of connection",this.loggerId,o.Wr.Xr)},f.prototype.c7=function(t){t.infos.map(function(t){t.guid=atob(t.guid),t.publicIp=new InetAddress,t.publicIp.address=t.publicIpString,t.privateIp=new InetAddress,t.privateIp.address=t.privateIpString}),t.peerInfo.guid=atob(t.peerInfo.guid),t.peerInfo.publicIp=new InetAddress,t.peerInfo.publicIp.address=t.peerInfo.publicIpString,t.peerInfo.privateIp=new InetAddress,t.peerInfo.privateIp.address=t.peerInfo.privateIpString},f.prototype.init=function(){var n=this;this.logger.debug("TRACKER MANAGER INIT"),this.client&&this.client.UE()?this.client.UE().on(HiveStreamingServices.n$,10,function(t){try{var i=null;try{i=n.f7.Xl(t.msg,"TRACKER_RESP",1,hive.services.protocol.oU.TrackerResponse),n.c7(i)}catch(t){h.ErrorMonitor.lt().logError("Error deserializing the tracker response",n.loggerId,o.Wr.$r,t)}n.l7&&n.logger.debug("RESP "+JSON.stringify(i)),i&&n.a7.has(i.sessionId)?n.a7.get(i.sessionId).rJ(i):n.logger.warn("SESSION ID NOT VALID OR NULL "+i.sessionId)}catch(t){h.ErrorMonitor.lt().logError("Error initializing the tracker manager",n.loggerId,o.Wr.Jr,t)}}):r.Framework.U()||this.logger.warn(this.loggerId+" CANNOT GET ACTIVE CONNECTION")},f);function f(){this.l7=!1,this.loggerId="[TRACKER] ",this.a7=new s,this.f7=new u.rv,this.logger=r.Framework.resolve(r.Framework.ht.m).log(),r.Framework.U()||(this.client=r.Framework.resolve(r.Framework.ht.R))}i.k$=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(27),r=(s.prototype.init=function(t,i){this.peer=t,this.yd=i},s.prototype.v7=function(t){t.uuid=this.yd.pl.tE;var i=this.yd.pl.tG.GF,n=this.d7(i.p2pSubRespQt),r=this.d7(i.srcRespQt);t.cdnRequests+=this.d7(i.srcReqN),t.cdnResponses+=this.d7(i.srcRespN),t.cdnResponseErrors+=this.d7(i.srcRespErrN),t.cdnResponseBytes+=this.d7(i.srcRespQt),t.p2pRequests+=this.d7(i.p2pSubReqN),t.p2pResponses+=this.d7(i.p2pSubRespN),t.p2pResponseErrors+=this.d7(i.p2pSubRespErrN),t.p2pResponseBytes+=this.d7(i.p2pSubRespQt),t.savings=this.d7(n/(r+n)*100)},s.prototype.d7=function(t){return t||0},s.prototype.E7=function(e){var h=this;e.uuid=this.yd.pl.tE;var t=this.yd.pl.tG.BF,o=this.yd.pl.tG.VF;t.forEach(function(t,i){e.partners[i]||(e.partners[i]=new u.rw);var n=e.partners[i];n.uuid=i;var r=h.d7(t.p2pSuccSent);n.sentBytes+=r,e.p2pPartnerTotalSentBytes+=r;var s=h.d7(t.p2pSuccReceived);n.receivedBytes+=s,n.successTransfers+=h.d7(t.p2pSuccReq),n.failedTransfers+=h.d7(t.p2pFailReq),o.has(i)&&(n.rateReceived=o.get(i).rateReceived),n.nw=Date.now()})},s.prototype.render=function(){var t=this.yd.renderStatsCallback;if(t){var i=new u.iw;this.v7(i),this.E7(i);try{t(i)}catch(t){console.warn("error in rendering local stats",t)}}},s);function s(){}i.I$=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(36),r=n(4),c=n(0),l=n(5),v=n(1),d=n(2),s=(e.prototype.init=function(t){this.logger=c.Framework.resolve(c.Framework.ht.m).log(t.sessionId)},e.prototype.sJ=function(t){try{var i=t.jp(),n=t.Xp,r=t.Vp.bp,s=Math.ceil(r/l.ea.Ju.au),e=t.Mp.bitrate,h=0,o=Math.min(l.ea.Ju.au,r);this.p7(i,e);for(var u=o-h;0<s;){var a=null;try{c.Framework.U()||(a=f.wrap(n.slice(h,o))),h+=u}catch(t){v.ErrorMonitor.lt().logError("Error wrapping chunk",this.loggerId,d.Pn.Ln,t)}this.w7.get(i).push(a),s--,u=(o=Math.min(h+l.ea.Ju.au,r))-h}}catch(t){v.ErrorMonitor.lt().logError("Error adding fragment to the fragmentMap",this.loggerId,d.Pn.Hn,t)}},e.prototype.p7=function(t,i){try{if(this.g7.has(i)&&this.g7.get(i).length>l.ea.Cache.tu){var n=this.g7.get(i)[0];this.w7.delete(n),this.g7.get(i).shift()}if(this.g7.has(i))this.g7.get(i).push(t),this.w7.set(t,[]);else{var r=[t];this.g7.set(i,r),this.w7.set(t,[])}}catch(t){v.ErrorMonitor.lt().logError("Error generating the chunk handler hashmaps",this.loggerId,d.Pn.Un,t)}},e.prototype.Z6=function(t,i){return this.w7.has(t)?this.w7.get(t)[i]:null},e.prototype.b7=function(t){return this.g7.get(t)},e.prototype.dX=function(){this.w7=new r,this.g7=new r},e);function e(){this.loggerId="[ChunkHandler] ",this.w7=new r,this.g7=new r}i.P$=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),h=n(5),s=n(0),o=n(2),u=n(1),e=(a.prototype.init=function(t){this.logger=s.Framework.resolve(s.Framework.ht.m).log(t.sessionId),this.HD=t.HD,this.y7=new r,this.T7=new r,this.m7&&this.O7()},a.prototype.JQ=function(i,t,n){try{if(!this.m7)return!1;if(this.y7.has(i)||!t||!n)return!1;var r=this.S7(t,n);return!!(r&&this.T7.has(r)&&this.T7.get(r).length>=h.ea.qu.Eo)&&(u.ErrorMonitor.lt().logError("Error peer violates ip spoofing rules",this.loggerId,o.js.Hs,{privateIp:t,publicIp:n,otherGuid:i}),this.logger.debug(this.loggerId+"Spoofing rule violated for "+i+" with privateIp "+t+" publicIp "+n),!0)}catch(t){return u.ErrorMonitor.lt().logError("Error checking if peer violates ip spoofing rules",this.loggerId,o.js.Ps,{detailedError:t,otherGuid:i}),!1}},a.prototype.nW=function(i,t,n){try{if(this.m7&&n&&t){var r=this.S7(t,n),s=this.y7.get(i);s&&s!=r&&this.R7(i,s),this.I7(i,r)}}catch(t){u.ErrorMonitor.lt().logError("Error adding or updating ip spoofing maps",this.loggerId,o.js.Ls,{detailedError:t,otherGuid:i})}},a.prototype._7=function(t){this.m7&&this._W(t)},a.prototype.dQ=function(t){this.m7&&this._W(t)},a.prototype.I7=function(t,i){this.y7.set(t,i);var n=[];this.T7.has(i)&&-1!=(n=this.T7.get(i)).indexOf(t)||(n.push(t),this.T7.set(i,n))},a.prototype._W=function(t){var i=this.y7.get(t);i?(this.R7(t,i),this.y7.delete(t)):this.logger.warn(this.loggerId+"no ip pair for guid "+t)},a.prototype.R7=function(t,i){var n=this.T7.get(i),r=n.indexOf(t);-1!=r?(n.splice(r,1),0==n.length?this.T7.delete(i):this.T7.set(t,n)):this.logger.warn(this.loggerId+"pair list "+i+" does not contain guid "+t)},a.prototype.S7=function(t,i){return i+":"+t},a.prototype.O7=function(){var e=this;s.Framework.setInterval(function(){try{var s=[];e.T7.forEach(function(t,i){if(t.length>h.ea.qu.Eo){for(var n=[],r=h.ea.qu.Eo;r<t.length;r++)n.push(t[r]);e.logger.warn("IpSpoofing violation for "+i+" - closing: "+n),s.concat(n)}}),s.forEach(function(t){e.HD.uW(t)})}catch(t){u.ErrorMonitor.lt().logError("Error checking periodic ip spoofing tables",e.loggerId,o.js.Us,t)}},h.ea.qu.po)},a);function a(){this.loggerId="[IPSpoofing] ",this.m7=h.ea.qu.vo}i.qu=e},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(97),o=n(5),u=n(63),a=n(0),f=n(2),c=n(1),l=(e=h.ZW,s(v,e),v.prototype.XW=function(t,i){try{return i.sort(u.AU.RU),i.slice(0,t)}catch(t){return c.ErrorMonitor.lt().logError("Error selecting partners to remove",this.A7,f.In.On,t),[]}},v.prototype.JW=function(t,n,r,i){try{return i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)}).slice(0,t)}catch(t){return c.ErrorMonitor.lt().logError("Error selecting partners to add",this.A7,f.In.Sn,t),[]}},v);function v(){var t=e.call(this)||this;return t.A7="[Score Partner Selection] ",t.type="Score",t}i.N7=l;var d=(E.prototype.dW=function(t){try{var i=t.filter(function(t){return!t.oW.Kl.Tv()}),n=a.Framework.time(),r=i.filter(function(t){return n-t.$W>o.ea.Vu.co});return 0<r.length?(r.sort(u.CU.RU),r.slice(0,1)[0]):null}catch(t){return c.ErrorMonitor.lt().logError("Error updating partners out",this.A7,f.In.Rn,t),null}},E);function E(){this.A7="[Score Partner Selection] "}i.U$=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var w=n(4),E=n(98),g=n(5),b=n(0),d=n(6),h=n(63),y=n(2),T=n(1),r=(s.prototype.init=function(t){this.PD=t.PD},s.prototype.YQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-g.ea.Bu.ro)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.oW.Kl.Tv()}),f=b.Framework.time(),c=a.filter(function(t){return f-t.$W>g.ea.Vu.co}),l=Math.min(c.length,o);(e=this.XW(l,c)).length>l&&(u+=e.length-l);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t._U.IU(!1))})}return 0<u&&(s=this.JW(u,i,n,r)),new E.zW(s,e)}catch(t){return T.ErrorMonitor.lt().logError("Error updating in partners",this.C7,y._n.Tn,t),new E.zW([],[])}},s.prototype.XW=function(t,i){var n=this;try{i.sort(h.AU.RU);var r=i.slice(0,t);return i.slice(t,i.length).forEach(function(t){n.k7(t.LM)&&r.push(t)}),r}catch(t){return T.ErrorMonitor.lt().logError("Error selecting partners to remove",this.C7,y._n.On,t),[]}},s.prototype.JW=function(t,i,n,r){var s=this;try{var e=[],h=[],o=[],u=[],a=[],f=[];i.forEach(function(t){f.push(t.guid)});var c=Math.floor(t*g.ea.Vu.uo),l=this.PD.TW();r.forEach(function(t){var i=t.peerInfo.streams;if(i){var n=s.isLeader(t,i,l);n.Iq?n.D7?e.push(t):h.push(t):s.M7(t,g.ea.Vu.oo)?s.k7(t)?a.push(t):u.push(t):o.push(t)}else a.push(t)});var v=this.j7(e,h,o,u,a,t,t,c);return v.slice(0,Math.min(v.length,t))}catch(t){return T.ErrorMonitor.lt().logError("Error selecting partners to add",this.C7,y._n.Sn,t),[]}},s.prototype.j7=function(t,i,n,r,s,e,h,o){try{var u=[],a=[];0<t.length&&b.Framework.random()<g.ea.Vu.ao&&(a=(t=d.La.Sa(t)).slice(0,Math.min(t.length,o)),u.push.apply(u,a),h=e-a.length);var f=[];0<i.length&&(f=(i=d.La.Sa(i)).slice(0,Math.min(i.length,o)),u.push.apply(u,f),h=e-f.length);var c=[];0<n.length&&(c=(n=d.La.Sa(n)).slice(0,Math.min(n.length,o)),u.push.apply(u,c),h=e-c.length);var l=null;0<r.length&&(l=(r=d.La.Sa(r)).slice(0,Math.min(r.length,h)),h=e-((0<c.length?c.length:0)-l.length));var v=[];return 0<h&&0<s.length&&(v=(s=d.La.Sa(s)).slice(0,Math.min(s.length,h)),u.push.apply(u,v)),u}catch(t){return T.ErrorMonitor.lt().logError("Error grouping partners",this.C7,y._n.An,t),[]}},s.prototype.isLeader=function(e,t,h){try{var o=!1,u=this.PD.PM(),a=this.PD.HM(),i=new w;t.forEach(function(t){i.set(t.bitrate,t)});var n=new w;return i.forEach(function(t,i){h.has(i)&&n.set(i,t)}),0<n.keys().length&&n.forEach(function(t,i){var n=h.get(i);if(n&&2<=t.state&&1<=n.type){var r=e.peerInfo.internalAs,s=e.peerInfo.externalAs;o=0<u?u===r:0<a&&a===s}}),{Iq:!1,D7:o}}catch(t){return T.ErrorMonitor.lt().logError("Error identifying if member is leader or same site",this.C7,y._n.Nn,{detailedError:t,otherGuid:e.peerInfo.guid}),{Iq:!1,D7:!1}}},s.prototype.M7=function(i,t){try{var n=this.PD.getDelta(),r=this.PD.VX(),s=this.P7(i,r);return(0!=n||0!=s)&&n<s&&s+t<n}catch(t){return T.ErrorMonitor.lt().logError("Error identifying if member is ahead or behind delta",this.C7,y._n.Cn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.k7=function(i){try{var t=this.PD.getDelta(),n=this.PD.VX(),r=this.P7(i,n);return 0==t&&0==r||r<t}catch(t){return T.ErrorMonitor.lt().logError("Error identifying if member is behind or not retrieveing the same bitrate",this.C7,y._n.kn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.P7=function(i,n){try{var t=i.peerInfo.streams,r=0;return t&&t.forEach(function(t){t.bitrate==n&&(r=t.delta)}),r}catch(t){return T.ErrorMonitor.lt().logError("Error retrieving delta for member's bitrate",this.C7,y._n.Dn,{detailedError:t,otherGuid:i.peerInfo.guid}),0}},s);function s(){this.C7="[Delta Partner Selection] "}i.F$=r;var e=(o.prototype.dW=function(t,i,n){var r=this;try{this.PD=t;var s=this.PD.TW(),e=i.streams;if(e){var h=n.filter(function(t){return!t.oW.Kl.Tv()}),o=b.Framework.time(),u=h.filter(function(t){return o-t.$W>g.ea.Vu.co});if(0==e.filter(function(t){return s.has(t.bitrate)}).length)return null;var a=this.H7(u),f=this.L7(s,a);if(f)return f;var c=s.keys().length,l=u.length,v=Math.round(l/c),d=a.keys().filter(function(t){return s.has(t)}),E=new w;d.forEach(function(t){E.set(t,a.get(t))});var p=this.U7(E,v);return null!=p?p:(e.forEach(function(t){var i=E.get(t.bitrate);if(null!=i){var n=r.F7(i);if(0<n.length&&!g.ea.Vu.fo)return n[0]}}),null)}return null}catch(t){return T.ErrorMonitor.lt().logError("Error selecting partner to update out",this.loggerId,y.Mn.jn,t),null}},o.prototype.H7=function(t){var r=new w;return t.forEach(function(t){var i=t.LM.peerInfo.watchingBitrate;if(i=i||-1,r.has(i)){var n=r.get(i);n.push(t),r.set(i,n)}else r.set(i,[t])}),r},o.prototype.F7=function(t){return t.filter(function(t){if(0==t.NU.C8(g.ea.Xu.ou))return t})},o.prototype.U7=function(r,s){var n=[];r.forEach(function(t,i){n.push({bitrate:i,G7:t.length})}),n.sort(function(t,i){return t.G7>i.G7?1:t.G7<i.G7?0:-1});var e=null;return n.forEach(function(t){var i=r.get(t.bitrate).length;if(s<i){var n=r.get(t.bitrate);0<n.length&&(n.sort(h.CU.RU),e=n[0])}}),e},o.prototype.L7=function(n,t){var r=this,s=null;return t.has(-1)?s=t.get(-1)[0]:t.filter(function(t,i){return!n.has(i)}).forEach(function(t,i){var n=r.F7(t);0<n.length&&(s=n[0])}),s},o);function o(){this.loggerId="[Throughput Partner Selection] ",this.logger=b.Framework.resolve(b.Framework.ht.m).log()}i.G$=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),f=n(9),s=n(35),a=n(26),c=n(10),e=n(14),h=n(5),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.ht.m).log(t.sessionId),this.loggerId="S["+t.sessionId+"]",this.pl=t.yd.pl,this.PD=t.PD,this.yX()},u.prototype.R1=function(t){this.pl.vH.metrics.memN=t,this.pl.tG.metrics.memN=t},u.prototype.tW=function(t,i){this.pl.vH.metrics.lookupTotal++,this.pl.tG.metrics.lookupTotal++,t?(this.pl.vH.metrics.lookupNotFound++,this.pl.tG.metrics.lookupNotFound++,this.pl.vH.metrics.lookupFailed++,this.pl.tG.metrics.lookupFailed++):i?(this.pl.vH.metrics.lookupFailed++,this.pl.tG.metrics.lookupFailed++):(this.pl.vH.metrics.lookupReqEstablished++,this.pl.tG.metrics.lookupReqEstablished++)},u.prototype.yW=function(){this.pl.vH.metrics.lookupReqAccept++,this.pl.tG.metrics.lookupReqAccept++},u.prototype.o6=function(t,i,n,r,s){if(this.x7||r){var e=s==a.fp.pp,h=this.pl.CG(t),o=this.pl.NG(t);h.p2pSuccReq++,h.p2pSuccReceived+=i,o.p2pSuccReq++,o.p2pSuccReceived+=i,e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i),0<n&&!e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i)}},u.prototype.f6=function(t,i,n,r,s,e){if(this.x7||s){var h=e==a.fp.pp,o=this.pl.CG(t),u=this.pl.NG(t);o.p2pFailReq++,o.p2pSuccReceived+=i,o.p2pFailReceived+=r-i,u.p2pSuccReq++,u.p2pSuccReceived+=i,u.p2pFailReceived+=r-i,h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i),0<n&&!h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i)}},u.prototype.c6=function(t,i,n){if(this.x7||n){var r=this.pl.CG(t),s=this.pl.NG(t);r.p2pFailReq++,r.p2pFailReceived+=i,s.p2pFailReq++,s.p2pFailReceived+=i}},u.prototype.v6=function(t,i,n){if(this.x7||n){var r=this.pl.CG(i),s=this.pl.NG(i);r.p2pSuccResp++,r.p2pSuccSent+=t,s.p2pSuccResp++,s.p2pSuccSent+=t}},u.prototype.w6=function(t,i,n,r){if(this.x7||r){var s=this.pl.CG(n),e=this.pl.NG(n);s.p2pPartResp++,s.p2pSuccSent+=t,s.p2pFailSent+=i-t,e.p2pPartResp++,e.p2pSuccSent+=t,e.p2pFailSent+=i-t}},u.prototype.E6=function(t,i,n){if(this.x7||n){var r=this.pl.CG(i),s=this.pl.NG(i);r.p2pFailResp++,r.p2pFailSent+=t,s.p2pFailResp++,s.p2pFailSent+=t}},u.prototype.PL=function(t){t?this.pl.vH.metrics.bitrateUpN++:this.pl.vH.metrics.bitrateDwnN++},u.prototype.UX=function(t){if(-1==[f.wf.yf,f.wf.Tf].indexOf(t.Dp())){var i=t.Dp()!=f.wf.gf;if((this.x7||i)&&(this.pl.RG().reqN++,this.pl.wH().reqN++,t.Dp()==f.wf.bf)){var n=t;if(n.bitrate){var r=n.bitrate;this.pl.IG(r).reqN++,this.pl.EH(r).reqN++}}}else this.pl.RG().reqOtherN++,this.pl.wH().reqOtherN++},u.prototype.cJ=function(t){var i=t.Dp()!=f.wf.gf;if(this.x7||i){var n,r=this.pl.RG(),s=this.pl.wH(),e=null,h=null;if(-1==[f.wf.yf,f.wf.Tf].indexOf(t.Dp()))r.srcReqN++,s.srcReqN++,!i||(n=this.B7(t))&&(e=this.pl.IG(n),h=this.pl.EH(n),e.srcReqN++,h.srcReqN++),t.kp()==a.fp.vp&&(r.srcOtherReqN++,s.srcOtherReqN++,!i||(n=this.B7(t))&&(e.srcOtherReqN++,h.srcOtherReqN++))}},u.prototype.h8=function(t){if(this.pl.RG().p2pSubReqN++,this.pl.wH().p2pSubReqN++,t.Dp()==f.wf.bf){var i=this.B7(t);i&&(this.pl.IG(i).p2pSubReqN++,this.pl.EH(i).p2pSubReqN++)}},u.prototype.V7=function(t,i){this.q7(t,this.pl.wH()),this.q7(t,this.pl.RG());var n=this.B7(t);n&&t.Dp()===f.wf.bf&&this.PD.VX()==n&&(this.q7(t,this.pl.IG(n)),this.q7(t,this.pl.EH(n))),isNaN(i)||(this.pl.vH.metrics.srcThroughput=i)},u.prototype.pJ=function(t,i){var n=t.Dp()!=f.wf.gf;(this.x7||n)&&(-1!=[f.wf.yf,f.wf.Tf].indexOf(t.Dp())?(this.pl.RG().respFallbackOtherN++,this.pl.wH().respFallbackOtherN++):this.V7(t,i))},u.prototype.vJ=function(t,i){if(-1!=[f.wf.yf,f.wf.Tf].indexOf(t.Dp()))this.pl.RG().respFallbackOthertErrN++,this.pl.wH().respFallbackOthertErrN++;else{var n=t.Dp()!=f.wf.gf;if(this.x7||n)if(this.jL(t.type))this.pl.wH().respFallbackErrN++,this.pl.RG().respFallbackErrN++,!n||(r=this.B7(t))&&(this.pl.IG(r).respFallbackErrN++,this.pl.EH(r).respFallbackErrN++),0==t.Vp.Op&&(this.pl.wH().srcRespErrN++,this.pl.RG().srcRespErrN++,!n||(r=this.B7(t))&&t.Dp()===f.wf.bf&&(this.pl.IG(r).srcRespErrN++,this.pl.EH(r).srcRespErrN++)),this.V7(t,i);else if(t.type==a.fp.vp&&-1!=h.ea.Yu.Io.indexOf(t.zp.status))this.pl.RG().fallAgentFailedRespN++,this.pl.wH().fallAgentFailedRespN++,this.pl.RG().reqN--,this.pl.wH().reqN--;else{var r;0==t.Vp.Op&&(this.pl.RG().srcOtherRespErrN++,this.pl.wH().srcOtherRespErrN++),n||(r=this.B7(t))&&t.Dp()===f.wf.bf&&(this.pl.IG(r).srcOtherRespErrN++,this.pl.EH(r).srcOtherRespErrN++),this.V7(t,i)}}},u.prototype.$X=function(t,i){if(i.pq==a.fp.pp)this.pl.wH().respP2pN++,this.pl.RG().respP2pN++;else if(i.pq==a.fp.vp)this.pl.wH().respFallbackN++,this.pl.RG().respFallbackN++;else if(i.pq==a.fp.cp){this.pl.wH().lCacheRespN++,this.pl.RG().lCacheRespN++;var n=r.Framework.U()?i.length:t.Xp.byteLength;this.pl.wH().lCacheRespQt+=n,this.pl.RG().lCacheRespQt+=n}},u.prototype.hJ=function(t,i){var n=t.Dp()!=f.wf.gf;(this.x7||n)&&this.V7(t,i);var r=new hive.snapshots.PartnerMetrics;r.rateReceived=t.lB.QM(),this.pl.tG.VF.set(t.lB.reportingGuid,r)},u.prototype.tJ=function(t){if(0!=t.Jp&&(this.pl.RG().p2pSubRespErrN++,this.pl.wH().p2pSubRespErrN++,t.Dp()==f.wf.bf)){var i=this.B7(t);i&&(this.pl.IG(i).p2pSubRespErrN++,this.pl.EH(i).p2pSubRespErrN++)}},u.prototype.a8=function(t){if(this.pl.RG().p2pSubRespExpN++,this.pl.wH().p2pSubRespExpN++,t.Dp()==f.wf.bf){var i=this.B7(t);i&&(this.pl.IG(i).p2pSubRespExpN++,this.pl.EH(i).p2pSubRespExpN++)}},u.prototype.q7=function(t,i){var n=t.Vp.bp,r=t.Vp.Op,s=t.Vp.yp,e=t.Vp.Tp,h=t.Vp.mp;if(t.Dp()!=f.wf.yf){if(t.Vp.wp&&e&&e<n){var o=e/n;i.p2pSubRespPartN+=o,this.jL(t.type)||(i.p2pAgenTrafficFailureQt+=n-s)}if(0!=h&&(h==n&&i.lCacheRespN++,i.lCacheRespQt+=t.Vp.mp),0!=s)if(s==n&&(this.jL(t.type)&&i.respP2pN++,i.p2pSubRespN++),i.p2pSubReqQt+=n,i.p2pSubRespQt+=s,i.p2pAgenTrafficSuccessQt+=t.Vp.p2pAgenTrafficSuccessQt,i.p2pDirectQt+=s,t.lB.LM.peerInfo.type==c.mf.k)i.p2pUdpbQt+=s,i.p2pNatQt+=s;else{var u=this.PD.PM();u&&0<u&&(null!=t.uq?u===t.uq.internalAs&&(i.p2pNatQt+=s):this.logger.warn("Missing partner info"))}}if(0!=r){if(this.Q7(t.type)&&(i.srcOtherReqQt+=t.Vp.Op),r==n)this.Q7(t.type)?(i.srcOtherRespN++,i.srcOtherRespQt+=t.Vp.Op,i.srcOtherOverQt+=t.Vp.Op,i.fallAgentRespN++):i.respFallbackN++,i.srcRespN++;else{i.srcRespErrN++;var a=r/(s+r);i.respFallbackN=a,i.respP2pN=1-a,this.Q7(t.type)&&(i.srcOtherRespErrN++,i.srcOtherRespQt+=t.Vp.Op,i.srcOtherOverQt+=t.Vp.Op,i.fallAgenTrafficFailureQt+=t.Vp.Op)}i.srcReqQt+=t.Vp.Op,i.srcRespQt+=t.Vp.Op,i.srcOverQt+=t.Vp.Op,this.Q7(t.type)&&(i.fallAgenTrafficSuccessQt+=t.Vp.Sp)}},u.prototype.B7=function(t){var i=null;if(t.Mp instanceof s.wA){var n=t.Mp;n.bitrate&&(i=n.bitrate)}return i},u.prototype.jL=function(t){return t!=a.fp.pp&&t!=a.fp.vp},u.prototype.Q7=function(t){return!this.jL(t)},u.prototype.yX=function(){this.W7()},u.prototype.pX=function(){r.Framework.clearInterval(this.Y7),this.Y7=null},u.prototype.W7=function(){var t=this;null==this.Y7&&(this.Y7=r.Framework.setInterval(function(){t.pl.yG=t.PD.HM(),t.pl.bG=t.PD.PM(),t.pl.TG=t.PD.getPublicIp()},h.ea.ta.Du))},u);function u(){this.x7=!0===e.HiveConfig.Stats.AudioAccounting,this.Y7=null}i.R$=o},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(97),c=n(5),o=n(63),l=n(0),v=n(2),d=n(1),E=n(47),u=(e=h.ZW,s(a,e),a.prototype.init=function(t){e.prototype.init.call(this,t),this.OX=t.OX},a.prototype.XW=function(t,i){try{return i.sort(o.AU.RU),i.slice(0,t)}catch(t){return d.ErrorMonitor.lt().logError("Error selecting partners to remove",this.A7,v.In.On,t),[]}},a.prototype.JW=function(t,n,r,i){try{var s=i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)});if(0<s.length){this.OX.K7(),this.OX.X7(!0);var e=[],h=0;for(s.forEach(function(t){h+=t.P1(),t.P1()});0<s.length&&e.length<t;)for(var o=l.Framework.random()*h,u=0,a=0;a<s.length;a++){var f=s[a];if(u<=o&&o<=u+f.P1()){e.push(f),h-=f.P1(),s.splice(a,1);break}u+=f.P1()}return c.ea.ra.Hu&&(s.sort(function(t,i){return i.P1()-t.P1()}),E.hD.sD(null,null,"local_score",this.PD.getReportingGuid(),[[s.length],e.map(function(t){return t.P1()}),s.reduce(function(t,i){return 0<i.P1()&&t.push(i.P1()),t},[])],6)),e}return[]}catch(t){return d.ErrorMonitor.lt().logError("Error selecting partners to add",this.A7,v.In.Sn,t),[]}},a);function a(){var t=e.call(this)||this;return t.A7="[Score Partner Selection] ",t.type="Locality",t}i.L$=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(5),r=(s.prototype.init=function(t){this.PD=t.PD},s.prototype.K7=function(){},s.prototype.J7=function(t,i){var n=0,r=t.split("."),s=i.split(".");if(4==r.length&&4==s.length)for(var e=0;e<r.length&&n==e;)r[e]==s[e]&&n++,e++;return n},s.prototype.z7=function(t){var i=this,n=!1;return t.peerInfo.streams.forEach(function(t){t.bitrate==i.PD.VX()&&(n=!0)}),n},s.prototype.N1=function(t){var i=this.PD.getPrivateIp()?this.PD.getPrivateIp().split(".").slice(0,2).join("."):null,n=this.PD.PM(),r=this.PD.getPublicIp(),s=this.PD.HM(),e=!1,h=0;if(0<s&&s===t.peerInfo.externalAs&&(h+=u.ea.sa.Lu,e=!0,0==n&&(h+=u.ea.sa.Uu)),r&&t.peerInfo.publicIpString){var o=this.J7(r,t.peerInfo.publicIpString);h+=o,4===o&&(e=!0)}e&&0<n&&n===t.peerInfo.internalAs&&(h+=u.ea.sa.Uu),e&&t.peerInfo.privateIpString&&t.peerInfo.privateIpString.startsWith(i)&&(h+=u.ea.sa.Fu),this.z7(t)&&(h+=u.ea.sa.Gu),h/=u.ea.sa.xu,t.H1(h)},s.prototype.X7=function(t){void 0===t&&(t=!1)},s);function s(){}i.W$=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(3);n(194);var r=n(0),h=n(1),o=n(2),u=n(17),s=n(8),a=n(19),f=(c.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.ht.m).log(t.sessionId),this.PD=t.PD},c.prototype.Z7=function(){var s=this;this.client&&this.client.UE()?this.ttt().then(function(t){s.logger.debug(s.loggerId+"Peer Locality Info constructed with privateip "+t.itt.privateIp);var i=null;try{i=s.f7.sl(t,"LOCALITY_INFO",0)}catch(t){h.ErrorMonitor.lt().logError("Error serializing locality info update",s.loggerId,o.Ue.we)}if(i){var n=new u.hl(HiveStreamingServices.h$,0,i),r=s.client.UE().send(n);r.then(function(){return s.logger.info("LOCALITY INFO UPDATE SENT")}),r.fail(function(t){h.ErrorMonitor.lt().logError("Error sending locality update",s.loggerId,o.Ue.qr)})}}):h.ErrorMonitor.lt().logError("Error sending locality update because of missing connection",this.loggerId,o.Ue.Xr)},c.prototype.ttt=function(){var n=this,t=e.defer(),i=new PeerLocalityInfo;i.ntt=this.PD.getReportingGuid();var r=new CustomerInfo;r.partnerId=this.PD.YM().pE(),r.customerId=this.PD.YM().wE(),i.stt=r;var s=new NetworkInfo;return this.SE.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();n.PD.Sx(i)}).fail(function(t){h.ErrorMonitor.lt().logError("Error getting connectivity info",n.loggerId,o.Ue.Fr)}).finally(function(){""!=n.PD.getPublicIp()&&(s.publicIp=n.PD.getPublicIp()),""!=n.PD.getPrivateIp()&&(s.privateIp=n.PD.getPrivateIp()),i.itt=s,t.resolve(i)}),t.promise},c.prototype.AE=function(t){this.Z7()},c);function c(){this.loggerId="[LocalityServiceClient] ",this.SE=r.Framework.resolve(s.pf.af),this.f7=new a.rv,r.Framework.U()||(this.client=r.Framework.resolve(r.Framework.ht.R))}i.S$=f},function(t,i,n){var s=n(28);CustomerInfo=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))},CustomerInfo.prototype={},CustomerInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.partnerId=t.xw().value:t.Bw(n);break;case 2:n==s.Type.STRING?this.customerId=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},CustomerInfo.prototype.write=function(t){t.Ww("CustomerInfo"),null!==this.partnerId&&void 0!==this.partnerId&&(t.Yw("partnerId",s.Type.STRING,1),t.Kw(this.partnerId),t.$w()),null!==this.customerId&&void 0!==this.customerId&&(t.Yw("customerId",s.Type.STRING,2),t.Kw(this.customerId),t.$w()),t.Jw(),t.zw()},NetworkInfo=function(t){this.privateIp=null,this.publicIp=null,t&&(void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp))},NetworkInfo.prototype={},NetworkInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.privateIp=t.xw().value:t.Bw(n);break;case 2:n==s.Type.STRING?this.publicIp=t.xw().value:t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},NetworkInfo.prototype.write=function(t){t.Ww("NetworkInfo"),null!==this.privateIp&&void 0!==this.privateIp&&(t.Yw("privateIp",s.Type.STRING,1),t.Kw(this.privateIp),t.$w()),null!==this.publicIp&&void 0!==this.publicIp&&(t.Yw("publicIp",s.Type.STRING,2),t.Kw(this.publicIp),t.$w()),t.Jw(),t.zw()},PeerLocalityInfo=function(t){this.ntt=null,this.stt=null,this.itt=null,t&&(void 0!==t.ntt&&null!==t.ntt&&(this.ntt=t.ntt),void 0!==t.stt&&null!==t.stt&&(this.stt=new CustomerInfo(t.stt)),void 0!==t.itt&&null!==t.itt&&(this.itt=new NetworkInfo(t.itt)))},PeerLocalityInfo.prototype={},PeerLocalityInfo.prototype.read=function(t){for(t.ib();;){var i=t.Gw(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.ntt=t.xw().value:t.Bw(n);break;case 2:n==s.Type.STRUCT?(this.stt=new CustomerInfo,this.stt.read(t)):t.Bw(n);break;case 3:n==s.Type.STRUCT?(this.itt=new NetworkInfo,this.itt.read(t)):t.Bw(n);break;default:t.Bw(n)}t.qw()}t.Qw()},PeerLocalityInfo.prototype.write=function(t){t.Ww("PeerLocalityInfo"),null!==this.ntt&&void 0!==this.ntt&&(t.Yw("agentId",s.Type.STRING,1),t.Kw(this.ntt),t.$w()),null!==this.stt&&void 0!==this.stt&&(t.Yw("customerInfo",s.Type.STRUCT,2),this.stt.write(t),t.$w()),null!==this.itt&&void 0!==this.itt&&(t.Yw("networkInfo",s.Type.STRUCT,3),this.itt.write(t),t.$w()),t.Jw(),t.zw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.startServer=function(t,i){try{this.ett&&this.ett.startServer(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.htt=function(){try{this.ett&&this.ett.htt()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.broadcast=function(t,i,n){try{this.ett&&this.ett.broadcast(t,i,n)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.vX=function(){try{this.ett&&this.ett.vX()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.ott=function(t,i){try{this.ett&&this.ett.ott(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e);function e(){this.loggerId="[ProxyUDPB]",this.logger=r.Framework.resolve(r.Framework.ht.m).log(),this.ett=window.myUdpBroadcaster,this.ett||this.logger.error(this.loggerId+" helper undefined")}i.K$=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),e=n(5),h=n(10),o=n(197),s=n(14),u=(a.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.ht.m).log(t.sessionId),this.ett=t.SX,this.PD=t.PD},a.prototype.tX=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.jd=t,this.contextId=this.PD.getContextId()},a.prototype.startServer=function(){var s=this;this.logger.debug(this.loggerId+"START UDP BROADCAST SERVER"),this.ett.startServer(e.ea.UDPBroadcast.Eu,function(t,i){if(-1<s.utt){var n=o.att.el(i);if(n.uuid!=s.guid&&n.streamId==s.contextId&&n.p2pProtocolVersion===e.ea.Vu.eo){s.logger.debug(s.loggerId+"I RECEIVED A MESSAGE FROM "+n.uuid);var r=new h.Nf(h.mf.k,null,n.isLeader);r.guid=n.uuid,r.privateIpString=t,r.rankValue=n.rankValue,s.jd.forEach(function(t){return t.Dq([r],!1)})}}})},a.prototype.bX=function(){var t=this;this.logger.info(this.loggerId+"START BROADCAST EVERY "+e.ea.UDPBroadcast.pu),-1!=this.utt&&r.Framework.clearInterval(this.utt),this.utt=r.Framework.setInterval(function(){t.ftt()},e.ea.UDPBroadcast.pu),this.ftt()},a.prototype.vX=function(){-1!=this.utt&&r.Framework.clearInterval(this.utt)},a.prototype.ftt=function(){var t=new o.att(this.contextId,this.PD.getId(),this.PD.vQ(),this.PD.AM(),e.ea.Vu.eo);this.logger.info(this.loggerId+"BROADCAST MESSAGE contextId "+t.streamId+" id "+t.uuid+" udpscore "+t.rankValue+" lan leader "+t.isLeader+" protobufVersion "+t.p2pProtocolVersion),s.HiveConfig.UDPBroadcast.usiz&&(e.ea.UDPBroadcast.wu=s.HiveConfig.UDPBroadcast.usiz),this.ett.broadcast(e.ea.UDPBroadcast.Eu,e.ea.UDPBroadcast.wu,t.sl())},a.prototype.AE=function(t){this.logger.info("UDPDISCOVERY SERVER CONNECTED"),this.ctt||(this.guid=t,this.startServer(),this.bX())},a);function a(){this.ctt=!1,this.loggerId="[UDPBDiscovery] ",this.utt=-1}i.Y$=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.sl=function(){var t={streamId:this.streamId,uuid:this.uuid,rankValue:this.rankValue,isLeader:this.isLeader,p2pProtocolVersion:this.p2pProtocolVersion};return JSON.stringify(t,this.ltt)},s.prototype.ltt=function(t,i){if(null!==i)return i},s.el=function(t){var i=t,n=JSON.parse(i);return new s(n.streamId,n.uuid,n.rankValue,n.isLeader,n.p2pProtocolVersion)},s);function s(t,i,n,r,s){this.streamId=t,this.uuid=i,this.rankValue=n,this.isLeader=r,this.p2pProtocolVersion=s}i.att=r},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(89),f=n(199),u=n(90),c=n(91),l=n(62),a=n(26),v=n(35),d=n(3),E=n(1),o=(e=h.Eq,s(p,e),p.prototype.vtt=function(){var t=this;setTimeout(function(){t.dtt()},1e3)},p.prototype.dtt=function(){var i=this;this.Ett.port.onmessage=function(t){i.logger.debug("LRU length : "+t.data.response)},this.logger.debug("Send message"),this.Ett.port.postMessage({type:f.wtt.ptt}),this.vtt()},p.prototype.contains=function(t){var i=this,n=d.defer();if(this.hq.has(t))n.resolve(!0);else{var r=!1,s=setTimeout(function(){r=!0,i.logger.debug("VOD CONTAINS TIMEDOUT : "+t),n.resolve(!1)},1e3);this.Ett.port.onmessage=function(t){clearTimeout(s),r||(t.data.response?n.resolve(!0):n.resolve(!1))},this.Ett.onerror=function(t){i.logger.error(t)},this.Ett.port.postMessage({type:f.wtt.gtt,btt:t})}return n.promise},p.prototype.ytt=function(t){var i=d.defer(),n=this.hq.get(t);if(null!=n){var r=null;n.content.forEach(function(t,i){if(l.SU.OU(i).gU())return(r=t).headers=n.headers,void(r.uq=n.uq)}),i.resolve(r)}else i.resolve(null);return i.promise},p.prototype.get=function(i){var n=this,r=d.defer();if(this.hq.has(i))this.ytt(i).then(function(t){r.resolve(t)});else{this.logger.debug("SHAREDWORKER: Permission Request to READ");var s=Date.now();this.Ttt(f.wtt.mtt,s).then(function(t){n.logger.debug("SHAREDWORKER: Permission Request To READ : "+t),t?n.Ott(i).then(function(t){n.logger.debug("SHAREDWORKER:  Read Completed "),n.Ett.port.postMessage({type:f.wtt.Stt,id:s}),r.resolve(t)}):r.reject(!1)})}return r.promise},p.prototype.Ott=function(n){var r=this,s=d.defer(),e=null,h=!1,o=setTimeout(function(){h=!0,s.resolve(e)},1e3);return this.Rtt.onmessage=function(t){if(clearTimeout(o),!h){if(t.data.response){var i=new a.Cp;i.wp=!1,i.gp=!0,i.bp=t.data.data.length,i.yp=0,i.mp=t.data.data.length,i.Op=0,(e=new u.aq(t.data.data.length,t.data.data.content,i,a.fp.cp)).headers=t.data.data.Itt}else r.Ett.port.postMessage({type:f.wtt._tt,btt:n});s.resolve(e)}},this.Rtt.postMessage({type:f.wtt.Att,btt:n}),s.promise},p.prototype.J=function(){var i=this;this.logger.debug("FLUSHING IN-MEMORY CACHE");for(var t=[],n=0;n<this.fq.length;n++)this.hq.get(this.fq[n]).wq||t.push(this.fq[n]);this.logger.debug("Flush "+t.length+" in memory"),0<t.length?this.Ntt(t).then(function(t){i.Ctt()}):this.Ctt()},p.prototype.Ctt=function(){var r=this,s=0,e=0;this.logger.debug("PURGING PERSISTENTDB's IN-MEMORY CACHE"),this.fq.every(function(t,i){var n=r.hq.get(t).size();return s+n>r.nq?(e=i,r.logger.debug("CACHE TOO BIG "+(s+n)),!1):(s+=n,!0)})||this.fq.splice(e,this.fq.length-1).forEach(function(t){r.hq.delete(t)}),this.eq()},p.prototype.Ntt=function(i){var n=this,r=d.defer();this.logger.debug("SHAREDWORKER:  Permission Request To Write ");var s=Date.now();return this.Ttt(f.wtt.ktt,s).then(function(t){n.logger.debug("SHAREDWORKER:  Permission Request To WRITE : "+t),t?(n.logger.debug("Flush the contents"),n.Dtt(i).then(function(t){n.logger.debug("SHAREDWORKER:  WRITE COMPLETED"),n.Ett.port.postMessage({type:f.wtt.Mtt,id:s}),r.resolve(t)})):r.resolve(t)}),r.promise},p.prototype.Dtt=function(o){var u=this,a=d.defer();return this.jtt(o[0]).then(function(t){if(t)o.shift(),0==o.length?a.resolve(!0):u.Dtt(o).then(function(t){a.resolve(t)});else{var i=!1,n=setTimeout(function(){i=!0,o.shift(),0==o.length?a.resolve(!1):u.Dtt(o).then(function(t){a.resolve(t)})},1e3);u.Rtt.onmessage=function(t){t.data&&(u.hq.get(o[0]).wq=!0,u.Ett.port.postMessage({type:f.wtt.Ptt,btt:o[0],size:u.hq.get(o[0]).size()})),clearTimeout(n),i||(o.shift(),0==o.length?t.data?a.resolve(!0):a.resolve(!1):u.Dtt(o).then(function(t){a.resolve(t)}))},u.Rtt.onerror=function(t){u.logger.error(t)};var r=u.hq.get(o[0]),s=null,e=null;r.content.forEach(function(t,i){if(l.SU.OU(i).gU())return e=i,void((s=t).headers=r.headers)});var h={pA:r.Mp.jp(),headers:r.headers,length:r.size(),Htt:e,content:s.data,Mp:r.Mp};u.Rtt.postMessage({type:f.wtt.Ltt,data:h})}}),a.promise},p.prototype.jtt=function(i){var n=this,r=d.defer(),s=!1,e=setTimeout(function(){s=!0,r.resolve(!1)},1e3);return this.Ett.port.onmessage=function(t){clearTimeout(e),s||(n.logger.debug("SHAREDWORKER:  CONTAINS REQUEST : "+i+" : "+t.data.response),t.data.response?r.resolve(!0):r.resolve(!1))},this.Ett.onerror=function(t){n.logger.error(t),r.resolve(!1)},this.Ett.port.postMessage({type:f.wtt.gtt,btt:i}),r.promise},p.prototype.Ttt=function(i,t){var n=this,r=d.defer(),s=!1,e=setTimeout(function(){s=!0,r.resolve(!1)},2e3);return this.Ett.port.onmessage=function(t){clearTimeout(e),s?i==f.wtt.mtt?n.Ett.port.postMessage({type:f.wtt.Stt}):i==f.wtt.ktt&&n.Ett.port.postMessage({type:f.wtt.Mtt}):r.resolve(t.data.response)},this.Ett.onerror=function(t){n.logger.error(t)},this.Ett.port.postMessage({type:i,id:t}),r.promise},p.prototype.OM=function(t){return[]},p.prototype.cq=function(t){var h=this,o=d.defer(),u=[],a=Date.now();return this.Ttt(f.wtt.mtt,a).then(function(t){if(t){var s=!1,e=setTimeout(function(){s=!0,h.Ett.port.postMessage({type:f.wtt.Stt,id:a}),o.resolve(u)},4e3);h.Rtt.onmessage=function(t){if(clearTimeout(e),t.data.response&&null!=t.data)for(var i=0;i<t.data.elements.length;i++){var n=new v.wA(t.data.elements[i].url,t.data.elements[i].fA,t.data.elements[i].EA,t.data.elements[i].lA,t.data.elements[i].duration,t.data.elements[i].bitrate,t.data.elements[i].vA),r=new c.oq(n);r.headers=t.data.elements[i].Itt,r.totalSize=t.data.elements[i].length,u.push(r)}h.Ett.port.postMessage({type:f.wtt.Stt,id:a}),s||o.resolve(u)},h.Rtt.onerror=function(t){E.ErrorMonitor.lt().logError("GET ELEMENTS ERROR",{error:t}),h.Ett.port.postMessage({type:f.wtt.Stt,id:a})},h.Rtt.postMessage({type:f.wtt.Utt})}}),o.resolve(null),o.promise},p);function p(){return e.call(this)||this}i.N$=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.ktt="write_request",s.gtt="contains_request",s.Ptt="write_id_operation",s.mtt="read_request",s.Stt="read_completed",s.Mtt="write_completed",s._tt="update_lru",s.ptt="lru_stats",s.Att="read_operation",s.Utt="read_elements_operation",s.Ftt="read_keys_operation",s.Ltt="write_operation",s);function s(){}i.wtt=r},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(21),o=(e=h.HiveTechOptions,s(u,e),u);function u(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion="3.0.0",t.renderStatsCallback=void 0,t}i.m$=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(3),e=n(22),o=n(15),r=n(202),u=n(27),a=n(64),s=n(18),f=n(24),c=n(46),l=n(99),v=n(14),d=n(1),E=n(56),p=n(31),w=n(203),g=n(29),b=navigator,y=(T.prototype.getName=function(){return T.WP},T.prototype.getVersion=function(){return this.version},T.prototype.KP=function(){return!1},T.prototype.$P=function(){var r=this;if(null==this.Gtt||1e4<Date.now()-this.xtt){var t="//"+a.UU.Ok+":"+a.UU.kU+"/version.json";this.Gtt=o.bc(t).then(function(t){var i=JSON.parse(t);r.state=i.state,r.version=i.version;var n=i.app;return r.logger().debug(" Version: "+n+", Min: "+r.options_.minVersion+", Max: "+r.options_.Btt),n&&n>=r.options_.minVersion&&(""===r.options_.Btt||n<r.options_.Btt)?"ready"===r.state?"ready":(r.logger().warn(r.id()+"Client not ready: "+r.state),h.reject(new u.HiveTechError(u.aw.fw,"state "+r.state))):h.reject(new u.HiveTechError(u.aw.vw,"Hive Electron version "+n+" is not matching the version requirements MIN: "+r.options_.minVersion+", MAX: "+r.options_.Btt))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned "+t.status),r.logger().warn(r.id()+i),h.reject(new u.HiveTechError(u.aw.fw,i))}).catch(function(t){return t instanceof u.HiveTechError?h.reject(t):h.reject(new u.HiveTechError(u.aw.fw,"error parsing response"))}),this.xtt=Date.now()}return this.Gtt},T.prototype.initSession=function(n,t){var r=this,i=this.YP.options().readyCheckTimeout,s="Client Ready check timed out after "+i;return(i&&0<i?this.$P().timeout(i,s):this.$P()).then(function(){return r.resolveTicketPromise(n).then(function(t){var i=r.XP(n,t);return r.Vtt(i)})}).catch(function(t){return t instanceof u.HiveTechError?h.reject(t):h.reject(new u.HiveTechError(u.aw.TICKET_ERROR,"generic error resolving ticket"))})},T.prototype.rF=function(t,n){var r=this,i=this.YP.options().readyCheckTimeout,s="Client Ready check timed out after "+i;return(i&&0<i?this.$P().timeout(i,s):this.$P()).then(function(){return r.qtt(n).then(function(t){var i=r.XP(null,t,n);return r.Vtt(i)})}).catch(function(t){return t instanceof Error&&t.message===s?h.reject(new u.HiveTechError(u.aw.dw,t.message)):t instanceof Error?h.reject(new u.HiveTechError(u.aw.TICKET_ERROR,"generic error resolving ticket")):h.reject(t)})},T.prototype.Vtt=function(t){if(null!=t)return w.Qtt.nB(t,this.YP.getPluginId()),w.Qtt.registerComm(this.YP,this.YP.getPluginId()),e.HiveRequestFactory.registerTech(this.YP.getPluginId(),this.getName()),t;throw new u.HiveTechError(u.aw.TICKET_ERROR,"error generating session")},T.prototype.hB=function(t){this.ad=t},T.prototype.JP=function(){return this.options_.initTimeout},T.prototype.isActive=function(t,i){var n=i.manifest.toLowerCase(),r=t.toLowerCase(),s=n.indexOf(".ism/manifest");if(-1<s){var e=n.substring(0,s);if(-1<r.indexOf(e))return-1<r.indexOf(".ism/manifest(format=mpd-time-csf)")?this.ad?(i.ticket.SourceURL=t,!0):this.E$(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.E$(i,"Protocol not supported by HiveJsProxy tech, downgrading to StatsJS")}else if(r===n)return!!this.ad||this.E$(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},T.prototype.E$=function(i,t){var n=this;return i.tech=this.BU,p.Hive.Reporting().initSession(i.ticket.pluginId,i.ticket.ticketUrl,!1).then(function(t){i.bd(t),t.ticket,n.logger().debug("[HiveJSProxy] downgrade verified ticket "+i.ticket.ticketUrl),n.YP.updatePlayerInfo(t)}).fail(function(t){d.ErrorMonitor.lt().logError("Error initializing session when downgrading session tech",n.loggerId,{error:t})}),this.ad&&this.ad.Wtt(),this.ad=void 0,e.HiveRequestFactory.registerTech(this.YP.getPluginId(),E.StatsJS.WP),this.YP.logger().warn("[HiveJsProxy] "+t),this.onError(new u.HiveTechError(u.aw.lw,t)),!0},T.prototype.pd=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [onUnload:"+n+"]");var t="//"+a.UU.Ok+":"+a.UU.kU+"/proxy/"+this.YP.getPluginId()+"/stop";n&&b.sendBeacon?(b.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):o.bc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},T.prototype.gl=function(t,i){var n=i?s.ul.IDLE:s.ul.al;this.logger().debug(this.id()+"idle state: "+s.ul[n])},T.prototype.ZP=function(t,i){var n=this,r="playing-point="+i.playingPoint;r+="&buffer-length="+i.bufferLength,r+="&total-buffering="+i.totalBuffering,r+="&width="+i.width,r+="&height="+i.height,r+="&fullscreen="+i.fullscreen;var s="//"+a.UU.Ok+":"+a.UU.kU+"/proxy/"+this.YP.getPluginId()+"/stats/put?"+r;return o.bc(s).fail(function(t){return n.logger().warn(n.id()+"error sending feedback to Hive Client",t),h.reject(t)})},T.prototype.rH=function(t,i,n){var r=this,s="//"+a.UU.Ok+":"+a.UU.kU+"/proxy/"+this.YP.getPluginId()+"/event?type="+i;if(null!=n)for(var e in n)s+="&"+e+"="+n[e];return this.logger().debug(this.id()+"event "+f.PlayerEvents[i],null!=n?n:""),o.bc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),h.reject(t)})},T.prototype.lE=function(t,i){return h.resolve(!0)},T.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{i=this.options_.onError(t)}catch(t){d.ErrorMonitor.lt().logError("exception in user-defined onError callback",this.id(),t)}return i},T.prototype.onActiveSession=function(t){var i=this.YP.getPlayerSource();0===i.indexOf("//")&&(i=location.protocol+i);var n=o.wc(a.UU.MU,a.UU.Ok,a.UU.kU,this.YP.getPluginId(),i);if(t.authenticationToken&&"3.0.1"<=this.version?o.Tc(n,JSON.stringify({authenticationToken:t.authenticationToken})):o.bc(n),this.updatePlayerInfo(t),l.nY.bt(this.logger()),this.ad&&this.ad.Ytt(),this.Ktt(t),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){d.ErrorMonitor.lt().logError("exception in user-defined onActiveSession callback",this.id(),t)}},T.prototype.aH=function(){},T.prototype.fH=function(){e.HiveRequestFactory.od(T.WP,l.nY,w.Qtt)},T.prototype.cH=function(t){this.YP=t},T.prototype.id=function(){return"["+T.WP+"] "},T.prototype.$tt=function(t){null!=t[T.WP]&&o.updateOptions(t[T.WP],this.options_)},T.prototype.resolveTicketPromise=function(n){var t,r=this;this.logger().debug(this.id()+"resolving ticket: "+n);var i=this.Xtt(n),s=JSON.stringify(this.Jtt()),e=null;return this.YP.options().testId&&((t={})[g.et._b]=this.YP.options().testId,e=t),o.Tc(i,s,"application/json",e).then(function(t){var i=JSON.parse(t);return r.logger().debug(r.id()+"resolved ticket "+n+" -> "+i.manifest),i},function(t){return r.logger().warn(r.id()+"ticket "+n+" resolve error: ",t),h.reject(new u.HiveTechError(u.aw.TICKET_ERROR,t))}).catch(function(t){return t instanceof u.HiveTechError?h.reject(t):h.reject(new u.HiveTechError(u.aw.cw,t))})},T.prototype.qtt=function(t){var i,n=this;this.logger().debug(this.id()+"Initializing all the sessions via Electron: ",t);var r=this.ztt(),s=JSON.stringify({authResponse:t,configurations:this.Jtt()}),e=null;return this.YP.options().testId&&((i={})[g.et._b]=this.YP.options().testId,e=i),this.logger().debug("My header ",e),o.Tc(r,s,"application/json",e).then(function(t){var i=JSON.parse(t);return n.logger().debug("got all sessions",i),i},function(t){return n.logger().warn(n.id()+" init sessions error: ",t),h.reject(new u.HiveTechError(u.aw.TICKET_ERROR,t))}).catch(function(t){return t instanceof u.HiveTechError?h.reject(t):h.reject(new u.HiveTechError(u.aw.cw,t))})},T.prototype.Xtt=function(t){return t=encodeURIComponent(t),o.wc(a.UU.Sk,a.UU.Ok,a.UU.kU,t,"&",this.YP.getPluginId())},T.prototype.ztt=function(){return o.wc(a.UU.DU,a.UU.Ok,a.UU.kU,this.YP.getPluginId())},T.prototype.XP=function(t,i,n){var r=new c.Ticket;t?r.Gk(t):(r.Hk(n.partnerId,n.customerId,n.validated[0].videoId),r.originalManifest=i.manifest);var s=new e.HiveSessionInternal(t,r,i.manifest,null);return s.lH=!0,s.id=i.sessionId,s.ticket.sessionId=s.id,s},T.prototype.Jtt=function(){var t={HiveConfig:{}};for(var i in window.HiveConfig)for(var n in t.HiveConfig[i]={},window.HiveConfig[i])t.HiveConfig[i][n]=window.HiveConfig[i][n];return t},T.prototype.Ktt=function(t){var i=this;if(void 0!==v.HiveConfig.Stats.render){var n="//"+a.UU.Ok+":"+a.UU.kU+"/proxy/"+this.YP.getPluginId()+"/stats/get";if("undefined"!=typeof EventSource){var r=new EventSource(n);r.onmessage=function(t){i.Ztt(t.data)},r.onerror=function(t){r.close()}}else this.tit=window.setInterval(function(){o.bc(n).then(function(t){i.Ztt(t)})},4e3)}},T.prototype.updatePlayerInfo=function(t){var i=this,n="comm-version="+this.YP.getCommVersion();n+="&plugin-name="+this.YP.getPluginName(),n+="&plugin-version="+this.YP.getPluginVersion(),n+="&player-tech="+this.YP.getPlayerTech(),n+="&player-version="+this.YP.getPlayerVersion(),this.YP.getTelemetryId()&&(n+="&telemetry-id="+this.YP.getTelemetryId());var r=o.wc(a.UU.PU,a.UU.Ok,a.UU.kU,this.YP.getPluginId(),n);return o.bc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),h.reject(t)})},T.prototype.Ztt=function(t){try{var i=JSON.parse(t);for(var n in i)i.hasOwnProperty(n)&&(i[n].human=function(t){return 1e6<t?(t/1e6).toFixed(2)+"MB":1e3<t?(t/1e3).toFixed(2)+"KB":t+"B"});v.HiveConfig.Stats.render(i)}catch(t){console.trace(t)}},T.prototype.logger=function(){return this.YP.logger()},T.WP="HiveJsProxy",T);function T(t,i,n){this.loggerId="[HiveJsProxy]",this.xtt=0,this.YP=t,this.options_=new r.iit,this.$tt(i),this.BU=n}i.HiveJsProxy=y},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(21),o=n(64),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.UU.HU,t.Btt=o.UU.LU,t}i.iit=u},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(99),o=n(6),u=n(55),a=n(1),f=(e=h.nY,s(c,e),c.nB=function(t,i){c.rB[i]?c.rB[i].push(t):c.rB[i]=[t]},c.registerTech=function(t,i){c.nit[i]=t},c.registerComm=function(t,i){c.sB[i]=t},c.prototype.send=function(){var i=this;if(!this.pluginId){var t=Object.keys(c.sB);0<t.length&&(this.pluginId=c.sB[t[0]])}var n=c.rB[this.pluginId],r=c.sB[this.pluginId],s=!1;n.forEach(function(t){u.LP(t)||u.LP(r)||t.manifest!==i.url||(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.hB(i),r.onActivateSession(i.url),s=!0)}),s||(n.forEach(function(t){!u.LP(t)&&!u.LP(r)&&0<=i.url.indexOf(t.manifest)&&(r.logger().debug("Intercepted Manifest Request "+i.url),t.tech.hB(i),r.onActivateSession(i.url),s=!0)}),s||(a.ErrorMonitor.lt().logError("HiveJS Tech or Comm are not defined",this.loggerId),this.Wtt()))},c.prototype.Wtt=function(){var i=this,n=new XMLHttpRequest;n.open("GET",this.url),n.onreadystatechange=function(t){4===n.readyState&&(i.response=n.responseText,i.responseText=n.responseText,i.readyState=4,i.status=n.status,i.onreadystatechange(o.La.createEvent(Event,"readystatechange",t,i)),i.onload(o.La.createEvent(ProgressEvent,"load",t,i)),console.debug("Returned Manifest Request "+i.url))},n.send()},c.prototype.Ytt=function(){e.prototype.send.call(this)},c.sB={},c.rB={},c.rit={},c.nit={},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.Qtt=f},function(t,s,i){"use strict";var r,n=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(s,"s",{value:!0});var h=i(3),e=i(22),o=i(15),u=i(205),a=i(21),f=i(206),c=i(27),l=i(44),v=i(29),d=i(18),E=i(24),p=i(46),w=i(1),g=i(54);s.sit=navigator;var b,y=(b=e.HiveSessionInternal,n(T,b),T);function T(){return null!==b&&b.apply(this,arguments)||this}var m=(O.prototype.getName=function(){return O.WP},O.prototype.getVersion=function(){return this.version},O.prototype.KP=function(){return!1},O.prototype.$P=function(){var n=this;if(null==this.Gtt||1e4<Date.now()-this.xtt){var t=new g.gE;t.bE(navigator.userAgent);var i=t.Bj();if("IE"===i.name&&i.version&&parseInt(i.version)<10)return h.reject(new c.HiveTechError(c.aw.fw,"Internet Explorer < v.10 not supported"));this.eit=Date.now(),this.hit=0;var r="//"+l.zv.Ok+":"+this.YP.options().monitorPort+"/version.json";this.logger().debug(this.id()+"verifying Hive Client version"),this.Gtt=o.bc(r).then(function(t){var i=JSON.parse(t);return n.state=i.state,n.version=i.version,"ready"===n.state?"developer"===n.version||n.version>=n.options_.minVersion?(n.hit=Date.now(),n.logger().debug(n.id()+"Hive Client ready - version "+n.version+" ["+(n.hit-n.eit)+"]"),"ready"):(w.ErrorMonitor.lt().logError("Client version requirement not satisfied",n.id(),{version:n.version,minVersion:n.options_.minVersion}),n.YP.addTechEvent(new E.$E(null,2)),h.reject(new c.HiveTechError(c.aw.vw,"version "+n.version))):(w.ErrorMonitor.lt().logError("Cannot check version: client state not ready",n.id(),{state:n.state}),n.YP.addTechEvent(new E.$E(null,1)),n.hit=Date.now(),n.logger().debug("[Timing] Hive Client not ready",n.hit-n.eit),h.reject(new c.HiveTechError(c.aw.fw,"state "+n.state)))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned error"),500===t.status?(w.ErrorMonitor.lt().logError(i,n.id(),{error:t}),n.YP.addTechEvent(new E.$E(null,1)),h.reject(new c.HiveTechError(c.aw.cw,i))):(w.ErrorMonitor.lt().logError(i,n.id(),null!=t&&null!=t.status&&-1!=t.status?{status:t.status}:void 0),n.YP.addTechEvent(new E.$E(null,0)),h.reject(new c.HiveTechError(c.aw.fw,i)))}).catch(function(t){if(t instanceof c.HiveTechError)return h.reject(t);var i="Error fetching Hive Client version";return w.ErrorMonitor.lt().logError(i,n.id(),t),h.reject(new c.HiveTechError(c.aw.fw,i))}),this.xtt=Date.now()}return this.Gtt},O.prototype.initSession=function(t,i){var n=this,r=this.YP.options().readyCheckTimeout;return(r&&0<r?this.$P().timeout(r,"Client Ready check timed out after "+r+"ms"):this.$P()).then(function(){return n.oit(t).catch(function(t){return h.reject(t)})}).catch(function(t){return t instanceof Error&&(t=new c.HiveTechError(c.aw.dw,t.message)),h.reject(t)})},O.prototype.JP=function(){return this.options_.initTimeout},O.prototype.isActive=function(t,i){return-1<t.indexOf(i.uit)},O.prototype.pd=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [complete close:"+n+"]");var t="//"+l.zv.Ok+":"+this.YP.options().playerPort+"/session?action=stop";t+="&currentSession="+i.id,n&&(t+="&completeStop=true"),n&&s.sit.sendBeacon?(s.sit.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):o.bc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},O.prototype.gl=function(t,i){this.ait=i?d.ul.IDLE:d.ul.al,this.logger().notice("[HiveComm] client state: "+d.ul[this.ait])},O.prototype.ZP=function(t,i){if(this.ait==d.ul.IDLE)return h.resolve(!0);var n="playing-point="+i.playingPoint;n+="&buffer-length="+i.bufferLength,n+="&total-buffering="+i.totalBuffering,n+="&width="+i.width,n+="&height="+i.height,n+="&fullscreen="+i.fullscreen;var r=t.uit+"stats?"+n;return this.logger().trace(r),o.bc(r)},O.prototype.rH=function(t,i,n){var r=this;if(!(i!==E.PlayerEvents.VISIBLE&&i!==E.PlayerEvents.HIDDEN||this.version&&("developer"===this.version||"2017"<=this.version)))return h.resolve(!0);var s=t.uit+"player-event?type="+E.PlayerEvents[i];if(null!=n)for(var e in n)s+="&"+e+"="+n[e];return this.logger().debug(this.id()+"event "+E.PlayerEvents[i],null!=n?n:""),o.bc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),h.reject(t)})},O.prototype.lE=function(t,i){return h.resolve(!0)},O.prototype.updatePlayerInfo=function(t){var i=this;if(this.fit())return this.logger().warn("Player info not supported in this Java client version"),h.resolve(!0);var n="comm-version="+this.YP.getCommVersion();n+="&plugin-name="+this.YP.getPluginName(),n+="&plugin-version="+this.YP.getPluginVersion(),n+="&player-tech="+this.YP.getPlayerTech(),n+="&player-version="+this.YP.getPlayerVersion(),this.YP.getTelemetryId()&&(n+="&telemetry-id="+this.YP.getTelemetryId());var r=t.uit+"player-info?"+n;return o.bc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),h.reject(t)})},O.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{i=this.options_.onError(t)}catch(t){w.ErrorMonitor.lt().logError("Exception in user-defined onError callback",this.id(),t)}return i},O.prototype.aH=function(t,i,n){var r={isReadyIn:this.eit,isReadyOut:this.hit,leaseIn:this.cit,leaseOut:this.lit,resolveIn:this.vit,resolveOut:this.dit};void 0!==i&&null!=i&&(r.sessionId=i.id),void 0!==n&&(r.total=n);var s=JSON.parse(JSON.stringify(r));w.ErrorMonitor.lt().logError(t.message,this.id(),s),this.YP.addTechEvent(new E.$E(null,5,r)),this.Eit()},O.prototype.onActiveSession=function(t){if(this.updatePlayerInfo(t),e.Fd.setItem("hiveActiveSessionId",t.id),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){w.ErrorMonitor.lt().logError("Exception in user-defined onActiveSession callback",this.id(),t)}},O.prototype.cH=function(t){this.YP=t},O.prototype.id=function(){return"["+O.WP+"] "},O.prototype.$tt=function(t){null!=t[O.WP]&&o.updateOptions(t[O.WP],this.options_)},O.prototype.oit=function(i){var n=this,r=(new Date).getTime();return this.pit(i).then(function(t){return t?n.wit(i,t,r):n.resolveTicketPromise(i).then(function(t){return n.wit(i,t,r)})})},O.prototype.pit=function(i){var r=this;if(this.cit=Date.now(),this.YP.options().useSessionCheck){var n="//"+l.zv.Ok+":"+this.YP.options().playerPort+"/session?&action=check";n+="&hivePluginId="+this.YP.getPluginId(),n+="&callback="+encodeURIComponent(i);var t=e.Fd.getItem("hiveActiveSessionId");return e.Fd.removeItem("hiveActiveSessionId"),t&&(n+="&currentSession="+t),this.git(),this.bit(n).then(function(t){return r.lit=Date.now(),t?r.yit(t,n,i,r.cit):(r.logger().debug(r.id()+"session allowed ["+(r.lit-r.cit)+"]"),!1)},function(t){if(400==t.status)return r.Tit("bad request","error resolving ticket",t);if(401==t.status)return r.Tit("unauthorized","error verifying the ticket",t);if(403!=t.status)return 404==t.status?(r.logger().debug(r.id()+"installed version does not support active session check"),r.lit=Date.now(),!1):(w.ErrorMonitor.lt().logError("unhandled error from Java",r.id(),{error:t.status}),r.YP.addTechEvent(new E.$E(null,4)),h.reject(new c.HiveTechError(c.aw.cw,t)));var i=O.mit(t,void 0,"session"),n=i?{Oit:i}:void 0;return w.ErrorMonitor.lt().logError("reports another active session",r.id(),n),r.YP.addTechEvent(new E.$E(null,3,n)),h.reject(new c.HiveTechError(c.aw.lw,"another active session"+(n?" ["+n.Oit+"]":"")))}).catch(function(t){return t instanceof c.HiveTechError?h.reject(t):(w.ErrorMonitor.lt().logError("unhandled error on requestLeaseDirect",r.id(),{error:t}),r.YP.addTechEvent(new E.$E(null,4)),r.lit=Date.now(),r.YP.logger().warn("[Timing] unhandeled session request ",r.lit-r.cit),h.reject(new c.HiveTechError(c.aw.cw,t)))}).finally(function(){clearTimeout(r.Sit)})}return this.logger().debug(this.id()+"Hive session check disabled - will directly resolve ticket (other active sessions may fail)"),h.resolve(!1)},O.prototype.bit=function(t){var i;if(this.YP.options().testId){if(!("developer"!==this.version||this.version<l.zv.Ak))return o.bc(t,void 0,!0,((i={})[v.et._b]=this.YP.options().testId,i));this.logger().warn(this.id()+"The Hive Client Version installed does not support the test id in its generated metrics")}return o.bc(t)},O.prototype.Tit=function(t,i,n){var r=O.mit(n,t);return w.ErrorMonitor.lt().logError(i,this.id()),this.dit=Date.now(),h.reject(new c.HiveTechError(c.aw.TICKET_ERROR,r))},O.mit=function(t,i,n){void 0===n&&(n="status");var r=i;if(t.body)try{r=JSON.parse(t.body)[n]}catch(t){}return r},O.prototype.resolveTicketPromise=function(i){var n=this;this.vit=Date.now(),this.logger().debug(this.id()+"resolving ticket: "+i);var r=this.Xtt(i);return o.bc(r,"application/json").then(function(t){return n.yit(t,r,i,n.vit)},function(t){return n.Rit(t,i)}).catch(function(t){return w.ErrorMonitor.lt().logError("error parsing ticket response",n.id(),t),h.reject(new c.HiveTechError(c.aw.cw,t))})},O.prototype.Rit=function(t,i){return w.ErrorMonitor.lt().logError("error resolving ticket",this.id(),{ticket:i}),h.reject(new c.HiveTechError(c.aw.TICKET_ERROR,t))},O.prototype.yit=function(t,i,n,r){var s=JSON.parse(t),e=u.Iit((0===i.indexOf("//")?location.protocol:"")+i,s.location);return s.version&&!this.version&&(this.version=s.version),this.dit=Date.now(),this.logger().debug(this.id()+"resolved ticket "+n+" -> "+e+" ["+(this.dit-r)+"]"),e},O.prototype.wit=function(t,i,n){var r=this.XP(t,i);if(null==r)throw new c.HiveTechError(c.aw.TICKET_ERROR,"error generating session");var s=(new Date).getTime()-n;return s>=this.options_.warnSlowRespTimeout&&this.aH(new c.HiveTechError(c.aw.dw,this.id()+" The tech initialization took more than "+this.options_.warnSlowRespTimeout+" milliseconds"),r,s),e.HiveRequestFactory.registerTech(this.YP.getPluginId(),this.getName()),r},O.prototype.XP=function(t,i){var n=new p.Ticket;n.Gk(t);var r=new y(t,n,i,null);r.lH=!0;var s=l.zv.Ik.exec(r.manifest);return null!=s?(r.uit=s[1],r.id=s[5],r):null},O.prototype.Xtt=function(t){var i=-1==t.indexOf("?")?"?":"&";return this.fit()?o.wc(l.zv.Rk,l.zv.Ok,this.YP.options().playerPort,t):o.wc(l.zv.Sk,l.zv.Ok,this.YP.options().playerPort,t,i,this.YP.getPluginId4Java())},O.prototype.git=function(){var t=this;this.Sit&&clearTimeout(this.Sit),this.Sit=setTimeout(function(){w.ErrorMonitor.lt().logError("The Lease Request is taking more than "+t.options_.warnSlowRespTimeout+" secs",t.id())},this.options_.warnSlowRespTimeout)},O.prototype.Eit=function(){this.cit=0,this.lit=0,this.vit=0,this.dit=0},O.prototype.logger=function(){return this.YP.logger()},O.prototype.fH=function(){this.Eit()},O.prototype.fit=function(){return this.options_.supportLegacyClient&&(!this.version||this.version.substr(0,4)<"2016")},O.WP="HiveJava",O);function O(t,i){this.xtt=0,this.YP=t,this.options_=new f._it,this.$tt(i),o.parseParameterOptions(window.location.href,new a.UrlConfigurableOptions,this.options_)}s.HiveJava=m},function(t,i,n){var r,f,s,e,c;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/?#]*)(.*)$/,s=/(?:\/|^)\.(?=\/)/g,e=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,c={Iit:function(t,i,n){if(n=n||{},t=t.trim(),!(i=i.trim())){if(!n.Ait)return t;var r=c.Nit(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=c.wT(r.path),c.Cit(r)}var s=c.Nit(i);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return n.Ait?(s.path=c.wT(s.path),c.Cit(s)):i;var e=c.Nit(t);if(!e)throw new Error("Error trying to parse base URL.");if(!e.kit&&e.path&&"/"!==e.path[0]){var h=f.exec(e.path);e.kit=h[1],e.path=h[2]}e.kit&&!e.path&&(e.path="/");var o={scheme:e.scheme,kit:s.kit,path:null,Dit:s.Dit,query:s.query,Cb:s.Cb};if(!s.kit&&(o.kit=e.kit,"/"!==s.path[0]))if(s.path){var u=e.path,a=u.substring(0,u.lastIndexOf("/")+1)+s.path;o.path=c.wT(a)}else o.path=e.path,s.Dit||(o.Dit=e.Dit,s.query||(o.query=e.query));return null===o.path&&(o.path=n.Ait?c.wT(s.path):s.path),c.Cit(o)},Nit:function(t){var i=r.exec(t);return i?{scheme:i[1]||"",kit:i[2]||"",path:i[3]||"",Dit:i[4]||"",query:i[5]||"",Cb:i[6]||""}:null},wT:function(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(e,"")).length;);return t.split("").reverse().join("")},Cit:function(t){return t.scheme+t.kit+t.path+t.Dit+t.query+t.Cb}},t.exports=c},function(t,i,n){"use strict";var r,s=this&&this.lc||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"s",{value:!0});var e,h=n(21),o=n(44),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.zv._k,t.initTimeout=6e4,t.warnSlowRespTimeout=5e3,t.supportLegacyClient=!1,t}i._it=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(65),r=(s.prototype.getResponse=function(){var a=this;return new Promise(function(e,u){a.Mit=new h.FU({xhrSetup:function(t,i){(t=new h.HiveRequestFactory(a.plugin.getPluginId())).open(a.request.method,i.url,!0);for(var n=0,r=a.request.headers;n<r.length;n++){var s=r[n];t.setRequestHeader(s.name,s.value)}return t.responseType=a.request.responseType,t}}),a.Mit.load(a.request,{lK:0,retryDelay:1e3,cK:1e3},{onSuccess:function(i,t,n){a.plugin.logger().debug("SUCCESS REQUEST",i,t,n);var r=Object.keys(i.fK).map(function(t){return{name:t,value:i.fK[t]}}),s={request:a.request,url:a.request.url,headers:r,status:i.code,length:i.data.length||i.data.byteLength,statusText:"OK",body:i.data,elapsedTime:(t.tload-t.trequest)/1e3,timeToFirstByte:(t.tfirst-t.trequest)/1e3};e(s)},onProgress:function(t,i,n){if(a.jit){var r={loadedBytes:t.loaded,totalBytes:t.total,responseTiming:{doneTimestamp:t.tload?t.tload:t.loaded===t.total?performance.now():void 0,headersReceivedTimestamp:t.tfirst,openedTimestamp:t.trequest,progressTimestamp:performance.now()}};a.jit.call(a,r)}},onError:function(t,i){var n=t.code,r=t.text,s=t.url,e=t.fK,h=t.data;a.plugin.logger().debug("FAILED REQUEST",a.request);var o=Object.keys(e).map(function(t){return{name:t,value:e[t]}});u({response:{status:n,statusText:r,headers:o,request:i,url:s,data:h}})},onTimeout:function(t,i){a.plugin.logger().debug("TIMEOUT REQUEST",a.request),u({response:{status:0}})}})})},s.prototype.setProgressListener=function(t){this.jit=t},s.prototype.cancel=function(){this.Mit&&this.Mit.abort()},s);function s(t,i){this.plugin=t,this.request=i,this.setProgressListener=this.setProgressListener.bind(this),this.cancel=this.cancel.bind(this)}i.sY=r}],g={},h.lO=f,h.c=g,h.d=function(t,i,n){h.Pit(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"s",{value:!0})},h.t=function(i,t){if(1&t&&(i=h(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.s)return i;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var r in i)h.d(n,r,function(t){return i[t]}.bind(null,r));return n},h.n=function(t){var i=t&&t.s?function(){return t.default}:function(){return t};return h.d(i,"a",i),i},h.Pit=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.xO="",h(h.yO=100);function h(t){if(g[t])return g[t].exports;var i=g[t]={Hit:t,Lit:!1,exports:{}};return f[t].call(i.exports,i,i.exports,h),i.Lit=!0,i.exports}var f,g});