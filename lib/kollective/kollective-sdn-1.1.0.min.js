exports.ksdn=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=10)}([function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.Strategy={AJAX:"AJAX",FLASH:"FLASH"};t.AgentRequestMode={Ajax:[r.AJAX],Flash:[r.FLASH],AjaxWithFlashFallback:[r.AJAX,r.FLASH]},t.PROTOCOL={HTTPS:"https://",HTTP:"http://",RTMP:"rtmp://"},t.MIME_TYPES={DASH:"application/dash+xml",HLS:"application/x-mpegURL"},t.STREAM_TYPE={FLASH:"FLASH",HDS:"HDS",HLS:"HLS",DASH:"DASH",SMOOTH:"SMOOTH",RTMP:"RTMP"},t.PLAYTYPE={VOD:"VOD",LIVE:"LIVE"},t.LIMITS={LIMIT_REPORT_EVENTS_INFO:4096,LIMIT_REPORT_SEGMENTS_INFO:4096,LIMIT_REPORT_NODE_NAME:16,LIMIT_REPORT_MACHINE_NAME:64},t.EVENT={player:{state_none:0,state_stop:1,state_pause:2,state_play:3,state_buffering:6,state_end:8,state_seek_forward:20,state_seek_reverse:21,state_reload:77,state_exit:99},agent:{detect_ajax:-61,detect_flash:-62,detect_success:-63,detect_timeout:-64,detect_error_ajax_cannot_open:-65,detect_error_invalid_version:-66,detect_error_flash_config:-67,detect_failure_ajax:-68,detect_failure_flash_load:-69,detect_failure_flash_embed:-70,detect_all_fail:-71}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r){if(!(t<=0)){var i="edge"===(0,u.default)().browser,o=function(t){if(t||e.readyState!==XMLHttpRequest.DONE){!(i&&r)&&(e.onreadystatechange=null),t&&e.abort(),n(e)}};i?setTimeout(o,t):(e.ontimeout=o.bind(null,!0),e.timeout=t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.XHR_ERROR=void 0,t.default=function(t){var n=t.method||"GET",r=t.url+(0,a.default)(t.params),o=Object.assign({},t.headers),s=null==t.expectJson||t.expectJson,u=null==t.async||t.async,f=t.onSuccess||c,d=t.onFailure||c,g=t.onError||c,h=t.onTimeout||c,p=t.timeout||0,m=t.body,y=t.continueAfterTimeout||!1;try{var v=new XMLHttpRequest;v.onreadystatechange=function(){if(v&&v.readyState===XMLHttpRequest.DONE)if(v.status>=200&&v.status<400){var t=s&&v.responseText?JSON.parse(v.responseText):v.responseText;f(t,v)}else v.status>=400?d(v):v.status<100&&e(function(){v.onreadystatechange&&g(v,l.NO_RESPONSE)})},v.open(n,r,u),i(v,p,h,y),s&&"GET"===n&&v.setRequestHeader("Accept","application/json");var T=o.auth;T&&(o.Authorization="Kontiki "+T,delete o.auth),Object.getOwnPropertyNames(o).forEach(function(e){v.setRequestHeader(e,o[e])}),v.send(m)}catch(e){g(null,l.CANNOT_OPEN)}};var o=n(9),a=r(o),s=n(4),u=r(s),c=function(){},l=t.XHR_ERROR={NO_RESPONSE:"no_ajax_response",CANNOT_OPEN:"ajax_cannot_open"}}).call(t,n(21).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e,t){return e&&t&&e.length>t?e.substring(0,t):e}var t,n,r=navigator.appVersion,i=navigator.userAgent,o="other",a="-";-1!=(t=i.indexOf("Opera"))?(o="opera",a=i.substring(t+6),-1!=(t=i.indexOf("Version"))&&(a=i.substring(t+8))):-1!=(t=i.indexOf("MSIE"))?(o="ie",a=i.substring(t+5)):-1!=(t=i.indexOf("Edge"))?(o="edge",a=i.substring(t+5)):-1!=(t=i.indexOf("Chrome"))?(o="chrome",a=i.substring(t+7)):-1!=(t=i.indexOf("Safari"))?(o="safari",a=i.substring(t+7),-1!=(t=i.indexOf("Version"))&&(a=i.substring(t+8))):-1!=(t=i.indexOf("Firefox"))?(o="firefox",a=i.substring(t+8)):-1!=i.indexOf("Trident/")?(o="ie",a=i.substring(i.indexOf("rv:")+3)):(o="other",a="-"),-1!=(n=a.indexOf(";"))&&(a=a.substring(0,n)),-1!=(n=a.indexOf(" "))&&(a=a.substring(0,n)),-1!=(n=a.indexOf(")"))&&(a=a.substring(0,n));var s="other",u=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 10.0",r:/(Windows NT 10.0)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0)/},{s:"Windows windows",r:/(WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"OpenBSD",r:/OpenBSD/},{s:"SunOS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"MacOSX",r:/Mac OS X/},{s:"MacOS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"SearchBT",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var c in u){var l=u[c];if(l.r&&l.r.test(i)){s=l.s;break}}var f="";switch(/Windows/.test(s)&&(f=/Windows (.*)/.exec(s)[1],s="windows"),s){case"MacOSX":f=/Mac OS X (10[\.\_\d]+)/.exec(i)[1];break;case"Android":f=/Android ([\.\_\d]+)/.exec(i)[1];break;case"iOS":f=/OS (\d+)_(\d+)_?(\d+)?/.exec(r),f=f[1]+"."+f[2]+"."+(0|f[3])}return{browser:e(o,8),browserVersion:e(a,8),os:e(s,8),osVersion:e(f,8)}}},function(e,t,n){"use strict";function r(){}function i(e){try{return e.then}catch(e){return y=e,v}}function o(e,t){try{return e(t)}catch(e){return y=e,v}}function a(e,t,n){try{e(t,n)}catch(e){return y=e,v}}function s(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof e)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,e!==r&&p(e,this)}function u(e,t,n){return new e.constructor(function(i,o){var a=new s(r);a.then(i,o),c(e,new h(t,n,a))})}function c(e,t){for(;3===e._83;)e=e._18;if(s._47&&s._47(e),0===e._83)return 0===e._75?(e._75=1,void(e._38=t)):1===e._75?(e._75=2,void(e._38=[e._38,t])):void e._38.push(t);l(e,t)}function l(e,t){m(function(){var n=1===e._83?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._83?f(t.promise,e._18):d(t.promise,e._18));var r=o(n,e._18);r===v?d(t.promise,y):f(t.promise,r)})}function f(e,t){if(t===e)return d(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"===typeof t||"function"===typeof t)){var n=i(t);if(n===v)return d(e,y);if(n===e.then&&t instanceof s)return e._83=3,e._18=t,void g(e);if("function"===typeof n)return void p(n.bind(t),e)}e._83=1,e._18=t,g(e)}function d(e,t){e._83=2,e._18=t,s._71&&s._71(e,t),g(e)}function g(e){if(1===e._75&&(c(e,e._38),e._38=null),2===e._75){for(var t=0;t<e._38.length;t++)c(e,e._38[t]);e._38=null}}function h(e,t,n){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.promise=n}function p(e,t){var n=!1,r=a(e,function(e){n||(n=!0,f(t,e))},function(e){n||(n=!0,d(t,e))});n||r!==v||(n=!0,d(t,y))}var m=n(13),y=null,v={};e.exports=s,s._47=null,s._71=null,s._44=r,s.prototype.then=function(e,t){if(this.constructor!==s)return u(this,e,t);var n=new s(r);return c(this,new h(e,t,n)),n}},function(e,t,n){var r,i,o;!function(n,a){i=[],r=a,void 0!==(o="function"===typeof r?r.apply(t,i):r)&&(e.exports=o)}(0,function(){function e(e,t){return-1===e.indexOf(t)?e.length:e.indexOf(t)}function t(t){var n=t.replace(/^v/,"").replace(/\+.*$/,""),r=e(n,"-"),i=n.substring(0,r).split(".");return i.push(n.substring(r+1)),i}function n(e){return isNaN(Number(e))?e:Number(e)}function r(e){if("string"!==typeof e)throw new TypeError("Invalid argument expected string");if(!i.test(e))throw new Error("Invalid argument not valid semver")}var i=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;return function(e,i){[e,i].forEach(r);for(var o=t(e),a=t(i),s=0;s<Math.max(o.length-1,a.length-1);s++){var u=parseInt(o[s]||0,10),c=parseInt(a[s]||0,10);if(u>c)return 1;if(c>u)return-1}var l=o[o.length-1],f=a[a.length-1];if(l&&f){var d=l.split(".").map(n),g=f.split(".").map(n);for(s=0;s<Math.max(d.length,g.length);s++){if(void 0===d[s]||"string"===typeof g[s]&&"number"===typeof d[s])return-1;if(void 0===g[s]||"string"===typeof d[s]&&"number"===typeof g[s])return 1;if(d[s]>g[s])return 1;if(g[s]>d[s])return-1}}else if(l||f)return l?-1:1;return 0}})},function(e,t,n){(function(r){var i,o;!function(t,n){e.exports=n(t)}("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof r?r:this,function(r){"use strict";var a,s=r.Base64;if("undefined"!==typeof e&&e.exports)try{a=n(20).Buffer}catch(e){}var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(u),l=String.fromCharCode,f=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?l(192|t>>>6)+l(128|63&t):l(224|t>>>12&15)+l(128|t>>>6&63)+l(128|63&t)}var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return l(240|t>>>18&7)+l(128|t>>>12&63)+l(128|t>>>6&63)+l(128|63&t)},d=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,g=function(e){return e.replace(d,f)},h=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[u.charAt(n>>>18),u.charAt(n>>>12&63),t>=2?"=":u.charAt(n>>>6&63),t>=1?"=":u.charAt(63&n)].join("")},p=r.btoa?function(e){return r.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,h)},m=a?a.from&&Uint8Array&&a.from!==Uint8Array.from?function(e){return(e.constructor===a.constructor?e:a.from(e)).toString("base64")}:function(e){return(e.constructor===a.constructor?e:new a(e)).toString("base64")}:function(e){return p(g(e))},y=function(e,t){return t?m(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):m(String(e))},v=function(e){return y(e,!0)},T=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),S=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),n=t-65536;return l(55296+(n>>>10))+l(56320+(1023&n));case 3:return l((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return l((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},E=function(e){return e.replace(T,S)},P=function(e){var t=e.length,n=t%4,r=(t>0?c[e.charAt(0)]<<18:0)|(t>1?c[e.charAt(1)]<<12:0)|(t>2?c[e.charAt(2)]<<6:0)|(t>3?c[e.charAt(3)]:0),i=[l(r>>>16),l(r>>>8&255),l(255&r)];return i.length-=[0,0,2,1][n],i.join("")},_=r.atob?function(e){return r.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,P)},b=a?a.from&&Uint8Array&&a.from!==Uint8Array.from?function(e){return(e.constructor===a.constructor?e:a.from(e,"base64")).toString()}:function(e){return(e.constructor===a.constructor?e:new a(e,"base64")).toString()}:function(e){return E(_(e))},A=function(e){return b(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var e=r.Base64;return r.Base64=s,e};if(r.Base64={VERSION:"2.4.5",atob:_,btoa:p,fromBase64:A,toBase64:y,utob:g,encode:y,encodeURI:v,btou:E,decode:A,noConflict:w},"function"===typeof Object.defineProperty){var L=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};r.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",L(function(){return A(this)})),Object.defineProperty(String.prototype,"toBase64",L(function(e){return y(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",L(function(){return y(this,!0)}))}}return r.Meteor&&(Base64=r.Base64),"undefined"!==typeof e&&e.exports?e.exports.Base64=r.Base64:(i=[],void 0!==(o=function(){return r.Base64}.apply(t,i))&&(e.exports=o)),{Base64:r.Base64}})}).call(t,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.replace(/^kontiki:/,"").split(":").reverse().slice(0,-2),n=t[3]||"prod1",o=r[n];return{moid:t[0],company:t[2],dms:n,host:i(null==o?n:o)}};var r={prod1:"",gmcorp:"wg1",eu:"eu1",lbg:"api.kontiki.service.group",vc10:"api-vc10.corp.kontiki.com",vc14:"api-vc14.kontiki.com",tc1rh5:"tc1"},i=function(e){return e.indexOf(".")>=0?"https://"+e:"https://api."+(e&&e+".")+"kontiki.com"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return null==e?"":(e=Object.getOwnPropertyNames(e).reduce(function(n,i){var a=e[i];return null==a?n:(!t&&o.has(i)&&(a=r.Base64.encodeURI(a)),n[i]=a,n)},{}),(0,i.stringify)(e,!0))};var r=n(7),i=n(24),o=new Set(["format","realmId","realmTicket"])},function(e,t,n){n(11),n(16),e.exports=n(17)},function(e,t,n){"use strict";"undefined"===typeof Promise&&(n(12).enable(),window.Promise=n(14)),Object.assign=n(15)},function(e,t,n){"use strict";function r(){c=!1,s._47=null,s._71=null}function i(e){function t(t){(e.allRejections||a(f[t].error,e.whitelist||u))&&(f[t].displayId=l++,e.onUnhandled?(f[t].logged=!0,e.onUnhandled(f[t].displayId,f[t].error)):(f[t].logged=!0,o(f[t].displayId,f[t].error)))}function n(t){f[t].logged&&(e.onHandled?e.onHandled(f[t].displayId,f[t].error):f[t].onUnhandled||(console.warn("Promise Rejection Handled (id: "+f[t].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+f[t].displayId+".")))}e=e||{},c&&r(),c=!0;var i=0,l=0,f={};s._47=function(e){2===e._83&&f[e._56]&&(f[e._56].logged?n(e._56):clearTimeout(f[e._56].timeout),delete f[e._56])},s._71=function(e,n){0===e._75&&(e._56=i++,f[e._56]={displayId:null,error:n,timeout:setTimeout(t.bind(null,e._56),a(n,u)?100:2e3),logged:!1})}}function o(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}function a(e,t){return t.some(function(t){return e instanceof t})}var s=n(5),u=[ReferenceError,TypeError,RangeError],c=!1;t.disable=r,t.enable=i},function(e,t,n){"use strict";(function(t){function n(e){a.length||(o(),s=!0),a[a.length]=e}function r(){for(;u<a.length;){var e=u;if(u+=1,a[e].call(),u>c){for(var t=0,n=a.length-u;t<n;t++)a[t]=a[t+u];a.length-=u,u=0}}a.length=0,u=0,s=!1}function i(e){return function(){function t(){clearTimeout(n),clearInterval(r),e()}var n=setTimeout(t,0),r=setInterval(t,50)}}e.exports=n;var o,a=[],s=!1,u=0,c=1024,l="undefined"!==typeof t?t:self,f=l.MutationObserver||l.WebKitMutationObserver;o="function"===typeof f?function(e){var t=1,n=new f(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}(r):i(r),n.requestFlush=o,n.makeRequestCallFromTimer=i}).call(t,n(0))},function(e,t,n){"use strict";function r(e){var t=new i(i._44);return t._83=1,t._18=e,t}var i=n(5);e.exports=i;var o=r(!0),a=r(!1),s=r(null),u=r(void 0),c=r(0),l=r("");i.resolve=function(e){if(e instanceof i)return e;if(null===e)return s;if(void 0===e)return u;if(!0===e)return o;if(!1===e)return a;if(0===e)return c;if(""===e)return l;if("object"===typeof e||"function"===typeof e)try{var t=e.then;if("function"===typeof t)return new i(t.bind(e))}catch(e){return new i(function(t,n){n(e)})}return r(e)},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,n){function r(a,s){if(s&&("object"===typeof s||"function"===typeof s)){if(s instanceof i&&s.then===i.prototype.then){for(;3===s._83;)s=s._18;return 1===s._83?r(a,s._18):(2===s._83&&n(s._18),void s.then(function(e){r(a,e)},n))}var u=s.then;if("function"===typeof u){return void new i(u.bind(s)).then(function(e){r(a,e)},n)}}t[a]=s,0===--o&&e(t)}if(0===t.length)return e([]);for(var o=t.length,a=0;a<t.length;a++)r(a,t[a])})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){e.forEach(function(e){i.resolve(e).then(t,n)})})},i.prototype.catch=function(e){return this.then(null,e)}},function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,u=r(e),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var l in n)o.call(n,l)&&(u[l]=n[l]);if(i){s=i(n);for(var f=0;f<s.length;f++)a.call(n,s[f])&&(u[s[f]]=n[s[f]])}}return u}},function(e,t,n){"use strict";(function(e){e.version="1.1.0"}).call(t,n(2))},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(!e.sdnData)return null;if(e.sdnData.constructor===Array)for(var t=0;t<e.sdnData.length;t++){var n=e.sdnData[t];if(n&&n.encodingInfo)return n.encodingInfo}return e.sdnData.encodingInfo}function o(e){var t=P.default[e];if(null==t)throw"No player interface for "+e;if("function"!==typeof t.isPlaying||"function"!==typeof t.isLive||"function"!==typeof t.getPlayerPosition||"function"!==typeof t.getPlayerDuration||"function"!==typeof t.setEventHandlers)throw"Incomplete player interface: "+e;return t}function a(e){var t=o(e),n=s.bind(null,e,t);return Object.defineProperty(n,"name",{value:e})}function s(t,n,r){function o(e,t,n){var r=(0,v.default)(n),i=function(e){n===D&&C.onPlaybackRequestFailure&&C.onPlaybackRequestFailure(R,e)&&A&&y()};(0,S.default)({url:(e||r.host)+"/api/v2/playback/video/"+r.moid,headers:{auth:t},onSuccess:function(e){if(n===D){var t=e.playbackVideo;C.onPlaybackRequestSuccess&&C.onPlaybackRequestSuccess(R,t),a(t)}},onFailure:i,onError:i})}function a(e){j=e,s(e)}function s(e){var t=function(t,n){if(e.urn===D)if(t.isInstalled()){R.agent=t;var r={provisionedForCurrentUrn:(0,h.default)(t.getNamespace(),e.urn),notBlackedOut:!t.getInBlackout()},i=!Object.getOwnPropertyNames(r).reduce(function(e,t){return e&&r[t]},!0);if(i)return C.onAgentRejected&&C.onAgentRejected(R,r),void y(e);if(C.onAgentDetected){var o=!!t.getKToken();C.onAgentDetected(R,o,t)}l(e)}else C.onAgentNotDetected&&C.onAgentNotDetected(R,n),y(e)};F=u(e),x=new b.default({hostHttp:e.clientHost,portHttp:e.clientPortHttp,portRtmp:e.clientPortRtmp,portHttps:e.clientPortHttps,timeout:M,flashTimeout:N,flashLoaderUrl:O,agentRequestMode:_,eventLogger:F&&F.logger,callback:t}),F&&F.setAgent(x)}function u(e){if(E&&R.player){var r=P||(0,v.default)(e.urn).host;return new w.default(R.player,t,n,e,E,r,I)}}function l(e){if(R.agent){var t=function(t){if(e.urn===D){var n=t&&t.success?C.onSessionStart:C.onSessionFailure;n&&n(R),m(e)}};R.agent.setSessionData({realmId:e.realmId,realmTicket:e.realmTicket,noPreroll:!0},t)}}function g(e){var t=!!R.agent.getKToken(),n=i(e),r=t?void 0:{noPreroll:!0},o=R.agent.getStreamUrl(n,e.urn,r);return 0===o.length?(console.log("Cannot play stream of type "+n),null):o}function p(e){var t=i(e);R.agent.prefetchStream(t,e.urn,null,function(t){if(R.agent&&e.urn===D){if(t.error){if(!t.reasons.reduce(function(e,t){return e&&("timeout"===t.type||t.status>=400&&t.status<500)},!0))return void(C.onPrimingFailure&&C.onPrimingFailure(R))}C.onPrimingStart&&C.onPrimingStart(R),R.agent.startLongpoll(function(t,n){"string"===typeof t&&e.urn===D&&("manifestProgress"===t?(C.onProgress&&C.onProgress(R,n.progress,e.urn),n.ready&&T(e,g(e),!0)):C.onCommand&&C.onCommand(R,t,n))})}})}function m(e){(0,f.default)(R.getAgentData().version,"10.0")>=0?p(e):T(e,g(e),!0)}function y(e){var t=A||e.mediaCdnUrl;if(!t&&e.sdnData){var n=e.sdnData;n.length&&n.length>0&&(n=n[0]),n&&n.mediaCdnUrl&&(t=n.mediaCdnUrl)}T(e,t,!1)}function T(e,t,n){var r=!n&&A&&L,o=r?L:d.MIME_TYPES[i(e)];if(!k||!t||!o||!R.player)return void console.log("Cannot play source: "+t);C.willSetSource&&C.willSetSource(R),k(R.player,t,o,n),F&&F.saveState(),C.didSetSource&&C.didSetSource(R)}var E,P,_,A,L,O,N,I,M,k,R=this;this.player=null,this.agent=null;var D,C,F,x,j;return this.configure=function(e){var t=function(t,n){return void 0===e[t]?n:e[t]},n=P,r=E;P=t("host",n),E=t("auth",r);var i=!!D&&(P!=n||E!=r);_=t("agentRequestMode",_)||d.AgentRequestMode.NoFlash,A=t("fallbackSrc",A),L=t("fallbackType",L),O=t("flashLoaderUrl",O),N=t("flashTimeout",N),I=t("reportInterval",I),M=t("timeout",M),F&&F.setReportInterval(I),i&&this.stop()}.bind(this),this.play=function(e,t,r){if("function"!==typeof(k=r.setSource||n.setSource))throw"Missing setSource callback: requried when the player interface lacks an implementation";var i,s;if("string"===typeof t?i=t:"object"===("undefined"===typeof t?"undefined":c(t))&&(s=t.playbackVideo||t,i=s.urn),i){if(D&&D!==i)return void this.stop(function(){this.play(e,t,r)}.bind(this));D=i,C=r,this.player=e,s?a(s):o(P,E,i)}}.bind(this),this.stop=function(e){if(!D||!this.agent)return void(e&&e());D=null,C=null,F.disconnect(),F=null,this.player=null,this.agent.stopStream(j.urn,e),this.agent.stopLongpoll(),j=null,this.agent=null}.bind(this),this.getAgentData=function(){return e.agentData},this.getLogs=function(){return e.agentLogs},this.flushLogs=function(){return e.agentLogs="",e.agentLogs},function(){return r&&R.configure(r),R}()}function u(e,t){P.default[e]=Object.assign(P.default[e]||{},t),L[e]=a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.KollectiveAgent=t.AgentRequestMode=t.createPublicToken=t.installPlayerPlugin=t.Players=t.$g=void 0;var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(6),f=r(l),d=n(1),g=n(18),h=r(g),p=n(19),m=r(p),y=n(8),v=r(y),T=n(3),S=r(T),E=n(25),P=r(E),_=n(26),b=r(_),A=n(27),w=r(A);console.log("Kollective SDK v"+e.version);var L={};for(var O in P.default)P.default.hasOwnProperty(O)&&u(O,P.default[O]);t.$g=e,t.Players=L,t.installPlayerPlugin=u,t.createPublicToken=m.default,t.AgentRequestMode=d.AgentRequestMode,t.KollectiveAgent=b.default}).call(t,n(2))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(t||"").split(":"),r=n.indexOf("moid");if(r<0)return!1;var i=n.slice(0,r).join(":")+":";return(e||"").split(",").filter(Boolean).reduce(function(e,t){return e||0===i.indexOf(t)},!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t;return t.indexOf(":")>=0&&(n=(0,o.default)(t).company),"pub-"+r.Base64.encode(e+"#"+n)};var r=n(7),i=n(8),o=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t){if("undefined"===typeof Buffer){var n=new Error('Cannot find module "Buffer"');throw n.code="MODULE_NOT_FOUND",n}e.exports=Buffer},function(e,t,n){(function(e){function r(e,t){this._id=e,this._clearFn=t}var i="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,o=Function.prototype.apply;t.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(22),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(t,n(0))},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return c[u]=r,s(u),u++}function i(e){delete c[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(l)setTimeout(a,0,e);else{var t=c[e];if(t){l=!0;try{o(t)}finally{i(e),l=!1}}}}if(!e.setImmediate){var s,u=1,c={},l=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?function(){s=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),s=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},s=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;s=function(t){var n=f.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){s=function(e){setTimeout(a,0,e)}}(),d.setImmediate=r,d.clearImmediate=i}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(t,n(0),n(23))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){p&&g&&(p=!1,g.length?h=g.concat(h):m=-1,h.length&&s())}function s(){if(!p){var e=i(a);p=!0;for(var t=h.length;t;){for(g=h,h=[];++m<t;)g&&g[m].run();m=-1,t=h.length}g=null,p=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,d=e.exports={};!function(){try{l="function"===typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"===typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var g,h=[],p=!1,m=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||p||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){"use strict";function r(e){return decodeURIComponent(e.replace(/\+/g," "))}function i(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,i={};t=n.exec(e);){var o=r(t[1]),a=r(t[2]);o in i||(i[o]=a)}return i}function o(e,t){t=t||"";var n=[];"string"!==typeof t&&(t="?");for(var r in e)a.call(e,r)&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n.length?t+n.join("&"):""}var a=Object.prototype.hasOwnProperty;t.stringify=o,t.parse=i},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.default={Amp:{isPlaying:function(e){return!(e.seeking||e.paused||e.ended)},isLive:function(e){return e.isLive()},getPlayerPosition:function(e){return 1e3*e.currentTime},getPlayerDuration:function(e){return 1e3*e.duration},setEventHandlers:function(e,t){var n=window.amp.eventName;e.addEventListener(n.timeupdate,t.onTimeUpdate),e.addEventListener(n.error,t.onError),e.addEventListener(n.pause,t.onPause),e.addEventListener(n.play,t.onPlay),e.addEventListener(n.ended,t.onEnd),e.addEventListener(n.seeked,t.onSeekEnd),e.addEventListener(n.waiting,t.onBuffering),e.addEventListener(n.canplaythrough,t.onCanPlay)},setSource:function(e,t,n){e.src([{src:t,type:n}])}},Bitmovin:{isPlaying:function(e){return e.isPlaying()},isLive:function(e){return e.isLive()},getPlayerPosition:function(e){return 1e3*e.getCurrentTime()},getPlayerDuration:function(e){return 1e3*e.getDuration()},setEventHandlers:function(e,t){var n=e.EVENT||window.bitmovin.player.PlayerEvent,r=e.EVENT?"addEventHandler":"on";e[r](n.ON_TIME_CHANGED||n.TimeChanged,t.onTimeUpdate),e[r](n.ON_ERROR||n.Error,t.onError),e[r](n.ON_PAUSED||n.Paused,t.onPause),e[r](n.ON_PLAY||n.Play,t.onPlay),e[r](n.ON_PLAYBACK_FINISHED||n.PlaybackFinished,t.onEnd),e[r](n.ON_SEEKED||n.Seeked,t.onSeekEnd),e[r](n.ON_TIME_SHIFTED||n.TimeShifted,t.onSeekEnd),e[r](n.ON_STALL_STARTED||n.StallStarted,t.onBuffering),e[r](n.ON_STALL_ENDED||n.StallEnded,t.onCanPlay)},setSource:function(e,t,n){var o=function(){switch(n){case i.MIME_TYPES.DASH:return"dash";default:return"hls"}}();e.load(r({},o,t)).then(function(){return e.play()}).catch(function(e){console.log("Bitmovin player load error: "+e)})}},Dashjs:{isPlaying:function(e){return!(e.isSeeking||e.isPaused)},isLive:function(e){return e.isDynamic()},getPlayerPosition:function(e){return 1e3*e.time()},getPlayerDuration:function(e){return 1e3*e.duration()},setEventHandlers:function(e,t){var n=window.dashjs.MediaPlayer.events;e.on(n.PLAYBACK_TIME_UPDATED,t.onTimeUpdate,this),e.on(n.ERROR,t.onError,this),e.on(n.PLAYBACK_PAUSED,t.onPause,this),e.on(n.PLAYBACK_PLAYING,t.onPlay,this),e.on(n.PLAYBACK_ENDED,t.onEnd,this),e.on(n.PLAYBACK_SEEKED,t.onSeekEnd,this),e.on(n.BUFFER_EMPTY,t.onBuffering,this),e.on(n.CAN_PLAY,t.onCanPlay,this)},setSource:function(e,t){e.setAutoPlay(!0),e.attachSource(t)}},Flow:{isPlaying:function(e){return e.playing},isLive:function(e){return e.live},getPlayerPosition:function(e){return e.ready?1e3*e.video.time:0},getPlayerDuration:function(e){return e.ready?1e3*e.video.duration:0},setEventHandlers:function(e,t){e.on("progress",t.onTimeUpdate),e.on("error",t.onError),e.on("pause",t.onPause),e.on("ready",t.onPlay),e.on("resume",t.onPlay),e.on("finish",t.onEnd),e.on("seek",t.onSeekEnd),e.on("buffer",function(){e.video.buffer>e.video.time?t.onCanPlay():t.onBuffering()})},setSource:function(e,t,n){e.load({sources:[{src:t,type:n}]})}},Jwplayer:{isPlaying:function(e){return"playing"===e.getState()},isLive:function(e){return!isFinite(e.duration())},getPlayerPosition:function(e){return 1e3*e.getPosition()},getPlayerDuration:function(e){return 1e3*e.getDuration()},setEventHandlers:function(e,t){e.on("time",t.onTimeUpdate),e.on("error",t.onError),e.on("pause",t.onPause),e.on("play",function(e){"buffering"===e.oldstate&&t.onCanPlay(),t.onPlay()}),e.on("complete",t.onEnd),e.on("seeked",t.onSeekEnd),e.on("buffer",t.onBuffering),e.on("bufferChange",function(n){100===n.bufferPercent&&"playing"!==e.getState()&&t.onCanPlay()})},setSource:function(e,t){e.setup({file:t,autostart:"viewable"})}},Theo:{isPlaying:function(e){return!(e.seeking||e.paused||e.ended)},isLive:function(e){return!isFinite(e.duration)},getPlayerPosition:function(e){return 1e3*e.currentTime},getPlayerDuration:function(e){return 1e3*e.duration},setEventHandlers:function(e,t){e.addEventListener("timeupdate",t.onTimeUpdate),e.addEventListener("error",t.onError),e.addEventListener("pause",t.onPause),e.addEventListener("playing",t.onPlay),e.addEventListener("ended",t.onEnd),e.addEventListener("seeked",t.onSeekEnd),e.addEventListener("waiting",t.onBuffering),e.addEventListener("canplaythrough",t.onCanPlay)},setSource:function(e,t,n){e.source={sources:[{src:t,type:n}]},e.play()}},Videojs:{isPlaying:function(e){return!(e.seeking||e.paused||e.ended)},isLive:function(e){return!isFinite(e.duration())},getPlayerPosition:function(e){return 1e3*e.currentTime},getPlayerDuration:function(e){return 1e3*e.duration()},setEventHandlers:function(e,t){e.on("timeupdate",t.onTimeUpdate),e.on("error",t.onError),e.on("pause",t.onPause),e.on("play",t.onPlay),e.on("ended",t.onEnd),e.on("seeked",t.onSeekEnd),e.on("stalled",t.onBuffering),e.on("canplay",t.onCanPlay)},setSource:function(e,t,n){e.src({src:t,type:n}),e.play()}}}},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function i(e){return"$g."+e+"Response"}function o(t){function n(e,t){I[e]=I[e]||[],I[e].push(t)}function r(e){if(e.strategies=(e.strategies||o()).slice(),0===e.strategies.length)return void e.onAllStrategiesFailed(I[e.requestId]);null==e.requestId&&(e.requestId=M,M++);var t=e.uri.split("/"),n=t[t.length-1],a=e.options||{};switch(e.callbackParam=e.callbackParam||i(n),e.expectJson=null==e.expectJson||e.expectJson,e.onStart=e.onStart||T,e.onTimeout=e.onTimeout||E,e.onError=e.onError||P,e.onFailure=e.onFailure||_,e.continueAfterTimeout=e.continueAfterTimeout||!1,e.flashDivId=a.flashDivId||"kollectiveAgent",e.flashTimeout=a.flashTimeout||V,e.timeout=a.timeout||e.defaultTimeout||B,e.strategies.shift()){case c.Strategy.AJAX:h(e.protocol||c.PROTOCOL.HTTPS,e);break;case c.Strategy.FLASH:y(e.protocol||c.PROTOCOL.HTTP,e);break;default:r(e)}}function o(){return O.isInstalled()?s(W):W}function s(e){e=e.slice();for(var t=[];e.length>0;){var n=e.shift();(function(e){switch(e){case c.Strategy.AJAX:return O.checkMinVersion("10.0");case c.Strategy.FLASH:return!0;default:return!1}})(n)&&t.push(n)}return t}function l(e,t){switch(e){case c.PROTOCOL.HTTPS:return c.PROTOCOL.HTTPS+F+":"+H+t;case c.PROTOCOL.HTTP:return c.PROTOCOL.HTTP+C+":"+x+t;case c.PROTOCOL.RTMP:return c.PROTOCOL.RTMP+C+":"+j+t;default:return null}}function h(e,t){var n=t.method,i=t.expectJson,o=t.timeout,a=t.continueAfterTimeout,s=t.uri,u=t.params,f=t.ignoreBase64Encoding,d=t.requestId,h=t.onStart,m=t.onSuccess,y=t.onFailure,v=t.onError,T=t.onTimeout,S=l(e,s)+(0,p.default)(u,f),E=c.Strategy.AJAX;h&&h(E,S),(0,g.default)({url:S,method:n,expectJson:i,timeout:o,continueAfterTimeout:a,onSuccess:m.bind(null,E),onFailure:function(e){y(E,d,e,"ajax"),r(t)},onError:function(e,n){v(E,d,e,n),r(t)},onTimeout:function(e){T(E,d,e),r(t)}})}function y(t,n){e.timeoutTripped=!1;var i=Object.assign({},n.params);i.callback=n.callbackParam,e.lastFlashUrl=(l(t,n.uri)+(0,p.default)(i,n.ignoreBase64Encoding)).replace("&","%26"),n.onStart&&n.onStart(c.Strategy.FLASH,e.lastFlashUrl),e.timeoutFlash=n.flashTimeout;var o=function(e){n.onFailure(c.Strategy.FLASH,n.requestId,null,e),r(n)};if("undefined"!=typeof window.swfobject){e.flashSuccessCallback=n.onSuccess.bind(null,c.Strategy.FLASH),e.flashFailureCallback=o,e.flashTimeoutCallback=function(){e.timeoutTripped=!0,n.onTimeout(c.Strategy.FLASH,n.requestId),r(n)};var a={url:e.lastFlashUrl},s={allowscriptaccess:"always"};window.swfobject.embedSWF(U,n.flashDivId,"8","8","10.0.0","",a,s,"",function(t){t.success?(e.timeoutTripped=!1,e.flashLoadTimeoutID=setTimeout(e.flashTimeoutCallback,e.timeoutFlash)):o("flash_embed")})}else n.onError(c.Strategy.FLASH,n.requestId,"flash_config"),r(n)}function v(e){q&&q.addAgentEvent&&e&&q.addAgentEvent(e)}function T(t,n){switch(t){case c.Strategy.AJAX:e.agentLogs+="Attempting AJAX request";break;case c.Strategy.FLASH:e.agentLogs+="Attempting FLASH request"}e.agentLogs+=": "+n}function S(t,n){return t=t||function(){},n=n||function(){return null},function(r,i){switch(r){case c.Strategy.AJAX:e.agentLogs+="AJAX request succeeded\n",t(i);break;case c.Strategy.FLASH:e.agentLogs+="FLASH request succeeded\n",t(n())}}}function E(t,r,i){switch(n(r,{type:"timeout",reason:"timeout",strategy:t,status:i.status}),t){case c.Strategy.AJAX:e.agentLogs+="AJAX request timed out\n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH request timed out\n"}}function P(t,r,i,o){switch(n(r,{type:"error",reason:o,strategy:t,status:i?i.status:0}),t){case c.Strategy.AJAX:e.agentLogs+="AJAX request failed with error:"+o+"\n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH request failed due to improper Flash configuration\n"}}function _(t,r,i,o){switch(n(r,{type:"error",reason:o,strategy:t,status:i.status}),t){case c.Strategy.AJAX:e.agentLogs+="AJAX request failed:"+i.statusText+" \n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH request failed\n"}}function b(e){return function(t){e({error:"Request failed",reasons:t})}}function A(e){return Object.assign(Object.assign({},e),L)}function w(t,n,i){R=(new Date).getTime(),r({uri:"/api/v1/longpoll",params:n,defaultTimeout:3e4,continueAfterTimeout:!0,options:i,onSuccess:S(function(e){if(!k){var r=!!e&&e.ts,o=!!e&&e.cmd,a=!!e&&e.params;if("manifestProgress"===o){var s=a&&a.percent,u=!!s&&100===parseInt(s);t(o,{progress:parseInt(s),ready:u})}else t(o,a);if(!k){var c=Object.assign({},n);c.ts=r,w(t,c,i)}}},function(){return e.longpollData}),onAllStrategiesFailed:function(e){if(!k){e=e||[];var r=e.filter(function(e){return!("timeout"===e.reason||e.reason===d.XHR_ERROR.NO_RESPONSE)}),o=0;if(r.length>0)t({error:"Longpoll request failed. Attempting again.",reasons:r});else{var a=(new Date).getTime()-R;o=Math.max(0,3e4-a);if("edge"===(0,f.default)().browser&&e.filter(function(e){return"timeout"===e.reason}).length>0)return}setTimeout(function(){k||w(t,n,i)},o)}}})}if("object"!==("undefined"===typeof t?"undefined":a(t)))throw"KollectiveAgent Error: No parameter object passed in";e.agentData=null,e.agentLogs="",e.timeoutTripped=!1;var L,O=this,N=!1,I={},M=1,k=!0,R=null,D=t.callback||function(){},C=t.hostHttp||"127.0.0.1",F=t.hostHttps||"client.kontiki.com",x=""+(t.portHttp||"31013"),j=""+(t.portRtmp||"31014"),H=""+(t.portHttps||"31015"),V=t.flashTimeout||5e3,B=t.timeout||5e3,U=t.flashLoaderUrl||"flash/kontikiagentflashloader-3.swf",W=t.agentRequestMode||c.AgentRequestMode.Ajax,q=t.eventLogger;!function(){r({strategies:W,uri:"/kontiki/kontiki/cache/RetrieveAgentData",callbackParam:i("agent"),onStart:function(t){switch(t){case c.Strategy.AJAX:v(c.EVENT.agent.detect_sajax),e.agentLogs+="Attempting AJAX detection\n";break;case c.Strategy.FLASH:v(c.EVENT.agent.detect_flash),e.agentLogs+="Attempting FLASH detection\n"}},onSuccess:function(t,n,r){switch(t){case c.Strategy.AJAX:if(!n||!n.version)throw v(c.EVENT.agent.detect_error_invalid_version),"responseText lacked agent version: "+r.responseText;v(c.EVENT.agent.detect_success),e.agentLogs+="AJAX detection succeeded! Agent version:"+n.version+"\n",e.agentData=n,D(O);break;case c.Strategy.FLASH:v(c.EVENT.agent.detect_success),e.agentLogs+="FLASH detection has succeeded\n",N=!0,D(O)}},onTimeout:function(t,r,i){switch(n(r,{type:"timeout",reason:"timeout",strategy:t,status:i.status}),v(c.EVENT.agent.detect_timeout),t){case c.Strategy.AJAX:e.agentLogs+="AJAX detection timed out\n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH detection timed out\n"}},onError:function(t,r,i,o){n(r,{type:"error",reason:o,strategy:t,status:i?i.status:0});var a=o&&c.EVENT.agent["detect_error_"+o];switch(a&&v(a),e.agentData=null,t){case c.Strategy.AJAX:e.agentLogs+="AJAX detection has failed with error:"+a+"\n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH detection failed due to improper Flash configuration\n"}},onFailure:function(t,r,i,o){n(r,{type:"error",reason:o,strategy:t,status:i.status});var a=o&&c.EVENT.agent["detect_failure_"+o];switch(a&&v(a),e.agentData=null,t){case c.Strategy.AJAX:e.agentLogs+="AJAX detection has failed:"+i.statusText+" \n";break;case c.Strategy.FLASH:e.agentLogs+="FLASH detection failed\n"}},onAllStrategiesFailed:function(e){v(c.EVENT.agent.detect_all_fail),D(O,e)}})}(),this.isInstalled=function(){return"undefined"!==typeof e.agentData&&null!=e.agentData}.bind(this),this.getVersion=function(){return this.isInstalled()?e.agentData.version:m}.bind(this),this.getNamespace=function(){return this.isInstalled()?e.agentData.urn_namespace:m}.bind(this),this.getMachineName=function(){return this.isInstalled()?e.agentData.machine_name:m}.bind(this),this.getNodeId=function(){return this.isInstalled()?e.agentData.node_id:m}.bind(this),this.getRtmpClientPlaybackSupported=function(){return this.isInstalled()&&e.agentData.rtmp_mp4_vod}.bind(this),this.getInBlackout=function(){return this.isInstalled()?e.agentData.blackout:m}.bind(this),this.getStreamUri=function(e,t,n){if(!this.isInstalled())return m;switch(e){case c.STREAM_TYPE.FLASH:return"/stream/"+t+"/"+(n||"content.f4v");case c.STREAM_TYPE.HDS:return"/stream/"+t+"/"+(n||"manifest.f4m");case c.STREAM_TYPE.HLS:return"/stream/"+t+"/"+(n||"chunklist.m3u8");case c.STREAM_TYPE.DASH:return"/stream/"+t+"/"+(n||"playlist.ism/Manifest(format=mpd-time-csf)");case c.STREAM_TYPE.SMOOTH:return"/stream/"+t+"/"+(n||"playlist.ism/Manifest");case c.STREAM_TYPE.RTMP:return"/stream/"+t;default:return""}}.bind(this),this.getStreamUrl=function(e,t,n,r){if(!this.isInstalled())return m;var i=this.getStreamUri(e,t,r),o=this.checkMinVersion("10.0")?c.PROTOCOL.HTTPS:c.PROTOCOL.HTTP;return e===c.STREAM_TYPE.RTMP&&(o=c.PROTOCOL.RTMP),l(o,i)+(0,p.default)(A(n))}.bind(this),this.getKToken=function(){return this.isInstalled()?e.agentData.ktoken:null}.bind(this),this.isDetectViaFlash=function(){return N},this.checkMinVersion=function(t){return this.isInstalled()&&(0,u.default)(e.agentData.version,t)>=0}.bind(this),this.getAgentLogs=function(){return e.agentLogs},this.setSessionData=function(e,t,n){L={realmId:e.realmId,realmTicket:e.realmTicket,noPreroll:e.noPreroll};var i=this.getKToken();if(null==i)t();else{var o={ktoken:i},a=function(e){var n=null==e||null==e.error;n&&(L=o),t(n?{success:n}:e)};r({uri:"/api/v1/setSessionData",ignoreBase64Encoding:!0,method:"POST",params:A(o),options:n,onSuccess:S(a),onAllStrategiesFailed:b(a)})}}.bind(this),this.getContentStatus=function(t,n,i){r({uri:"/api/v1/contentStatus",params:{urn:t},options:i,onSuccess:S(n,function(){return e.contentStatusData}),onAllStrategiesFailed:b(n)})},this.downloadMonitor=function(t,n,i){r({uri:"/api/v1/downloadMonitor",params:{urn:t},options:i,onSuccess:S(n,function(){return e.downloadMonitorData}),onAllStrategiesFailed:b(n)})},this.isContentPrefetched=function(){return"undefined"!==typeof e.contentStatusData&&"Complete"==e.contentStatusData.state},this.getContentProgress=function(){return"undefined"!==typeof e.contentStatusData?e.contentStatusData.progress:-1},this.getDownloadMonitorData=function(){return e.downloadMonitorData},this.stopStream=function(e,t,n){r({uri:"/api/v1/stopStream",params:A({urn:e}),options:n,onSuccess:S(t),onAllStrategiesFailed:b(t)})},this.deleteContent=function(e,t,n){r({uri:"/api/v1/contentDelete",params:A({urn:e}),options:n,onSuccess:S(t),onAllStrategiesFailed:b(t)})},this.requestDeliveryGuid=function(t,n,i){r({uri:"/api/v1/contentDeliveryGuid",params:A({urn:t}),options:i,onSuccess:S(n,function(){return e.contentDeliveryGuidData}),onAllStrategiesFailed:b(n)})},this.sendErrorLogs=function(t,n){r({uri:"/api/v1/sendErrorLogs",params:{_:1},options:n,onSuccess:S(t,function(){return e.sendErrorLogsData}),onAllStrategiesFailed:b(t)})},this.prefetchStream=function(t,n,o,a,s){var u=this.getStreamUri(t,n,s&&s.file);r({expectJson:!1,protocol:t===c.STREAM_TYPE.RTMP?c.PROTOCOL.RTMP:null,uri:u,params:A(o),options:s,callbackParam:i("prefetchStream"),onSuccess:S(a,function(){return e.prefetchStreamData}),onAllStrategiesFailed:b(a)})}.bind(this),this.startLongpoll=function(e,t){k=!1,w(e,A({ts:0}),t)}.bind(this),this.stopLongpoll=function(){k=!0}}Object.defineProperty(t,"__esModule",{value:!0});var a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(6),u=r(s),c=n(1),l=n(4),f=r(l),d=n(3),g=r(d),h=n(9),p=r(h),m="";t.default=o}).call(t,n(2))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,r,i,o,u){function l(){S.logger&&(S.logger.onPlayerStateChange(s.EVENT.player.state_exit),m(!0))}function g(e){S.logger&&(S.logger.onPlayerStateChange(e),S.saveState())}function h(e){S.agent&&setTimeout(S.agent.stopStream.bind(null,r.urn),e)}function p(){!P&&S.agent&&S.agent.requestDeliveryGuid(r.urn,function(e){P=e.deliveryGuid})}function m(e){if(S.agent&&S.logger){if(!P)return void p();T();var n=v(),a=new Date;S.logger.updateLastReportTime();var s=S.logger.getPlayDuration();s<=0&&(s=1);var u=(0,c.default)(),l={contentMoid:r.moid,formatMoid:r.formatMoid,playGuid:E,deliveryGuid:P,percentage:0,inProgress:n,playDuration:s,startTime:S.logger.getStartTime(),playType:S.logger.getPlayType(),endTime:a.getTime(),prepareTime:S.logger.getPrepareTime(),bufferTime:S.logger.getBufferTime(),stallCount:S.logger.getStallCount(),stallTime:S.logger.getStallTime(),segmentList:S.logger.getSegmentList(),eventList:S.logger.getEventList(),nodeId:S.agent.getNodeId(),machineName:S.agent.getMachineName(),playContext:t,browser:u.browser,browserVersion:u.browserVersion,os:u.os,osVersion:u.osVersion},f=JSON.stringify({reportPlay:l}),d=o+"/api/v2/playback/report";n&&!e?y(d,f,!0):navigator.sendBeacon?navigator.sendBeacon(d+"?_ctype=json&auth="+i,f):y(d,f,!1)}}function y(e,t,n){window.XMLHttpRequest&&e&&((0,f.default)({method:"POST",headers:{auth:i,"Content-Type":"application/json"},url:e,body:t,async:n}),n&&(_&&clearTimeout(_),_=setTimeout(function(){m(!1)},u)))}function v(){return n.isLive(e)}function T(){S.logger&&S.logger.setPlayType(v()?s.PLAYTYPE.LIVE:s.PLAYTYPE.VOD)}var S=this;this.logger=new a.default(e,n);var E=r.guid,P=null,_=null;this.setReportInterval=function(e){u=1e3*Math.max(60,e||r.reportInterval||0)}.bind(this),this.setReportInterval(u),this.disconnect=function(){l(),this.agent=null,this.logger=null,_&&clearTimeout(_)}.bind(this),this.setAgent=function(e){this.agent=e}.bind(this),this.saveState=function(){this.logger&&this.logger.saveCurrentState(E)}.bind(this);var b={onTimeUpdate:function(){},onError:function(){},onPause:g.bind(null,s.EVENT.player.state_pause),onPlay:g.bind(null,s.EVENT.player.state_play),onBuffering:g.bind(null,s.EVENT.player.state_buffering),onEnd:function(){g(s.EVENT.player.state_end),h(d.DEFAULT),l()},onSeekEnd:function(){if(this.logger){var e=this.logger.lastSegmentPercentage,t=this.logger.getPlayerPercentage();if(0!==e||0!==t){var n=e<t?s.EVENT.player.state_seek_forward:s.EVENT.player.state_seek_reverse;this.logger.onPlayerStateChange(n,t,t),this.saveState()}}}.bind(this),onCanPlay:function(){p(),setTimeout(function(){m(!1)},1e3)}};!function(){if(n.setEventHandlers&&n.setEventHandlers(e,b),window.onbeforeunload){var t=window.onbeforeunload;window.onbeforeunload=function(){h(d.NONE),l(),t()}}else window.onbeforeunload=function(){h(d.NONE),l()};if(window.onunload){var r=window.onunload;window.onunload=function(){h(d.NONE),l(),r()}}else window.onunload=function(){h(d.NONE),l()}}()}Object.defineProperty(t,"__esModule",{value:!0});var o=n(28),a=r(o),s=n(1),u=n(4),c=r(u),l=n(3),f=r(l),d={NONE:0,DEFAULT:100};t.default=i},function(e,t,n){"use strict";function r(e,t){var n=new Date;this.startTime=n.getTime(),this.playerState=i.EVENT.player.state_none,this.playType=i.PLAYTYPE.LIVE,this.firstEventTime=0,this.firstPlayTime=0,this.firstBufferTime=0,this.bufferTime=0,this.lastTime=0,this.lastEvent=0,this.stallCount=0,this.stallTime=0,this.agentEventList="",this.rawEventList="",this.resetPlayTime=!1,this.lastFlashPlayStateTime=0,this.mediaEnded=!1,this.playDuration=0,this.lastReportTime=-1,this.duration=0,this.percentage=0,this.maxPercentage=0,this.buffering=!1,this.segmentList="",this.lastSegmentEvent="",this.lastSegmentPercentage=0,this.playStateCallback=null,this.getTime=function(){return(new Date).getTime()-this.startTime},this.getLastEvent=function(){return this.lastEvent},this.timeToPercent=function(e){if(0==this.duration)return 0;var t=this.duration?Math.round(1e3*e/this.duration)/10:0;return Math.min(t,100)},this.getPlayerPercentage=function(){var n=t.getPlayerDuration(e),r=t.getPlayerPosition(e);return(0,a.default)(n)&&(0,a.default)(r)&&0!=n&&(this.duration=n,this.percentage=Math.round(r/this.duration)/10,this.percentage=Math.min(this.percentage,100),this.maxPercentage=Math.max(this.maxPercentage,this.percentage)),this.percentage},this.getCachedPlayerPercentage=function(){return this.percentage},this.getMaxPercentage=function(){return this.maxPercentage},this.getStartTime=function(){return this.startTime},this.getPlayDuration=function(){return this.lastEvent==i.EVENT.player.state_play&&this.onPlayerStateChange(i.EVENT.player.state_play),this.playDuration},this.isPlaying=function(){return t.isPlaying(e)},this.updateLastReportTime=function(){this.lastReportTime=this.getTime()},this.hasNewReportingData=function(){return this.isPlaying()||this.lastTime>this.lastReportTime},this.getBufferTime=function(){return this.bufferTime},this.getPrepareTime=function(){return this.firstPlayTime},this.getStallCount=function(){return this.stallCount},this.getStallTime=function(){return this.stallTime},this.getSegmentList=function(){return this.segmentList},this.getEventList=function(){var e=this.agentEventList+this.rawEventList;if(e.length>=i.LIMITS.LIMIT_REPORT_EVENTS_INFO){e=e.substring(0,i.LIMITS.LIMIT_REPORT_EVENTS_INFO);var t=e.lastIndexOf(":");t>0&&(e=e.substring(0,t))}return e},this.isMediaEnded=function(){return this.mediaEnded},this.isBuffering=function(){return this.buffering},this.addSegment=function(e,t,n){var r=this.segmentList+"("+e+","+t+","+n+")";r.length<i.LIMITS.LIMIT_REPORT_SEGMENTS_INFO&&(this.segmentList=r)},this.addAgentEvent=function(e){var t=this.agentEventList+":"+e+":"+this.getTime();t.length<i.LIMITS.LIMIT_REPORT_EVENTS_INFO&&(this.agentEventList=t)},this.onPlayerStateChange=function(e,t,n){if(e!=i.EVENT.player.state_ready){var r=this.getTime(),o=r-this.lastTime,a=this.getCachedPlayerPercentage();if(this.lastEvent==i.EVENT.player.state_play&&(this.playDuration+=r-this.lastTime),this.lastEvent==e)return void(this.lastTime=r);0==this.firstEventTime&&(this.firstEventTime=r),0==this.resetPlayTime&&0!=this.firstPlayTime&&this.lastEvent==i.EVENT.player.state_play&&e==i.EVENT.player.state_buffering&&o<10&&(this.resetPlayTime=!0,this.firstPlayTime=0),0==this.firstBufferTime&&e==i.EVENT.player.state_buffering&&(this.firstBufferTime=r),0!=this.firstPlayTime&&this.lastEvent==i.EVENT.player.state_buffering&&e!=i.EVENT.player.state_buffering&&o>10&&(this.stallCount++,this.stallTime+=r-this.lastTime),0===this.firstPlayTime&&e===i.EVENT.player.state_play&&(this.firstPlayTime=r,this.bufferTime=r-this.firstBufferTime),this.rawEventList+=":"+e+":"+r,e==i.EVENT.player.state_end&&(this.percentage=this.maxPercentage=100,this.mediaEnded=!0),this.buffering=e==i.EVENT.player.state_buffering,e==i.EVENT.player.state_stop&&(this.addSegment(this.lastSegmentPercentage,a,"st"),this.lastSegmentPercentage=0),e==i.EVENT.player.state_pause&&(this.addSegment(this.lastSegmentPercentage,a,"ps"),this.lastSegmentPercentage=a),e==i.EVENT.player.state_forward&&(this.addSegment(this.lastSegmentPercentage,t,"ff"),this.lastSegmentPercentage=n),e==i.EVENT.player.state_reverse&&(this.addSegment(this.lastSegmentPercentage,t,"rw"),this.lastSegmentPercentage=n),e==i.EVENT.player.state_exit&&(this.lastEvent==i.EVENT.player.state_stop&&o<100?this.addSegment(a,a,"ex"):this.addSegment(this.lastSegmentPercentage,a,"ex")),this.lastTime=r,this.lastEvent=e,this.playStateCallback&&this.playStateCallback(e)}},this.saveLocalStorage=function(e,t){if("undefined"!==typeof Storage)try{localStorage.setItem(e,t)}catch(e){return void console.log(e)}},this.readLocalStorage=function(e){if("undefined"!==typeof Storage)try{return localStorage.getItem(e)}catch(e){return console.log(e),null}},this.removeLocalStorage=function(e){if("undefined"!==typeof Storage)try{localStorage.removeItem(e)}catch(e){return void console.log(e)}},this.saveCurrentState=function(e){if(e){var t=this.readLocalStorage("ksdn.current.report.session.id");t&&t!=e&&this.removeLocalStorage("ksdn.report.session.data."+t),this.saveLocalStorage("ksdn.current.report.session.id",e);var n={startTime:this.startTime,playerState:this.playerState,firstEventTime:this.firstEventTime,firstPlayTime:this.firstPlayTime,firstBufferTime:this.firstBufferTime,segmentList:this.segmentList,stallCount:this.stallCount,stallTime:this.stallTime,bufferTime:this.getBufferTime(),playDuration:this.playDuration,agentEventList:this.agentEventList,rawEventList:this.rawEventList,lastTime:this.lastTime,lastEvent:this.lastEvent,playType:this.playType};this.saveLocalStorage("ksdn.report.session.data."+e,JSON.stringify(n))}},this.readSavedState=function(e){if(!e)return null;var t=this.readLocalStorage("ksdn.current.report.session.id");if(t){if(t==e){var n=this.readLocalStorage("ksdn.report.session.data."+e);return JSON.parse(n)}this.removeLocalStorage("ksdn.report.session.data."+t)}return null},this.restoreSavedState=function(e){if(e){var t=this.readSavedState(e);if(t){this.startTime=t.startTime,this.playerState=t.playerState,this.firstEventTime=t.firstEventTime,this.firstPlayTime=t.firstPlayTime,this.firstBufferTime=t.firstBufferTime,this.segmentList=t.segmentList,this.stallCount=t.stallCount,this.stallTime=t.stallTime,this.bufferTime=t.bufferTime,this.playDuration=t.playDuration,this.lastTime=t.lastTime,this.lastEvent=t.lastEvent,this.playType=t.playType,this.agentEventList=t.agentEventList;var n=this.getTime(),r=t.rawEventList+":"+i.EVENT.player.state_reload+":"+n;this.rawEventList=r}}},this.setPlayType=function(e){this.playType=e},this.getPlayType=function(){return this.playType}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(29),a=function(e){return e&&e.__esModule?e:{default:e}}(o);t.default=r},function(e,t,n){function r(e){return"number"==typeof e&&o(e)}var i=n(30),o=i.isFinite;e.exports=r},function(e,t,n){var r=n(31),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(t,n(0))}]);